
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="PLAYA ain't a LAYout Analyzer">
      
      
        <meta name="author" content="David Huggins-Daines">
      
      
        <link rel="canonical" href="https://dhdaines.github.io/playa/v1.0.0/working-in-the-pdf-mine/">
      
      
        <link rel="prev" href="../data/">
      
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>PDFMiner.six compatibility - PLAYA</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#working-in-the-pdf-mine" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="PLAYA" class="md-header__button md-logo" aria-label="PLAYA" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PLAYA
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              PDFMiner.six compatibility
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/dhdaines/playa" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    dhdaines/playa
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="PLAYA" class="md-nav__button md-logo" aria-label="PLAYA" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    PLAYA
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/dhdaines/playa" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    dhdaines/playa
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CLI
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Reference
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data API
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    PDFMiner.six compatibility
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    PDFMiner.six compatibility
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#reference" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reference
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#playa.miner" class="md-nav__link">
    <span class="md-ellipsis">
      
        miner
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="miner">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.miner.GraphicState" class="md-nav__link">
    <span class="md-ellipsis">
      
        GraphicState
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LAParams" class="md-nav__link">
    <span class="md-ellipsis">
      
        LAParams
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTAnno" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTAnno
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTChar" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTChar
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTComponent" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTComponent
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTContainer" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTContainer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTCurve" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTCurve
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTFigure" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTFigure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTImage" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTImage
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTItem" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTItem
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LTItem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTItem.analyze" class="md-nav__link">
    <span class="md-ellipsis">
      
        analyze
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTLayoutContainer" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTLayoutContainer
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LTLayoutContainer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTLayoutContainer.group_textboxes" class="md-nav__link">
    <span class="md-ellipsis">
      
        group_textboxes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTLayoutContainer.group_textlines" class="md-nav__link">
    <span class="md-ellipsis">
      
        group_textlines
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTLine" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTLine
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTPage" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTPage
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTRect" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTRect
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTText" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTText
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LTText">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTText.get_text" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_text
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTTextBox" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTTextBox
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTTextLine" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTTextLine
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTTextLineHorizontal" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTTextLineHorizontal
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LTTextLineHorizontal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTTextLineHorizontal.find_neighbors" class="md-nav__link">
    <span class="md-ellipsis">
      
        find_neighbors
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTTextLineVertical" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTTextLineVertical
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LTTextLineVertical">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTTextLineVertical.find_neighbors" class="md-nav__link">
    <span class="md-ellipsis">
      
        find_neighbors
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.NameTree" class="md-nav__link">
    <span class="md-ellipsis">
      
        NameTree
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.NumberTree" class="md-nav__link">
    <span class="md-ellipsis">
      
        NumberTree
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFDocument" class="md-nav__link">
    <span class="md-ellipsis">
      
        PDFDocument
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PDFDocument">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFDocument.destinations" class="md-nav__link">
    <span class="md-ellipsis">
      
        destinations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFDocument.fonts" class="md-nav__link">
    <span class="md-ellipsis">
      
        fonts
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFDocument.names" class="md-nav__link">
    <span class="md-ellipsis">
      
        names
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFDocument.objects" class="md-nav__link">
    <span class="md-ellipsis">
      
        objects
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFDocument.outline" class="md-nav__link">
    <span class="md-ellipsis">
      
        outline
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFDocument.page_labels" class="md-nav__link">
    <span class="md-ellipsis">
      
        page_labels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFDocument.pages" class="md-nav__link">
    <span class="md-ellipsis">
      
        pages
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFDocument.structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        structure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFDocument.tokens" class="md-nav__link">
    <span class="md-ellipsis">
      
        tokens
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFDocument.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __getitem__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFDocument.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __iter__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFDocument.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __len__
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFObjRef" class="md-nav__link">
    <span class="md-ellipsis">
      
        PDFObjRef
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PDFObjRef">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFObjRef.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage" class="md-nav__link">
    <span class="md-ellipsis">
      
        PDFPage
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PDFPage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.annotations" class="md-nav__link">
    <span class="md-ellipsis">
      
        annotations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.contents" class="md-nav__link">
    <span class="md-ellipsis">
      
        contents
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.doc" class="md-nav__link">
    <span class="md-ellipsis">
      
        doc
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.fonts" class="md-nav__link">
    <span class="md-ellipsis">
      
        fonts
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.glyphs" class="md-nav__link">
    <span class="md-ellipsis">
      
        glyphs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.height" class="md-nav__link">
    <span class="md-ellipsis">
      
        height
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.images" class="md-nav__link">
    <span class="md-ellipsis">
      
        images
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.marked_content" class="md-nav__link">
    <span class="md-ellipsis">
      
        marked_content
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.parent_key" class="md-nav__link">
    <span class="md-ellipsis">
      
        parent_key
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.paths" class="md-nav__link">
    <span class="md-ellipsis">
      
        paths
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.streams" class="md-nav__link">
    <span class="md-ellipsis">
      
        streams
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        structure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.texts" class="md-nav__link">
    <span class="md-ellipsis">
      
        texts
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.tokens" class="md-nav__link">
    <span class="md-ellipsis">
      
        tokens
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.width" class="md-nav__link">
    <span class="md-ellipsis">
      
        width
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.xobjects" class="md-nav__link">
    <span class="md-ellipsis">
      
        xobjects
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __iter__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.extract_text" class="md-nav__link">
    <span class="md-ellipsis">
      
        extract_text
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.extract_text_tagged" class="md-nav__link">
    <span class="md-ellipsis">
      
        extract_text_tagged
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.extract_text_untagged" class="md-nav__link">
    <span class="md-ellipsis">
      
        extract_text_untagged
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.flatten" class="md-nav__link">
    <span class="md-ellipsis">
      
        flatten
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.set_initial_ctm" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_initial_ctm
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFTypeError" class="md-nav__link">
    <span class="md-ellipsis">
      
        PDFTypeError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFValueError" class="md-nav__link">
    <span class="md-ellipsis">
      
        PDFValueError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PSLiteral" class="md-nav__link">
    <span class="md-ellipsis">
      
        PSLiteral
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.Plane" class="md-nav__link">
    <span class="md-ellipsis">
      
        Plane
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Plane">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.miner.Plane.add" class="md-nav__link">
    <span class="md-ellipsis">
      
        add
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.Plane.find" class="md-nav__link">
    <span class="md-ellipsis">
      
        find
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.Plane.remove" class="md-nav__link">
    <span class="md-ellipsis">
      
        remove
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.decode_text" class="md-nav__link">
    <span class="md-ellipsis">
      
        decode_text
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.drange" class="md-nav__link">
    <span class="md-ellipsis">
      
        drange
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.extract" class="md-nav__link">
    <span class="md-ellipsis">
      
        extract
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.extract_page" class="md-nav__link">
    <span class="md-ellipsis">
      
        extract_page
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.fsplit" class="md-nav__link">
    <span class="md-ellipsis">
      
        fsplit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.make_path_segment" class="md-nav__link">
    <span class="md-ellipsis">
      
        make_path_segment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.process_object" class="md-nav__link">
    <span class="md-ellipsis">
      
        process_object
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.resolve1" class="md-nav__link">
    <span class="md-ellipsis">
      
        resolve1
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.resolve_all" class="md-nav__link">
    <span class="md-ellipsis">
      
        resolve_all
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.subpaths" class="md-nav__link">
    <span class="md-ellipsis">
      
        subpaths
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.uniq" class="md-nav__link">
    <span class="md-ellipsis">
      
        uniq
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#reference" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reference
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#playa.miner" class="md-nav__link">
    <span class="md-ellipsis">
      
        miner
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="miner">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.miner.GraphicState" class="md-nav__link">
    <span class="md-ellipsis">
      
        GraphicState
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LAParams" class="md-nav__link">
    <span class="md-ellipsis">
      
        LAParams
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTAnno" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTAnno
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTChar" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTChar
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTComponent" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTComponent
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTContainer" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTContainer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTCurve" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTCurve
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTFigure" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTFigure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTImage" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTImage
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTItem" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTItem
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LTItem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTItem.analyze" class="md-nav__link">
    <span class="md-ellipsis">
      
        analyze
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTLayoutContainer" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTLayoutContainer
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LTLayoutContainer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTLayoutContainer.group_textboxes" class="md-nav__link">
    <span class="md-ellipsis">
      
        group_textboxes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTLayoutContainer.group_textlines" class="md-nav__link">
    <span class="md-ellipsis">
      
        group_textlines
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTLine" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTLine
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTPage" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTPage
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTRect" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTRect
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTText" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTText
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LTText">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTText.get_text" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_text
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTTextBox" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTTextBox
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTTextLine" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTTextLine
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTTextLineHorizontal" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTTextLineHorizontal
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LTTextLineHorizontal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTTextLineHorizontal.find_neighbors" class="md-nav__link">
    <span class="md-ellipsis">
      
        find_neighbors
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTTextLineVertical" class="md-nav__link">
    <span class="md-ellipsis">
      
        LTTextLineVertical
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LTTextLineVertical">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.miner.LTTextLineVertical.find_neighbors" class="md-nav__link">
    <span class="md-ellipsis">
      
        find_neighbors
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.NameTree" class="md-nav__link">
    <span class="md-ellipsis">
      
        NameTree
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.NumberTree" class="md-nav__link">
    <span class="md-ellipsis">
      
        NumberTree
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFDocument" class="md-nav__link">
    <span class="md-ellipsis">
      
        PDFDocument
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PDFDocument">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFDocument.destinations" class="md-nav__link">
    <span class="md-ellipsis">
      
        destinations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFDocument.fonts" class="md-nav__link">
    <span class="md-ellipsis">
      
        fonts
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFDocument.names" class="md-nav__link">
    <span class="md-ellipsis">
      
        names
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFDocument.objects" class="md-nav__link">
    <span class="md-ellipsis">
      
        objects
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFDocument.outline" class="md-nav__link">
    <span class="md-ellipsis">
      
        outline
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFDocument.page_labels" class="md-nav__link">
    <span class="md-ellipsis">
      
        page_labels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFDocument.pages" class="md-nav__link">
    <span class="md-ellipsis">
      
        pages
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFDocument.structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        structure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFDocument.tokens" class="md-nav__link">
    <span class="md-ellipsis">
      
        tokens
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFDocument.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __getitem__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFDocument.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __iter__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFDocument.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __len__
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFObjRef" class="md-nav__link">
    <span class="md-ellipsis">
      
        PDFObjRef
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PDFObjRef">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFObjRef.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage" class="md-nav__link">
    <span class="md-ellipsis">
      
        PDFPage
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PDFPage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.annotations" class="md-nav__link">
    <span class="md-ellipsis">
      
        annotations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.contents" class="md-nav__link">
    <span class="md-ellipsis">
      
        contents
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.doc" class="md-nav__link">
    <span class="md-ellipsis">
      
        doc
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.fonts" class="md-nav__link">
    <span class="md-ellipsis">
      
        fonts
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.glyphs" class="md-nav__link">
    <span class="md-ellipsis">
      
        glyphs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.height" class="md-nav__link">
    <span class="md-ellipsis">
      
        height
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.images" class="md-nav__link">
    <span class="md-ellipsis">
      
        images
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.marked_content" class="md-nav__link">
    <span class="md-ellipsis">
      
        marked_content
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.parent_key" class="md-nav__link">
    <span class="md-ellipsis">
      
        parent_key
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.paths" class="md-nav__link">
    <span class="md-ellipsis">
      
        paths
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.streams" class="md-nav__link">
    <span class="md-ellipsis">
      
        streams
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        structure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.texts" class="md-nav__link">
    <span class="md-ellipsis">
      
        texts
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.tokens" class="md-nav__link">
    <span class="md-ellipsis">
      
        tokens
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.width" class="md-nav__link">
    <span class="md-ellipsis">
      
        width
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.xobjects" class="md-nav__link">
    <span class="md-ellipsis">
      
        xobjects
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __iter__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.extract_text" class="md-nav__link">
    <span class="md-ellipsis">
      
        extract_text
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.extract_text_tagged" class="md-nav__link">
    <span class="md-ellipsis">
      
        extract_text_tagged
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.extract_text_untagged" class="md-nav__link">
    <span class="md-ellipsis">
      
        extract_text_untagged
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.flatten" class="md-nav__link">
    <span class="md-ellipsis">
      
        flatten
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFPage.set_initial_ctm" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_initial_ctm
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFTypeError" class="md-nav__link">
    <span class="md-ellipsis">
      
        PDFTypeError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PDFValueError" class="md-nav__link">
    <span class="md-ellipsis">
      
        PDFValueError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.PSLiteral" class="md-nav__link">
    <span class="md-ellipsis">
      
        PSLiteral
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.Plane" class="md-nav__link">
    <span class="md-ellipsis">
      
        Plane
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Plane">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.miner.Plane.add" class="md-nav__link">
    <span class="md-ellipsis">
      
        add
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.Plane.find" class="md-nav__link">
    <span class="md-ellipsis">
      
        find
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.Plane.remove" class="md-nav__link">
    <span class="md-ellipsis">
      
        remove
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.decode_text" class="md-nav__link">
    <span class="md-ellipsis">
      
        decode_text
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.drange" class="md-nav__link">
    <span class="md-ellipsis">
      
        drange
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.extract" class="md-nav__link">
    <span class="md-ellipsis">
      
        extract
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.extract_page" class="md-nav__link">
    <span class="md-ellipsis">
      
        extract_page
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.fsplit" class="md-nav__link">
    <span class="md-ellipsis">
      
        fsplit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.make_path_segment" class="md-nav__link">
    <span class="md-ellipsis">
      
        make_path_segment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.process_object" class="md-nav__link">
    <span class="md-ellipsis">
      
        process_object
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.resolve1" class="md-nav__link">
    <span class="md-ellipsis">
      
        resolve1
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.resolve_all" class="md-nav__link">
    <span class="md-ellipsis">
      
        resolve_all
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.subpaths" class="md-nav__link">
    <span class="md-ellipsis">
      
        subpaths
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.miner.uniq" class="md-nav__link">
    <span class="md-ellipsis">
      
        uniq
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="working-in-the-pdf-mine">Working in the PDF mine</h1>
<p><code>pdfminer.six</code> is widely used for text extraction and layout analysis
due to its liberal licensing terms.  Unfortunately it is quite slow
and contains many bugs.  Now you can use PLAYA instead:</p>
<pre><code class="language-python">from playa.miner import extract, LAParams

laparams = LAParams()
for page in extract(path, laparams):
    # do something
</code></pre>
<p>This is generally faster than <code>pdfminer.six</code>.  You can often make it
even faster on large documents by running in parallel with the
<code>max_workers</code> argument, which is the same as the one you will find in
<code>concurrent.futures.ProcessPoolExecutor</code>.  If you pass <code>None</code> it will
use all your CPUs, but due to some unavoidable overhead, it usually
doesn't help to use more than 2-4:</p>
<pre><code>for page in extract(path, laparams, max_workers=2):
    # do something
</code></pre>
<p>There are a few differences with <code>pdfminer.six</code> (some might call them
bug fixes):</p>
<ul>
<li>By default, if you do not pass the <code>laparams</code> argument to <code>extract</code>,
  no layout analysis at all is done.  This is different from
  <code>extract_pages</code> in <code>pdfminer.six</code> which will set some default
  parameters for you.  If you don't see any <code>LTTextBox</code> items in your
  <code>LTPage</code> then this is why!</li>
<li>Rectangles are recognized correctly in some cases where
  <code>pdfminer.six</code> thought they were "curves".</li>
<li>Colours and colour spaces are the PLAYA versions, which do not
  correspond to what <code>pdfminer.six</code> gives you, because what
  <code>pdfminer.six</code> gives you is not useful and often wrong.</li>
<li>You have access to the list of enclosing marked content sections in
  every <code>LTComponent</code>, as the <code>mcstack</code> attribute.</li>
<li>Bounding boxes of rotated glyphs are the actual bounding box.</li>
</ul>
<p>Probably more... but you didn't use any of that stuff anyway, you just
wanted to get <code>LTTextBoxes</code> to feed to your hallucination factories.</p>
<h2 id="reference">Reference</h2>


<div class="doc doc-object doc-module">



<h2 id="playa.miner" class="doc doc-heading">
            <code>playa.miner</code>


</h2>

    <div class="doc doc-contents first">

        <p>Reimplementation of pdfminer.six layout analysis on top of PLAYA.</p>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="playa.miner.GraphicState" class="doc doc-heading">
            <code>GraphicState</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">



        <p>PDF graphics state (PDF 1.7 section 8.4) including text state
(PDF 1.7 section 9.3.1), but excluding coordinate transformations.</p>
<p>Contrary to the pretensions of pdfminer.six, the text state is for
the most part not at all separate from the graphics state, and can
be updated outside the confines of <code>BT</code> and <code>ET</code> operators, thus
there is no advantage and only confusion that comes from treating
it separately.</p>
<p>The only state that does not persist outside <code>BT</code> / <code>ET</code> pairs is
the text coordinate space (line matrix and text rendering matrix),
and it is also the only part that is updated during iteration over
a <code>TextObject</code>.</p>
<p>For historical reasons the main coordinate transformation matrix,
though it is also part of the graphics state, is also stored
separately.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.GraphicState.clipping_path">clipping_path</span></code></td>
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current clipping path (sec. 8.5.4)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.GraphicState.linewidth">linewidth</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Line width in user space units (sec. 8.4.3.2)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.GraphicState.linecap">linecap</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Line cap style (sec. 8.4.3.3)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.GraphicState.linejoin">linejoin</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Line join style (sec. 8.4.3.4)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.GraphicState.miterlimit">miterlimit</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum length of mitered line joins (sec. 8.4.3.5)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.GraphicState.dash">dash</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="DashPattern (playa.content.DashPattern)" href="../reference/#playa.content.DashPattern">DashPattern</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dash pattern for stroking (sec 8.4.3.6)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.GraphicState.intent">intent</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PSLiteral (playa.pdftypes.PSLiteral)" href="#playa.miner.PSLiteral">PSLiteral</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Rendering intent (sec. 8.6.5.8)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.GraphicState.stroke_adjustment">stroke_adjustment</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A flag specifying whether to compensate for
possible rasterization effects when stroking a path with a line
width that is small relative to the pixel resolution of the output
device (sec. 10.7.5)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.GraphicState.blend_mode">blend_mode</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-internal" title="PSLiteral (playa.pdftypes.PSLiteral)" href="#playa.miner.PSLiteral">PSLiteral</a>, <a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-internal" title="PSLiteral (playa.pdftypes.PSLiteral)" href="#playa.miner.PSLiteral">PSLiteral</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current blend mode that shall be used in the
transparent imaging model (sec. 11.3.5)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.GraphicState.smask">smask</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[None, <a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <span title="playa.pdftypes.PDFObject">PDFObject</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A soft-mask dictionary (sec. 11.6.5.1) or None</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.GraphicState.salpha">salpha</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The constant shape or constant opacity value used for
stroking operations (sec. 11.3.7.2 &amp; 11.6.4.4)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.GraphicState.nalpha">nalpha</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The constant shape or constant opacity value used for
non-stroking operations</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.GraphicState.alpha_source">alpha_source</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A flag specifying whether the current soft mask and
alpha constant parameters shall be interpreted as shape values
(true) or opacity values (false). This flag also governs the
interpretation of the SMask entry, if any, in an image dictionary</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.GraphicState.black_pt_comp">black_pt_comp</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PSLiteral (playa.pdftypes.PSLiteral)" href="#playa.miner.PSLiteral">PSLiteral</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The black point compensation algorithm that shall be
used when converting CIE-based colours (sec. 8.6.5.9)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.GraphicState.flatness">flatness</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The precision with which curves shall be rendered on
the output device (sec. 10.6.2)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.GraphicState.scolor">scolor</span></code></td>
            <td>
                  <code><span title="playa.color.Color">Color</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Colour used for stroking operations</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.GraphicState.scs">scs</span></code></td>
            <td>
                  <code><span title="playa.color.ColorSpace">ColorSpace</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Colour space used for stroking operations</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.GraphicState.ncolor">ncolor</span></code></td>
            <td>
                  <code><span title="playa.color.Color">Color</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Colour used for non-stroking operations</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.GraphicState.ncs">ncs</span></code></td>
            <td>
                  <code><span title="playa.color.ColorSpace">ColorSpace</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Colour space used for non-stroking operations</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.GraphicState.font">font</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-internal" title="Font (playa.font.Font)" href="../reference/#playa.font.Font">Font</a>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current font.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.GraphicState.fontsize">fontsize</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The "font size" parameter, which is <strong>not</strong> the font
size in points as you might understand it, but rather a
scaling factor applied to text space (so, it affects not only
text size but position as well).  Since most reasonable people
find that behaviour rather confusing, this is often just 1.0,
and PDFs rely on the text matrix to set the size of text.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.GraphicState.charspace">charspace</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Extra spacing to add after each glyph, expressed in
unscaled text space units, meaning it is not affected by
<code>fontsize</code>.  <strong>BUT</strong> it will be modified by <code>scaling</code> for
horizontal writing mode (so, most of the time).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.GraphicState.wordspace">wordspace</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Extra spacing to add after a space glyph, defined
very specifically as the glyph encoded by the single-byte
character code 32 (SPOILER: it is probably a space).  Also
expressed in unscaled text space units, but modified by
<code>scaling</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.GraphicState.scaling">scaling</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The horizontal scaling factor as defined by the PDF
standard (that is, divided by 100).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.GraphicState.leading">leading</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The leading as defined by the PDF standard, in unscaled
text space units.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.GraphicState.render_mode">render_mode</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The PDF rendering mode.  The really important one
here is 3, which means "don't render the text".  You might
want to use this to detect invisible text.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.GraphicState.rise">rise</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The text rise (superscript or subscript position), in
unscaled text space units.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.GraphicState.knockout">knockout</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The text knockout flag, shall determine the behaviour of
overlapping glyphs within a text object in the transparent imaging
model (sec. 9.3.8)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>playa/content.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">GraphicState</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;PDF graphics state (PDF 1.7 section 8.4) including text state</span>
<span class="sd">    (PDF 1.7 section 9.3.1), but excluding coordinate transformations.</span>

<span class="sd">    Contrary to the pretensions of pdfminer.six, the text state is for</span>
<span class="sd">    the most part not at all separate from the graphics state, and can</span>
<span class="sd">    be updated outside the confines of `BT` and `ET` operators, thus</span>
<span class="sd">    there is no advantage and only confusion that comes from treating</span>
<span class="sd">    it separately.</span>

<span class="sd">    The only state that does not persist outside `BT` / `ET` pairs is</span>
<span class="sd">    the text coordinate space (line matrix and text rendering matrix),</span>
<span class="sd">    and it is also the only part that is updated during iteration over</span>
<span class="sd">    a `TextObject`.</span>

<span class="sd">    For historical reasons the main coordinate transformation matrix,</span>
<span class="sd">    though it is also part of the graphics state, is also stored</span>
<span class="sd">    separately.</span>

<span class="sd">    Attributes:</span>
<span class="sd">      clipping_path: The current clipping path (sec. 8.5.4)</span>
<span class="sd">      linewidth: Line width in user space units (sec. 8.4.3.2)</span>
<span class="sd">      linecap: Line cap style (sec. 8.4.3.3)</span>
<span class="sd">      linejoin: Line join style (sec. 8.4.3.4)</span>
<span class="sd">      miterlimit: Maximum length of mitered line joins (sec. 8.4.3.5)</span>
<span class="sd">      dash: Dash pattern for stroking (sec 8.4.3.6)</span>
<span class="sd">      intent: Rendering intent (sec. 8.6.5.8)</span>
<span class="sd">      stroke_adjustment: A flag specifying whether to compensate for</span>
<span class="sd">        possible rasterization effects when stroking a path with a line</span>
<span class="sd">        width that is small relative to the pixel resolution of the output</span>
<span class="sd">        device (sec. 10.7.5)</span>
<span class="sd">      blend_mode: The current blend mode that shall be used in the</span>
<span class="sd">        transparent imaging model (sec. 11.3.5)</span>
<span class="sd">      smask: A soft-mask dictionary (sec. 11.6.5.1) or None</span>
<span class="sd">      salpha: The constant shape or constant opacity value used for</span>
<span class="sd">        stroking operations (sec. 11.3.7.2 &amp; 11.6.4.4)</span>
<span class="sd">      nalpha: The constant shape or constant opacity value used for</span>
<span class="sd">        non-stroking operations</span>
<span class="sd">      alpha_source: A flag specifying whether the current soft mask and</span>
<span class="sd">        alpha constant parameters shall be interpreted as shape values</span>
<span class="sd">        (true) or opacity values (false). This flag also governs the</span>
<span class="sd">        interpretation of the SMask entry, if any, in an image dictionary</span>
<span class="sd">      black_pt_comp: The black point compensation algorithm that shall be</span>
<span class="sd">        used when converting CIE-based colours (sec. 8.6.5.9)</span>
<span class="sd">      flatness: The precision with which curves shall be rendered on</span>
<span class="sd">        the output device (sec. 10.6.2)</span>
<span class="sd">      scolor: Colour used for stroking operations</span>
<span class="sd">      scs: Colour space used for stroking operations</span>
<span class="sd">      ncolor: Colour used for non-stroking operations</span>
<span class="sd">      ncs: Colour space used for non-stroking operations</span>
<span class="sd">      font: The current font.</span>
<span class="sd">      fontsize: The &quot;font size&quot; parameter, which is **not** the font</span>
<span class="sd">        size in points as you might understand it, but rather a</span>
<span class="sd">        scaling factor applied to text space (so, it affects not only</span>
<span class="sd">        text size but position as well).  Since most reasonable people</span>
<span class="sd">        find that behaviour rather confusing, this is often just 1.0,</span>
<span class="sd">        and PDFs rely on the text matrix to set the size of text.</span>
<span class="sd">      charspace: Extra spacing to add after each glyph, expressed in</span>
<span class="sd">        unscaled text space units, meaning it is not affected by</span>
<span class="sd">        `fontsize`.  **BUT** it will be modified by `scaling` for</span>
<span class="sd">        horizontal writing mode (so, most of the time).</span>
<span class="sd">      wordspace: Extra spacing to add after a space glyph, defined</span>
<span class="sd">        very specifically as the glyph encoded by the single-byte</span>
<span class="sd">        character code 32 (SPOILER: it is probably a space).  Also</span>
<span class="sd">        expressed in unscaled text space units, but modified by</span>
<span class="sd">        `scaling`.</span>
<span class="sd">      scaling: The horizontal scaling factor as defined by the PDF</span>
<span class="sd">        standard (that is, divided by 100).</span>
<span class="sd">      leading: The leading as defined by the PDF standard, in unscaled</span>
<span class="sd">        text space units.</span>
<span class="sd">      render_mode: The PDF rendering mode.  The really important one</span>
<span class="sd">        here is 3, which means &quot;don&#39;t render the text&quot;.  You might</span>
<span class="sd">        want to use this to detect invisible text.</span>
<span class="sd">      rise: The text rise (superscript or subscript position), in</span>
<span class="sd">        unscaled text space units.</span>
<span class="sd">      knockout: The text knockout flag, shall determine the behaviour of</span>
<span class="sd">        overlapping glyphs within a text object in the transparent imaging</span>
<span class="sd">        model (sec. 9.3.8)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">clipping_path</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># TODO</span>
    <span class="n">linewidth</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">linecap</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">linejoin</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">miterlimit</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">dash</span><span class="p">:</span> <span class="n">DashPattern</span> <span class="o">=</span> <span class="n">SOLID_LINE</span>
    <span class="n">intent</span><span class="p">:</span> <span class="n">PSLiteral</span> <span class="o">=</span> <span class="n">LITERAL_RELATIVE_COLORIMETRIC</span>
    <span class="n">stroke_adjustment</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">blend_mode</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">PSLiteral</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">PSLiteral</span><span class="p">]]</span> <span class="o">=</span> <span class="n">LITERAL_NORMAL</span>
    <span class="n">smask</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">salpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">nalpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">alpha_source</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">black_pt_comp</span><span class="p">:</span> <span class="n">PSLiteral</span> <span class="o">=</span> <span class="n">LITERAL_DEFAULT</span>
    <span class="n">flatness</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">scolor</span><span class="p">:</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">BASIC_BLACK</span>
    <span class="n">scs</span><span class="p">:</span> <span class="n">ColorSpace</span> <span class="o">=</span> <span class="n">PREDEFINED_COLORSPACE</span><span class="p">[</span><span class="s2">&quot;DeviceGray&quot;</span><span class="p">]</span>
    <span class="n">ncolor</span><span class="p">:</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">BASIC_BLACK</span>
    <span class="n">ncs</span><span class="p">:</span> <span class="n">ColorSpace</span> <span class="o">=</span> <span class="n">PREDEFINED_COLORSPACE</span><span class="p">[</span><span class="s2">&quot;DeviceGray&quot;</span><span class="p">]</span>
    <span class="n">font</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Font</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">fontsize</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">charspace</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">wordspace</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">scaling</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="n">leading</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">render_mode</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">rise</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">knockout</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.miner.LAParams" class="doc doc-heading">
            <code>LAParams</code>


</h3>


    <div class="doc doc-contents ">



        <p>Parameters for layout analysis</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>line_overlap</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If two characters have more overlap than this they
are considered to be on the same line. The overlap is specified
relative to the minimum height of both characters.</p>
              </div>
            </td>
            <td>
                  <code>0.5</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>char_margin</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If two characters are closer together than this
margin they are considered part of the same line. The margin is
specified relative to the width of the character.</p>
              </div>
            </td>
            <td>
                  <code>2.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>word_margin</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If two characters on the same line are further apart
than this margin then they are considered to be two separate words, and
an intermediate space will be added for readability. The margin is
specified relative to the width of the character.</p>
              </div>
            </td>
            <td>
                  <code>0.1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>line_margin</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If two lines are are close together they are
considered to be part of the same paragraph. The margin is
specified relative to the height of a line.</p>
              </div>
            </td>
            <td>
                  <code>0.5</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>boxes_flow</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies how much a horizontal and vertical position
of a text matters when determining the order of text boxes. The value
should be within the range of -1.0 (only horizontal position
matters) to +1.0 (only vertical position matters). You can also pass
<code>None</code> to disable advanced layout analysis, and instead return text
based on the position of the bottom left corner of the text box.</p>
              </div>
            </td>
            <td>
                  <code>0.5</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>detect_vertical</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If vertical text should be considered during
layout analysis</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>all_texts</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If layout analysis should be performed on text in
figures.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>playa/miner.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">LAParams</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parameters for layout analysis</span>

<span class="sd">    Args:</span>
<span class="sd">      line_overlap: If two characters have more overlap than this they</span>
<span class="sd">        are considered to be on the same line. The overlap is specified</span>
<span class="sd">        relative to the minimum height of both characters.</span>
<span class="sd">      char_margin: If two characters are closer together than this</span>
<span class="sd">        margin they are considered part of the same line. The margin is</span>
<span class="sd">        specified relative to the width of the character.</span>
<span class="sd">      word_margin: If two characters on the same line are further apart</span>
<span class="sd">        than this margin then they are considered to be two separate words, and</span>
<span class="sd">        an intermediate space will be added for readability. The margin is</span>
<span class="sd">        specified relative to the width of the character.</span>
<span class="sd">      line_margin: If two lines are are close together they are</span>
<span class="sd">        considered to be part of the same paragraph. The margin is</span>
<span class="sd">        specified relative to the height of a line.</span>
<span class="sd">      boxes_flow: Specifies how much a horizontal and vertical position</span>
<span class="sd">        of a text matters when determining the order of text boxes. The value</span>
<span class="sd">        should be within the range of -1.0 (only horizontal position</span>
<span class="sd">        matters) to +1.0 (only vertical position matters). You can also pass</span>
<span class="sd">        `None` to disable advanced layout analysis, and instead return text</span>
<span class="sd">        based on the position of the bottom left corner of the text box.</span>
<span class="sd">      detect_vertical: If vertical text should be considered during</span>
<span class="sd">        layout analysis</span>
<span class="sd">      all_texts: If layout analysis should be performed on text in</span>
<span class="sd">        figures.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">line_overlap</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="n">char_margin</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
        <span class="n">line_margin</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="n">word_margin</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="n">boxes_flow</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="n">detect_vertical</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">all_texts</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_overlap</span> <span class="o">=</span> <span class="n">line_overlap</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">char_margin</span> <span class="o">=</span> <span class="n">char_margin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_margin</span> <span class="o">=</span> <span class="n">line_margin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">word_margin</span> <span class="o">=</span> <span class="n">word_margin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boxes_flow</span> <span class="o">=</span> <span class="n">boxes_flow</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_vertical</span> <span class="o">=</span> <span class="n">detect_vertical</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">all_texts</span> <span class="o">=</span> <span class="n">all_texts</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_validate</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_validate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">boxes_flow</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">boxes_flow_err_msg</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;LAParam boxes_flow should be None, or a number between -1 and +1&quot;</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boxes_flow</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="n">PDFTypeError</span><span class="p">(</span><span class="n">boxes_flow_err_msg</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">boxes_flow</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PDFValueError</span><span class="p">(</span><span class="n">boxes_flow_err_msg</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="s2">&quot;&lt;LAParams: char_margin=</span><span class="si">%.1f</span><span class="s2">, line_margin=</span><span class="si">%.1f</span><span class="s2">, &quot;</span>
            <span class="s2">&quot;word_margin=</span><span class="si">%.1f</span><span class="s2"> all_texts=</span><span class="si">%r</span><span class="s2">&gt;&quot;</span>
            <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">char_margin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_margin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">word_margin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_texts</span><span class="p">)</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.miner.LTAnno" class="doc doc-heading">
            <code>LTAnno</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="LTItem (playa.miner.LTItem)" href="#playa.miner.LTItem">LTItem</a></code>, <code><a class="autorefs autorefs-internal" title="LTText (playa.miner.LTText)" href="#playa.miner.LTText">LTText</a></code></p>



        <p>Actual letter in the text as a Unicode string.</p>
<p>Note that, while a LTChar object has actual boundaries, LTAnno objects does
not, as these are "virtual" characters, inserted by a layout analyzer
according to the relationship between two characters (e.g. a space).</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>playa/miner.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">LTAnno</span><span class="p">(</span><span class="n">LTItem</span><span class="p">,</span> <span class="n">LTText</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Actual letter in the text as a Unicode string.</span>

<span class="sd">    Note that, while a LTChar object has actual boundaries, LTAnno objects does</span>
<span class="sd">    not, as these are &quot;virtual&quot; characters, inserted by a layout analyzer</span>
<span class="sd">    according to the relationship between two characters (e.g. a space).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">text</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># No initialization, for pickling purposes</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_text</span> <span class="o">=</span> <span class="n">text</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_text</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.miner.LTChar" class="doc doc-heading">
            <code>LTChar</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="LTComponent (playa.miner.LTComponent)" href="#playa.miner.LTComponent">LTComponent</a></code>, <code><a class="autorefs autorefs-internal" title="LTText (playa.miner.LTText)" href="#playa.miner.LTText">LTText</a></code></p>



        <p>Actual letter in the text as a Unicode string.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>playa/miner.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">LTChar</span><span class="p">(</span><span class="n">LTComponent</span><span class="p">,</span> <span class="n">LTText</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Actual letter in the text as a Unicode string.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">glyph</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">GlyphObject</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">glyph</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># No initialization, for pickling purposes</span>
            <span class="k">return</span>
        <span class="n">gstate</span> <span class="o">=</span> <span class="n">glyph</span><span class="o">.</span><span class="n">gstate</span>
        <span class="n">matrix</span> <span class="o">=</span> <span class="n">glyph</span><span class="o">.</span><span class="n">matrix</span>
        <span class="n">font</span> <span class="o">=</span> <span class="n">glyph</span><span class="o">.</span><span class="n">font</span>
        <span class="k">if</span> <span class="n">glyph</span><span class="o">.</span><span class="n">text</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;undefined: </span><span class="si">%r</span><span class="s2">, </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">glyph</span><span class="o">.</span><span class="n">cid</span><span class="p">)</span>
            <span class="c1"># Horrible awful pdfminer.six behaviour</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_text</span> <span class="o">=</span> <span class="s2">&quot;(cid:</span><span class="si">%d</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="n">glyph</span><span class="o">.</span><span class="n">cid</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_text</span> <span class="o">=</span> <span class="n">glyph</span><span class="o">.</span><span class="n">text</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcstack</span> <span class="o">=</span> <span class="n">glyph</span><span class="o">.</span><span class="n">mcstack</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fontname</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">fontname</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graphicstate</span> <span class="o">=</span> <span class="n">gstate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">render_mode</span> <span class="o">=</span> <span class="n">gstate</span><span class="o">.</span><span class="n">render_mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stroking_color</span> <span class="o">=</span> <span class="n">gstate</span><span class="o">.</span><span class="n">scolor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">non_stroking_color</span> <span class="o">=</span> <span class="n">gstate</span><span class="o">.</span><span class="n">ncolor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scs</span> <span class="o">=</span> <span class="n">gstate</span><span class="o">.</span><span class="n">scs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ncs</span> <span class="o">=</span> <span class="n">gstate</span><span class="o">.</span><span class="n">ncs</span>
        <span class="n">scaling</span> <span class="o">=</span> <span class="n">gstate</span><span class="o">.</span><span class="n">scaling</span> <span class="o">*</span> <span class="mf">0.01</span>
        <span class="n">fontsize</span> <span class="o">=</span> <span class="n">gstate</span><span class="o">.</span><span class="n">fontsize</span>
        <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span> <span class="o">=</span> <span class="n">matrix</span>
        <span class="c1"># FIXME: Still really not sure what this means</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">upright</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">d</span> <span class="o">*</span> <span class="n">scaling</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">b</span> <span class="o">*</span> <span class="n">c</span> <span class="o">&lt;=</span> <span class="mi">0</span>
        <span class="c1"># Unscale the matrix to match pdfminer.six</span>
        <span class="n">xscale</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">fontsize</span> <span class="o">*</span> <span class="n">scaling</span><span class="p">)</span>
        <span class="n">yscale</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">fontsize</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">xscale</span><span class="p">,</span> <span class="n">b</span> <span class="o">*</span> <span class="n">yscale</span><span class="p">,</span> <span class="n">c</span> <span class="o">*</span> <span class="n">xscale</span><span class="p">,</span> <span class="n">d</span> <span class="o">*</span> <span class="n">yscale</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
        <span class="c1"># Recreate pdfminer.six&#39;s bogus bboxes</span>
        <span class="k">if</span> <span class="n">font</span><span class="o">.</span><span class="n">vertical</span><span class="p">:</span>
            <span class="n">vdisp</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">vdisp</span><span class="p">(</span><span class="n">glyph</span><span class="o">.</span><span class="n">cid</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">adv</span> <span class="o">=</span> <span class="n">vdisp</span> <span class="o">*</span> <span class="n">fontsize</span>
            <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">position</span><span class="p">(</span><span class="n">glyph</span><span class="o">.</span><span class="n">cid</span><span class="p">)</span>
            <span class="n">textbox</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">vx</span><span class="p">,</span> <span class="n">vy</span> <span class="o">+</span> <span class="n">vdisp</span><span class="p">,</span> <span class="o">-</span><span class="n">vx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">vy</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">textwidth</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">hdisp</span><span class="p">(</span><span class="n">glyph</span><span class="o">.</span><span class="n">cid</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">adv</span> <span class="o">=</span> <span class="n">textwidth</span> <span class="o">*</span> <span class="n">fontsize</span> <span class="o">*</span> <span class="n">scaling</span>
            <span class="n">descent</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">descent</span> <span class="o">*</span> <span class="n">font</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">textbox</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">descent</span><span class="p">,</span> <span class="n">textwidth</span><span class="p">,</span> <span class="n">descent</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">miner_box</span> <span class="o">=</span> <span class="n">transform_bbox</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">textbox</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">miner_box</span><span class="p">,</span> <span class="n">glyph</span><span class="o">.</span><span class="n">mcstack</span><span class="p">)</span>
        <span class="c1"># FIXME: This is quite wrong for rotated glyphs, but so is pdfminer.six</span>
        <span class="k">if</span> <span class="n">font</span><span class="o">.</span><span class="n">vertical</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;&lt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">bbox2str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;matrix=</span><span class="si">{</span><span class="n">matrix2str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">)</span><span class="si">}</span><span class="s2"> font=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fontname</span><span class="si">!r}</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;adv=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">adv</span><span class="si">}</span><span class="s2"> text=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="si">!r}</span><span class="s2">&gt;&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_text</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.miner.LTComponent" class="doc doc-heading">
            <code>LTComponent</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="LTItem (playa.miner.LTItem)" href="#playa.miner.LTItem">LTItem</a></code></p>



        <p>Object with a bounding box</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>playa/miner.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">LTComponent</span><span class="p">(</span><span class="n">LTItem</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Object with a bounding box&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">bbox</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Rect</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">mcstack</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">MarkedContent</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">()</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">bbox</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># No initialization, for pickling purposes (see</span>
            <span class="c1"># https://mypyc.readthedocs.io/en/latest/differences_from_python.html#pickling-and-copying-objects)</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_bbox</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcstack</span> <span class="o">=</span> <span class="n">mcstack</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">bbox2str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="p">)</span><span class="si">}</span><span class="s2">&gt;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bbox</span><span class="p">:</span> <span class="n">Rect</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span> <span class="o">=</span> <span class="n">bbox</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x0</span> <span class="o">=</span> <span class="n">x0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y0</span> <span class="o">=</span> <span class="n">y0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x1</span> <span class="o">=</span> <span class="n">x1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y1</span> <span class="o">=</span> <span class="n">y1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span> <span class="o">=</span> <span class="n">bbox</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">&lt;=</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_hoverlap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="s2">&quot;LTComponent&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">x0</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">x0</span> <span class="o">&lt;=</span> <span class="n">obj</span><span class="o">.</span><span class="n">x1</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">hdistance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="s2">&quot;LTComponent&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_hoverlap</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x0</span> <span class="o">-</span> <span class="n">obj</span><span class="o">.</span><span class="n">x1</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x1</span> <span class="o">-</span> <span class="n">obj</span><span class="o">.</span><span class="n">x0</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">hoverlap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="s2">&quot;LTComponent&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_hoverlap</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x0</span> <span class="o">-</span> <span class="n">obj</span><span class="o">.</span><span class="n">x1</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x1</span> <span class="o">-</span> <span class="n">obj</span><span class="o">.</span><span class="n">x0</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_voverlap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="s2">&quot;LTComponent&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">y0</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">y0</span> <span class="o">&lt;=</span> <span class="n">obj</span><span class="o">.</span><span class="n">y1</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">vdistance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="s2">&quot;LTComponent&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_voverlap</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y0</span> <span class="o">-</span> <span class="n">obj</span><span class="o">.</span><span class="n">y1</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y1</span> <span class="o">-</span> <span class="n">obj</span><span class="o">.</span><span class="n">y0</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">voverlap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="s2">&quot;LTComponent&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_voverlap</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y0</span> <span class="o">-</span> <span class="n">obj</span><span class="o">.</span><span class="n">y1</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y1</span> <span class="o">-</span> <span class="n">obj</span><span class="o">.</span><span class="n">y0</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.miner.LTContainer" class="doc doc-heading">
            <code>LTContainer</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="LTComponent (playa.miner.LTComponent)" href="#playa.miner.LTComponent">LTComponent</a></code>, <code><a class="autorefs autorefs-external" title="typing.Generic" href="https://docs.python.org/3/library/typing.html#typing.Generic">Generic</a>[<span title="playa.miner.LTItemT">LTItemT</span>]</code></p>



        <p>Object that can be extended and analyzed</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>playa/miner.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">LTContainer</span><span class="p">(</span><span class="n">LTComponent</span><span class="p">,</span> <span class="n">Generic</span><span class="p">[</span><span class="n">LTItemT</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Object that can be extended and analyzed&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">bbox</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Rect</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">mcstack</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">MarkedContent</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">()</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">bbox</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># No initialization, for pickling purposes</span>
            <span class="k">return</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="n">mcstack</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_objs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">LTItemT</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">LTItemT</span><span class="p">]:</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_objs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_objs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">LTItemT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_objs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">extend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objs</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">LTItemT</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">laparams</span><span class="p">:</span> <span class="n">LAParams</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_objs</span><span class="p">:</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">analyze</span><span class="p">(</span><span class="n">laparams</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.miner.LTCurve" class="doc doc-heading">
            <code>LTCurve</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="LTComponent (playa.miner.LTComponent)" href="#playa.miner.LTComponent">LTComponent</a></code></p>



        <p>A generic Bezier curve</p>
<p>The parameter <code>original_path</code> contains the original
pathing information from the pdf (e.g. for reconstructing Bezier Curves).</p>
<p><code>dashing_style</code> contains the Dashing information if any.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>playa/miner.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">LTCurve</span><span class="p">(</span><span class="n">LTComponent</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A generic Bezier curve</span>

<span class="sd">    The parameter `original_path` contains the original</span>
<span class="sd">    pathing information from the pdf (e.g. for reconstructing Bezier Curves).</span>

<span class="sd">    `dashing_style` contains the Dashing information if any.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">PathObject</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">pts</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Point</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>  <span class="c1"># These are actually immutable so not a problem</span>
        <span class="n">transformed_path</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PathSegment</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># No initialization, for pickling purposes</span>
            <span class="k">return</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">get_bound</span><span class="p">(</span><span class="n">pts</span><span class="p">),</span> <span class="n">path</span><span class="o">.</span><span class="n">mcstack</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pts</span> <span class="o">=</span> <span class="n">pts</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linewidth</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">linewidth</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stroke</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">stroke</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">fill</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evenodd</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">evenodd</span>
        <span class="n">gstate</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">gstate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graphicstate</span> <span class="o">=</span> <span class="n">gstate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stroking_color</span> <span class="o">=</span> <span class="n">gstate</span><span class="o">.</span><span class="n">scolor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">non_stroking_color</span> <span class="o">=</span> <span class="n">gstate</span><span class="o">.</span><span class="n">ncolor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scs</span> <span class="o">=</span> <span class="n">gstate</span><span class="o">.</span><span class="n">scs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ncs</span> <span class="o">=</span> <span class="n">gstate</span><span class="o">.</span><span class="n">ncs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">original_path</span> <span class="o">=</span> <span class="n">transformed_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dashing_style</span> <span class="o">=</span> <span class="n">gstate</span><span class="o">.</span><span class="n">dash</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_pts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%.3f</span><span class="s2">,</span><span class="si">%.3f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.miner.LTFigure" class="doc doc-heading">
            <code>LTFigure</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="LTLayoutContainer (playa.miner.LTLayoutContainer)" href="#playa.miner.LTLayoutContainer">LTLayoutContainer</a></code></p>



        <p>Represents an area used by PDF Form objects.</p>
<p>PDF Forms can be used to present figures or pictures by embedding yet
another PDF document within a page. Note that LTFigure objects can appear
recursively.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>playa/miner.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">LTFigure</span><span class="p">(</span><span class="n">LTLayoutContainer</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents an area used by PDF Form objects.</span>

<span class="sd">    PDF Forms can be used to present figures or pictures by embedding yet</span>
<span class="sd">    another PDF document within a page. Note that LTFigure objects can appear</span>
<span class="sd">    recursively.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ImageObject</span><span class="p">,</span> <span class="n">XObjectObject</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># No initialization, for pickling purposes</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">xobjid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">xobjid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">ctm</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">bbox</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">mcstack</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;&lt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">) &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">bbox2str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="p">)</span><span class="si">}</span><span class="s2"> matrix=</span><span class="si">{</span><span class="n">matrix2str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">)</span><span class="si">}</span><span class="s2">&gt;&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">laparams</span><span class="p">:</span> <span class="n">LAParams</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">laparams</span><span class="o">.</span><span class="n">all_texts</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">LTLayoutContainer</span><span class="o">.</span><span class="n">analyze</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">laparams</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.miner.LTImage" class="doc doc-heading">
            <code>LTImage</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="LTComponent (playa.miner.LTComponent)" href="#playa.miner.LTComponent">LTComponent</a></code></p>



        <p>An image object.</p>
<p>Embedded images can be in JPEG, Bitmap or JBIG2.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>playa/miner.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">LTImage</span><span class="p">(</span><span class="n">LTComponent</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;An image object.</span>

<span class="sd">    Embedded images can be in JPEG, Bitmap or JBIG2.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ImageObject</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># No initialization, for pickling purposes</span>
            <span class="k">return</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">bbox</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">mcstack</span><span class="p">)</span>
        <span class="c1"># Inline images don&#39;t actually have an xobjid, so we make shit</span>
        <span class="c1"># up like pdfminer.six does.</span>
        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">xobjid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">xobjid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stream</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">stream</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">srcsize</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">srcsize</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">imagemask</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">imagemask</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bits</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">bits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">colorspace</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">colorspace</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;&lt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">bbox2str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">srcsize</span><span class="si">!r}</span><span class="s2">&gt;&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.miner.LTItem" class="doc doc-heading">
            <code>LTItem</code>


</h3>


    <div class="doc doc-contents ">



        <p>Interface for things that can be analyzed</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>playa/miner.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@trait</span>
<span class="k">class</span><span class="w"> </span><span class="nc">LTItem</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Interface for things that can be analyzed&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">laparams</span><span class="p">:</span> <span class="n">LAParams</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform the layout analysis.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="playa.miner.LTItem.analyze" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">analyze</span><span class="p">(</span><span class="n">laparams</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Perform the layout analysis.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>playa/miner.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">330</span>
<span class="normal">331</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">analyze</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">laparams</span><span class="p">:</span> <span class="n">LAParams</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform the layout analysis.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.miner.LTLayoutContainer" class="doc doc-heading">
            <code>LTLayoutContainer</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="LTContainer (playa.miner.LTContainer)" href="#playa.miner.LTContainer">LTContainer</a>[<a class="autorefs autorefs-internal" title="LTComponent (playa.miner.LTComponent)" href="#playa.miner.LTComponent">LTComponent</a>]</code></p>










              <details class="mkdocstrings-source">
                <summary>Source code in <code>playa/miner.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">LTLayoutContainer</span><span class="p">(</span><span class="n">LTContainer</span><span class="p">[</span><span class="n">LTComponent</span><span class="p">]):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">bbox</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Rect</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">mcstack</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">MarkedContent</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">()</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">bbox</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># No initialization, for pickling purposes</span>
            <span class="k">return</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="n">mcstack</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">LTTextGroup</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># group_objects: group text object to textlines.</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">group_objects</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">laparams</span><span class="p">:</span> <span class="n">LAParams</span><span class="p">,</span>
        <span class="n">objs</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">LTComponent</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">LTTextLine</span><span class="p">]:</span>
        <span class="n">obj0</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">line</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">obj1</span> <span class="ow">in</span> <span class="n">objs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">obj0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># halign: obj0 and obj1 is horizontally aligned.</span>
                <span class="c1">#</span>
                <span class="c1">#   +------+ - - -</span>
                <span class="c1">#   | obj0 | - - +------+   -</span>
                <span class="c1">#   |      |     | obj1 |   | (line_overlap)</span>
                <span class="c1">#   +------+ - - |      |   -</span>
                <span class="c1">#          - - - +------+</span>
                <span class="c1">#</span>
                <span class="c1">#          |&lt;---&gt;|</span>
                <span class="c1">#        (char_margin)</span>
                <span class="n">halign</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">obj0</span><span class="o">.</span><span class="n">is_voverlap</span><span class="p">(</span><span class="n">obj1</span><span class="p">)</span>
                    <span class="ow">and</span> <span class="nb">min</span><span class="p">(</span><span class="n">obj0</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="n">obj1</span><span class="o">.</span><span class="n">height</span><span class="p">)</span> <span class="o">*</span> <span class="n">laparams</span><span class="o">.</span><span class="n">line_overlap</span>
                    <span class="o">&lt;</span> <span class="n">obj0</span><span class="o">.</span><span class="n">voverlap</span><span class="p">(</span><span class="n">obj1</span><span class="p">)</span>
                    <span class="ow">and</span> <span class="n">obj0</span><span class="o">.</span><span class="n">hdistance</span><span class="p">(</span><span class="n">obj1</span><span class="p">)</span>
                    <span class="o">&lt;</span> <span class="nb">max</span><span class="p">(</span><span class="n">obj0</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">obj1</span><span class="o">.</span><span class="n">width</span><span class="p">)</span> <span class="o">*</span> <span class="n">laparams</span><span class="o">.</span><span class="n">char_margin</span>
                <span class="p">)</span>

                <span class="c1"># valign: obj0 and obj1 is vertically aligned.</span>
                <span class="c1">#</span>
                <span class="c1">#   +------+</span>
                <span class="c1">#   | obj0 |</span>
                <span class="c1">#   |      |</span>
                <span class="c1">#   +------+ - - -</span>
                <span class="c1">#     |    |     | (char_margin)</span>
                <span class="c1">#     +------+ - -</span>
                <span class="c1">#     | obj1 |</span>
                <span class="c1">#     |      |</span>
                <span class="c1">#     +------+</span>
                <span class="c1">#</span>
                <span class="c1">#     |&lt;--&gt;|</span>
                <span class="c1">#   (line_overlap)</span>
                <span class="n">valign</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">laparams</span><span class="o">.</span><span class="n">detect_vertical</span>
                    <span class="ow">and</span> <span class="n">obj0</span><span class="o">.</span><span class="n">is_hoverlap</span><span class="p">(</span><span class="n">obj1</span><span class="p">)</span>
                    <span class="ow">and</span> <span class="nb">min</span><span class="p">(</span><span class="n">obj0</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">obj1</span><span class="o">.</span><span class="n">width</span><span class="p">)</span> <span class="o">*</span> <span class="n">laparams</span><span class="o">.</span><span class="n">line_overlap</span>
                    <span class="o">&lt;</span> <span class="n">obj0</span><span class="o">.</span><span class="n">hoverlap</span><span class="p">(</span><span class="n">obj1</span><span class="p">)</span>
                    <span class="ow">and</span> <span class="n">obj0</span><span class="o">.</span><span class="n">vdistance</span><span class="p">(</span><span class="n">obj1</span><span class="p">)</span>
                    <span class="o">&lt;</span> <span class="nb">max</span><span class="p">(</span><span class="n">obj0</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="n">obj1</span><span class="o">.</span><span class="n">height</span><span class="p">)</span> <span class="o">*</span> <span class="n">laparams</span><span class="o">.</span><span class="n">char_margin</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">halign</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">LTTextLineHorizontal</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span>
                    <span class="n">valign</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">LTTextLineVertical</span><span class="p">)</span>
                <span class="p">):</span>
                    <span class="n">line</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">obj1</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">line</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">line</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">elif</span> <span class="n">valign</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">halign</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">LTTextLineVertical</span><span class="p">(</span><span class="n">laparams</span><span class="o">.</span><span class="n">word_margin</span><span class="p">)</span>
                    <span class="n">line</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">obj0</span><span class="p">)</span>
                    <span class="n">line</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">obj1</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">halign</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">valign</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">LTTextLineHorizontal</span><span class="p">(</span><span class="n">laparams</span><span class="o">.</span><span class="n">word_margin</span><span class="p">)</span>
                    <span class="n">line</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">obj0</span><span class="p">)</span>
                    <span class="n">line</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">obj1</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">LTTextLineHorizontal</span><span class="p">(</span><span class="n">laparams</span><span class="o">.</span><span class="n">word_margin</span><span class="p">)</span>
                    <span class="n">line</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">obj0</span><span class="p">)</span>
                    <span class="k">yield</span> <span class="n">line</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">obj0</span> <span class="o">=</span> <span class="n">obj1</span>
        <span class="k">if</span> <span class="n">line</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">LTTextLineHorizontal</span><span class="p">(</span><span class="n">laparams</span><span class="o">.</span><span class="n">word_margin</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">obj0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="n">line</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">obj0</span><span class="p">)</span>
        <span class="k">yield</span> <span class="n">line</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">group_textlines</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">laparams</span><span class="p">:</span> <span class="n">LAParams</span><span class="p">,</span>
        <span class="n">lines</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">LTTextLine</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">LTTextBox</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Group neighboring lines to textboxes&quot;&quot;&quot;</span>
        <span class="n">plane</span><span class="p">:</span> <span class="n">Plane</span><span class="p">[</span><span class="n">LTTextLine</span><span class="p">]</span> <span class="o">=</span> <span class="n">Plane</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="p">)</span>
        <span class="n">plane</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
        <span class="n">boxes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">LTTextBox</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="n">neighbors</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">find_neighbors</span><span class="p">(</span><span class="n">plane</span><span class="p">,</span> <span class="n">laparams</span><span class="o">.</span><span class="n">line_margin</span><span class="p">)</span>
            <span class="n">members</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">obj1</span> <span class="ow">in</span> <span class="n">neighbors</span><span class="p">:</span>
                <span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj1</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">id</span><span class="p">(</span><span class="n">obj1</span><span class="p">)</span> <span class="ow">in</span> <span class="n">boxes</span><span class="p">:</span>
                    <span class="n">members</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">boxes</span><span class="p">[</span><span class="nb">id</span><span class="p">(</span><span class="n">obj1</span><span class="p">)])</span>
                    <span class="k">del</span> <span class="n">boxes</span><span class="p">[</span><span class="nb">id</span><span class="p">(</span><span class="n">obj1</span><span class="p">)]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">LTTextLineHorizontal</span><span class="p">):</span>
                <span class="n">box</span><span class="p">:</span> <span class="n">LTTextBox</span> <span class="o">=</span> <span class="n">LTTextBoxHorizontal</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">box</span> <span class="o">=</span> <span class="n">LTTextBoxVertical</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">uniq</span><span class="p">(</span><span class="n">members</span><span class="p">):</span>
                <span class="n">box</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
                <span class="n">boxes</span><span class="p">[</span><span class="nb">id</span><span class="p">(</span><span class="n">obj</span><span class="p">)]</span> <span class="o">=</span> <span class="n">box</span>
        <span class="n">done</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">id</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">boxes</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">box</span> <span class="o">=</span> <span class="n">boxes</span><span class="p">[</span><span class="nb">id</span><span class="p">(</span><span class="n">line</span><span class="p">)]</span>
            <span class="k">if</span> <span class="nb">id</span><span class="p">(</span><span class="n">box</span><span class="p">)</span> <span class="ow">in</span> <span class="n">done</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">done</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">box</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">box</span><span class="o">.</span><span class="n">is_empty</span><span class="p">():</span>
                <span class="k">yield</span> <span class="n">box</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">group_textboxes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">laparams</span><span class="p">:</span> <span class="n">LAParams</span><span class="p">,</span>
        <span class="n">boxes</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">LTTextBox</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">LTTextGroup</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Group textboxes hierarchically.</span>

<span class="sd">        Get pair-wise distances, via dist func defined below, and then merge</span>
<span class="sd">        from the closest textbox pair. Once obj1 and obj2 are merged /</span>
<span class="sd">        grouped, the resulting group is considered as a new object, and its</span>
<span class="sd">        distances to other objects &amp; groups are added to the process queue.</span>

<span class="sd">        For performance reason, pair-wise distances and object pair info are</span>
<span class="sd">        maintained in a heap of (idx, dist, id(obj1), id(obj2), obj1, obj2)</span>
<span class="sd">        tuples. It ensures quick access to the smallest element. Note that</span>
<span class="sd">        since comparison operators, e.g., __lt__, are disabled for</span>
<span class="sd">        LTComponent, id(obj) has to appear before obj in element tuples.</span>

<span class="sd">        Args:</span>
<span class="sd">          laparams: LAParams object.</span>
<span class="sd">          boxes: All textbox objects to be grouped.</span>
<span class="sd">        Returns:</span>
<span class="sd">          a list that has only one element, the final top level group.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ElementT</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">LTTextBox</span><span class="p">,</span> <span class="n">LTTextGroup</span><span class="p">]</span>
        <span class="n">plane</span><span class="p">:</span> <span class="n">Plane</span><span class="p">[</span><span class="n">ElementT</span><span class="p">]</span> <span class="o">=</span> <span class="n">Plane</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">dist</span><span class="p">(</span><span class="n">obj1</span><span class="p">:</span> <span class="n">LTComponent</span><span class="p">,</span> <span class="n">obj2</span><span class="p">:</span> <span class="n">LTComponent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;A distance function between two TextBoxes.</span>

<span class="sd">            Consider the bounding rectangle for obj1 and obj2.</span>
<span class="sd">            Return its area less the areas of obj1 and obj2,</span>
<span class="sd">            shown as &#39;www&#39; below. This value may be negative.</span>
<span class="sd">                    +------+..........+ (x1, y1)</span>
<span class="sd">                    | obj1 |wwwwwwwwww:</span>
<span class="sd">                    +------+www+------+</span>
<span class="sd">                    :wwwwwwwwww| obj2 |</span>
<span class="sd">            (x0, y0) +..........+------+</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">x0</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">obj1</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">obj2</span><span class="o">.</span><span class="n">x0</span><span class="p">)</span>
            <span class="n">y0</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">obj1</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="n">obj2</span><span class="o">.</span><span class="n">y0</span><span class="p">)</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">obj1</span><span class="o">.</span><span class="n">x1</span><span class="p">,</span> <span class="n">obj2</span><span class="o">.</span><span class="n">x1</span><span class="p">)</span>
            <span class="n">y1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">obj1</span><span class="o">.</span><span class="n">y1</span><span class="p">,</span> <span class="n">obj2</span><span class="o">.</span><span class="n">y1</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span>
                <span class="o">-</span> <span class="n">obj1</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="n">obj1</span><span class="o">.</span><span class="n">height</span>
                <span class="o">-</span> <span class="n">obj2</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="n">obj2</span><span class="o">.</span><span class="n">height</span>
            <span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">isany</span><span class="p">(</span><span class="n">obj1</span><span class="p">:</span> <span class="n">ElementT</span><span class="p">,</span> <span class="n">obj2</span><span class="p">:</span> <span class="n">ElementT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Check if there&#39;s any other object between obj1 and obj2.&quot;&quot;&quot;</span>
            <span class="n">x0</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">obj1</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">obj2</span><span class="o">.</span><span class="n">x0</span><span class="p">)</span>
            <span class="n">y0</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">obj1</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="n">obj2</span><span class="o">.</span><span class="n">y0</span><span class="p">)</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">obj1</span><span class="o">.</span><span class="n">x1</span><span class="p">,</span> <span class="n">obj2</span><span class="o">.</span><span class="n">x1</span><span class="p">)</span>
            <span class="n">y1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">obj1</span><span class="o">.</span><span class="n">y1</span><span class="p">,</span> <span class="n">obj2</span><span class="o">.</span><span class="n">y1</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">plane</span><span class="o">.</span><span class="n">find</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">obj</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">obj1</span><span class="p">,</span> <span class="n">obj2</span><span class="p">):</span>
                    <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="c1"># If there&#39;s only one box, no grouping need be done, but we</span>
        <span class="c1"># should still always return a group!</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">boxes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">LTTextGroup</span><span class="p">(</span><span class="n">boxes</span><span class="p">)]</span>

        <span class="n">dists</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ElementT</span><span class="p">,</span> <span class="n">ElementT</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">boxes</span><span class="p">)):</span>
            <span class="n">box1</span> <span class="o">=</span> <span class="n">boxes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">boxes</span><span class="p">)):</span>
                <span class="n">box2</span> <span class="o">=</span> <span class="n">boxes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="n">dists</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="kc">False</span><span class="p">,</span> <span class="n">dist</span><span class="p">(</span><span class="n">box1</span><span class="p">,</span> <span class="n">box2</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">box1</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">box2</span><span class="p">),</span> <span class="n">box1</span><span class="p">,</span> <span class="n">box2</span><span class="p">))</span>
        <span class="n">heapq</span><span class="o">.</span><span class="n">heapify</span><span class="p">(</span><span class="n">dists</span><span class="p">)</span>

        <span class="n">plane</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">boxes</span><span class="p">)</span>
        <span class="n">done</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">dists</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="p">(</span><span class="n">skip_isany</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">id1</span><span class="p">,</span> <span class="n">id2</span><span class="p">,</span> <span class="n">obj1</span><span class="p">,</span> <span class="n">obj2</span><span class="p">)</span> <span class="o">=</span> <span class="n">heapq</span><span class="o">.</span><span class="n">heappop</span><span class="p">(</span><span class="n">dists</span><span class="p">)</span>
            <span class="c1"># Skip objects that are already merged</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">id1</span> <span class="ow">in</span> <span class="n">done</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">id2</span> <span class="ow">in</span> <span class="n">done</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">skip_isany</span> <span class="ow">and</span> <span class="n">isany</span><span class="p">(</span><span class="n">obj1</span><span class="p">,</span> <span class="n">obj2</span><span class="p">):</span>
                <span class="n">heapq</span><span class="o">.</span><span class="n">heappush</span><span class="p">(</span><span class="n">dists</span><span class="p">,</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">id1</span><span class="p">,</span> <span class="n">id2</span><span class="p">,</span> <span class="n">obj1</span><span class="p">,</span> <span class="n">obj2</span><span class="p">))</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj1</span><span class="p">,</span> <span class="p">(</span><span class="n">LTTextBoxVertical</span><span class="p">,</span> <span class="n">LTTextGroupTBRL</span><span class="p">))</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span>
                <span class="n">obj2</span><span class="p">,</span>
                <span class="p">(</span><span class="n">LTTextBoxVertical</span><span class="p">,</span> <span class="n">LTTextGroupTBRL</span><span class="p">),</span>
            <span class="p">):</span>
                <span class="n">group</span><span class="p">:</span> <span class="n">LTTextGroup</span> <span class="o">=</span> <span class="n">LTTextGroupTBRL</span><span class="p">([</span><span class="n">obj1</span><span class="p">,</span> <span class="n">obj2</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">group</span> <span class="o">=</span> <span class="n">LTTextGroupLRTB</span><span class="p">([</span><span class="n">obj1</span><span class="p">,</span> <span class="n">obj2</span><span class="p">])</span>
            <span class="n">plane</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">obj1</span><span class="p">)</span>
            <span class="n">done</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">id1</span><span class="p">)</span>
            <span class="n">plane</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">obj2</span><span class="p">)</span>
            <span class="n">done</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">id2</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">other</span> <span class="ow">in</span> <span class="n">plane</span><span class="p">:</span>
                <span class="n">heapq</span><span class="o">.</span><span class="n">heappush</span><span class="p">(</span>
                    <span class="n">dists</span><span class="p">,</span>
                    <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">dist</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">other</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">group</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">other</span><span class="p">),</span> <span class="n">group</span><span class="p">,</span> <span class="n">other</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="n">plane</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
        <span class="c1"># The plane should now only contain groups, otherwise it&#39;s a bug</span>
        <span class="n">groups</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">LTTextGroup</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">plane</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">LTTextGroup</span><span class="p">)</span>
            <span class="n">groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">groups</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">laparams</span><span class="p">:</span> <span class="n">LAParams</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># textobjs is a list of LTChar objects, i.e.</span>
        <span class="c1"># it has all the individual characters in the page.</span>
        <span class="p">(</span><span class="n">textobjs</span><span class="p">,</span> <span class="n">otherobjs</span><span class="p">)</span> <span class="o">=</span> <span class="n">fsplit</span><span class="p">(</span><span class="k">lambda</span> <span class="n">obj</span><span class="p">:</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">LTChar</span><span class="p">),</span> <span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">otherobjs</span><span class="p">:</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">analyze</span><span class="p">(</span><span class="n">laparams</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">textobjs</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">textlines</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">group_objects</span><span class="p">(</span><span class="n">laparams</span><span class="p">,</span> <span class="n">textobjs</span><span class="p">))</span>
        <span class="p">(</span><span class="n">empties</span><span class="p">,</span> <span class="n">textlines</span><span class="p">)</span> <span class="o">=</span> <span class="n">fsplit</span><span class="p">(</span><span class="k">lambda</span> <span class="n">obj</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">is_empty</span><span class="p">(),</span> <span class="n">textlines</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">empties</span><span class="p">:</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">analyze</span><span class="p">(</span><span class="n">laparams</span><span class="p">)</span>
        <span class="n">textboxes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">group_textlines</span><span class="p">(</span><span class="n">laparams</span><span class="p">,</span> <span class="n">textlines</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">laparams</span><span class="o">.</span><span class="n">boxes_flow</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">textbox</span> <span class="ow">in</span> <span class="n">textboxes</span><span class="p">:</span>
                <span class="n">textbox</span><span class="o">.</span><span class="n">analyze</span><span class="p">(</span><span class="n">laparams</span><span class="p">)</span>

            <span class="k">def</span><span class="w"> </span><span class="nf">getkey</span><span class="p">(</span><span class="n">box</span><span class="p">:</span> <span class="n">LTTextBox</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">box</span><span class="p">,</span> <span class="n">LTTextBoxVertical</span><span class="p">):</span>
                    <span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">box</span><span class="o">.</span><span class="n">x1</span><span class="p">,</span> <span class="o">-</span><span class="n">box</span><span class="o">.</span><span class="n">y0</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">box</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">x0</span><span class="p">)</span>

            <span class="n">textboxes</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">getkey</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">groups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_textboxes</span><span class="p">(</span><span class="n">laparams</span><span class="p">,</span> <span class="n">textboxes</span><span class="p">)</span>
            <span class="n">assigner</span> <span class="o">=</span> <span class="n">IndexAssigner</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">:</span>
                <span class="n">group</span><span class="o">.</span><span class="n">analyze</span><span class="p">(</span><span class="n">laparams</span><span class="p">)</span>
                <span class="n">assigner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
            <span class="n">textboxes</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">box</span><span class="p">:</span> <span class="n">box</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_objs</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">textboxes</span><span class="p">,</span> <span class="o">*</span><span class="n">otherobjs</span><span class="p">,</span> <span class="o">*</span><span class="n">empties</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="playa.miner.LTLayoutContainer.group_textboxes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">group_textboxes</span><span class="p">(</span><span class="n">laparams</span><span class="p">,</span> <span class="n">boxes</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Group textboxes hierarchically.</p>
<p>Get pair-wise distances, via dist func defined below, and then merge
from the closest textbox pair. Once obj1 and obj2 are merged /
grouped, the resulting group is considered as a new object, and its
distances to other objects &amp; groups are added to the process queue.</p>
<p>For performance reason, pair-wise distances and object pair info are
maintained in a heap of (idx, dist, id(obj1), id(obj2), obj1, obj2)
tuples. It ensures quick access to the smallest element. Note that
since comparison operators, e.g., <strong>lt</strong>, are disabled for
LTComponent, id(obj) has to appear before obj in element tuples.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>laparams</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="LAParams (playa.miner.LAParams)" href="#playa.miner.LAParams">LAParams</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>LAParams object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>boxes</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Sequence" href="https://docs.python.org/3/library/typing.html#typing.Sequence">Sequence</a>[<a class="autorefs autorefs-internal" title="LTTextBox (playa.miner.LTTextBox)" href="#playa.miner.LTTextBox">LTTextBox</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>All textbox objects to be grouped.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Returns:
  a list that has only one element, the final top level group.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>playa/miner.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">group_textboxes</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">laparams</span><span class="p">:</span> <span class="n">LAParams</span><span class="p">,</span>
    <span class="n">boxes</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">LTTextBox</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">LTTextGroup</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Group textboxes hierarchically.</span>

<span class="sd">    Get pair-wise distances, via dist func defined below, and then merge</span>
<span class="sd">    from the closest textbox pair. Once obj1 and obj2 are merged /</span>
<span class="sd">    grouped, the resulting group is considered as a new object, and its</span>
<span class="sd">    distances to other objects &amp; groups are added to the process queue.</span>

<span class="sd">    For performance reason, pair-wise distances and object pair info are</span>
<span class="sd">    maintained in a heap of (idx, dist, id(obj1), id(obj2), obj1, obj2)</span>
<span class="sd">    tuples. It ensures quick access to the smallest element. Note that</span>
<span class="sd">    since comparison operators, e.g., __lt__, are disabled for</span>
<span class="sd">    LTComponent, id(obj) has to appear before obj in element tuples.</span>

<span class="sd">    Args:</span>
<span class="sd">      laparams: LAParams object.</span>
<span class="sd">      boxes: All textbox objects to be grouped.</span>
<span class="sd">    Returns:</span>
<span class="sd">      a list that has only one element, the final top level group.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ElementT</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">LTTextBox</span><span class="p">,</span> <span class="n">LTTextGroup</span><span class="p">]</span>
    <span class="n">plane</span><span class="p">:</span> <span class="n">Plane</span><span class="p">[</span><span class="n">ElementT</span><span class="p">]</span> <span class="o">=</span> <span class="n">Plane</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">dist</span><span class="p">(</span><span class="n">obj1</span><span class="p">:</span> <span class="n">LTComponent</span><span class="p">,</span> <span class="n">obj2</span><span class="p">:</span> <span class="n">LTComponent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A distance function between two TextBoxes.</span>

<span class="sd">        Consider the bounding rectangle for obj1 and obj2.</span>
<span class="sd">        Return its area less the areas of obj1 and obj2,</span>
<span class="sd">        shown as &#39;www&#39; below. This value may be negative.</span>
<span class="sd">                +------+..........+ (x1, y1)</span>
<span class="sd">                | obj1 |wwwwwwwwww:</span>
<span class="sd">                +------+www+------+</span>
<span class="sd">                :wwwwwwwwww| obj2 |</span>
<span class="sd">        (x0, y0) +..........+------+</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x0</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">obj1</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">obj2</span><span class="o">.</span><span class="n">x0</span><span class="p">)</span>
        <span class="n">y0</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">obj1</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="n">obj2</span><span class="o">.</span><span class="n">y0</span><span class="p">)</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">obj1</span><span class="o">.</span><span class="n">x1</span><span class="p">,</span> <span class="n">obj2</span><span class="o">.</span><span class="n">x1</span><span class="p">)</span>
        <span class="n">y1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">obj1</span><span class="o">.</span><span class="n">y1</span><span class="p">,</span> <span class="n">obj2</span><span class="o">.</span><span class="n">y1</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span>
            <span class="o">-</span> <span class="n">obj1</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="n">obj1</span><span class="o">.</span><span class="n">height</span>
            <span class="o">-</span> <span class="n">obj2</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="n">obj2</span><span class="o">.</span><span class="n">height</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">isany</span><span class="p">(</span><span class="n">obj1</span><span class="p">:</span> <span class="n">ElementT</span><span class="p">,</span> <span class="n">obj2</span><span class="p">:</span> <span class="n">ElementT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if there&#39;s any other object between obj1 and obj2.&quot;&quot;&quot;</span>
        <span class="n">x0</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">obj1</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">obj2</span><span class="o">.</span><span class="n">x0</span><span class="p">)</span>
        <span class="n">y0</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">obj1</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="n">obj2</span><span class="o">.</span><span class="n">y0</span><span class="p">)</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">obj1</span><span class="o">.</span><span class="n">x1</span><span class="p">,</span> <span class="n">obj2</span><span class="o">.</span><span class="n">x1</span><span class="p">)</span>
        <span class="n">y1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">obj1</span><span class="o">.</span><span class="n">y1</span><span class="p">,</span> <span class="n">obj2</span><span class="o">.</span><span class="n">y1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">plane</span><span class="o">.</span><span class="n">find</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">obj</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">obj1</span><span class="p">,</span> <span class="n">obj2</span><span class="p">):</span>
                <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="c1"># If there&#39;s only one box, no grouping need be done, but we</span>
    <span class="c1"># should still always return a group!</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">boxes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">LTTextGroup</span><span class="p">(</span><span class="n">boxes</span><span class="p">)]</span>

    <span class="n">dists</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ElementT</span><span class="p">,</span> <span class="n">ElementT</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">boxes</span><span class="p">)):</span>
        <span class="n">box1</span> <span class="o">=</span> <span class="n">boxes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">boxes</span><span class="p">)):</span>
            <span class="n">box2</span> <span class="o">=</span> <span class="n">boxes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="n">dists</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="kc">False</span><span class="p">,</span> <span class="n">dist</span><span class="p">(</span><span class="n">box1</span><span class="p">,</span> <span class="n">box2</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">box1</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">box2</span><span class="p">),</span> <span class="n">box1</span><span class="p">,</span> <span class="n">box2</span><span class="p">))</span>
    <span class="n">heapq</span><span class="o">.</span><span class="n">heapify</span><span class="p">(</span><span class="n">dists</span><span class="p">)</span>

    <span class="n">plane</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">boxes</span><span class="p">)</span>
    <span class="n">done</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">dists</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="p">(</span><span class="n">skip_isany</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">id1</span><span class="p">,</span> <span class="n">id2</span><span class="p">,</span> <span class="n">obj1</span><span class="p">,</span> <span class="n">obj2</span><span class="p">)</span> <span class="o">=</span> <span class="n">heapq</span><span class="o">.</span><span class="n">heappop</span><span class="p">(</span><span class="n">dists</span><span class="p">)</span>
        <span class="c1"># Skip objects that are already merged</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">id1</span> <span class="ow">in</span> <span class="n">done</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">id2</span> <span class="ow">in</span> <span class="n">done</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">skip_isany</span> <span class="ow">and</span> <span class="n">isany</span><span class="p">(</span><span class="n">obj1</span><span class="p">,</span> <span class="n">obj2</span><span class="p">):</span>
            <span class="n">heapq</span><span class="o">.</span><span class="n">heappush</span><span class="p">(</span><span class="n">dists</span><span class="p">,</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">id1</span><span class="p">,</span> <span class="n">id2</span><span class="p">,</span> <span class="n">obj1</span><span class="p">,</span> <span class="n">obj2</span><span class="p">))</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj1</span><span class="p">,</span> <span class="p">(</span><span class="n">LTTextBoxVertical</span><span class="p">,</span> <span class="n">LTTextGroupTBRL</span><span class="p">))</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="n">obj2</span><span class="p">,</span>
            <span class="p">(</span><span class="n">LTTextBoxVertical</span><span class="p">,</span> <span class="n">LTTextGroupTBRL</span><span class="p">),</span>
        <span class="p">):</span>
            <span class="n">group</span><span class="p">:</span> <span class="n">LTTextGroup</span> <span class="o">=</span> <span class="n">LTTextGroupTBRL</span><span class="p">([</span><span class="n">obj1</span><span class="p">,</span> <span class="n">obj2</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">group</span> <span class="o">=</span> <span class="n">LTTextGroupLRTB</span><span class="p">([</span><span class="n">obj1</span><span class="p">,</span> <span class="n">obj2</span><span class="p">])</span>
        <span class="n">plane</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">obj1</span><span class="p">)</span>
        <span class="n">done</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">id1</span><span class="p">)</span>
        <span class="n">plane</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">obj2</span><span class="p">)</span>
        <span class="n">done</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">id2</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">other</span> <span class="ow">in</span> <span class="n">plane</span><span class="p">:</span>
            <span class="n">heapq</span><span class="o">.</span><span class="n">heappush</span><span class="p">(</span>
                <span class="n">dists</span><span class="p">,</span>
                <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">dist</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">other</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">group</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">other</span><span class="p">),</span> <span class="n">group</span><span class="p">,</span> <span class="n">other</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="n">plane</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
    <span class="c1"># The plane should now only contain groups, otherwise it&#39;s a bug</span>
    <span class="n">groups</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">LTTextGroup</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">plane</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">LTTextGroup</span><span class="p">)</span>
        <span class="n">groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">groups</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.miner.LTLayoutContainer.group_textlines" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">group_textlines</span><span class="p">(</span><span class="n">laparams</span><span class="p">,</span> <span class="n">lines</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Group neighboring lines to textboxes</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>playa/miner.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">group_textlines</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">laparams</span><span class="p">:</span> <span class="n">LAParams</span><span class="p">,</span>
    <span class="n">lines</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">LTTextLine</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">LTTextBox</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Group neighboring lines to textboxes&quot;&quot;&quot;</span>
    <span class="n">plane</span><span class="p">:</span> <span class="n">Plane</span><span class="p">[</span><span class="n">LTTextLine</span><span class="p">]</span> <span class="o">=</span> <span class="n">Plane</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="p">)</span>
    <span class="n">plane</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
    <span class="n">boxes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">LTTextBox</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="n">neighbors</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">find_neighbors</span><span class="p">(</span><span class="n">plane</span><span class="p">,</span> <span class="n">laparams</span><span class="o">.</span><span class="n">line_margin</span><span class="p">)</span>
        <span class="n">members</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">obj1</span> <span class="ow">in</span> <span class="n">neighbors</span><span class="p">:</span>
            <span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj1</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">id</span><span class="p">(</span><span class="n">obj1</span><span class="p">)</span> <span class="ow">in</span> <span class="n">boxes</span><span class="p">:</span>
                <span class="n">members</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">boxes</span><span class="p">[</span><span class="nb">id</span><span class="p">(</span><span class="n">obj1</span><span class="p">)])</span>
                <span class="k">del</span> <span class="n">boxes</span><span class="p">[</span><span class="nb">id</span><span class="p">(</span><span class="n">obj1</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">LTTextLineHorizontal</span><span class="p">):</span>
            <span class="n">box</span><span class="p">:</span> <span class="n">LTTextBox</span> <span class="o">=</span> <span class="n">LTTextBoxHorizontal</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">box</span> <span class="o">=</span> <span class="n">LTTextBoxVertical</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">uniq</span><span class="p">(</span><span class="n">members</span><span class="p">):</span>
            <span class="n">box</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="n">boxes</span><span class="p">[</span><span class="nb">id</span><span class="p">(</span><span class="n">obj</span><span class="p">)]</span> <span class="o">=</span> <span class="n">box</span>
    <span class="n">done</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">id</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">boxes</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">box</span> <span class="o">=</span> <span class="n">boxes</span><span class="p">[</span><span class="nb">id</span><span class="p">(</span><span class="n">line</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">id</span><span class="p">(</span><span class="n">box</span><span class="p">)</span> <span class="ow">in</span> <span class="n">done</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">done</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">box</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">box</span><span class="o">.</span><span class="n">is_empty</span><span class="p">():</span>
            <span class="k">yield</span> <span class="n">box</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.miner.LTLine" class="doc doc-heading">
            <code>LTLine</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="LTCurve (playa.miner.LTCurve)" href="#playa.miner.LTCurve">LTCurve</a></code></p>



        <p>A single straight line.</p>
<p>Could be used for separating text or figures.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>playa/miner.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">LTLine</span><span class="p">(</span><span class="n">LTCurve</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A single straight line.</span>

<span class="sd">    Could be used for separating text or figures.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">PathObject</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">p0</span><span class="p">:</span> <span class="n">Point</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">p1</span><span class="p">:</span> <span class="n">Point</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">transformed_path</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PathSegment</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># No initialization, for pickling purposes</span>
            <span class="k">return</span>
        <span class="n">LTCurve</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">path</span><span class="p">,</span>
            <span class="p">[</span><span class="n">p0</span><span class="p">,</span> <span class="n">p1</span><span class="p">],</span>
            <span class="n">transformed_path</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.miner.LTPage" class="doc doc-heading">
            <code>LTPage</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="LTLayoutContainer (playa.miner.LTLayoutContainer)" href="#playa.miner.LTLayoutContainer">LTLayoutContainer</a></code></p>



        <p>Represents an entire page.</p>
<p>Like any other LTLayoutContainer, an LTPage can be iterated to obtain child
objects like LTTextBox, LTFigure, LTImage, LTRect, LTCurve and LTLine.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>playa/miner.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">LTPage</span><span class="p">(</span><span class="n">LTLayoutContainer</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents an entire page.</span>

<span class="sd">    Like any other LTLayoutContainer, an LTPage can be iterated to obtain child</span>
<span class="sd">    objects like LTTextBox, LTFigure, LTImage, LTRect, LTCurve and LTLine.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pageid</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">bbox</span><span class="p">:</span> <span class="n">Rect</span><span class="p">,</span> <span class="n">rotate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pageid</span> <span class="o">=</span> <span class="n">pageid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rotate</span> <span class="o">=</span> <span class="n">rotate</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;&lt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pageid</span><span class="si">!r}</span><span class="s2">) &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">bbox2str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="p">)</span><span class="si">}</span><span class="s2"> rotate=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rotate</span><span class="si">!r}</span><span class="s2">&gt;&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.miner.LTRect" class="doc doc-heading">
            <code>LTRect</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="LTCurve (playa.miner.LTCurve)" href="#playa.miner.LTCurve">LTCurve</a></code></p>



        <p>A rectangle.</p>
<p>Could be used for framing another pictures or figures.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>playa/miner.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">LTRect</span><span class="p">(</span><span class="n">LTCurve</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A rectangle.</span>

<span class="sd">    Could be used for framing another pictures or figures.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">PathObject</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">bbox</span><span class="p">:</span> <span class="n">Rect</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">transformed_path</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PathSegment</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># No initialization, for pickling purposes</span>
            <span class="k">return</span>
        <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span> <span class="o">=</span> <span class="n">bbox</span>
        <span class="n">LTCurve</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">path</span><span class="p">,</span>
            <span class="p">[(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y1</span><span class="p">)],</span>
            <span class="n">transformed_path</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.miner.LTText" class="doc doc-heading">
            <code>LTText</code>


</h3>


    <div class="doc doc-contents ">



        <p>Interface for things that have text</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>playa/miner.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@trait</span>
<span class="k">class</span><span class="w"> </span><span class="nc">LTText</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Interface for things that have text&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="si">!r}</span><span class="s2">&gt;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_text</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Text contained in this object&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="playa.miner.LTText.get_text" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_text</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Text contained in this object</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>playa/miner.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_text</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Text contained in this object&quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.miner.LTTextBox" class="doc doc-heading">
            <code>LTTextBox</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="playa.miner.LTTextContainer">LTTextContainer</span></code></p>



        <p>Represents a group of text chunks in a rectangular area.</p>
<p>Note that this box is created by geometric analysis and does not
necessarily represents a logical boundary of the text. It contains a list
of LTTextLine objects.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>playa/miner.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">LTTextBox</span><span class="p">(</span><span class="n">LTTextContainer</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a group of text chunks in a rectangular area.</span>

<span class="sd">    Note that this box is created by geometric analysis and does not</span>
<span class="sd">    necessarily represents a logical boundary of the text. It contains a list</span>
<span class="sd">    of LTTextLine objects.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;&lt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="si">}</span><span class="s2">) &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">bbox2str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="si">!r}</span><span class="s2">&gt;&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_writing_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.miner.LTTextLine" class="doc doc-heading">
            <code>LTTextLine</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="playa.miner.LTTextContainer">LTTextContainer</span></code></p>



        <p>Contains a list of LTChar objects that represent a single text line.</p>
<p>The characters are aligned either horizontally or vertically, depending on
the text's writing mode.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>playa/miner.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">LTTextLine</span><span class="p">(</span><span class="n">LTTextContainer</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Contains a list of LTChar objects that represent a single text line.</span>

<span class="sd">    The characters are aligned either horizontally or vertically, depending on</span>
<span class="sd">    the text&#39;s writing mode.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">word_margin</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">word_margin</span> <span class="o">=</span> <span class="n">word_margin</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">bbox2str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="si">!r}</span><span class="s2">&gt;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">laparams</span><span class="p">:</span> <span class="n">LAParams</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_objs</span><span class="p">:</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">analyze</span><span class="p">(</span><span class="n">laparams</span><span class="p">)</span>
        <span class="c1"># FIXME: Should probably inherit mcstack somehow</span>
        <span class="n">LTContainer</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">LTAnno</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">find_neighbors</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">plane</span><span class="p">:</span> <span class="n">Plane</span><span class="p">[</span><span class="n">LTComponentT</span><span class="p">],</span>
        <span class="n">ratio</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;LTTextLine&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">is_empty</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">isspace</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.miner.LTTextLineHorizontal" class="doc doc-heading">
            <code>LTTextLineHorizontal</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="LTTextLine (playa.miner.LTTextLine)" href="#playa.miner.LTTextLine">LTTextLine</a></code></p>










              <details class="mkdocstrings-source">
                <summary>Source code in <code>playa/miner.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">LTTextLineHorizontal</span><span class="p">(</span><span class="n">LTTextLine</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">word_margin</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">word_margin</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_x1</span> <span class="o">=</span> <span class="o">+</span><span class="n">INF</span> <span class="o">+</span> <span class="mf">0.0</span>

    <span class="c1"># Incompatible override: we take an LTComponent (with bounding box), but</span>
    <span class="c1"># LTContainer only considers LTItem (no bounding box).</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">LTComponent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># type: ignore[override]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">LTChar</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">word_margin</span><span class="p">:</span>
            <span class="n">margin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">word_margin</span> <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x1</span> <span class="o">&lt;</span> <span class="n">obj</span><span class="o">.</span><span class="n">x0</span> <span class="o">-</span> <span class="n">margin</span><span class="p">:</span>
                <span class="c1"># FIXME: Should probably inherit mcstack somehow</span>
                <span class="n">LTContainer</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">LTAnno</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_x1</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">x1</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">find_neighbors</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">plane</span><span class="p">:</span> <span class="n">Plane</span><span class="p">[</span><span class="n">LTComponentT</span><span class="p">],</span>
        <span class="n">ratio</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">LTTextLine</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Finds neighboring LTTextLineHorizontals in the plane.</span>

<span class="sd">        Returns a list of other LTTestLineHorizontals in the plane which are</span>
<span class="sd">        close to self. &quot;Close&quot; can be controlled by ratio. The returned objects</span>
<span class="sd">        will be the same height as self, and also either left-, right-, or</span>
<span class="sd">        centrally-aligned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">ratio</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span>
        <span class="n">objs</span> <span class="o">=</span> <span class="n">plane</span><span class="o">.</span><span class="n">find</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y0</span> <span class="o">-</span> <span class="n">d</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y1</span> <span class="o">+</span> <span class="n">d</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">obj</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objs</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">LTTextLineHorizontal</span><span class="p">)</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_same_height_as</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
                <span class="ow">and</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_is_left_aligned_with</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
                    <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_right_aligned_with</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
                    <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_centrally_aligned_with</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_is_left_aligned_with</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">LTComponent</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether the left-hand edge of `other` is within `tolerance`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">x0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x0</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">tolerance</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_is_right_aligned_with</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">LTComponent</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether the right-hand edge of `other` is within `tolerance`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">x1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">tolerance</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_is_centrally_aligned_with</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">other</span><span class="p">:</span> <span class="n">LTComponent</span><span class="p">,</span>
        <span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether the horizontal center of `other` is within `tolerance`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">abs</span><span class="p">((</span><span class="n">other</span><span class="o">.</span><span class="n">x0</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">x1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">x1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">tolerance</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_is_same_height_as</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">LTComponent</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">tolerance</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="playa.miner.LTTextLineHorizontal.find_neighbors" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find_neighbors</span><span class="p">(</span><span class="n">plane</span><span class="p">,</span> <span class="n">ratio</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Finds neighboring LTTextLineHorizontals in the plane.</p>
<p>Returns a list of other LTTestLineHorizontals in the plane which are
close to self. "Close" can be controlled by ratio. The returned objects
will be the same height as self, and also either left-, right-, or
centrally-aligned.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>playa/miner.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">find_neighbors</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">plane</span><span class="p">:</span> <span class="n">Plane</span><span class="p">[</span><span class="n">LTComponentT</span><span class="p">],</span>
    <span class="n">ratio</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">LTTextLine</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Finds neighboring LTTextLineHorizontals in the plane.</span>

<span class="sd">    Returns a list of other LTTestLineHorizontals in the plane which are</span>
<span class="sd">    close to self. &quot;Close&quot; can be controlled by ratio. The returned objects</span>
<span class="sd">    will be the same height as self, and also either left-, right-, or</span>
<span class="sd">    centrally-aligned.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">ratio</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span>
    <span class="n">objs</span> <span class="o">=</span> <span class="n">plane</span><span class="o">.</span><span class="n">find</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y0</span> <span class="o">-</span> <span class="n">d</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y1</span> <span class="o">+</span> <span class="n">d</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">obj</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objs</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">LTTextLineHorizontal</span><span class="p">)</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_same_height_as</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
            <span class="ow">and</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_is_left_aligned_with</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
                <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_right_aligned_with</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
                <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_centrally_aligned_with</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.miner.LTTextLineVertical" class="doc doc-heading">
            <code>LTTextLineVertical</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="LTTextLine (playa.miner.LTTextLine)" href="#playa.miner.LTTextLine">LTTextLine</a></code></p>










              <details class="mkdocstrings-source">
                <summary>Source code in <code>playa/miner.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">LTTextLineVertical</span><span class="p">(</span><span class="n">LTTextLine</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">word_margin</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">word_margin</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_y0</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="n">INF</span> <span class="o">+</span> <span class="mf">0.0</span>

    <span class="c1"># Incompatible override: we take an LTComponent (with bounding box), but</span>
    <span class="c1"># LTContainer only considers LTItem (no bounding box).</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">LTComponent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># type: ignore[override]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">LTChar</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">word_margin</span><span class="p">:</span>
            <span class="n">margin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">word_margin</span> <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">y1</span> <span class="o">+</span> <span class="n">margin</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y0</span><span class="p">:</span>
                <span class="c1"># FIXME: Should probably inherit mcstack somehow</span>
                <span class="n">LTContainer</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">LTAnno</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_y0</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">y0</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">find_neighbors</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">plane</span><span class="p">:</span> <span class="n">Plane</span><span class="p">[</span><span class="n">LTComponentT</span><span class="p">],</span>
        <span class="n">ratio</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">LTTextLine</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Finds neighboring LTTextLineVerticals in the plane.</span>

<span class="sd">        Returns a list of other LTTextLineVerticals in the plane which are</span>
<span class="sd">        close to self. &quot;Close&quot; can be controlled by ratio. The returned objects</span>
<span class="sd">        will be the same width as self, and also either upper-, lower-, or</span>
<span class="sd">        centrally-aligned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">ratio</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span>
        <span class="n">objs</span> <span class="o">=</span> <span class="n">plane</span><span class="o">.</span><span class="n">find</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x0</span> <span class="o">-</span> <span class="n">d</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x1</span> <span class="o">+</span> <span class="n">d</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y1</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">obj</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objs</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">LTTextLineVertical</span><span class="p">)</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_same_width_as</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
                <span class="ow">and</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_is_lower_aligned_with</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
                    <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_upper_aligned_with</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
                    <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_centrally_aligned_with</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_is_lower_aligned_with</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">LTComponent</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether the lower edge of `other` is within `tolerance`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">y0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">y0</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">tolerance</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_is_upper_aligned_with</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">LTComponent</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether the upper edge of `other` is within `tolerance`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">y1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">y1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">tolerance</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_is_centrally_aligned_with</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">other</span><span class="p">:</span> <span class="n">LTComponent</span><span class="p">,</span>
        <span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether the vertical center of `other` is within `tolerance`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">abs</span><span class="p">((</span><span class="n">other</span><span class="o">.</span><span class="n">y0</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">y1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">y1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">tolerance</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_is_same_width_as</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">LTComponent</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">tolerance</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="playa.miner.LTTextLineVertical.find_neighbors" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find_neighbors</span><span class="p">(</span><span class="n">plane</span><span class="p">,</span> <span class="n">ratio</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Finds neighboring LTTextLineVerticals in the plane.</p>
<p>Returns a list of other LTTextLineVerticals in the plane which are
close to self. "Close" can be controlled by ratio. The returned objects
will be the same width as self, and also either upper-, lower-, or
centrally-aligned.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>playa/miner.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">find_neighbors</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">plane</span><span class="p">:</span> <span class="n">Plane</span><span class="p">[</span><span class="n">LTComponentT</span><span class="p">],</span>
    <span class="n">ratio</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">LTTextLine</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Finds neighboring LTTextLineVerticals in the plane.</span>

<span class="sd">    Returns a list of other LTTextLineVerticals in the plane which are</span>
<span class="sd">    close to self. &quot;Close&quot; can be controlled by ratio. The returned objects</span>
<span class="sd">    will be the same width as self, and also either upper-, lower-, or</span>
<span class="sd">    centrally-aligned.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">ratio</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span>
    <span class="n">objs</span> <span class="o">=</span> <span class="n">plane</span><span class="o">.</span><span class="n">find</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x0</span> <span class="o">-</span> <span class="n">d</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x1</span> <span class="o">+</span> <span class="n">d</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y1</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">obj</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objs</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">LTTextLineVertical</span><span class="p">)</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_same_width_as</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
            <span class="ow">and</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_is_lower_aligned_with</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
                <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_upper_aligned_with</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
                <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_centrally_aligned_with</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.miner.NameTree" class="doc doc-heading">
            <code>NameTree</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" title="typing.Mapping" href="https://docs.python.org/3/library/typing.html#typing.Mapping">Mapping</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#bytes">bytes</a>, <span title="playa.pdftypes.PDFObject">PDFObject</span>]</code></p>



        <p>A PDF name tree.</p>
<p>See Section 7.9.6 of the PDF 1.7 Reference.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#TypeError">TypeError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If initialized with a non-dictionary.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>playa/data_structures.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">NameTree</span><span class="p">(</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A PDF name tree.</span>

<span class="sd">    See Section 7.9.6 of the PDF 1.7 Reference.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: If initialized with a non-dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">PDFObject</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">walk_name_tree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">name</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDFObject</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">walk_name_tree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="n">key</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">val</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Name </span><span class="si">%r</span><span class="s2"> not in tree&quot;</span> <span class="o">%</span> <span class="n">key</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NameTreeItemsView</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">NameTreeItemsView</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.miner.NumberTree" class="doc doc-heading">
            <code>NumberTree</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" title="typing.Mapping" href="https://docs.python.org/3/library/typing.html#typing.Mapping">Mapping</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, <span title="playa.pdftypes.PDFObject">PDFObject</span>]</code></p>



        <p>A PDF number tree.</p>
<p>See Section 7.9.7 of the PDF 1.7 Reference.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#TypeError">TypeError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If initialized with a non-dictionary.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>playa/data_structures.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">NumberTree</span><span class="p">(</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A PDF number tree.</span>

<span class="sd">    See Section 7.9.7 of the PDF 1.7 Reference.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: If initialized with a non-dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">PDFObject</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">walk_number_tree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">idx</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDFObject</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">walk_number_tree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="n">num</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">val</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number </span><span class="si">{</span><span class="n">num</span><span class="si">}</span><span class="s2"> not in tree&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NumberTreeItemsView</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">NumberTreeItemsView</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.miner.PDFDocument" class="doc doc-heading">
            <code>PDFDocument</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" title="typing.Mapping" href="https://docs.python.org/3/library/typing.html#typing.Mapping">Mapping</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, <span title="playa.parser.PDFObject">PDFObject</span>]</code></p>



        <p>Representation of a PDF document.</p>
<p>PDF documents, at a basic level, are collections of indirect
objects with numeric IDs.  Since these IDs are sparse, and do not
need to be ordered, this is best represented as a mapping of <code>int</code>
to <code>PDFObject</code>.  The specification also provides for "generation
numbers" which can be used to track successive revisions of the
same object.  In practice very few PDFs actually do this, so the
most recent generation of an object is accessible simply by its
object ID.  To find other objects, use the <code>objects</code> property.</p>
<p>Since PDF documents can be very large and complex, merely creating
a <code>Document</code> does very little aside from verifying that the
password is correct and getting a minimal amount of metadata.  In
general, PLAYA will try to open just about anything as a PDF, so
you should not expect the constructor to fail here if you give it
nonsense (something else may fail later on).</p>
<p>Some metadata, such as the structure tree and page tree, will be
loaded lazily and cached.  We do not handle modification of PDFs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fp</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" title="typing.BinaryIO" href="https://docs.python.org/3/library/typing.html#typing.BinaryIO">BinaryIO</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#bytes">bytes</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>File-like object in binary mode, or a buffer with binary data.
  Files will be read using <code>mmap</code> if possible.  They do not need
  to be seekable, as if <code>mmap</code> fails the entire file will simply
  be read into memory (so a pipe or socket ought to work).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>password</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Password for decryption, if needed.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>space</code>
            </td>
            <td>
                  <code><span title="playa.page.DeviceSpace">DeviceSpace</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the device space to use for interpreting content ("screen"
  or "page")</p>
              </div>
            </td>
            <td>
                  <code>&#39;screen&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#TypeError">TypeError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if <code>fp</code> is a file opened in text mode (don't do that!)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="playa.exceptions.PDFEncryptionError">PDFEncryptionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if the PDF has an unsupported encryption scheme</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="playa.exceptions.PDFPasswordIncorrect">PDFPasswordIncorrect</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if the password is incorrect</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>playa/document.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Document</span><span class="p">(</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Representation of a PDF document.</span>

<span class="sd">    PDF documents, at a basic level, are collections of indirect</span>
<span class="sd">    objects with numeric IDs.  Since these IDs are sparse, and do not</span>
<span class="sd">    need to be ordered, this is best represented as a mapping of `int`</span>
<span class="sd">    to `PDFObject`.  The specification also provides for &quot;generation</span>
<span class="sd">    numbers&quot; which can be used to track successive revisions of the</span>
<span class="sd">    same object.  In practice very few PDFs actually do this, so the</span>
<span class="sd">    most recent generation of an object is accessible simply by its</span>
<span class="sd">    object ID.  To find other objects, use the `objects` property.</span>

<span class="sd">    Since PDF documents can be very large and complex, merely creating</span>
<span class="sd">    a `Document` does very little aside from verifying that the</span>
<span class="sd">    password is correct and getting a minimal amount of metadata.  In</span>
<span class="sd">    general, PLAYA will try to open just about anything as a PDF, so</span>
<span class="sd">    you should not expect the constructor to fail here if you give it</span>
<span class="sd">    nonsense (something else may fail later on).</span>

<span class="sd">    Some metadata, such as the structure tree and page tree, will be</span>
<span class="sd">    loaded lazily and cached.  We do not handle modification of PDFs.</span>

<span class="sd">    Args:</span>
<span class="sd">      fp: File-like object in binary mode, or a buffer with binary data.</span>
<span class="sd">          Files will be read using `mmap` if possible.  They do not need</span>
<span class="sd">          to be seekable, as if `mmap` fails the entire file will simply</span>
<span class="sd">          be read into memory (so a pipe or socket ought to work).</span>
<span class="sd">      password: Password for decryption, if needed.</span>
<span class="sd">      space: the device space to use for interpreting content (&quot;screen&quot;</span>
<span class="sd">          or &quot;page&quot;)</span>

<span class="sd">    Raises:</span>
<span class="sd">      TypeError: if `fp` is a file opened in text mode (don&#39;t do that!)</span>
<span class="sd">      PDFEncryptionError: if the PDF has an unsupported encryption scheme</span>
<span class="sd">      PDFPasswordIncorrect: if the password is incorrect</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">trailer</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">]</span>
    <span class="n">info</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">]</span>
    <span class="n">buffer</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="n">mmap</span><span class="o">.</span><span class="n">mmap</span><span class="p">]</span>  <span class="c1"># FIXME: abstract type for this?</span>
    <span class="n">space</span><span class="p">:</span> <span class="n">DeviceSpace</span>
    <span class="n">encryption</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span> <span class="n">Dict</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">decipher</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">DecipherCallable</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">_fp</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">BinaryIO</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_pages</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;PageList&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_pool</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Executor</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_catalog</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_outline</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Outlines&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_destinations</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Destinations&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_structure</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Tree&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_fontmap</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Font</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_parser</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">IndirectObjectParser</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_xrefs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">XRef</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_trailer_pos</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">_startxref_pos</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Document&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">,</span> <span class="n">traceback</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># If we were opened from a file then close it</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fp</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fp</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># Shutdown process pool</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pool</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pool</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pool</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">fp</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">BinaryIO</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span>
        <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">space</span><span class="p">:</span> <span class="n">DeviceSpace</span> <span class="o">=</span> <span class="s2">&quot;screen&quot;</span><span class="p">,</span>
        <span class="n">_boss_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Get this out of the way, eh</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">TextIOBase</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;fp is not a binary file&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">_boss_id</span><span class="p">:</span>
            <span class="c1"># Set this **right away** because it is needed to get</span>
            <span class="c1"># indirect object references right.</span>
            <span class="n">_set_document</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_boss_id</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">in_worker</span><span class="p">()</span>

        <span class="c1"># Initialize mutable properties</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">space</span> <span class="o">=</span> <span class="n">space</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cached_objs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parsed_objs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">PDFObject</span><span class="p">],</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cached_fonts</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Font</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cached_inline_images</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span>
            <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">InlineImage</span><span class="p">,</span> <span class="kc">None</span><span class="p">]]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pdf_version</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_offset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span> <span class="o">=</span> <span class="n">_open_input</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
        <span class="c1"># These are always True unless &quot;encryption&quot; (lol) is present</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_printable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_modifiable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_extractable</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># We are Lazy, only find and read the trailer.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trailer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_trailer</span><span class="p">()</span>
        <span class="c1"># If there is encryption, then we need to read xref tables.</span>
        <span class="c1"># Otherwise we will defer this to the first object lookup.</span>
        <span class="k">if</span> <span class="s2">&quot;Encrypt&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">trailer</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_xrefs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_xrefs</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ids</span> <span class="o">=</span> <span class="n">list_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trailer</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">])</span>
                <span class="n">id_value</span> <span class="o">=</span> <span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">ids</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">ids</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
                <span class="c1"># Some documents may not have a /ID, use two empty</span>
                <span class="c1"># byte strings instead. Solves</span>
                <span class="c1"># https://github.com/pdfminer/pdfminer.six/issues/594</span>
                <span class="n">id_value</span> <span class="o">=</span> <span class="p">(</span><span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">encrypt</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trailer</span><span class="p">[</span><span class="s2">&quot;Encrypt&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">encryption</span> <span class="o">=</span> <span class="p">(</span><span class="n">id_value</span><span class="p">,</span> <span class="n">encrypt</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_password</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_read_trailer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="c1"># To read the trailer, we must first find the trailer, which</span>
        <span class="c1"># is supposed to be at the end of the file, immediately before</span>
        <span class="c1"># the &quot;startxref&quot; keyword and after a &quot;trailer&quot; keyword.  This,</span>
        <span class="c1"># like so many other things in the PDF standard, is a cruel</span>
        <span class="c1"># lie, because:</span>
        <span class="c1">#</span>
        <span class="c1"># 1. If the file only contains cross-reference streams, there</span>
        <span class="c1">#    is no &quot;trailer&quot; keyword, and the trailer is the stream</span>
        <span class="c1">#    dictionary (which could be anywhere in the file)</span>
        <span class="c1"># 2. If the file is a linearized PDF, there *is* a trailer at</span>
        <span class="c1">#    the end of the file, but it&#39;s a bogus one that only</span>
        <span class="c1">#    contains /Size. The real trailer is after the main xref</span>
        <span class="c1">#    table (or stream) pointed to by the &quot;startxref&quot; value.</span>
        <span class="c1"># 3. Of course nobody understood these rules and so you might</span>
        <span class="c1">#    find the trailer in various other places.  Also, the</span>
        <span class="c1">#    &quot;startxref&quot; value is probably wrong.</span>
        <span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">)</span>
        <span class="n">indobj</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">pos</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="ow">in</span> <span class="n">NOTKEYWORD</span><span class="p">:</span>
                <span class="n">token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">[</span><span class="n">pos</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">end</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">token</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&quot;startxref&quot;</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">_</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">ObjectParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">end</span><span class="p">))</span>
                    <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_startxref_pos</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_startxref_pos</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_offset</span>
                    <span class="c1"># If this is an xref stream, then its dictionary</span>
                    <span class="c1"># is the trailer.</span>
                    <span class="k">if</span> <span class="n">m</span> <span class="o">:=</span> <span class="n">INDOBJR</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_startxref_pos</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_trailer_pos</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                        <span class="k">break</span>
                    <span class="c1"># If this is a normal xref table, then look for a</span>
                    <span class="c1"># trailer after it, which will be the correct one</span>
                    <span class="c1"># to use (because linearization)</span>
                    <span class="k">if</span> <span class="n">m</span> <span class="o">:=</span> <span class="n">XREFR</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_startxref_pos</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_trailer_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="o">.</span><span class="n">find</span><span class="p">(</span>
                            <span class="sa">b</span><span class="s2">&quot;trailer&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_startxref_pos</span>
                        <span class="p">)</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trailer_pos</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_trailer_pos</span> <span class="o">+=</span> <span class="mi">7</span>
                            <span class="k">break</span>
                <span class="k">if</span> <span class="n">token</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&quot;trailer&quot;</span><span class="p">:</span>
                    <span class="c1"># We continued to scan backwards and found a trailer</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_trailer_pos</span> <span class="o">=</span> <span class="n">end</span>
                <span class="k">if</span> <span class="n">token</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&quot;obj&quot;</span><span class="p">:</span>
                    <span class="c1"># We continued to scan backwards and found an</span>
                    <span class="c1"># indirect object, which may or may not be the</span>
                    <span class="c1"># cross-reference stream.</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trailer_pos</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_trailer_pos</span> <span class="o">=</span> <span class="n">end</span>
                    <span class="n">indobj</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="n">token</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&quot;xref&quot;</span><span class="p">:</span>
                    <span class="c1"># We continued to scan backwards and found an xref table</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_startxref_pos</span> <span class="o">=</span> <span class="n">pos</span> <span class="o">+</span> <span class="mi">1</span>
                    <span class="k">break</span>
                <span class="k">if</span> <span class="n">indobj</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">token</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;9&quot;</span><span class="p">):</span>
                    <span class="c1"># We are in the abovementioned indirect object</span>
                    <span class="n">indobj</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">indobj</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_startxref_pos</span> <span class="o">=</span> <span class="n">pos</span> <span class="o">+</span> <span class="mi">1</span>
                        <span class="k">break</span>
                <span class="n">end</span> <span class="o">=</span> <span class="n">pos</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_trailer_pos</span><span class="p">,</span> <span class="n">trailer</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span>
            <span class="n">ObjectParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_trailer_pos</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">trailer</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Trailer is not a dict: </span><span class="si">{</span><span class="n">trailer</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">indobj</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">trailer</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="n">LITERAL_XREF</span><span class="p">:</span>
            <span class="c1"># Either it&#39;s just the trailer (no problem) and there&#39;s no</span>
            <span class="c1"># xref table, or it&#39;s some other random indirect object.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_startxref_pos</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">return</span> <span class="n">trailer</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_initialize_password</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the decryption handler with a given password, if any.</span>

<span class="sd">        Internal function, requires the Encrypt dictionary to have</span>
<span class="sd">        been read from the trailer into self.encryption.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">encryption</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="p">(</span><span class="n">docid</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encryption</span>
        <span class="k">if</span> <span class="n">literal_name</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Filter&quot;</span><span class="p">))</span> <span class="o">!=</span> <span class="s2">&quot;Standard&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PDFEncryptionError</span><span class="p">(</span><span class="s2">&quot;Unknown filter: param=</span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">param</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;V&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="c1"># 3 (PDF 1.4) An unpublished algorithm that permits encryption</span>
        <span class="c1"># key lengths ranging from 40 to 128 bits. This value shall</span>
        <span class="c1"># not appear in a conforming PDF file.</span>
        <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PDFEncryptionError</span><span class="p">(</span><span class="s2">&quot;Unpublished algorithm 3 not supported&quot;</span><span class="p">)</span>
        <span class="n">factory</span> <span class="o">=</span> <span class="n">SECURITY_HANDLERS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="c1"># 0 An algorithm that is undocumented. This value shall not be used.</span>
        <span class="k">if</span> <span class="n">factory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PDFEncryptionError</span><span class="p">(</span><span class="s2">&quot;Unknown algorithm: param=</span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">param</span><span class="p">)</span>
        <span class="n">handler</span> <span class="o">=</span> <span class="n">factory</span><span class="p">(</span><span class="n">docid</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decipher</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">decrypt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_printable</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">is_printable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_modifiable</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">is_modifiable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_extractable</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">is_extractable</span>
        <span class="c1"># Ensure that no extra data leaks into encrypted streams</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">decipher</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decipher</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">parser</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IndirectObjectParser</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span> <span class="o">=</span> <span class="n">IndirectObjectParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_offset</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">xrefs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">XRef</span><span class="p">]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xrefs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xrefs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xrefs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_xrefs</span><span class="p">()</span>
        <span class="n">size</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xrefs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trailer</span><span class="p">[</span><span class="s2">&quot;Size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">size</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Updated /Size in trailer to </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xrefs</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_read_xrefs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">XRef</span><span class="p">]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_startxref_pos</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;startxref was not found, falling back to object parser&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">XRefFallback</span><span class="p">(</span><span class="bp">self</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xrefpos</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">xrefs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">XRef</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_xrefs_into</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_startxref_pos</span><span class="p">,</span> <span class="n">xrefs</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">xrefs</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">,</span> <span class="ne">StopIteration</span><span class="p">,</span> <span class="n">PDFSyntaxError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;xref parsing failed, falling back to object parser: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">XRefFallback</span><span class="p">(</span><span class="bp">self</span><span class="p">)]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_read_xrefs_into</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">start</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">xrefs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">XRef</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reads XRefs from the given location.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">start</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xrefpos</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Detected circular xref chain at </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="c1"># Look for an XRefStream first, then an XRefTable</span>
        <span class="k">if</span> <span class="n">INDOBJR</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="n">start</span><span class="p">):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Reading xref stream at </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span>
            <span class="c1"># XRefStream: PDF-1.5</span>
            <span class="n">xref</span><span class="p">:</span> <span class="n">XRef</span> <span class="o">=</span> <span class="n">XRefStream</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_offset</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">m</span> <span class="o">:=</span> <span class="n">XREFR</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="n">start</span><span class="p">):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Reading xref table at </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">xref</span> <span class="o">=</span> <span class="n">XRefTable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">offset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_offset</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Well, maybe it&#39;s an XRef table without &quot;xref&quot; (but</span>
            <span class="c1"># probably not)</span>
            <span class="n">xref</span> <span class="o">=</span> <span class="n">XRefTable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_offset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xrefpos</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
        <span class="n">xrefs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xref</span><span class="p">)</span>
        <span class="n">trailer</span> <span class="o">=</span> <span class="n">xref</span><span class="o">.</span><span class="n">trailer</span>
        <span class="c1"># For hybrid-reference files, an additional set of xrefs as a</span>
        <span class="c1"># stream.</span>
        <span class="k">if</span> <span class="s2">&quot;XRefStm&quot;</span> <span class="ow">in</span> <span class="n">trailer</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">trailer</span><span class="p">[</span><span class="s2">&quot;XRefStm&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_xrefs_into</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_offset</span><span class="p">,</span> <span class="n">xrefs</span><span class="p">)</span>
        <span class="c1"># Recurse into any previous xref tables or streams</span>
        <span class="k">if</span> <span class="s2">&quot;Prev&quot;</span> <span class="ow">in</span> <span class="n">trailer</span><span class="p">:</span>
            <span class="c1"># find previous xref</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">trailer</span><span class="p">[</span><span class="s2">&quot;Prev&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_xrefs_into</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_offset</span><span class="p">,</span> <span class="n">xrefs</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">catalog</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_catalog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_catalog</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_catalog</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="s2">&quot;Root&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">trailer</span><span class="p">:</span>
            <span class="c1"># Every PDF file must have exactly one /Root dictionary.</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_catalog</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trailer</span><span class="p">[</span><span class="s2">&quot;Root&quot;</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Root is a broken reference (incorrect xref table?)&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No /Root object! - Is this really a PDF?&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;Type&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_catalog</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_catalog</span><span class="p">[</span><span class="s2">&quot;Type&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">LITERAL_CATALOG</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Catalog doesn&#39;t seem to be a catalog: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_catalog</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_catalog</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_tagged</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">markinfo</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;MarkInfo&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">markinfo</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">return</span> <span class="ow">not</span> <span class="ow">not</span> <span class="n">markinfo</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Marked&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">pdf_version</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;Version&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="s2">&quot;Using PDF version </span><span class="si">%r</span><span class="s2"> from catalog instead of </span><span class="si">%r</span><span class="s2"> from header&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">[</span><span class="s2">&quot;Version&quot;</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_pdf_version</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">literal_name</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">[</span><span class="s2">&quot;Version&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pdf_version</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the number of indirect objects in this PDF.</span>

<span class="sd">        Danger: This number is unreliable and ephemeral.</span>
<span class="sd">            In a conforming PDF, the number of objects is declared by</span>
<span class="sd">            the `/Size` key in the document trailer, but conforming</span>
<span class="sd">            PDFs do not exist in the real world.  Upon opening a PDF,</span>
<span class="sd">            the trailer value will be returned here, but once the</span>
<span class="sd">            cross-reference tables have been loaded, a *different*</span>
<span class="sd">            number will be returned, and in the case where the</span>
<span class="sd">            cross-reference tables are invalid and must be</span>
<span class="sd">            regenerated, this value will be updated yet again.  This</span>
<span class="sd">            is the price of laziness (not to be confused with the</span>
<span class="sd">            wages of sin).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trailer</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Size&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">size</span>
        <span class="n">size</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trailer</span><span class="p">[</span><span class="s2">&quot;Size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">size</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Updated /Size in trailer to </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">size</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over object IDs&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">objects</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">IndirectObject</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over all indirect objects (including, then expanding object</span>
<span class="sd">        streams)&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">IndirectObjectParser</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_offset</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">strict</span>
        <span class="p">):</span>
            <span class="k">yield</span> <span class="n">obj</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">ContentStream</span><span class="p">)</span>
                <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="n">LITERAL_OBJSTM</span>
            <span class="p">):</span>
                <span class="n">parser</span> <span class="o">=</span> <span class="n">ObjectStreamParser</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">sobj</span> <span class="ow">in</span> <span class="n">parser</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">sobj</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Token</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over tokens.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">tok</span> <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">tok</span> <span class="ow">in</span> <span class="n">Lexer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">structure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Tree</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Logical structure of this document, if any.</span>

<span class="sd">        In the case where no logical structure tree exists, this will</span>
<span class="sd">        be `None`.  Otherwise you may iterate over it, search it, etc.</span>

<span class="sd">        We do this instead of simply returning an empty structure tree</span>
<span class="sd">        because the vast majority of PDFs have no logical structure.</span>
<span class="sd">        Also, because the structure is a lazy object (the type</span>
<span class="sd">        signature here may change to `Iterable[Element]` at some</span>
<span class="sd">        point) there is no way to know if it&#39;s empty without iterating</span>
<span class="sd">        over it.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_structure</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_structure</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_structure</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">KeyError</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_structure</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_structure</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_getobj_objstm</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">stream</span><span class="p">:</span> <span class="n">ContentStream</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">objid</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDFObject</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">stream</span><span class="o">.</span><span class="n">objid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parsed_objs</span><span class="p">:</span>
            <span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parsed_objs</span><span class="p">[</span><span class="n">stream</span><span class="o">.</span><span class="n">objid</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_objects</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">stream</span><span class="o">.</span><span class="n">objid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parsed_objs</span><span class="p">[</span><span class="n">stream</span><span class="o">.</span><span class="n">objid</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">index</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">objs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">IndexError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span>
                <span class="s2">&quot;index </span><span class="si">%d</span><span class="s2"> + </span><span class="si">%d</span><span class="s2"> too big for stream of </span><span class="si">%d</span><span class="s2"> objects&quot;</span>
                <span class="o">%</span> <span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">objs</span><span class="p">))</span>
            <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
        <span class="k">return</span> <span class="n">obj</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream</span><span class="p">:</span> <span class="n">ContentStream</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">PDFObject</span><span class="p">],</span> <span class="nb">int</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">LITERAL_OBJSTM</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Content stream Type is not /ObjStm: </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">stream</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">stream</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;N is not defined in content stream: </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">stream</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;N is invalid in content stream: </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">stream</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">ObjectParser</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">objs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PDFObject</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">obj</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">parser</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_getobj_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">objid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDFObject</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">INDOBJR</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Not an indirect object at position </span><span class="si">{</span><span class="n">pos</span><span class="si">}</span><span class="s2">: &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">[</span><span class="n">pos</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">pos</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">8</span><span class="p">]</span><span class="si">!r}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">obj</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">objid</span> <span class="o">!=</span> <span class="n">objid</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;objid mismatch: </span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="n">objid</span><span class="si">!r}</span><span class="s2">=</span><span class="si">{</span><span class="n">objid</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">,</span> <span class="n">PDFSyntaxError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span>
                <span class="s2">&quot;Indirect object </span><span class="si">%d</span><span class="s2"> not found at position </span><span class="si">%d</span><span class="s2">&quot;</span>
                <span class="o">%</span> <span class="p">(</span>
                    <span class="n">objid</span><span class="p">,</span>
                    <span class="n">pos</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">objid</span> <span class="o">!=</span> <span class="n">objid</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;objid mismatch: </span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="n">objid</span><span class="si">!r}</span><span class="s2">=</span><span class="si">{</span><span class="n">objid</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">obj</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDFObject</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get an indirect object from the PDF.</span>

<span class="sd">        Note that the behaviour in the case of a non-existent object</span>
<span class="sd">        (raising `KeyError`), while Pythonic, is not PDFic, as PDF</span>
<span class="sd">        1.7 sec 7.3.10 states:</span>

<span class="sd">        &gt; An indirect reference to an undefined object shall not be</span>
<span class="sd">        considered an error by a conforming reader; it shall be</span>
<span class="sd">        treated as a reference to the null object.</span>

<span class="sd">        Raises:</span>
<span class="sd">          ValueError: if Document cannot be initialized</span>
<span class="sd">          KeyError: if objid does not exist in PDF</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">objid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;PDF object id cannot be 0.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">objid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_objs</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_objs</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Object with ID </span><span class="si">{</span><span class="n">objid</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_objs</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">for</span> <span class="n">xref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="p">(</span><span class="n">strmid</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">genno</span><span class="p">)</span> <span class="o">=</span> <span class="n">xref</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">strmid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">stream</span> <span class="o">=</span> <span class="n">stream_value</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">strmid</span><span class="p">])</span>
                    <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getobj_objstm</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">objid</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getobj_parse</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">objid</span><span class="p">)</span>
                    <span class="k">except</span> <span class="n">PDFSyntaxError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                            <span class="s2">&quot;Indirect object </span><span class="si">%d</span><span class="s2"> not found at position </span><span class="si">%d</span><span class="s2">: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span>
                            <span class="n">objid</span><span class="p">,</span>
                            <span class="n">index</span><span class="p">,</span>
                            <span class="n">e</span><span class="p">,</span>
                        <span class="p">)</span>
                        <span class="c1"># xref tables are clearly borked, so</span>
                        <span class="c1"># rebuild them and try again</span>
                        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Rebuilding xref table from object parser&quot;</span><span class="p">)</span>
                        <span class="n">fallback</span> <span class="o">=</span> <span class="n">XRefFallback</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">trailer</span><span class="p">[</span><span class="s2">&quot;Size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fallback</span><span class="p">)</span>
                        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                            <span class="s2">&quot;Updated /Size in trailer to </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">trailer</span><span class="p">[</span><span class="s2">&quot;Size&quot;</span><span class="p">]</span>
                        <span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_xrefs</span> <span class="o">=</span> <span class="p">[</span><span class="n">fallback</span><span class="p">]</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="p">(</span><span class="n">strmid</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">genno</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xrefs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">objid</span><span class="p">]</span>
                            <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getobj_parse</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">objid</span><span class="p">)</span>
                        <span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="n">PDFSyntaxError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                                <span class="s2">&quot;Indirect object </span><span class="si">%d</span><span class="s2"> STILL not found at position </span><span class="si">%d</span><span class="s2">: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span>
                                <span class="n">objid</span><span class="p">,</span>
                                <span class="n">index</span><span class="p">,</span>
                                <span class="n">e</span><span class="p">,</span>
                            <span class="p">)</span>
                <span class="k">break</span>
            <span class="c1"># FIXME: We might not actually want to catch these...</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;EOF when searching for object </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">objid</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="k">except</span> <span class="n">PDFSyntaxError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Syntax error when searching for object </span><span class="si">%d</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">objid</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                <span class="k">continue</span>

        <span class="c1"># Store it anyway as None if we can&#39;t find it to avoid costly searching</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cached_objs</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Object with ID </span><span class="si">{</span><span class="n">objid</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_objs</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_font</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">objid</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">spec</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Font</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">objid</span> <span class="ow">and</span> <span class="n">objid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_fonts</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_fonts</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">spec</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Font</span><span class="p">({},</span> <span class="p">{})</span>
        <span class="c1"># Create a Font object, hopefully</span>
        <span class="n">font</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Font</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">spec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">LITERAL_FONT</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Font Type is not /Font: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">spec</span><span class="p">)</span>
        <span class="n">subtype</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Subtype&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">subtype</span> <span class="ow">in</span> <span class="p">(</span><span class="n">LITERAL_TYPE1</span><span class="p">,</span> <span class="n">LITERAL_MMTYPE1</span><span class="p">):</span>
            <span class="n">font</span> <span class="o">=</span> <span class="n">Type1Font</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">subtype</span> <span class="ow">is</span> <span class="n">LITERAL_TRUETYPE</span><span class="p">:</span>
            <span class="n">font</span> <span class="o">=</span> <span class="n">TrueTypeFont</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">subtype</span> <span class="o">==</span> <span class="n">LITERAL_TYPE3</span><span class="p">:</span>
            <span class="n">font</span> <span class="o">=</span> <span class="n">Type3Font</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">subtype</span> <span class="o">==</span> <span class="n">LITERAL_TYPE0</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;DescendantFonts&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">spec</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Type0 font has no DescendantFonts: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">spec</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dfonts</span> <span class="o">=</span> <span class="n">list_value</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="s2">&quot;DescendantFonts&quot;</span><span class="p">])</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dfonts</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                        <span class="s2">&quot;Type 0 font should have 1 descendant, has more: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dfonts</span>
                    <span class="p">)</span>
                <span class="n">subspec</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">dfonts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subspec</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Invalid descendant font: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">subspec</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">subspec</span> <span class="o">=</span> <span class="n">subspec</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                    <span class="c1"># Merge the root and descendant font dictionaries</span>
                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;Encoding&quot;</span><span class="p">,</span> <span class="s2">&quot;ToUnicode&quot;</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">spec</span><span class="p">:</span>
                            <span class="n">subspec</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">font</span> <span class="o">=</span> <span class="n">CIDFont</span><span class="p">(</span><span class="n">subspec</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Unknown Subtype in font: </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">spec</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">font</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># We need a dummy font object to be able to do *something*</span>
            <span class="c1"># (even if it&#39;s the wrong thing) with text objects.</span>
            <span class="n">font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">({},</span> <span class="p">{})</span>
        <span class="k">if</span> <span class="n">objid</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cached_fonts</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span> <span class="o">=</span> <span class="n">font</span>
        <span class="k">return</span> <span class="n">font</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">fonts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Font</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the mapping of font names to fonts for this document.</span>

<span class="sd">        Note that this can be quite slow the first time it&#39;s accessed</span>
<span class="sd">        as it must scan every single page in the document.</span>

<span class="sd">        Note: Font names may collide.</span>
<span class="sd">            Font names are generally understood to be globally unique</span>
<span class="sd">            &lt;del&gt;in the neighbourhood&lt;/del&gt; in the document, but there&#39;s no</span>
<span class="sd">            guarantee that this is the case.  In keeping with the</span>
<span class="sd">            &quot;incremental update&quot; philosophy dear to PDF, you get the</span>
<span class="sd">            last font defined with a given name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fontmap</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fontmap</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fontmap</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Font</span><span class="p">]</span> <span class="o">=</span> <span class="n">FontMapping</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fontmap</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">outline</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Outlines</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Document outline, if any.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;Outlines&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_outline</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_outline</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_outline</span> <span class="o">=</span> <span class="n">Outlines</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Invalid Outlines entry in catalog: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">[</span><span class="s2">&quot;Outlines&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_outline</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">page_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterator</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over page label strings for the PDF document.</span>

<span class="sd">        If the document includes page labels, this generates strings,</span>
<span class="sd">        one per page, otherwise it is None.</span>

<span class="sd">        Warning: Unbounded iterator</span>
<span class="sd">            This iterator is unbounded, because the page label tree</span>
<span class="sd">            has no relation to the actual page tree, so it is</span>
<span class="sd">            recommended to use `pages` instead.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">label_tree_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;PageLabels&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">label_tree_obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">label_tree</span> <span class="o">=</span> <span class="n">NumberTree</span><span class="p">(</span><span class="n">label_tree_obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_iter_labels</span><span class="p">(</span><span class="n">label_tree</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">pages</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;PageList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Pages of the document as an iterable/addressable `PageList` object.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span> <span class="o">=</span> <span class="n">PageList</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;PDF name dictionary (PDF 1.7 sec 7.7.4).</span>

<span class="sd">        Raises:</span>
<span class="sd">          KeyError: if nonexistent.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">dict_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">[</span><span class="s2">&quot;Names&quot;</span><span class="p">])</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">destinations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Destinations&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Named destinations as an iterable/addressable `Destinations` object.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_destinations</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_destinations</span> <span class="o">=</span> <span class="n">Destinations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_destinations</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="playa.miner.PDFDocument.destinations" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">destinations</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Named destinations as an iterable/addressable <code>Destinations</code> object.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.miner.PDFDocument.fonts" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fonts</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Get the mapping of font names to fonts for this document.</p>
<p>Note that this can be quite slow the first time it's accessed
as it must scan every single page in the document.</p>


<details class="note" open>
  <summary>Font names may collide.</summary>
  <p>Font names are generally understood to be globally unique
<del>in the neighbourhood</del> in the document, but there's no
guarantee that this is the case.  In keeping with the
"incremental update" philosophy dear to PDF, you get the
last font defined with a given name.</p>
</details>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.miner.PDFDocument.names" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">names</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>PDF name dictionary (PDF 1.7 sec 7.7.4).</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#KeyError">KeyError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if nonexistent.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.miner.PDFDocument.objects" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">objects</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterate over all indirect objects (including, then expanding object
streams)</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.miner.PDFDocument.outline" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">outline</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Document outline, if any.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.miner.PDFDocument.page_labels" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">page_labels</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterate over page label strings for the PDF document.</p>
<p>If the document includes page labels, this generates strings,
one per page, otherwise it is None.</p>


<details class="warning" open>
  <summary>Unbounded iterator</summary>
  <p>This iterator is unbounded, because the page label tree
has no relation to the actual page tree, so it is
recommended to use <code>pages</code> instead.</p>
</details>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.miner.PDFDocument.pages" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pages</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Pages of the document as an iterable/addressable <code>PageList</code> object.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.miner.PDFDocument.structure" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">structure</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Logical structure of this document, if any.</p>
<p>In the case where no logical structure tree exists, this will
be <code>None</code>.  Otherwise you may iterate over it, search it, etc.</p>
<p>We do this instead of simply returning an empty structure tree
because the vast majority of PDFs have no logical structure.
Also, because the structure is a lazy object (the type
signature here may change to <code>Iterable[Element]</code> at some
point) there is no way to know if it's empty without iterating
over it.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.miner.PDFDocument.tokens" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tokens</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterate over tokens.</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="playa.miner.PDFDocument.__getitem__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__getitem__</span><span class="p">(</span><span class="n">objid</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get an indirect object from the PDF.</p>
<p>Note that the behaviour in the case of a non-existent object
(raising <code>KeyError</code>), while Pythonic, is not PDFic, as PDF
1.7 sec 7.3.10 states:</p>
<blockquote>
<p>An indirect reference to an undefined object shall not be
considered an error by a conforming reader; it shall be
treated as a reference to the null object.</p>
</blockquote>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if Document cannot be initialized</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#KeyError">KeyError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if objid does not exist in PDF</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>playa/document.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDFObject</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get an indirect object from the PDF.</span>

<span class="sd">    Note that the behaviour in the case of a non-existent object</span>
<span class="sd">    (raising `KeyError`), while Pythonic, is not PDFic, as PDF</span>
<span class="sd">    1.7 sec 7.3.10 states:</span>

<span class="sd">    &gt; An indirect reference to an undefined object shall not be</span>
<span class="sd">    considered an error by a conforming reader; it shall be</span>
<span class="sd">    treated as a reference to the null object.</span>

<span class="sd">    Raises:</span>
<span class="sd">      ValueError: if Document cannot be initialized</span>
<span class="sd">      KeyError: if objid does not exist in PDF</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">objid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;PDF object id cannot be 0.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">objid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_objs</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_objs</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Object with ID </span><span class="si">{</span><span class="n">objid</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_objs</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">for</span> <span class="n">xref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="p">(</span><span class="n">strmid</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">genno</span><span class="p">)</span> <span class="o">=</span> <span class="n">xref</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">strmid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">stream</span> <span class="o">=</span> <span class="n">stream_value</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">strmid</span><span class="p">])</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getobj_objstm</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">objid</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getobj_parse</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">objid</span><span class="p">)</span>
                <span class="k">except</span> <span class="n">PDFSyntaxError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                        <span class="s2">&quot;Indirect object </span><span class="si">%d</span><span class="s2"> not found at position </span><span class="si">%d</span><span class="s2">: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">objid</span><span class="p">,</span>
                        <span class="n">index</span><span class="p">,</span>
                        <span class="n">e</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="c1"># xref tables are clearly borked, so</span>
                    <span class="c1"># rebuild them and try again</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Rebuilding xref table from object parser&quot;</span><span class="p">)</span>
                    <span class="n">fallback</span> <span class="o">=</span> <span class="n">XRefFallback</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">trailer</span><span class="p">[</span><span class="s2">&quot;Size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fallback</span><span class="p">)</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                        <span class="s2">&quot;Updated /Size in trailer to </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">trailer</span><span class="p">[</span><span class="s2">&quot;Size&quot;</span><span class="p">]</span>
                    <span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_xrefs</span> <span class="o">=</span> <span class="p">[</span><span class="n">fallback</span><span class="p">]</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="p">(</span><span class="n">strmid</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">genno</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xrefs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">objid</span><span class="p">]</span>
                        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getobj_parse</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">objid</span><span class="p">)</span>
                    <span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="n">PDFSyntaxError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                            <span class="s2">&quot;Indirect object </span><span class="si">%d</span><span class="s2"> STILL not found at position </span><span class="si">%d</span><span class="s2">: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span>
                            <span class="n">objid</span><span class="p">,</span>
                            <span class="n">index</span><span class="p">,</span>
                            <span class="n">e</span><span class="p">,</span>
                        <span class="p">)</span>
            <span class="k">break</span>
        <span class="c1"># FIXME: We might not actually want to catch these...</span>
        <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;EOF when searching for object </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">objid</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="k">except</span> <span class="n">PDFSyntaxError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Syntax error when searching for object </span><span class="si">%d</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">objid</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">continue</span>

    <span class="c1"># Store it anyway as None if we can&#39;t find it to avoid costly searching</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_cached_objs</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>
    <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Object with ID </span><span class="si">{</span><span class="n">objid</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_objs</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.miner.PDFDocument.__iter__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__iter__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Iterate over object IDs</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>playa/document.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterate over object IDs&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.miner.PDFDocument.__len__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return the number of indirect objects in this PDF.</p>


<details class="danger" open>
  <summary>This number is unreliable and ephemeral.</summary>
  <p>In a conforming PDF, the number of objects is declared by
the <code>/Size</code> key in the document trailer, but conforming
PDFs do not exist in the real world.  Upon opening a PDF,
the trailer value will be returned here, but once the
cross-reference tables have been loaded, a <em>different</em>
number will be returned, and in the case where the
cross-reference tables are invalid and must be
regenerated, this value will be updated yet again.  This
is the price of laziness (not to be confused with the
wages of sin).</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>playa/document.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the number of indirect objects in this PDF.</span>

<span class="sd">    Danger: This number is unreliable and ephemeral.</span>
<span class="sd">        In a conforming PDF, the number of objects is declared by</span>
<span class="sd">        the `/Size` key in the document trailer, but conforming</span>
<span class="sd">        PDFs do not exist in the real world.  Upon opening a PDF,</span>
<span class="sd">        the trailer value will be returned here, but once the</span>
<span class="sd">        cross-reference tables have been loaded, a *different*</span>
<span class="sd">        number will be returned, and in the case where the</span>
<span class="sd">        cross-reference tables are invalid and must be</span>
<span class="sd">        regenerated, this value will be updated yet again.  This</span>
<span class="sd">        is the price of laziness (not to be confused with the</span>
<span class="sd">        wages of sin).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trailer</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Size&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">size</span>
    <span class="n">size</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">trailer</span><span class="p">[</span><span class="s2">&quot;Size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">size</span>
    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Updated /Size in trailer to </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">size</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.miner.PDFObjRef" class="doc doc-heading">
            <code>PDFObjRef</code>


</h3>


    <div class="doc doc-contents ">










              <details class="mkdocstrings-source">
                <summary>Source code in <code>playa/pdftypes.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ObjRef</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">doc</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">DocumentRef</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">objid</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reference to a PDF object.</span>

<span class="sd">        :param doc: The PDF document.</span>
<span class="sd">        :param objid: The object number.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doc</span> <span class="o">=</span> <span class="n">doc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objid</span> <span class="o">=</span> <span class="n">objid</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ObjRef</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Unimplemented comparison with non-ObjRef&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">doc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">objid</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">objid</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">other</span><span class="o">.</span><span class="n">doc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">selfdoc</span> <span class="o">=</span> <span class="n">_deref_document</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="p">)</span>
            <span class="n">otherdoc</span> <span class="o">=</span> <span class="n">_deref_document</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">doc</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">selfdoc</span> <span class="ow">is</span> <span class="n">otherdoc</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">objid</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">objid</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">objid</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;&lt;ObjRef:</span><span class="si">%d</span><span class="s2">&gt;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objid</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">resolve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">PDFObject</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDFObject</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">default</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="n">_deref_document</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">doc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">objid</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">default</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="playa.miner.PDFObjRef.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">objid</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Reference to a PDF object.</p>
<p>:param doc: The PDF document.
:param objid: The object number.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>playa/pdftypes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">doc</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">DocumentRef</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">objid</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reference to a PDF object.</span>

<span class="sd">    :param doc: The PDF document.</span>
<span class="sd">    :param objid: The object number.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">doc</span> <span class="o">=</span> <span class="n">doc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">objid</span> <span class="o">=</span> <span class="n">objid</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.miner.PDFPage" class="doc doc-heading">
            <code>PDFPage</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" title="typing.Iterable" href="https://docs.python.org/3/library/typing.html#typing.Iterable">Iterable</a>[<a class="autorefs autorefs-internal" title="ContentObject


  
      dataclass
   (playa.content.ContentObject)" href="../reference/#playa.content.ContentObject">ContentObject</a>]</code></p>



        <p>An object that holds the information about a page.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>doc</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Document (playa.document.Document)" href="../reference/#playa.document.Document">Document</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a Document object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pageid</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the integer PDF object ID associated with the page in the page tree.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>attrs</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a dictionary of page attributes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>label</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>page label string.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>page_idx</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>0-based index of the page in the document.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>space</code>
            </td>
            <td>
                  <code><span title="playa.page.DeviceSpace">DeviceSpace</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the device space to use for interpreting content</p>
              </div>
            </td>
            <td>
                  <code>&#39;screen&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.PDFPage.pageid">pageid</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the integer object ID associated with the page in the page tree</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.PDFPage.attrs">attrs</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a dictionary of page attributes.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.PDFPage.resources">resources</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <span title="playa.parser.PDFObject">PDFObject</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a dictionary of resources used by the page.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.PDFPage.mediabox">mediabox</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the physical size of the page.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.PDFPage.cropbox">cropbox</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the crop rectangle of the page.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.PDFPage.rotate">rotate</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the page rotation (in degree).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.PDFPage.label">label</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the page's label (typically, the logical page number).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.PDFPage.page_idx">page_idx</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>0-based index of the page in the document.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.miner.PDFPage.ctm">ctm</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>coordinate transformation matrix from default user space to
   page's device space</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>playa/page.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Page</span><span class="p">(</span><span class="n">Iterable</span><span class="p">[</span><span class="n">ContentObject</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;An object that holds the information about a page.</span>

<span class="sd">    Args:</span>
<span class="sd">      doc: a Document object.</span>
<span class="sd">      pageid: the integer PDF object ID associated with the page in the page tree.</span>
<span class="sd">      attrs: a dictionary of page attributes.</span>
<span class="sd">      label: page label string.</span>
<span class="sd">      page_idx: 0-based index of the page in the document.</span>
<span class="sd">      space: the device space to use for interpreting content</span>

<span class="sd">    Attributes:</span>
<span class="sd">      pageid: the integer object ID associated with the page in the page tree</span>
<span class="sd">      attrs: a dictionary of page attributes.</span>
<span class="sd">      resources: a dictionary of resources used by the page.</span>
<span class="sd">      mediabox: the physical size of the page.</span>
<span class="sd">      cropbox: the crop rectangle of the page.</span>
<span class="sd">      rotate: the page rotation (in degree).</span>
<span class="sd">      label: the page&#39;s label (typically, the logical page number).</span>
<span class="sd">      page_idx: 0-based index of the page in the document.</span>
<span class="sd">      ctm: coordinate transformation matrix from default user space to</span>
<span class="sd">           page&#39;s device space</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_structmap</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">PageStructure</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_marked_contents</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ContentSequence</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_fontmap</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;Font&quot;</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_textmap</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">doc</span><span class="p">:</span> <span class="s2">&quot;Document&quot;</span><span class="p">,</span>
        <span class="n">pageid</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">attrs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
        <span class="n">label</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
        <span class="n">page_idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">space</span><span class="p">:</span> <span class="n">DeviceSpace</span> <span class="o">=</span> <span class="s2">&quot;screen&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">docref</span> <span class="o">=</span> <span class="n">_ref_document</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pageid</span> <span class="o">=</span> <span class="n">pageid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="n">attrs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">page_idx</span> <span class="o">=</span> <span class="n">page_idx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">space</span> <span class="o">=</span> <span class="n">space</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pageref</span> <span class="o">=</span> <span class="n">_ref_page</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lastmod</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;LastModified&quot;</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">]</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Resources&quot;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Resources missing or invalid from Page id </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pageid</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resources</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mediabox</span> <span class="o">=</span> <span class="n">normalize_rect</span><span class="p">(</span><span class="n">rect_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;MediaBox&quot;</span><span class="p">]))</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;MediaBox missing from Page id </span><span class="si">%d</span><span class="s2"> (and not inherited),&quot;</span>
                <span class="s2">&quot; defaulting to US Letter (612x792)&quot;</span><span class="p">,</span>
                <span class="n">pageid</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mediabox</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">612</span><span class="p">,</span> <span class="mi">792</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">PDFSyntaxError</span><span class="p">):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;MediaBox </span><span class="si">%r</span><span class="s2"> invalid in Page id </span><span class="si">%d</span><span class="s2">, defaulting to US Letter (612x792)&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;MediaBox&quot;</span><span class="p">],</span>
                <span class="n">pageid</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mediabox</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">612</span><span class="p">,</span> <span class="mi">792</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cropbox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mediabox</span>
        <span class="k">if</span> <span class="s2">&quot;CropBox&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cropbox</span> <span class="o">=</span> <span class="n">normalize_rect</span><span class="p">(</span><span class="n">rect_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;CropBox&quot;</span><span class="p">]))</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">PDFSyntaxError</span><span class="p">):</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;Invalid CropBox </span><span class="si">%r</span><span class="s2"> in /Page, defaulting to MediaBox&quot;</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;CropBox&quot;</span><span class="p">],</span>
                <span class="p">)</span>

        <span class="c1"># This is supposed to be an int, but be robust to bogus PDFs where it isn&#39;t</span>
        <span class="n">rotate</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Rotate&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_initial_ctm</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">rotate</span><span class="p">)</span>

        <span class="n">contents</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Contents&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">contents</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_contents</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">contents</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_contents</span> <span class="o">=</span> <span class="n">contents</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_contents</span> <span class="o">=</span> <span class="p">[</span><span class="n">contents</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_initial_ctm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">space</span><span class="p">:</span> <span class="n">DeviceSpace</span><span class="p">,</span> <span class="n">rotate</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set or update initial coordinate transform matrix.</span>

<span class="sd">        PDF 1.7 section 8.4.1: Initial value: a matrix that</span>
<span class="sd">        transforms default user coordinates to device coordinates.</span>

<span class="sd">        We keep this as `self.ctm` in order to transform layout</span>
<span class="sd">        attributes in tagged PDFs which are specified in default</span>
<span class="sd">        user space (PDF 1.7 section 14.8.5.4.3, table 344)</span>

<span class="sd">        If you wish to modify the rotation or the device space of the</span>
<span class="sd">        page, then you can do it with this method (the initial values</span>
<span class="sd">        are in the `rotate` and `space` properties).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Normalize the rotation value</span>
        <span class="n">rotate</span> <span class="o">=</span> <span class="p">(</span><span class="n">rotate</span> <span class="o">+</span> <span class="mi">360</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mediabox</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="o">=</span> <span class="n">MATRIX_IDENTITY</span>
        <span class="k">if</span> <span class="n">rotate</span> <span class="o">==</span> <span class="mi">90</span><span class="p">:</span>
            <span class="c1"># x&#39; = y</span>
            <span class="c1"># y&#39; = width - x</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">rotate</span> <span class="o">==</span> <span class="mi">180</span><span class="p">:</span>
            <span class="c1"># x&#39; = width - x</span>
            <span class="c1"># y&#39; = height - y</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">rotate</span> <span class="o">==</span> <span class="mi">270</span><span class="p">:</span>
            <span class="c1"># x&#39; = height - y</span>
            <span class="c1"># y&#39; = x</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">rotate</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Invalid rotation value </span><span class="si">%r</span><span class="s2"> (only multiples of 90 accepted)&quot;</span><span class="p">,</span> <span class="n">rotate</span>
            <span class="p">)</span>
        <span class="c1"># Apply this to the mediabox to determine device space</span>
        <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span> <span class="o">=</span> <span class="n">transform_bbox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mediabox</span><span class="p">)</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span>
        <span class="c1"># &quot;screen&quot; device space: origin is top left of MediaBox</span>
        <span class="k">if</span> <span class="n">space</span> <span class="o">==</span> <span class="s2">&quot;screen&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="o">=</span> <span class="n">mult_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">x0</span><span class="p">,</span> <span class="n">y1</span><span class="p">))</span>
        <span class="c1"># &quot;page&quot; device space: origin is bottom left of MediaBox</span>
        <span class="k">elif</span> <span class="n">space</span> <span class="o">==</span> <span class="s2">&quot;page&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="o">=</span> <span class="n">mult_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">x0</span><span class="p">,</span> <span class="o">-</span><span class="n">y0</span><span class="p">))</span>
        <span class="c1"># &quot;default&quot; device space: no transformation or rotation</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">space</span> <span class="o">!=</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Unknown device space: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">space</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="o">=</span> <span class="n">MATRIX_IDENTITY</span>
            <span class="n">width</span> <span class="o">=</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">space</span> <span class="o">=</span> <span class="n">space</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rotate</span> <span class="o">=</span> <span class="n">rotate</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">annotations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;Annotation&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Lazily iterate over page annotations.&quot;&quot;&quot;</span>
        <span class="n">alist</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Annots&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">alist</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">alist</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Invalid Annots list: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">alist</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">alist</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">Annotation</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">PDFSyntaxError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Invalid object </span><span class="si">%r</span><span class="s2"> in Annots: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                <span class="k">continue</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">doc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Document&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get associated document if it exists.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_deref_document</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">docref</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">streams</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">ContentStream</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return resolved content streams.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contents</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">stream_value</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Found non-stream in contents: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">width</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Width of the page in default user space units.&quot;&quot;&quot;</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mediabox</span>
        <span class="k">return</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">height</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Width of the page in default user space units.&quot;&quot;&quot;</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mediabox</span>
        <span class="k">return</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">contents</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">PDFObject</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterator over PDF objects in the content streams.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">ContentParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_contents</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">obj</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;ContentObject&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterator over lazy layout objects.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">interp</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">interp</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">filter_classes</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">ContentObject</span><span class="p">]],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">restrict_ops</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="n">PSKeyword</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">ContentObject</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">LazyInterpreter</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_contents</span><span class="p">,</span>
            <span class="n">filter_classes</span><span class="o">=</span><span class="n">filter_classes</span><span class="p">,</span>
            <span class="n">restrict_ops</span><span class="o">=</span><span class="n">restrict_ops</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">paths</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;PathObject&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterator over lazy path objects.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">PathObject</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">images</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;ImageObject&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterator over lazy image objects.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">ImageObject</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">texts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;TextObject&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterator over lazy text objects.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">TextObject</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">glyphs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;GlyphObject&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterator over lazy glyph objects.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">TextObject</span><span class="p">):</span>
            <span class="k">yield from</span> <span class="n">text</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">xobjects</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;XObjectObject&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return resolved and rendered Form XObjects.</span>

<span class="sd">        This does *not* return any image or PostScript XObjects.  You</span>
<span class="sd">        can get images via the `images` property.  Apparently you</span>
<span class="sd">        aren&#39;t supposed to use PostScript XObjects for anything, ever.</span>

<span class="sd">        Note that these are the XObjects as rendered on the page, so</span>
<span class="sd">        you may see the same named XObject multiple times.  If you</span>
<span class="sd">        need to access their actual definitions you&#39;ll have to look at</span>
<span class="sd">        `page.resources`.</span>

<span class="sd">        This will also return Form XObjects within Form XObjects,</span>
<span class="sd">        except in the case of circular reference chains.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Set</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">xobjects_one</span><span class="p">(</span>
            <span class="n">itor</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="s2">&quot;ContentObject&quot;</span><span class="p">],</span> <span class="n">parents</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;XObjectObject&quot;</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">itor</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">XObjectObject</span><span class="p">):</span>
                    <span class="n">stream_id</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">objid</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">obj</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">objid</span>
                    <span class="k">if</span> <span class="n">stream_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">parents</span><span class="p">:</span>
                        <span class="k">yield</span> <span class="n">obj</span>
                        <span class="k">yield from</span> <span class="n">xobjects_one</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">parents</span> <span class="o">|</span> <span class="p">{</span><span class="n">stream_id</span><span class="p">})</span>

        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">xobjects_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">set</span><span class="p">()):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">XObjectObject</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">obj</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Token</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterator over tokens in the content streams.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">stream</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contents</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">tok</span> <span class="ow">in</span> <span class="n">Lexer</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">buffer</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">tok</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">parent_key</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parent tree key for this page, if any.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;StructParents&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">int_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;StructParents&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">structure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PageStructure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Mapping of marked content IDs to logical structure elements.</span>

<span class="sd">        This is a sequence of logical structure elements, or `None`</span>
<span class="sd">        for unused marked content IDs.  Note that because structure</span>
<span class="sd">        elements may contain multiple marked content sections, the</span>
<span class="sd">        same element may occur multiple times in this list.</span>

<span class="sd">        It also has `find` and `find_all` methods which allow you to</span>
<span class="sd">        access enclosing structural elements (you can also use the</span>
<span class="sd">        `parent` method of elements for that)</span>

<span class="sd">        Note: This is not the same as `playa.Document.structure`.</span>
<span class="sd">            PDF documents have logical structure, but PDF pages **do</span>
<span class="sd">            not**, and it is dishonest to pretend otherwise (as some</span>
<span class="sd">            code I once wrote unfortunately does).  What they do have</span>
<span class="sd">            is marked content sections which correspond to content</span>
<span class="sd">            items in the logical structure tree.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_structmap</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_structmap</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_structmap</span> <span class="o">=</span> <span class="n">PageStructure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pageref</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">structure</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_structmap</span>
        <span class="n">parent_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent_key</span>
        <span class="k">if</span> <span class="n">parent_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_structmap</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_structmap</span> <span class="o">=</span> <span class="n">PageStructure</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pageref</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">parent_tree</span><span class="p">[</span><span class="n">parent_key</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Invalid StructParents: </span><span class="si">%r</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">parent_key</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_structmap</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">marked_content</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ContentSequence</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A [`ContentSequence`][playa.content.ContentSequence] containing</span>
<span class="sd">        content objects associated with the structural elements in</span>
<span class="sd">        [`structure`][playa.page.Page.structure].  They consist of a</span>
<span class="sd">        sequence with the same indices (these are the marked content</span>
<span class="sd">        IDs) as the structure so can be zipped:</span>

<span class="sd">            for element, contents in zip(page.structure,</span>
<span class="sd">                                         page.marked_content):</span>
<span class="sd">                for obj in contents:</span>
<span class="sd">                    ...  # do something with it</span>

<span class="sd">        Or you can also access the contents of a single element:</span>

<span class="sd">            for obj in page.marked_content[mcid]:</span>
<span class="sd">                ... # do something with it</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_marked_contents</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_marked_contents</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_marked_contents</span> <span class="o">=</span> <span class="n">ContentSequence</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_marked_contents</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">fonts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;Font&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Mapping of resource names to fonts for this page.</span>

<span class="sd">        Note: This is not the same as `playa.Document.fonts`.</span>
<span class="sd">            The resource names (e.g. `F1`, `F42`, `FooBar`) here are</span>
<span class="sd">            specific to a page (or Form XObject) resource dictionary</span>
<span class="sd">            and have no relation to the font name as commonly</span>
<span class="sd">            understood (e.g. `Helvetica`,</span>
<span class="sd">            `WQERQE+Arial-SuperBold-HJRE-UTF-8`).  Since font names are</span>
<span class="sd">            generally considered to be globally unique, it may be</span>
<span class="sd">            possible to access fonts by them in the future.</span>

<span class="sd">        Note: This does not include fonts specific to Form XObjects.</span>
<span class="sd">            Since it is possible for the resource names to collide,</span>
<span class="sd">            this will only return the fonts for a page and not for any</span>
<span class="sd">            Form XObjects invoked on it.  You may use</span>
<span class="sd">            `XObjectObject.fonts` to access these.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fontmap</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fontmap</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fontmap</span> <span class="o">=</span> <span class="n">FontMapping</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Font&quot;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fontmap</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;Page: Resources=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="si">!r}</span><span class="s2">, MediaBox=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mediabox</span><span class="si">!r}</span><span class="s2">&gt;&quot;</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">flatten</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;ContentObject&quot;</span><span class="p">]:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">flatten</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">CO</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">CO</span><span class="p">]:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">flatten</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">filter_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">CO</span><span class="p">],</span> <span class="n">restrict_ops</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="n">PSKeyword</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">CO</span><span class="p">]:</span> <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">flatten</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">filter_class</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">Type</span><span class="p">[</span><span class="n">CO</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">restrict_ops</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="n">PSKeyword</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">CO</span><span class="p">,</span> <span class="s2">&quot;ContentObject&quot;</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over content objects, recursing into form XObjects.&quot;&quot;&quot;</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Set</span>

        <span class="k">if</span> <span class="n">filter_class</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">filter_classes</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">ContentObject</span><span class="p">]],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">XObjectObject</span><span class="p">,</span>
                <span class="n">filter_class</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">filter_classes</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">flatten_one</span><span class="p">(</span>
            <span class="n">itor</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="s2">&quot;ContentObject&quot;</span><span class="p">],</span> <span class="n">parents</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;ContentObject&quot;</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">itor</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">XObjectObject</span><span class="p">):</span>
                    <span class="n">stream_id</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">objid</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">obj</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">objid</span>
                    <span class="k">if</span> <span class="n">stream_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">parents</span><span class="p">:</span>
                        <span class="k">yield from</span> <span class="n">flatten_one</span><span class="p">(</span>
                            <span class="n">obj</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span>
                                <span class="n">filter_classes</span><span class="o">=</span><span class="n">filter_classes</span><span class="p">,</span> <span class="n">restrict_ops</span><span class="o">=</span><span class="n">restrict_ops</span>
                            <span class="p">),</span>
                            <span class="n">parents</span> <span class="o">|</span> <span class="p">{</span><span class="n">stream_id</span><span class="p">},</span>
                        <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">obj</span>

        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">flatten_one</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">filter_classes</span><span class="o">=</span><span class="n">filter_classes</span><span class="p">,</span> <span class="n">restrict_ops</span><span class="o">=</span><span class="n">restrict_ops</span><span class="p">),</span>
            <span class="nb">set</span><span class="p">(),</span>
        <span class="p">):</span>
            <span class="k">yield</span> <span class="n">obj</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">extract_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">bbox</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Rect</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Do some best-effort text extraction.</span>

<span class="sd">        This necessarily involves a few heuristics, so don&#39;t get your</span>
<span class="sd">        hopes up.  It will attempt to use marked content information</span>
<span class="sd">        for a tagged PDF, otherwise it will fall back on the character</span>
<span class="sd">        displacement and line matrix to determine word and line breaks.</span>

<span class="sd">        Args:</span>
<span class="sd">          bbox: If not `None`, only text objects which intersect this</span>
<span class="sd">                rectangle will be extracted.</span>

<span class="sd">        Note: `bbox` operates on text objects, not glyphs.</span>
<span class="sd">          You may be surprised to get a lot more text than you</span>
<span class="sd">          expected if you call this with a `bbox`.  This is because,</span>
<span class="sd">          for efficiency reasons, the intersection check is performed</span>
<span class="sd">          on text objects (strings in the content stream) rather than</span>
<span class="sd">          glyphs (individual characters).  For many tasks like table</span>
<span class="sd">          extraction, this is actually what you want.  Otherwise, you</span>
<span class="sd">          will need to use `playa.utils.intersect_rects` on the</span>
<span class="sd">          individual glyph bboxes, which is, of course, slow.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">is_tagged</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_text_tagged</span><span class="p">(</span><span class="n">bbox</span><span class="o">=</span><span class="n">bbox</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_text_untagged</span><span class="p">(</span><span class="n">bbox</span><span class="o">=</span><span class="n">bbox</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">extract_text_untagged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">bbox</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Rect</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get text from a page of an untagged PDF.&quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">_extract_text_from_obj</span><span class="p">(</span>
            <span class="n">obj</span><span class="p">:</span> <span class="s2">&quot;TextObject&quot;</span><span class="p">,</span> <span class="n">vertical</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">prev_end</span><span class="p">:</span> <span class="nb">float</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Try to get text from a text object.&quot;&quot;&quot;</span>
            <span class="n">chars</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">glyph</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
                <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">glyph</span><span class="o">.</span><span class="n">origin</span>
                <span class="n">off</span> <span class="o">=</span> <span class="n">y</span> <span class="k">if</span> <span class="n">vertical</span> <span class="k">else</span> <span class="n">x</span>
                <span class="c1"># 0.5 here is a heuristic!!!</span>
                <span class="k">if</span> <span class="n">prev_end</span> <span class="ow">and</span> <span class="n">off</span> <span class="o">-</span> <span class="n">prev_end</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">chars</span> <span class="ow">and</span> <span class="n">chars</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot; &quot;</span><span class="p">:</span>
                        <span class="n">chars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">glyph</span><span class="o">.</span><span class="n">text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">chars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">glyph</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
                <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">glyph</span><span class="o">.</span><span class="n">displacement</span>
                <span class="n">prev_end</span> <span class="o">=</span> <span class="n">off</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span> <span class="k">if</span> <span class="n">vertical</span> <span class="k">else</span> <span class="n">dx</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">chars</span><span class="p">),</span> <span class="n">prev_end</span>

        <span class="n">prev_end</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">prev_origin</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Point</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">strings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">itor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">filter_class</span><span class="o">=</span><span class="n">TextObject</span><span class="p">,</span> <span class="n">restrict_ops</span><span class="o">=</span><span class="n">TEXT_OPERATORS</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">itor</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">text</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">font</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">vertical</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">vertical</span>
            <span class="c1"># Track changes to the translation component of text</span>
            <span class="c1"># rendering matrix to (yes, heuristically) detect newlines</span>
            <span class="c1"># and spaces between text objects</span>
            <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">origin</span>
            <span class="n">off</span> <span class="o">=</span> <span class="n">dy</span> <span class="k">if</span> <span class="n">vertical</span> <span class="k">else</span> <span class="n">dx</span>
            <span class="k">if</span> <span class="n">strings</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_line</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">prev_origin</span><span class="p">):</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">strings</span><span class="p">))</span>
                <span class="n">strings</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="c1"># 0.5 here is a heuristic!!!</span>
            <span class="k">if</span> <span class="n">strings</span> <span class="ow">and</span> <span class="n">off</span> <span class="o">-</span> <span class="n">prev_end</span> <span class="o">&gt;</span> <span class="mf">0.5</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">strings</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">):</span>
                <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
            <span class="n">textstr</span><span class="p">,</span> <span class="n">prev_end</span> <span class="o">=</span> <span class="n">_extract_text_from_obj</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">vertical</span><span class="p">,</span> <span class="n">off</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">bbox</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">textstr</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ex</span><span class="p">,</span> <span class="n">ey</span> <span class="o">=</span> <span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">prev_end</span><span class="p">)</span> <span class="k">if</span> <span class="n">vertical</span> <span class="k">else</span> <span class="p">(</span><span class="n">prev_end</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">_crosses_bbox</span><span class="p">((</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">),</span> <span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="n">ey</span><span class="p">),</span> <span class="n">bbox</span><span class="p">):</span>
                    <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">textstr</span><span class="p">)</span>
            <span class="n">prev_origin</span> <span class="o">=</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">strings</span><span class="p">))</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_next_line</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">TextObject</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">prev_offset</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Point</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">text</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">text</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">font</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">prev_offset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">origin</span>

        <span class="c1"># Vertical text (usually) means right-to-left lines</span>
        <span class="k">if</span> <span class="n">text</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">vertical</span><span class="p">:</span>
            <span class="n">line_offset</span> <span class="o">=</span> <span class="n">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">prev_offset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># The CTM isn&#39;t useful here because we actually do care</span>
            <span class="c1"># about the final device space, and we just want to know</span>
            <span class="c1"># which way is up and which way is down.</span>
            <span class="n">dy</span> <span class="o">=</span> <span class="n">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">prev_offset</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span> <span class="o">==</span> <span class="s2">&quot;screen&quot;</span><span class="p">:</span>
                <span class="n">line_offset</span> <span class="o">=</span> <span class="o">-</span><span class="n">dy</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">line_offset</span> <span class="o">=</span> <span class="n">dy</span>
        <span class="k">return</span> <span class="n">line_offset</span> <span class="o">&lt;</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">extract_text_tagged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">bbox</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Rect</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get text from a page of a tagged PDF.&quot;&quot;&quot;</span>
        <span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">strings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">prev_mcid</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">prev_origin</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Point</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># TODO: Iteration over marked content sections and getting</span>
        <span class="c1"># their text, origin, and displacement, will be refactored</span>
        <span class="n">itor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">filter_class</span><span class="o">=</span><span class="n">TextObject</span><span class="p">,</span> <span class="n">restrict_ops</span><span class="o">=</span><span class="n">TEXT_OPERATORS</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">mcs</span><span class="p">,</span> <span class="n">texts</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">itor</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;mcs&quot;</span><span class="p">)):</span>
            <span class="n">text</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">TextObject</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="c1"># TODO: Artifact can also be a structure element, but</span>
            <span class="c1"># also, any content outside the structure tree is</span>
            <span class="c1"># considered an artifact</span>
            <span class="k">if</span> <span class="n">mcs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">mcs</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="s2">&quot;Artifact&quot;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">:</span>
                    <span class="n">prev_origin</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">origin</span>
                <span class="k">continue</span>
            <span class="n">actual_text</span> <span class="o">=</span> <span class="n">mcs</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ActualText&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">actual_text</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="nb">reversed</span> <span class="o">=</span> <span class="n">mcs</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="s2">&quot;ReversedChars&quot;</span>
                <span class="n">c</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">:</span>  <span class="c1"># noqa: B031</span>
                    <span class="k">if</span> <span class="n">bbox</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">chars</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="nb">reversed</span> <span class="k">else</span> <span class="n">text</span><span class="o">.</span><span class="n">chars</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">origin</span>
                        <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">displacement</span>
                        <span class="n">ex</span><span class="p">,</span> <span class="n">ey</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dy</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">_crosses_bbox</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="n">ey</span><span class="p">),</span> <span class="n">bbox</span><span class="p">):</span>
                            <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">chars</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="nb">reversed</span> <span class="k">else</span> <span class="n">text</span><span class="o">.</span><span class="n">chars</span><span class="p">)</span>
                <span class="n">chars</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">actual_text</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)</span>
                <span class="c1"># It&#39;s a text string so decode_text it</span>
                <span class="n">chars</span> <span class="o">=</span> <span class="n">decode_text</span><span class="p">(</span><span class="n">actual_text</span><span class="p">)</span>
                <span class="c1"># Consume all text objects to ensure correct graphicstate</span>
                <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">:</span>  <span class="c1"># noqa: B031</span>
                    <span class="k">pass</span>

            <span class="c1"># Remove soft hyphens</span>
            <span class="n">chars</span> <span class="o">=</span> <span class="n">chars</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\xad</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="c1"># There *might* be a line break, determine based on origin</span>
            <span class="k">if</span> <span class="n">mcs</span><span class="o">.</span><span class="n">mcid</span> <span class="o">!=</span> <span class="n">prev_mcid</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_line</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">prev_origin</span><span class="p">):</span>
                    <span class="n">lines</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">strings</span><span class="p">)))</span>
                    <span class="n">strings</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                <span class="n">prev_mcid</span> <span class="o">=</span> <span class="n">mcs</span><span class="o">.</span><span class="n">mcid</span>
            <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chars</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">prev_origin</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">origin</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">strings</span><span class="p">)))</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="playa.miner.PDFPage.annotations" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">annotations</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Lazily iterate over page annotations.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.miner.PDFPage.contents" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">contents</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterator over PDF objects in the content streams.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.miner.PDFPage.doc" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">doc</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Get associated document if it exists.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.miner.PDFPage.fonts" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fonts</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Mapping of resource names to fonts for this page.</p>


<details class="note" open>
  <summary>This is not the same as <code>playa.Document.fonts</code>.</summary>
  <p>The resource names (e.g. <code>F1</code>, <code>F42</code>, <code>FooBar</code>) here are
specific to a page (or Form XObject) resource dictionary
and have no relation to the font name as commonly
understood (e.g. <code>Helvetica</code>,
<code>WQERQE+Arial-SuperBold-HJRE-UTF-8</code>).  Since font names are
generally considered to be globally unique, it may be
possible to access fonts by them in the future.</p>
</details>

<details class="note" open>
  <summary>This does not include fonts specific to Form XObjects.</summary>
  <p>Since it is possible for the resource names to collide,
this will only return the fonts for a page and not for any
Form XObjects invoked on it.  You may use
<code>XObjectObject.fonts</code> to access these.</p>
</details>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.miner.PDFPage.glyphs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">glyphs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterator over lazy glyph objects.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.miner.PDFPage.height" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">height</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Width of the page in default user space units.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.miner.PDFPage.images" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">images</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterator over lazy image objects.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.miner.PDFPage.marked_content" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">marked_content</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>A <a class="autorefs autorefs-internal" href="../reference/#playa.content.ContentSequence"><code>ContentSequence</code></a> containing
content objects associated with the structural elements in
<a class="autorefs autorefs-internal" title="structure

  
      property
  " href="../reference/#playa.page.Page.structure"><code>structure</code></a>.  They consist of a
sequence with the same indices (these are the marked content
IDs) as the structure so can be zipped:</p>
<pre><code>for element, contents in zip(page.structure,
                             page.marked_content):
    for obj in contents:
        ...  # do something with it
</code></pre>
<p>Or you can also access the contents of a single element:</p>
<pre><code>for obj in page.marked_content[mcid]:
    ... # do something with it
</code></pre>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.miner.PDFPage.parent_key" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parent_key</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Parent tree key for this page, if any.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.miner.PDFPage.paths" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">paths</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterator over lazy path objects.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.miner.PDFPage.streams" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">streams</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Return resolved content streams.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.miner.PDFPage.structure" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">structure</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Mapping of marked content IDs to logical structure elements.</p>
<p>This is a sequence of logical structure elements, or <code>None</code>
for unused marked content IDs.  Note that because structure
elements may contain multiple marked content sections, the
same element may occur multiple times in this list.</p>
<p>It also has <code>find</code> and <code>find_all</code> methods which allow you to
access enclosing structural elements (you can also use the
<code>parent</code> method of elements for that)</p>


<details class="note" open>
  <summary>This is not the same as <code>playa.Document.structure</code>.</summary>
  <p>PDF documents have logical structure, but PDF pages <strong>do
not</strong>, and it is dishonest to pretend otherwise (as some
code I once wrote unfortunately does).  What they do have
is marked content sections which correspond to content
items in the logical structure tree.</p>
</details>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.miner.PDFPage.texts" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">texts</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterator over lazy text objects.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.miner.PDFPage.tokens" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tokens</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterator over tokens in the content streams.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.miner.PDFPage.width" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">width</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Width of the page in default user space units.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.miner.PDFPage.xobjects" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">xobjects</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Return resolved and rendered Form XObjects.</p>
<p>This does <em>not</em> return any image or PostScript XObjects.  You
can get images via the <code>images</code> property.  Apparently you
aren't supposed to use PostScript XObjects for anything, ever.</p>
<p>Note that these are the XObjects as rendered on the page, so
you may see the same named XObject multiple times.  If you
need to access their actual definitions you'll have to look at
<code>page.resources</code>.</p>
<p>This will also return Form XObjects within Form XObjects,
except in the case of circular reference chains.</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="playa.miner.PDFPage.__iter__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__iter__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Iterator over lazy layout objects.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>playa/page.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;ContentObject&quot;</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterator over lazy layout objects.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">interp</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.miner.PDFPage.extract_text" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extract_text</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Do some best-effort text extraction.</p>
<p>This necessarily involves a few heuristics, so don't get your
hopes up.  It will attempt to use marked content information
for a tagged PDF, otherwise it will fall back on the character
displacement and line matrix to determine word and line breaks.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>bbox</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<span title="playa.pdftypes.Rect">Rect</span>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If not <code>None</code>, only text objects which intersect this
    rectangle will be extracted.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary><code>bbox</code> operates on text objects, not glyphs.</summary>
  <p>You may be surprised to get a lot more text than you
expected if you call this with a <code>bbox</code>.  This is because,
for efficiency reasons, the intersection check is performed
on text objects (strings in the content stream) rather than
glyphs (individual characters).  For many tasks like table
extraction, this is actually what you want.  Otherwise, you
will need to use <code>playa.utils.intersect_rects</code> on the
individual glyph bboxes, which is, of course, slow.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>playa/page.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">extract_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">bbox</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Rect</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Do some best-effort text extraction.</span>

<span class="sd">    This necessarily involves a few heuristics, so don&#39;t get your</span>
<span class="sd">    hopes up.  It will attempt to use marked content information</span>
<span class="sd">    for a tagged PDF, otherwise it will fall back on the character</span>
<span class="sd">    displacement and line matrix to determine word and line breaks.</span>

<span class="sd">    Args:</span>
<span class="sd">      bbox: If not `None`, only text objects which intersect this</span>
<span class="sd">            rectangle will be extracted.</span>

<span class="sd">    Note: `bbox` operates on text objects, not glyphs.</span>
<span class="sd">      You may be surprised to get a lot more text than you</span>
<span class="sd">      expected if you call this with a `bbox`.  This is because,</span>
<span class="sd">      for efficiency reasons, the intersection check is performed</span>
<span class="sd">      on text objects (strings in the content stream) rather than</span>
<span class="sd">      glyphs (individual characters).  For many tasks like table</span>
<span class="sd">      extraction, this is actually what you want.  Otherwise, you</span>
<span class="sd">      will need to use `playa.utils.intersect_rects` on the</span>
<span class="sd">      individual glyph bboxes, which is, of course, slow.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">is_tagged</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_text_tagged</span><span class="p">(</span><span class="n">bbox</span><span class="o">=</span><span class="n">bbox</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_text_untagged</span><span class="p">(</span><span class="n">bbox</span><span class="o">=</span><span class="n">bbox</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.miner.PDFPage.extract_text_tagged" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extract_text_tagged</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get text from a page of a tagged PDF.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>playa/page.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">extract_text_tagged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">bbox</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Rect</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get text from a page of a tagged PDF.&quot;&quot;&quot;</span>
    <span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">strings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">prev_mcid</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">prev_origin</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Point</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># TODO: Iteration over marked content sections and getting</span>
    <span class="c1"># their text, origin, and displacement, will be refactored</span>
    <span class="n">itor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">filter_class</span><span class="o">=</span><span class="n">TextObject</span><span class="p">,</span> <span class="n">restrict_ops</span><span class="o">=</span><span class="n">TEXT_OPERATORS</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">mcs</span><span class="p">,</span> <span class="n">texts</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">itor</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;mcs&quot;</span><span class="p">)):</span>
        <span class="n">text</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">TextObject</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># TODO: Artifact can also be a structure element, but</span>
        <span class="c1"># also, any content outside the structure tree is</span>
        <span class="c1"># considered an artifact</span>
        <span class="k">if</span> <span class="n">mcs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">mcs</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="s2">&quot;Artifact&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">:</span>
                <span class="n">prev_origin</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">origin</span>
            <span class="k">continue</span>
        <span class="n">actual_text</span> <span class="o">=</span> <span class="n">mcs</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ActualText&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">actual_text</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">reversed</span> <span class="o">=</span> <span class="n">mcs</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="s2">&quot;ReversedChars&quot;</span>
            <span class="n">c</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">:</span>  <span class="c1"># noqa: B031</span>
                <span class="k">if</span> <span class="n">bbox</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">chars</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="nb">reversed</span> <span class="k">else</span> <span class="n">text</span><span class="o">.</span><span class="n">chars</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">origin</span>
                    <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">displacement</span>
                    <span class="n">ex</span><span class="p">,</span> <span class="n">ey</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dy</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">_crosses_bbox</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="n">ey</span><span class="p">),</span> <span class="n">bbox</span><span class="p">):</span>
                        <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">chars</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="nb">reversed</span> <span class="k">else</span> <span class="n">text</span><span class="o">.</span><span class="n">chars</span><span class="p">)</span>
            <span class="n">chars</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">actual_text</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)</span>
            <span class="c1"># It&#39;s a text string so decode_text it</span>
            <span class="n">chars</span> <span class="o">=</span> <span class="n">decode_text</span><span class="p">(</span><span class="n">actual_text</span><span class="p">)</span>
            <span class="c1"># Consume all text objects to ensure correct graphicstate</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">:</span>  <span class="c1"># noqa: B031</span>
                <span class="k">pass</span>

        <span class="c1"># Remove soft hyphens</span>
        <span class="n">chars</span> <span class="o">=</span> <span class="n">chars</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\xad</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="c1"># There *might* be a line break, determine based on origin</span>
        <span class="k">if</span> <span class="n">mcs</span><span class="o">.</span><span class="n">mcid</span> <span class="o">!=</span> <span class="n">prev_mcid</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_line</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">prev_origin</span><span class="p">):</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">strings</span><span class="p">)))</span>
                <span class="n">strings</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">prev_mcid</span> <span class="o">=</span> <span class="n">mcs</span><span class="o">.</span><span class="n">mcid</span>
        <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chars</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">prev_origin</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">origin</span>
    <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">strings</span><span class="p">)))</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.miner.PDFPage.extract_text_untagged" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extract_text_untagged</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get text from a page of an untagged PDF.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>playa/page.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">extract_text_untagged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">bbox</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Rect</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get text from a page of an untagged PDF.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_extract_text_from_obj</span><span class="p">(</span>
        <span class="n">obj</span><span class="p">:</span> <span class="s2">&quot;TextObject&quot;</span><span class="p">,</span> <span class="n">vertical</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">prev_end</span><span class="p">:</span> <span class="nb">float</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Try to get text from a text object.&quot;&quot;&quot;</span>
        <span class="n">chars</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">glyph</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">glyph</span><span class="o">.</span><span class="n">origin</span>
            <span class="n">off</span> <span class="o">=</span> <span class="n">y</span> <span class="k">if</span> <span class="n">vertical</span> <span class="k">else</span> <span class="n">x</span>
            <span class="c1"># 0.5 here is a heuristic!!!</span>
            <span class="k">if</span> <span class="n">prev_end</span> <span class="ow">and</span> <span class="n">off</span> <span class="o">-</span> <span class="n">prev_end</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">chars</span> <span class="ow">and</span> <span class="n">chars</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot; &quot;</span><span class="p">:</span>
                    <span class="n">chars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">glyph</span><span class="o">.</span><span class="n">text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">chars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">glyph</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">glyph</span><span class="o">.</span><span class="n">displacement</span>
            <span class="n">prev_end</span> <span class="o">=</span> <span class="n">off</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span> <span class="k">if</span> <span class="n">vertical</span> <span class="k">else</span> <span class="n">dx</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">chars</span><span class="p">),</span> <span class="n">prev_end</span>

    <span class="n">prev_end</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">prev_origin</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Point</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">strings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">itor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">filter_class</span><span class="o">=</span><span class="n">TextObject</span><span class="p">,</span> <span class="n">restrict_ops</span><span class="o">=</span><span class="n">TEXT_OPERATORS</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">itor</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">text</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">font</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">vertical</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">vertical</span>
        <span class="c1"># Track changes to the translation component of text</span>
        <span class="c1"># rendering matrix to (yes, heuristically) detect newlines</span>
        <span class="c1"># and spaces between text objects</span>
        <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">origin</span>
        <span class="n">off</span> <span class="o">=</span> <span class="n">dy</span> <span class="k">if</span> <span class="n">vertical</span> <span class="k">else</span> <span class="n">dx</span>
        <span class="k">if</span> <span class="n">strings</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_line</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">prev_origin</span><span class="p">):</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">strings</span><span class="p">))</span>
            <span class="n">strings</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="c1"># 0.5 here is a heuristic!!!</span>
        <span class="k">if</span> <span class="n">strings</span> <span class="ow">and</span> <span class="n">off</span> <span class="o">-</span> <span class="n">prev_end</span> <span class="o">&gt;</span> <span class="mf">0.5</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">strings</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">):</span>
            <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="n">textstr</span><span class="p">,</span> <span class="n">prev_end</span> <span class="o">=</span> <span class="n">_extract_text_from_obj</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">vertical</span><span class="p">,</span> <span class="n">off</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bbox</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">textstr</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ex</span><span class="p">,</span> <span class="n">ey</span> <span class="o">=</span> <span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">prev_end</span><span class="p">)</span> <span class="k">if</span> <span class="n">vertical</span> <span class="k">else</span> <span class="p">(</span><span class="n">prev_end</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">_crosses_bbox</span><span class="p">((</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">),</span> <span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="n">ey</span><span class="p">),</span> <span class="n">bbox</span><span class="p">):</span>
                <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">textstr</span><span class="p">)</span>
        <span class="n">prev_origin</span> <span class="o">=</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span>
    <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">strings</span><span class="p">))</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.miner.PDFPage.flatten" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">flatten</span><span class="p">(</span><span class="n">filter_class</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">restrict_ops</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>
          <div class="doc-overloads">
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">flatten</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">ContentObject</span><span class="p">]</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class="nf">flatten</span><span class="p">(</span><span class="n">filter_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">CO</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">CO</span><span class="p">]</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class="nf">flatten</span><span class="p">(</span><span class="n">filter_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">CO</span><span class="p">],</span> <span class="n">restrict_ops</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="n">PSKeyword</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">CO</span><span class="p">]</span>
</code></pre></div>          </div>


    <div class="doc doc-contents ">

        <p>Iterate over content objects, recursing into form XObjects.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>playa/page.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">flatten</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">filter_class</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">Type</span><span class="p">[</span><span class="n">CO</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">restrict_ops</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="n">PSKeyword</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">CO</span><span class="p">,</span> <span class="s2">&quot;ContentObject&quot;</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterate over content objects, recursing into form XObjects.&quot;&quot;&quot;</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Set</span>

    <span class="k">if</span> <span class="n">filter_class</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">filter_classes</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">ContentObject</span><span class="p">]],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">XObjectObject</span><span class="p">,</span>
            <span class="n">filter_class</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">filter_classes</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">flatten_one</span><span class="p">(</span>
        <span class="n">itor</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="s2">&quot;ContentObject&quot;</span><span class="p">],</span> <span class="n">parents</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;ContentObject&quot;</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">itor</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">XObjectObject</span><span class="p">):</span>
                <span class="n">stream_id</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">objid</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">obj</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">objid</span>
                <span class="k">if</span> <span class="n">stream_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">parents</span><span class="p">:</span>
                    <span class="k">yield from</span> <span class="n">flatten_one</span><span class="p">(</span>
                        <span class="n">obj</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span>
                            <span class="n">filter_classes</span><span class="o">=</span><span class="n">filter_classes</span><span class="p">,</span> <span class="n">restrict_ops</span><span class="o">=</span><span class="n">restrict_ops</span>
                        <span class="p">),</span>
                        <span class="n">parents</span> <span class="o">|</span> <span class="p">{</span><span class="n">stream_id</span><span class="p">},</span>
                    <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">obj</span>

    <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">flatten_one</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">filter_classes</span><span class="o">=</span><span class="n">filter_classes</span><span class="p">,</span> <span class="n">restrict_ops</span><span class="o">=</span><span class="n">restrict_ops</span><span class="p">),</span>
        <span class="nb">set</span><span class="p">(),</span>
    <span class="p">):</span>
        <span class="k">yield</span> <span class="n">obj</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.miner.PDFPage.set_initial_ctm" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_initial_ctm</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">rotate</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Set or update initial coordinate transform matrix.</p>
<p>PDF 1.7 section 8.4.1: Initial value: a matrix that
transforms default user coordinates to device coordinates.</p>
<p>We keep this as <code>self.ctm</code> in order to transform layout
attributes in tagged PDFs which are specified in default
user space (PDF 1.7 section 14.8.5.4.3, table 344)</p>
<p>If you wish to modify the rotation or the device space of the
page, then you can do it with this method (the initial values
are in the <code>rotate</code> and <code>space</code> properties).</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>playa/page.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_initial_ctm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">space</span><span class="p">:</span> <span class="n">DeviceSpace</span><span class="p">,</span> <span class="n">rotate</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set or update initial coordinate transform matrix.</span>

<span class="sd">    PDF 1.7 section 8.4.1: Initial value: a matrix that</span>
<span class="sd">    transforms default user coordinates to device coordinates.</span>

<span class="sd">    We keep this as `self.ctm` in order to transform layout</span>
<span class="sd">    attributes in tagged PDFs which are specified in default</span>
<span class="sd">    user space (PDF 1.7 section 14.8.5.4.3, table 344)</span>

<span class="sd">    If you wish to modify the rotation or the device space of the</span>
<span class="sd">    page, then you can do it with this method (the initial values</span>
<span class="sd">    are in the `rotate` and `space` properties).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Normalize the rotation value</span>
    <span class="n">rotate</span> <span class="o">=</span> <span class="p">(</span><span class="n">rotate</span> <span class="o">+</span> <span class="mi">360</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
    <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mediabox</span>
    <span class="n">width</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span>
    <span class="n">height</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="o">=</span> <span class="n">MATRIX_IDENTITY</span>
    <span class="k">if</span> <span class="n">rotate</span> <span class="o">==</span> <span class="mi">90</span><span class="p">:</span>
        <span class="c1"># x&#39; = y</span>
        <span class="c1"># y&#39; = width - x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">rotate</span> <span class="o">==</span> <span class="mi">180</span><span class="p">:</span>
        <span class="c1"># x&#39; = width - x</span>
        <span class="c1"># y&#39; = height - y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">rotate</span> <span class="o">==</span> <span class="mi">270</span><span class="p">:</span>
        <span class="c1"># x&#39; = height - y</span>
        <span class="c1"># y&#39; = x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">rotate</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;Invalid rotation value </span><span class="si">%r</span><span class="s2"> (only multiples of 90 accepted)&quot;</span><span class="p">,</span> <span class="n">rotate</span>
        <span class="p">)</span>
    <span class="c1"># Apply this to the mediabox to determine device space</span>
    <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span> <span class="o">=</span> <span class="n">transform_bbox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mediabox</span><span class="p">)</span>
    <span class="n">width</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span>
    <span class="n">height</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span>
    <span class="c1"># &quot;screen&quot; device space: origin is top left of MediaBox</span>
    <span class="k">if</span> <span class="n">space</span> <span class="o">==</span> <span class="s2">&quot;screen&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="o">=</span> <span class="n">mult_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">x0</span><span class="p">,</span> <span class="n">y1</span><span class="p">))</span>
    <span class="c1"># &quot;page&quot; device space: origin is bottom left of MediaBox</span>
    <span class="k">elif</span> <span class="n">space</span> <span class="o">==</span> <span class="s2">&quot;page&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="o">=</span> <span class="n">mult_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">x0</span><span class="p">,</span> <span class="o">-</span><span class="n">y0</span><span class="p">))</span>
    <span class="c1"># &quot;default&quot; device space: no transformation or rotation</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">space</span> <span class="o">!=</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Unknown device space: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">space</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="o">=</span> <span class="n">MATRIX_IDENTITY</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">space</span> <span class="o">=</span> <span class="n">space</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rotate</span> <span class="o">=</span> <span class="n">rotate</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.miner.PDFTypeError" class="doc doc-heading">
            <code>PDFTypeError</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="playa.exceptions.PDFException">PDFException</span></code></p>



        <p>TypeError, but for PDFs (not a subclass of TypeError, unlike in pdfminer.six)</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>playa/miner.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PDFTypeError</span><span class="p">(</span><span class="n">PDFException</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    TypeError, but for PDFs (not a subclass of TypeError, unlike in pdfminer.six)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.miner.PDFValueError" class="doc doc-heading">
            <code>PDFValueError</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="playa.exceptions.PDFException">PDFException</span></code></p>



        <p>ValueError, but for PDFs (not a subclass of ValueError, unlike in pdfminer.six)</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>playa/miner.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PDFValueError</span><span class="p">(</span><span class="n">PDFException</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ValueError, but for PDFs (not a subclass of ValueError, unlike in pdfminer.six)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.miner.PSLiteral" class="doc doc-heading">
            <code>PSLiteral</code>


</h3>


    <div class="doc doc-contents ">



        <p>A class that represents a PostScript literal.</p>
<p>Postscript literals are used as identifiers, such as variable
names, property names and dictionary keys.  Literals are case
sensitive and denoted by a preceding slash sign (e.g. "/Name").
They are globally unique objects stored in PSLiteralTable.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>playa/pdftypes.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PSLiteral</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A class that represents a PostScript literal.</span>

<span class="sd">    Postscript literals are used as identifiers, such as variable</span>
<span class="sd">    names, property names and dictionary keys.  Literals are case</span>
<span class="sd">    sensitive and denoted by a preceding slash sign (e.g. &quot;/Name&quot;).</span>
<span class="sd">    They are globally unique objects stored in PSLiteralTable.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;PSLiteral&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">PSLiteralTable</span><span class="p">:</span>
            <span class="n">PSLiteralTable</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
            <span class="n">PSLiteralTable</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">return</span> <span class="n">PSLiteralTable</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;/</span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.miner.Plane" class="doc doc-heading">
            <code>Plane</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" title="typing.Generic" href="https://docs.python.org/3/library/typing.html#typing.Generic">Generic</a>[<span title="playa.miner.LTComponentT">LTComponentT</span>]</code></p>



        <p>A set-like data structure for objects placed on a plane.</p>
<p>Can efficiently find objects in a certain rectangular area.
It maintains two parallel lists of objects, each of
which is sorted by its x or y coordinate.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>playa/miner.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Plane</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">LTComponentT</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A set-like data structure for objects placed on a plane.</span>

<span class="sd">    Can efficiently find objects in a certain rectangular area.</span>
<span class="sd">    It maintains two parallel lists of objects, each of</span>
<span class="sd">    which is sorted by its x or y coordinate.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bbox</span><span class="p">:</span> <span class="n">Rect</span><span class="p">,</span> <span class="n">gridsize</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_seq</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">LTComponentT</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># preserve the object order.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_objs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">LTComponentT</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># store unique objects</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Point</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">LTComponentT</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gridsize</span> <span class="o">=</span> <span class="n">gridsize</span>
        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y1</span><span class="p">)</span> <span class="o">=</span> <span class="n">bbox</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;&lt;Plane objs=</span><span class="si">%r</span><span class="s2">&gt;&quot;</span> <span class="o">%</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">LTComponentT</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seq</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">id</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_objs</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">obj</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_objs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">LTComponentT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">id</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_objs</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_getrange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bbox</span><span class="p">:</span> <span class="n">Rect</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Point</span><span class="p">]:</span>
        <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span> <span class="o">=</span> <span class="n">bbox</span>
        <span class="k">if</span> <span class="n">x1</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">x1</span> <span class="o">&lt;=</span> <span class="n">x0</span> <span class="ow">or</span> <span class="n">y1</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">y1</span> <span class="o">&lt;=</span> <span class="n">y0</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">x0</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
        <span class="n">y0</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="n">y0</span><span class="p">)</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x1</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>
        <span class="n">y1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">grid_y</span> <span class="ow">in</span> <span class="n">drange</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridsize</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">grid_x</span> <span class="ow">in</span> <span class="n">drange</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridsize</span><span class="p">):</span>
                <span class="k">yield</span> <span class="p">(</span><span class="n">grid_x</span><span class="p">,</span> <span class="n">grid_y</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">extend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objs</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">LTComponentT</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">LTComponentT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Place an object.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getrange</span><span class="p">((</span><span class="n">obj</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">x1</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">y1</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">:</span>
                <span class="n">r</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">LTComponentT</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_seq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_objs</span><span class="p">[</span><span class="nb">id</span><span class="p">(</span><span class="n">obj</span><span class="p">)]</span> <span class="o">=</span> <span class="n">obj</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">LTComponentT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Displace an object.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getrange</span><span class="p">((</span><span class="n">obj</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">x1</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">y1</span><span class="p">)):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
                <span class="k">pass</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_objs</span><span class="p">[</span><span class="nb">id</span><span class="p">(</span><span class="n">obj</span><span class="p">)]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">find</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bbox</span><span class="p">:</span> <span class="n">Rect</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">LTComponentT</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Finds objects that are in a certain area.&quot;&quot;&quot;</span>
        <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span> <span class="o">=</span> <span class="n">bbox</span>
        <span class="n">done</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getrange</span><span class="p">(</span><span class="n">bbox</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                <span class="k">if</span> <span class="nb">id</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="ow">in</span> <span class="n">done</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">done</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">x1</span> <span class="o">&lt;=</span> <span class="n">x0</span> <span class="ow">or</span> <span class="n">x1</span> <span class="o">&lt;=</span> <span class="n">obj</span><span class="o">.</span><span class="n">x0</span> <span class="ow">or</span> <span class="n">obj</span><span class="o">.</span><span class="n">y1</span> <span class="o">&lt;=</span> <span class="n">y0</span> <span class="ow">or</span> <span class="n">y1</span> <span class="o">&lt;=</span> <span class="n">obj</span><span class="o">.</span><span class="n">y0</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">yield</span> <span class="n">obj</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="playa.miner.Plane.add" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Place an object.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>playa/miner.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">LTComponentT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Place an object.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getrange</span><span class="p">((</span><span class="n">obj</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">x1</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">y1</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">:</span>
            <span class="n">r</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">LTComponentT</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="n">r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_seq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_objs</span><span class="p">[</span><span class="nb">id</span><span class="p">(</span><span class="n">obj</span><span class="p">)]</span> <span class="o">=</span> <span class="n">obj</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.miner.Plane.find" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Finds objects that are in a certain area.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>playa/miner.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">find</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bbox</span><span class="p">:</span> <span class="n">Rect</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">LTComponentT</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Finds objects that are in a certain area.&quot;&quot;&quot;</span>
    <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span> <span class="o">=</span> <span class="n">bbox</span>
    <span class="n">done</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getrange</span><span class="p">(</span><span class="n">bbox</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">id</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="ow">in</span> <span class="n">done</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">done</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">x1</span> <span class="o">&lt;=</span> <span class="n">x0</span> <span class="ow">or</span> <span class="n">x1</span> <span class="o">&lt;=</span> <span class="n">obj</span><span class="o">.</span><span class="n">x0</span> <span class="ow">or</span> <span class="n">obj</span><span class="o">.</span><span class="n">y1</span> <span class="o">&lt;=</span> <span class="n">y0</span> <span class="ow">or</span> <span class="n">y1</span> <span class="o">&lt;=</span> <span class="n">obj</span><span class="o">.</span><span class="n">y0</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">yield</span> <span class="n">obj</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.miner.Plane.remove" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Displace an object.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>playa/miner.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">LTComponentT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Displace an object.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getrange</span><span class="p">((</span><span class="n">obj</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">x1</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">y1</span><span class="p">)):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
            <span class="k">pass</span>
    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_objs</span><span class="p">[</span><span class="nb">id</span><span class="p">(</span><span class="n">obj</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="playa.miner.decode_text" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">decode_text</span><span class="p">(</span><span class="n">s</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Decodes a text string (see PDF 1.7 section 7.9.2.2 - it could
be PDFDocEncoding or UTF-16BE) to a <code>str</code>.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>playa/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">decode_text</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Decodes a text string (see PDF 1.7 section 7.9.2.2 - it could</span>
<span class="sd">    be PDFDocEncoding or UTF-16BE) to a `str`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Sure, it could be UTF-16LE... \/\/hatever...</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
        <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xfe\xff</span><span class="s2">&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xff\xfe</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;UTF-16&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">UnicodeDecodeError</span><span class="p">:</span>
            <span class="c1"># Sure, it could have a BOM and not actually be UTF-16, \/\/TF...</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PDFDocEncoding</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
        <span class="c1"># This is obviously wrong, but a reasonable fallback</span>
        <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;iso-8859-1&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="playa.miner.drange" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">drange</span><span class="p">(</span><span class="n">v0</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns a discrete range.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>playa/miner.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">drange</span><span class="p">(</span><span class="n">v0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">v1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">range</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a discrete range.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">v0</span><span class="p">)</span> <span class="o">//</span> <span class="n">d</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">v1</span> <span class="o">+</span> <span class="n">d</span><span class="p">)</span> <span class="o">//</span> <span class="n">d</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="playa.miner.extract" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extract</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">laparams</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_workers</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mp_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Extract LTPages from a document.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>playa/miner.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">extract</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">laparams</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">LAParams</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_workers</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">mp_context</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">BaseContext</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">LTPage</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract LTPages from a document.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">max_workers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">max_workers</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">playa</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
        <span class="n">path</span><span class="p">,</span>
        <span class="n">space</span><span class="o">=</span><span class="s2">&quot;page&quot;</span><span class="p">,</span>
        <span class="n">max_workers</span><span class="o">=</span><span class="n">max_workers</span><span class="p">,</span>
        <span class="n">mp_context</span><span class="o">=</span><span class="n">mp_context</span><span class="p">,</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">pdf</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">max_workers</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">pdf</span><span class="o">.</span><span class="n">pages</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">extract_page</span><span class="p">(</span><span class="n">page</span><span class="p">,</span> <span class="n">laparams</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">yield from</span> <span class="n">pdf</span><span class="o">.</span><span class="n">pages</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">extract_page</span><span class="p">,</span> <span class="n">laparams</span><span class="o">=</span><span class="n">laparams</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="playa.miner.extract_page" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extract_page</span><span class="p">(</span><span class="n">page</span><span class="p">,</span> <span class="n">laparams</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Extract an LTPage from a Page, and possibly do some layout analysis.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>page</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Page (playa.page.Page)" href="../reference/#playa.page.Page">Page</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a Page as returned by PLAYA (please create this with
  space="page" if you want pdfminer.six compatibility).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>laparams</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-internal" title="LAParams (playa.miner.LAParams)" href="#playa.miner.LAParams">LAParams</a>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if None, no layout analysis is done. Otherwise do
      some kind of heuristic magic that all "Artificial
      Intelligence" depends on but nobody actually
      understands.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="LTPage (playa.miner.LTPage)" href="#playa.miner.LTPage">LTPage</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An analysis of the page as <code>pdfminer.six</code> would give you.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>playa/miner.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">extract_page</span><span class="p">(</span><span class="n">page</span><span class="p">:</span> <span class="n">Page</span><span class="p">,</span> <span class="n">laparams</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">LAParams</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LTPage</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract an LTPage from a Page, and possibly do some layout analysis.</span>

<span class="sd">    Args:</span>
<span class="sd">        page: a Page as returned by PLAYA (please create this with</span>
<span class="sd">              space=&quot;page&quot; if you want pdfminer.six compatibility).</span>
<span class="sd">        laparams: if None, no layout analysis is done. Otherwise do</span>
<span class="sd">                  some kind of heuristic magic that all &quot;Artificial</span>
<span class="sd">                  Intelligence&quot; depends on but nobody actually</span>
<span class="sd">                  understands.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An analysis of the page as `pdfminer.six` would give you.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># This is the mediabox in device space rather than default user</span>
    <span class="c1"># space, which is the source of some confusion</span>
    <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">mediabox</span>
    <span class="c1"># Note that a page can never be rotated by a non-multiple of 90</span>
    <span class="c1"># degrees (pi / 2 for nerds) so that&#39;s why we only care about two</span>
    <span class="c1"># of its corners</span>
    <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">)</span> <span class="o">=</span> <span class="n">apply_matrix_pt</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">ctm</span><span class="p">,</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">))</span>
    <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span> <span class="o">=</span> <span class="n">apply_matrix_pt</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">ctm</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">))</span>
    <span class="c1"># FIXME: The translation of the mediabox here is useless due to</span>
    <span class="c1"># the above transformation (but this should be verified against</span>
    <span class="c1"># pdfminer.six)</span>
    <span class="n">mediabox</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x0</span> <span class="o">-</span> <span class="n">x1</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">y0</span> <span class="o">-</span> <span class="n">y1</span><span class="p">))</span>
    <span class="n">ltpage</span> <span class="o">=</span> <span class="n">LTPage</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">page_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mediabox</span><span class="p">)</span>

    <span class="c1"># Emulating PDFLayoutAnalyzer is fairly simple and maps almost</span>
    <span class="c1"># directly onto PLAYA&#39;s lazy API.  XObjects and inline images</span>
    <span class="c1"># produce an LTFigure, characters produce an LTChar, everything</span>
    <span class="c1"># else produces an LTLine, LTRect, or LTCurve.</span>
    <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">page</span><span class="p">:</span>
        <span class="c1"># Put this in some functions to avoid isinstance abuse</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">process_object</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="n">ltpage</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">laparams</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ltpage</span><span class="o">.</span><span class="n">analyze</span><span class="p">(</span><span class="n">laparams</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ltpage</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="playa.miner.fsplit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fsplit</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">objs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Split a list into two classes according to the predicate.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>playa/miner.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fsplit</span><span class="p">(</span><span class="n">pred</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">_T</span><span class="p">],</span> <span class="nb">bool</span><span class="p">],</span> <span class="n">objs</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">_T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">_T</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Split a list into two classes according to the predicate.&quot;&quot;&quot;</span>
    <span class="n">t</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">f</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objs</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pred</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="n">t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">f</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="playa.miner.make_path_segment" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_path_segment</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create a type-safe PathSegment, unlike pdfminer.six.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>playa/miner.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_path_segment</span><span class="p">(</span><span class="n">op</span><span class="p">:</span> <span class="n">PathOperator</span><span class="p">,</span> <span class="n">points</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Point</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">PathSegment</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a type-safe PathSegment, unlike pdfminer.six.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">op</span> <span class="o">!=</span> <span class="s2">&quot;h&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Incorrect arguments for </span><span class="si">{op!r}</span><span class="s2">: </span><span class="si">{points!r}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">op</span><span class="p">),)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">op</span> <span class="ow">not</span> <span class="ow">in</span> <span class="s2">&quot;ml&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Incorrect arguments for </span><span class="si">{op!r}</span><span class="s2">: </span><span class="si">{points!r}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">op</span><span class="p">),</span> <span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">op</span> <span class="ow">not</span> <span class="ow">in</span> <span class="s2">&quot;vy&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Incorrect arguments for </span><span class="si">{op!r}</span><span class="s2">: </span><span class="si">{points!r}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">op</span><span class="p">),</span> <span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">op</span> <span class="o">!=</span> <span class="s2">&quot;c&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Incorrect arguments for </span><span class="si">{op!r}</span><span class="s2">: </span><span class="si">{points!r}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">op</span><span class="p">),</span> <span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Path segment has unknown number of points: </span><span class="si">{</span><span class="n">op</span><span class="si">!r}</span><span class="s2"> </span><span class="si">{</span><span class="n">points</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="playa.miner.process_object" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">process_object</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Handle obj according to its type</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>playa/miner.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@singledispatch</span>
<span class="k">def</span><span class="w"> </span><span class="nf">process_object</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="n">ContentObject</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">LTComponent</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Handle obj according to its type&quot;&quot;&quot;</span>
    <span class="k">yield from</span> <span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="playa.miner.resolve1" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">resolve1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Resolves an object.</p>
<p>If this is an array or dictionary, it may still contains
some indirect objects inside.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>playa/pdftypes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">resolve1</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">PDFObject</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">PDFObject</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDFObject</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Resolves an object.</span>

<span class="sd">    If this is an array or dictionary, it may still contains</span>
<span class="sd">    some indirect objects inside.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">while</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ObjRef</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="playa.miner.resolve_all" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">resolve_all</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Resolves all indirect object references inside the given object.</p>
<p>This creates new copies of any lists or dictionaries, so the
original object is not modified.  However, it will ultimately
create circular references if they exist, so beware.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>playa/pdftypes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">resolve_all</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">PDFObject</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">PDFObject</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDFObject</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Resolves all indirect object references inside the given object.</span>

<span class="sd">    This creates new copies of any lists or dictionaries, so the</span>
<span class="sd">    original object is not modified.  However, it will ultimately</span>
<span class="sd">    create circular references if they exist, so beware.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">resolver</span><span class="p">(</span>
        <span class="n">x</span><span class="p">:</span> <span class="n">PDFObject</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">PDFObject</span><span class="p">,</span> <span class="n">seen</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDFObject</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ObjRef</span><span class="p">):</span>
            <span class="n">ref</span> <span class="o">=</span> <span class="n">x</span>
            <span class="k">while</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ObjRef</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">objid</span> <span class="ow">in</span> <span class="n">seen</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">seen</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">objid</span><span class="p">]</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">)</span>
            <span class="n">seen</span><span class="p">[</span><span class="n">ref</span><span class="o">.</span><span class="n">objid</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">resolver</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">seen</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">resolver</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">seen</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="k">return</span> <span class="n">x</span>

    <span class="k">return</span> <span class="n">resolver</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="p">{})</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="playa.miner.subpaths" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">subpaths</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Iterate over "subpaths".</p>
<p>Note: subpaths inherit the values of <code>fill</code> and <code>evenodd</code> from
the parent path, but these values are no longer meaningful
since the winding rules must be applied to the composite path
as a whole (this is not a bug, just don't rely on them to know
which regions are filled or not).</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>playa/miner.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">subpaths</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n">PathObject</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">PathObject</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterate over &quot;subpaths&quot;.</span>

<span class="sd">    Note: subpaths inherit the values of `fill` and `evenodd` from</span>
<span class="sd">    the parent path, but these values are no longer meaningful</span>
<span class="sd">    since the winding rules must be applied to the composite path</span>
<span class="sd">    as a whole (this is not a bug, just don&#39;t rely on them to know</span>
<span class="sd">    which regions are filled or not).</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># FIXME: Is there an itertool or a more_itertool for this?</span>
    <span class="n">segs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PLAYAPathSegment</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">seg</span> <span class="ow">in</span> <span class="n">path</span><span class="o">.</span><span class="n">raw_segments</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">seg</span><span class="o">.</span><span class="n">operator</span> <span class="o">==</span> <span class="s2">&quot;m&quot;</span> <span class="ow">and</span> <span class="n">segs</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">PathObject</span><span class="p">(</span>
                <span class="n">_pageref</span><span class="o">=</span><span class="n">path</span><span class="o">.</span><span class="n">_pageref</span><span class="p">,</span>
                <span class="n">_parentkey</span><span class="o">=</span><span class="n">path</span><span class="o">.</span><span class="n">_parentkey</span><span class="p">,</span>
                <span class="n">gstate</span><span class="o">=</span><span class="n">path</span><span class="o">.</span><span class="n">gstate</span><span class="p">,</span>
                <span class="n">ctm</span><span class="o">=</span><span class="n">path</span><span class="o">.</span><span class="n">ctm</span><span class="p">,</span>
                <span class="n">mcstack</span><span class="o">=</span><span class="n">path</span><span class="o">.</span><span class="n">mcstack</span><span class="p">,</span>
                <span class="n">raw_segments</span><span class="o">=</span><span class="n">segs</span><span class="p">,</span>
                <span class="n">stroke</span><span class="o">=</span><span class="n">path</span><span class="o">.</span><span class="n">stroke</span><span class="p">,</span>
                <span class="n">fill</span><span class="o">=</span><span class="n">path</span><span class="o">.</span><span class="n">fill</span><span class="p">,</span>
                <span class="n">evenodd</span><span class="o">=</span><span class="n">path</span><span class="o">.</span><span class="n">evenodd</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">segs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">segs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">seg</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">segs</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">PathObject</span><span class="p">(</span>
            <span class="n">_pageref</span><span class="o">=</span><span class="n">path</span><span class="o">.</span><span class="n">_pageref</span><span class="p">,</span>
            <span class="n">_parentkey</span><span class="o">=</span><span class="n">path</span><span class="o">.</span><span class="n">_parentkey</span><span class="p">,</span>
            <span class="n">gstate</span><span class="o">=</span><span class="n">path</span><span class="o">.</span><span class="n">gstate</span><span class="p">,</span>
            <span class="n">ctm</span><span class="o">=</span><span class="n">path</span><span class="o">.</span><span class="n">ctm</span><span class="p">,</span>
            <span class="n">mcstack</span><span class="o">=</span><span class="n">path</span><span class="o">.</span><span class="n">mcstack</span><span class="p">,</span>
            <span class="n">raw_segments</span><span class="o">=</span><span class="n">segs</span><span class="p">,</span>
            <span class="n">stroke</span><span class="o">=</span><span class="n">path</span><span class="o">.</span><span class="n">stroke</span><span class="p">,</span>
            <span class="n">fill</span><span class="o">=</span><span class="n">path</span><span class="o">.</span><span class="n">fill</span><span class="p">,</span>
            <span class="n">evenodd</span><span class="o">=</span><span class="n">path</span><span class="o">.</span><span class="n">evenodd</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="playa.miner.uniq" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">uniq</span><span class="p">(</span><span class="n">objs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Eliminates duplicated elements.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>playa/miner.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">uniq</span><span class="p">(</span><span class="n">objs</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">_T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">_T</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Eliminates duplicated elements.&quot;&quot;&quot;</span>
    <span class="c1"># Duplicated here means the same object (this horrible code was</span>
    <span class="c1"># horribly written without any notion of hashable or non-hashable</span>
    <span class="c1"># types, SMH)</span>
    <span class="n">done</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objs</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">id</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="ow">in</span> <span class="n">done</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">done</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
        <span class="k">yield</span> <span class="n">obj</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; David Huggins-Daines 2024-present
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": [], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>
