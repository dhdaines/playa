
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="PLAYA ain't a LAYout Analyzer">
      
      
        <meta name="author" content="David Huggins-Daines">
      
      
        <link rel="canonical" href="https://dhdaines.github.io/playa/0.2.9/reference/">
      
      
        <link rel="prev" href="../cli/">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>Reference - PLAYA</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6f8fc17f.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="PLAYA" class="md-header__button md-logo" aria-label="PLAYA" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PLAYA
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Reference
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/dhdaines/playa" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    dhdaines/playa
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="PLAYA" class="md-nav__button md-logo" aria-label="PLAYA" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    PLAYA
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/dhdaines/playa" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    dhdaines/playa
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CLI
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Reference
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Reference
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#playa" class="md-nav__link">
    <span class="md-ellipsis">
      playa
    </span>
  </a>
  
    <nav class="md-nav" aria-label="playa">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.Document" class="md-nav__link">
    <span class="md-ellipsis">
      Document
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Document">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.Document.dests" class="md-nav__link">
    <span class="md-ellipsis">
      dests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Document.layout" class="md-nav__link">
    <span class="md-ellipsis">
      layout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Document.names" class="md-nav__link">
    <span class="md-ellipsis">
      names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Document.objects" class="md-nav__link">
    <span class="md-ellipsis">
      objects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Document.outlines" class="md-nav__link">
    <span class="md-ellipsis">
      outlines
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Document.page_labels" class="md-nav__link">
    <span class="md-ellipsis">
      page_labels
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Document.pages" class="md-nav__link">
    <span class="md-ellipsis">
      pages
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Document.structtree" class="md-nav__link">
    <span class="md-ellipsis">
      structtree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Document.tokens" class="md-nav__link">
    <span class="md-ellipsis">
      tokens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Document.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Document.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      __iter__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Page" class="md-nav__link">
    <span class="md-ellipsis">
      Page
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Page">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.Page.contents" class="md-nav__link">
    <span class="md-ellipsis">
      contents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Page.doc" class="md-nav__link">
    <span class="md-ellipsis">
      doc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Page.height" class="md-nav__link">
    <span class="md-ellipsis">
      height
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Page.images" class="md-nav__link">
    <span class="md-ellipsis">
      images
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Page.layout" class="md-nav__link">
    <span class="md-ellipsis">
      layout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Page.paths" class="md-nav__link">
    <span class="md-ellipsis">
      paths
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Page.streams" class="md-nav__link">
    <span class="md-ellipsis">
      streams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Page.structtree" class="md-nav__link">
    <span class="md-ellipsis">
      structtree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Page.texts" class="md-nav__link">
    <span class="md-ellipsis">
      texts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Page.tokens" class="md-nav__link">
    <span class="md-ellipsis">
      tokens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Page.width" class="md-nav__link">
    <span class="md-ellipsis">
      width
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Page.xobjects" class="md-nav__link">
    <span class="md-ellipsis">
      xobjects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Page.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      __iter__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.open" class="md-nav__link">
    <span class="md-ellipsis">
      open
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#playa.document" class="md-nav__link">
    <span class="md-ellipsis">
      document
    </span>
  </a>
  
    <nav class="md-nav" aria-label="document">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.document.Document" class="md-nav__link">
    <span class="md-ellipsis">
      Document
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Document">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.dests" class="md-nav__link">
    <span class="md-ellipsis">
      dests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.layout" class="md-nav__link">
    <span class="md-ellipsis">
      layout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.names" class="md-nav__link">
    <span class="md-ellipsis">
      names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.objects" class="md-nav__link">
    <span class="md-ellipsis">
      objects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.outlines" class="md-nav__link">
    <span class="md-ellipsis">
      outlines
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.page_labels" class="md-nav__link">
    <span class="md-ellipsis">
      page_labels
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.pages" class="md-nav__link">
    <span class="md-ellipsis">
      pages
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.structtree" class="md-nav__link">
    <span class="md-ellipsis">
      structtree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.tokens" class="md-nav__link">
    <span class="md-ellipsis">
      tokens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      __iter__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.PageList" class="md-nav__link">
    <span class="md-ellipsis">
      PageList
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PageList">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.document.PageList.doc" class="md-nav__link">
    <span class="md-ellipsis">
      doc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.PageList.map" class="md-nav__link">
    <span class="md-ellipsis">
      map
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#playa.page" class="md-nav__link">
    <span class="md-ellipsis">
      page
    </span>
  </a>
  
    <nav class="md-nav" aria-label="page">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.page.ContentObject" class="md-nav__link">
    <span class="md-ellipsis">
      ContentObject
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ContentObject">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.page.ContentObject.bbox" class="md-nav__link">
    <span class="md-ellipsis">
      bbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.ContentObject.mcid" class="md-nav__link">
    <span class="md-ellipsis">
      mcid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.ContentObject.mcs" class="md-nav__link">
    <span class="md-ellipsis">
      mcs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.ContentObject.object_type" class="md-nav__link">
    <span class="md-ellipsis">
      object_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.ContentObject.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.DashPattern" class="md-nav__link">
    <span class="md-ellipsis">
      DashPattern
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.GlyphObject" class="md-nav__link">
    <span class="md-ellipsis">
      GlyphObject
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GlyphObject">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.page.GlyphObject.mcid" class="md-nav__link">
    <span class="md-ellipsis">
      mcid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.GlyphObject.mcs" class="md-nav__link">
    <span class="md-ellipsis">
      mcs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.GlyphObject.object_type" class="md-nav__link">
    <span class="md-ellipsis">
      object_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.GlyphObject.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.GraphicState" class="md-nav__link">
    <span class="md-ellipsis">
      GraphicState
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.ImageObject" class="md-nav__link">
    <span class="md-ellipsis">
      ImageObject
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ImageObject">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.page.ImageObject.buffer" class="md-nav__link">
    <span class="md-ellipsis">
      buffer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.ImageObject.mcid" class="md-nav__link">
    <span class="md-ellipsis">
      mcid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.ImageObject.mcs" class="md-nav__link">
    <span class="md-ellipsis">
      mcs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.ImageObject.object_type" class="md-nav__link">
    <span class="md-ellipsis">
      object_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.ImageObject.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.LayoutDict" class="md-nav__link">
    <span class="md-ellipsis">
      LayoutDict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.MarkedContent" class="md-nav__link">
    <span class="md-ellipsis">
      MarkedContent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page" class="md-nav__link">
    <span class="md-ellipsis">
      Page
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Page">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.contents" class="md-nav__link">
    <span class="md-ellipsis">
      contents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.doc" class="md-nav__link">
    <span class="md-ellipsis">
      doc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.height" class="md-nav__link">
    <span class="md-ellipsis">
      height
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.images" class="md-nav__link">
    <span class="md-ellipsis">
      images
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.layout" class="md-nav__link">
    <span class="md-ellipsis">
      layout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.paths" class="md-nav__link">
    <span class="md-ellipsis">
      paths
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.streams" class="md-nav__link">
    <span class="md-ellipsis">
      streams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.structtree" class="md-nav__link">
    <span class="md-ellipsis">
      structtree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.texts" class="md-nav__link">
    <span class="md-ellipsis">
      texts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.tokens" class="md-nav__link">
    <span class="md-ellipsis">
      tokens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.width" class="md-nav__link">
    <span class="md-ellipsis">
      width
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.xobjects" class="md-nav__link">
    <span class="md-ellipsis">
      xobjects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      __iter__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.PathObject" class="md-nav__link">
    <span class="md-ellipsis">
      PathObject
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PathObject">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.page.PathObject.bbox" class="md-nav__link">
    <span class="md-ellipsis">
      bbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.PathObject.mcid" class="md-nav__link">
    <span class="md-ellipsis">
      mcid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.PathObject.mcs" class="md-nav__link">
    <span class="md-ellipsis">
      mcs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.PathObject.object_type" class="md-nav__link">
    <span class="md-ellipsis">
      object_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.PathObject.segments" class="md-nav__link">
    <span class="md-ellipsis">
      segments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.PathObject.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      __iter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.PathObject.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.PathSegment" class="md-nav__link">
    <span class="md-ellipsis">
      PathSegment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.TagObject" class="md-nav__link">
    <span class="md-ellipsis">
      TagObject
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TagObject">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.page.TagObject.bbox" class="md-nav__link">
    <span class="md-ellipsis">
      bbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.TagObject.mcid" class="md-nav__link">
    <span class="md-ellipsis">
      mcid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.TagObject.mcs" class="md-nav__link">
    <span class="md-ellipsis">
      mcs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.TagObject.object_type" class="md-nav__link">
    <span class="md-ellipsis">
      object_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.TagObject.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.TextObject" class="md-nav__link">
    <span class="md-ellipsis">
      TextObject
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TextObject">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.page.TextObject.bbox" class="md-nav__link">
    <span class="md-ellipsis">
      bbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.TextObject.chars" class="md-nav__link">
    <span class="md-ellipsis">
      chars
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.TextObject.mcid" class="md-nav__link">
    <span class="md-ellipsis">
      mcid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.TextObject.mcs" class="md-nav__link">
    <span class="md-ellipsis">
      mcs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.TextObject.object_type" class="md-nav__link">
    <span class="md-ellipsis">
      object_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.TextObject.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      __iter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.TextObject.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.TextState" class="md-nav__link">
    <span class="md-ellipsis">
      TextState
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TextState">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.page.TextState.reset" class="md-nav__link">
    <span class="md-ellipsis">
      reset
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.XObjectObject" class="md-nav__link">
    <span class="md-ellipsis">
      XObjectObject
    </span>
  </a>
  
    <nav class="md-nav" aria-label="XObjectObject">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.page.XObjectObject.bbox" class="md-nav__link">
    <span class="md-ellipsis">
      bbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.XObjectObject.buffer" class="md-nav__link">
    <span class="md-ellipsis">
      buffer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.XObjectObject.contents" class="md-nav__link">
    <span class="md-ellipsis">
      contents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.XObjectObject.layout" class="md-nav__link">
    <span class="md-ellipsis">
      layout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.XObjectObject.mcid" class="md-nav__link">
    <span class="md-ellipsis">
      mcid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.XObjectObject.mcs" class="md-nav__link">
    <span class="md-ellipsis">
      mcs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.XObjectObject.object_type" class="md-nav__link">
    <span class="md-ellipsis">
      object_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.XObjectObject.page" class="md-nav__link">
    <span class="md-ellipsis">
      page
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.XObjectObject.tokens" class="md-nav__link">
    <span class="md-ellipsis">
      tokens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.XObjectObject.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#playa.structtree" class="md-nav__link">
    <span class="md-ellipsis">
      structtree
    </span>
  </a>
  
    <nav class="md-nav" aria-label="structtree">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.structtree.StructElement" class="md-nav__link">
    <span class="md-ellipsis">
      StructElement
    </span>
  </a>
  
    <nav class="md-nav" aria-label="StructElement">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.structtree.StructElement.all_mcids" class="md-nav__link">
    <span class="md-ellipsis">
      all_mcids
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structtree.StructElement.find" class="md-nav__link">
    <span class="md-ellipsis">
      find
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structtree.StructElement.find_all" class="md-nav__link">
    <span class="md-ellipsis">
      find_all
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structtree.StructTree" class="md-nav__link">
    <span class="md-ellipsis">
      StructTree
    </span>
  </a>
  
    <nav class="md-nav" aria-label="StructTree">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.structtree.StructTree.find" class="md-nav__link">
    <span class="md-ellipsis">
      find
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structtree.StructTree.find_all" class="md-nav__link">
    <span class="md-ellipsis">
      find_all
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#playa.worker" class="md-nav__link">
    <span class="md-ellipsis">
      worker
    </span>
  </a>
  
    <nav class="md-nav" aria-label="worker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.worker.in_worker" class="md-nav__link">
    <span class="md-ellipsis">
      in_worker
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#playa" class="md-nav__link">
    <span class="md-ellipsis">
      playa
    </span>
  </a>
  
    <nav class="md-nav" aria-label="playa">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.Document" class="md-nav__link">
    <span class="md-ellipsis">
      Document
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Document">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.Document.dests" class="md-nav__link">
    <span class="md-ellipsis">
      dests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Document.layout" class="md-nav__link">
    <span class="md-ellipsis">
      layout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Document.names" class="md-nav__link">
    <span class="md-ellipsis">
      names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Document.objects" class="md-nav__link">
    <span class="md-ellipsis">
      objects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Document.outlines" class="md-nav__link">
    <span class="md-ellipsis">
      outlines
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Document.page_labels" class="md-nav__link">
    <span class="md-ellipsis">
      page_labels
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Document.pages" class="md-nav__link">
    <span class="md-ellipsis">
      pages
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Document.structtree" class="md-nav__link">
    <span class="md-ellipsis">
      structtree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Document.tokens" class="md-nav__link">
    <span class="md-ellipsis">
      tokens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Document.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Document.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      __iter__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Page" class="md-nav__link">
    <span class="md-ellipsis">
      Page
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Page">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.Page.contents" class="md-nav__link">
    <span class="md-ellipsis">
      contents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Page.doc" class="md-nav__link">
    <span class="md-ellipsis">
      doc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Page.height" class="md-nav__link">
    <span class="md-ellipsis">
      height
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Page.images" class="md-nav__link">
    <span class="md-ellipsis">
      images
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Page.layout" class="md-nav__link">
    <span class="md-ellipsis">
      layout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Page.paths" class="md-nav__link">
    <span class="md-ellipsis">
      paths
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Page.streams" class="md-nav__link">
    <span class="md-ellipsis">
      streams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Page.structtree" class="md-nav__link">
    <span class="md-ellipsis">
      structtree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Page.texts" class="md-nav__link">
    <span class="md-ellipsis">
      texts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Page.tokens" class="md-nav__link">
    <span class="md-ellipsis">
      tokens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Page.width" class="md-nav__link">
    <span class="md-ellipsis">
      width
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Page.xobjects" class="md-nav__link">
    <span class="md-ellipsis">
      xobjects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.Page.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      __iter__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.open" class="md-nav__link">
    <span class="md-ellipsis">
      open
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#playa.document" class="md-nav__link">
    <span class="md-ellipsis">
      document
    </span>
  </a>
  
    <nav class="md-nav" aria-label="document">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.document.Document" class="md-nav__link">
    <span class="md-ellipsis">
      Document
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Document">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.dests" class="md-nav__link">
    <span class="md-ellipsis">
      dests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.layout" class="md-nav__link">
    <span class="md-ellipsis">
      layout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.names" class="md-nav__link">
    <span class="md-ellipsis">
      names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.objects" class="md-nav__link">
    <span class="md-ellipsis">
      objects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.outlines" class="md-nav__link">
    <span class="md-ellipsis">
      outlines
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.page_labels" class="md-nav__link">
    <span class="md-ellipsis">
      page_labels
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.pages" class="md-nav__link">
    <span class="md-ellipsis">
      pages
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.structtree" class="md-nav__link">
    <span class="md-ellipsis">
      structtree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.tokens" class="md-nav__link">
    <span class="md-ellipsis">
      tokens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      __iter__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.PageList" class="md-nav__link">
    <span class="md-ellipsis">
      PageList
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PageList">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.document.PageList.doc" class="md-nav__link">
    <span class="md-ellipsis">
      doc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.PageList.map" class="md-nav__link">
    <span class="md-ellipsis">
      map
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#playa.page" class="md-nav__link">
    <span class="md-ellipsis">
      page
    </span>
  </a>
  
    <nav class="md-nav" aria-label="page">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.page.ContentObject" class="md-nav__link">
    <span class="md-ellipsis">
      ContentObject
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ContentObject">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.page.ContentObject.bbox" class="md-nav__link">
    <span class="md-ellipsis">
      bbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.ContentObject.mcid" class="md-nav__link">
    <span class="md-ellipsis">
      mcid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.ContentObject.mcs" class="md-nav__link">
    <span class="md-ellipsis">
      mcs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.ContentObject.object_type" class="md-nav__link">
    <span class="md-ellipsis">
      object_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.ContentObject.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.DashPattern" class="md-nav__link">
    <span class="md-ellipsis">
      DashPattern
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.GlyphObject" class="md-nav__link">
    <span class="md-ellipsis">
      GlyphObject
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GlyphObject">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.page.GlyphObject.mcid" class="md-nav__link">
    <span class="md-ellipsis">
      mcid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.GlyphObject.mcs" class="md-nav__link">
    <span class="md-ellipsis">
      mcs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.GlyphObject.object_type" class="md-nav__link">
    <span class="md-ellipsis">
      object_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.GlyphObject.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.GraphicState" class="md-nav__link">
    <span class="md-ellipsis">
      GraphicState
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.ImageObject" class="md-nav__link">
    <span class="md-ellipsis">
      ImageObject
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ImageObject">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.page.ImageObject.buffer" class="md-nav__link">
    <span class="md-ellipsis">
      buffer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.ImageObject.mcid" class="md-nav__link">
    <span class="md-ellipsis">
      mcid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.ImageObject.mcs" class="md-nav__link">
    <span class="md-ellipsis">
      mcs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.ImageObject.object_type" class="md-nav__link">
    <span class="md-ellipsis">
      object_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.ImageObject.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.LayoutDict" class="md-nav__link">
    <span class="md-ellipsis">
      LayoutDict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.MarkedContent" class="md-nav__link">
    <span class="md-ellipsis">
      MarkedContent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page" class="md-nav__link">
    <span class="md-ellipsis">
      Page
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Page">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.contents" class="md-nav__link">
    <span class="md-ellipsis">
      contents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.doc" class="md-nav__link">
    <span class="md-ellipsis">
      doc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.height" class="md-nav__link">
    <span class="md-ellipsis">
      height
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.images" class="md-nav__link">
    <span class="md-ellipsis">
      images
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.layout" class="md-nav__link">
    <span class="md-ellipsis">
      layout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.paths" class="md-nav__link">
    <span class="md-ellipsis">
      paths
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.streams" class="md-nav__link">
    <span class="md-ellipsis">
      streams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.structtree" class="md-nav__link">
    <span class="md-ellipsis">
      structtree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.texts" class="md-nav__link">
    <span class="md-ellipsis">
      texts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.tokens" class="md-nav__link">
    <span class="md-ellipsis">
      tokens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.width" class="md-nav__link">
    <span class="md-ellipsis">
      width
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.xobjects" class="md-nav__link">
    <span class="md-ellipsis">
      xobjects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      __iter__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.PathObject" class="md-nav__link">
    <span class="md-ellipsis">
      PathObject
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PathObject">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.page.PathObject.bbox" class="md-nav__link">
    <span class="md-ellipsis">
      bbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.PathObject.mcid" class="md-nav__link">
    <span class="md-ellipsis">
      mcid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.PathObject.mcs" class="md-nav__link">
    <span class="md-ellipsis">
      mcs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.PathObject.object_type" class="md-nav__link">
    <span class="md-ellipsis">
      object_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.PathObject.segments" class="md-nav__link">
    <span class="md-ellipsis">
      segments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.PathObject.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      __iter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.PathObject.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.PathSegment" class="md-nav__link">
    <span class="md-ellipsis">
      PathSegment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.TagObject" class="md-nav__link">
    <span class="md-ellipsis">
      TagObject
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TagObject">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.page.TagObject.bbox" class="md-nav__link">
    <span class="md-ellipsis">
      bbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.TagObject.mcid" class="md-nav__link">
    <span class="md-ellipsis">
      mcid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.TagObject.mcs" class="md-nav__link">
    <span class="md-ellipsis">
      mcs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.TagObject.object_type" class="md-nav__link">
    <span class="md-ellipsis">
      object_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.TagObject.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.TextObject" class="md-nav__link">
    <span class="md-ellipsis">
      TextObject
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TextObject">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.page.TextObject.bbox" class="md-nav__link">
    <span class="md-ellipsis">
      bbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.TextObject.chars" class="md-nav__link">
    <span class="md-ellipsis">
      chars
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.TextObject.mcid" class="md-nav__link">
    <span class="md-ellipsis">
      mcid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.TextObject.mcs" class="md-nav__link">
    <span class="md-ellipsis">
      mcs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.TextObject.object_type" class="md-nav__link">
    <span class="md-ellipsis">
      object_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.TextObject.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      __iter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.TextObject.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.TextState" class="md-nav__link">
    <span class="md-ellipsis">
      TextState
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TextState">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.page.TextState.reset" class="md-nav__link">
    <span class="md-ellipsis">
      reset
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.XObjectObject" class="md-nav__link">
    <span class="md-ellipsis">
      XObjectObject
    </span>
  </a>
  
    <nav class="md-nav" aria-label="XObjectObject">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.page.XObjectObject.bbox" class="md-nav__link">
    <span class="md-ellipsis">
      bbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.XObjectObject.buffer" class="md-nav__link">
    <span class="md-ellipsis">
      buffer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.XObjectObject.contents" class="md-nav__link">
    <span class="md-ellipsis">
      contents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.XObjectObject.layout" class="md-nav__link">
    <span class="md-ellipsis">
      layout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.XObjectObject.mcid" class="md-nav__link">
    <span class="md-ellipsis">
      mcid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.XObjectObject.mcs" class="md-nav__link">
    <span class="md-ellipsis">
      mcs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.XObjectObject.object_type" class="md-nav__link">
    <span class="md-ellipsis">
      object_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.XObjectObject.page" class="md-nav__link">
    <span class="md-ellipsis">
      page
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.XObjectObject.tokens" class="md-nav__link">
    <span class="md-ellipsis">
      tokens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.XObjectObject.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#playa.structtree" class="md-nav__link">
    <span class="md-ellipsis">
      structtree
    </span>
  </a>
  
    <nav class="md-nav" aria-label="structtree">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.structtree.StructElement" class="md-nav__link">
    <span class="md-ellipsis">
      StructElement
    </span>
  </a>
  
    <nav class="md-nav" aria-label="StructElement">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.structtree.StructElement.all_mcids" class="md-nav__link">
    <span class="md-ellipsis">
      all_mcids
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structtree.StructElement.find" class="md-nav__link">
    <span class="md-ellipsis">
      find
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structtree.StructElement.find_all" class="md-nav__link">
    <span class="md-ellipsis">
      find_all
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structtree.StructTree" class="md-nav__link">
    <span class="md-ellipsis">
      StructTree
    </span>
  </a>
  
    <nav class="md-nav" aria-label="StructTree">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.structtree.StructTree.find" class="md-nav__link">
    <span class="md-ellipsis">
      find
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structtree.StructTree.find_all" class="md-nav__link">
    <span class="md-ellipsis">
      find_all
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#playa.worker" class="md-nav__link">
    <span class="md-ellipsis">
      worker
    </span>
  </a>
  
    <nav class="md-nav" aria-label="worker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.worker.in_worker" class="md-nav__link">
    <span class="md-ellipsis">
      in_worker
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="reference">Reference</h1>


<div class="doc doc-object doc-module">



<h2 id="playa" class="doc doc-heading">
            <code>playa</code>


</h2>

    <div class="doc doc-contents first">

        <p>PLAYA ain't a LAYout Analyzer... but it can help you get stuff
out of PDFs.</p>
<p>Basic usage:</p>
<pre><code>with playa.open(path) as pdf:
    for page in pdf.pages:
        print(f"page {page.label}:")
        for obj in page:
            print(f"    {obj.object_type} at {obj.bbox}")
            if obj.object_type == "text":
                print(f"        chars: {obj.chars}")
</code></pre>








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="playa.Document" class="doc doc-heading">
            <code>Document</code>


</h3>


    <div class="doc doc-contents ">


        <p>Representation of a PDF document on disk.</p>
<p>Since PDF documents can be very large and complex, merely creating
a <code>Document</code> does very little aside from opening the file and
verifying that the password is correct and it is, in fact, a PDF.
This may, however, involve a certain amount of file access since
the cross-reference table and trailer must be read in order to
determine this (we do not treat linearized PDFs specially for the
moment).</p>
<p>Some metadata, such as the structure tree and page tree, will be
loaded lazily and cached.  We do not handle modification of PDFs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fp</code>
            </td>
            <td>
                  <code><span title="typing.BinaryIO">BinaryIO</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>File-like object in binary mode.  Will be read using
  <code>mmap</code> if possible, otherwise will be read into memory.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>password</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Password for decryption, if needed.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>space</code>
            </td>
            <td>
                  <code><span title="playa.page.DeviceSpace">DeviceSpace</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the device space to use for interpreting content ("screen"
     or "page")</p>
              </div>
            </td>
            <td>
                  <code>&#39;screen&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>playa/document.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Document</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Representation of a PDF document on disk.</span>

<span class="sd">    Since PDF documents can be very large and complex, merely creating</span>
<span class="sd">    a `Document` does very little aside from opening the file and</span>
<span class="sd">    verifying that the password is correct and it is, in fact, a PDF.</span>
<span class="sd">    This may, however, involve a certain amount of file access since</span>
<span class="sd">    the cross-reference table and trailer must be read in order to</span>
<span class="sd">    determine this (we do not treat linearized PDFs specially for the</span>
<span class="sd">    moment).</span>

<span class="sd">    Some metadata, such as the structure tree and page tree, will be</span>
<span class="sd">    loaded lazily and cached.  We do not handle modification of PDFs.</span>

<span class="sd">    Args:</span>
<span class="sd">      fp: File-like object in binary mode.  Will be read using</span>
<span class="sd">          `mmap` if possible, otherwise will be read into memory.</span>
<span class="sd">      password: Password for decryption, if needed.</span>
<span class="sd">      space: the device space to use for interpreting content (&quot;screen&quot;</span>
<span class="sd">             or &quot;page&quot;)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_fp</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">BinaryIO</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_pages</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;PageList&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_pool</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Executor</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Document&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">,</span> <span class="n">traceback</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># If we were opened from a file then close it</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fp</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fp</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># Shutdown process pool</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pool</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pool</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pool</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">fp</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">,</span>
        <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">space</span><span class="p">:</span> <span class="n">DeviceSpace</span> <span class="o">=</span> <span class="s2">&quot;screen&quot;</span><span class="p">,</span>
        <span class="n">_boss_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">_boss_id</span><span class="p">:</span>
            <span class="c1"># Set this **right away** because it is needed to get</span>
            <span class="c1"># indirect object references right.</span>
            <span class="n">_set_document</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_boss_id</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">in_worker</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">XRef</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">space</span> <span class="o">=</span> <span class="n">space</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encryption</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decipher</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DecipherCallable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cached_objs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parsed_objs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">PDFObject</span><span class="p">],</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cached_fonts</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">object</span><span class="p">,</span> <span class="n">Font</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">TextIOBase</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;fp is not a binary file&quot;</span><span class="p">)</span>
        <span class="c1"># The header is frequently mangled, in which case we will try to read the</span>
        <span class="c1"># file anyway.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_version</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">read_header</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">PDFSyntaxError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;PDF header not found, will try to read the file anyway&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_version</span> <span class="o">=</span> <span class="s2">&quot;UNKNOWN&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="n">mmap</span><span class="o">.</span><span class="n">mmap</span><span class="p">]</span> <span class="o">=</span> <span class="n">mmap</span><span class="o">.</span><span class="n">mmap</span><span class="p">(</span>
                <span class="n">fp</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">access</span><span class="o">=</span><span class="n">mmap</span><span class="o">.</span><span class="n">ACCESS_READ</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="n">io</span><span class="o">.</span><span class="n">UnsupportedOperation</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;mmap not supported on </span><span class="si">%r</span><span class="s2">, reading document into memory&quot;</span><span class="p">,</span> <span class="n">fp</span><span class="p">)</span>
            <span class="n">fp</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_printable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_modifiable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_extractable</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># Getting the XRef table and trailer is done non-lazily</span>
        <span class="c1"># because they contain encryption information among other</span>
        <span class="c1"># things.  As noted above we don&#39;t try to look for the first</span>
        <span class="c1"># page cross-reference table (for linearized PDFs) after the</span>
        <span class="c1"># header, it will instead be loaded with all the rest.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">IndirectObjectParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_xref</span><span class="p">()</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Found xref at </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_xref_from</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">,</span> <span class="ne">StopIteration</span><span class="p">,</span> <span class="n">PDFSyntaxError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Using fallback XRef parsing: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="n">newxref</span> <span class="o">=</span> <span class="n">XRefFallback</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newxref</span><span class="p">)</span>
        <span class="c1"># Now find the trailer</span>
        <span class="k">for</span> <span class="n">xref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">:</span>
            <span class="n">trailer</span> <span class="o">=</span> <span class="n">xref</span><span class="o">.</span><span class="n">trailer</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">trailer</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="c1"># If there&#39;s an encryption info, remember it.</span>
            <span class="k">if</span> <span class="s2">&quot;Encrypt&quot;</span> <span class="ow">in</span> <span class="n">trailer</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;ID&quot;</span> <span class="ow">in</span> <span class="n">trailer</span><span class="p">:</span>
                    <span class="n">id_value</span> <span class="o">=</span> <span class="n">list_value</span><span class="p">(</span><span class="n">trailer</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Some documents may not have a /ID, use two empty</span>
                    <span class="c1"># byte strings instead. Solves</span>
                    <span class="c1"># https://github.com/pdfminer/pdfminer.six/issues/594</span>
                    <span class="n">id_value</span> <span class="o">=</span> <span class="p">(</span><span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">encryption</span> <span class="o">=</span> <span class="p">(</span><span class="n">id_value</span><span class="p">,</span> <span class="n">dict_value</span><span class="p">(</span><span class="n">trailer</span><span class="p">[</span><span class="s2">&quot;Encrypt&quot;</span><span class="p">]))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_password</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;Info&quot;</span> <span class="ow">in</span> <span class="n">trailer</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_value</span><span class="p">(</span><span class="n">trailer</span><span class="p">[</span><span class="s2">&quot;Info&quot;</span><span class="p">]))</span>
                <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Info is a broken reference (incorrect xref table?)&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;Root&quot;</span> <span class="ow">in</span> <span class="n">trailer</span><span class="p">:</span>
                <span class="c1"># Every PDF file must have exactly one /Root dictionary.</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span><span class="n">trailer</span><span class="p">[</span><span class="s2">&quot;Root&quot;</span><span class="p">])</span>
                <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Root is a broken reference (incorrect xref table?)&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No /Root object! - Is this really a PDF?&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">LITERAL_CATALOG</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Catalog not found!&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;Version&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="s2">&quot;Using PDF version </span><span class="si">%r</span><span class="s2"> from catalog instead of </span><span class="si">%r</span><span class="s2"> from header&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">[</span><span class="s2">&quot;Version&quot;</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pdf_version</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">[</span><span class="s2">&quot;Version&quot;</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_initialize_password</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the decryption handler with a given password, if any.</span>

<span class="sd">        Internal function, requires the Encrypt dictionary to have</span>
<span class="sd">        been read from the trailer into self.encryption.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">encryption</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="p">(</span><span class="n">docid</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encryption</span>
        <span class="k">if</span> <span class="n">literal_name</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Filter&quot;</span><span class="p">))</span> <span class="o">!=</span> <span class="s2">&quot;Standard&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PDFEncryptionError</span><span class="p">(</span><span class="s2">&quot;Unknown filter: param=</span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">param</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;V&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="c1"># 3 (PDF 1.4) An unpublished algorithm that permits encryption</span>
        <span class="c1"># key lengths ranging from 40 to 128 bits. This value shall</span>
        <span class="c1"># not appear in a conforming PDF file.</span>
        <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PDFEncryptionError</span><span class="p">(</span><span class="s2">&quot;Unpublished algorithm 3 not supported&quot;</span><span class="p">)</span>
        <span class="n">factory</span> <span class="o">=</span> <span class="n">SECURITY_HANDLERS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="c1"># 0 An algorithm that is undocumented. This value shall not be used.</span>
        <span class="k">if</span> <span class="n">factory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PDFEncryptionError</span><span class="p">(</span><span class="s2">&quot;Unknown algorithm: param=</span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">param</span><span class="p">)</span>
        <span class="n">handler</span> <span class="o">=</span> <span class="n">factory</span><span class="p">(</span><span class="n">docid</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decipher</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">decrypt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_printable</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">is_printable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_modifiable</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">is_modifiable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_extractable</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">is_extractable</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="c1"># Ensure that no extra data leaks into encrypted streams</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">IndirectObject</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over top-level `IndirectObject` (does not expand object streams)&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">obj</span> <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">IndirectObjectParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">objects</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">IndirectObject</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over all indirect objects (including, then expanding object</span>
<span class="sd">        streams)&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">IndirectObjectParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="bp">self</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">obj</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">ContentStream</span><span class="p">)</span>
                <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="n">LITERAL_OBJSTM</span>
            <span class="p">):</span>
                <span class="n">parser</span> <span class="o">=</span> <span class="n">ObjectStreamParser</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">spos</span><span class="p">,</span> <span class="n">sobj</span> <span class="ow">in</span> <span class="n">parser</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">sobj</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Token</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over tokens.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">tok</span> <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">tok</span> <span class="ow">in</span> <span class="n">Lexer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">layout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">LayoutDict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over `LayoutDict` for all pages.</span>

<span class="sd">        Danger: Deprecated</span>
<span class="sd">            This interface is deprecated and has been moved to</span>
<span class="sd">            [PAVS](https://github.com/dhdaines/paves).  It will be</span>
<span class="sd">            removed in PLAYA 0.3.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;The layout property has moved to PAVS (https://github.com/dhdaines/paves)&quot;</span>
            <span class="s2">&quot; and will be removed in PLAYA 0.3&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">cast</span>

        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">page</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pages</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">dic</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">layout</span><span class="p">:</span>
                <span class="n">dic</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">LayoutDict</span><span class="p">,</span> <span class="n">dic</span><span class="p">)</span>  <span class="c1"># ugh</span>
                <span class="n">dic</span><span class="p">[</span><span class="s2">&quot;page_index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">idx</span>
                <span class="n">dic</span><span class="p">[</span><span class="s2">&quot;page_label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">label</span>
                <span class="k">yield</span> <span class="n">dic</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">structtree</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StructTree</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the PDF structure tree.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">StructTree</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_getobj_objstm</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">stream</span><span class="p">:</span> <span class="n">ContentStream</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">objid</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDFObject</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">stream</span><span class="o">.</span><span class="n">objid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parsed_objs</span><span class="p">:</span>
            <span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parsed_objs</span><span class="p">[</span><span class="n">stream</span><span class="o">.</span><span class="n">objid</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_objects</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">stream</span><span class="o">.</span><span class="n">objid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parsed_objs</span><span class="p">[</span><span class="n">stream</span><span class="o">.</span><span class="n">objid</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">index</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">objs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span><span class="s2">&quot;index too big: </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">index</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream</span><span class="p">:</span> <span class="n">ContentStream</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">PDFObject</span><span class="p">],</span> <span class="nb">int</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">LITERAL_OBJSTM</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Content stream Type is not /ObjStm: </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">stream</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">stream</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;N is not defined in content stream: </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">stream</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;N is invalid in content stream: </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">stream</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">ObjectParser</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">objs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PDFObject</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">obj</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">parser</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_getobj_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">objid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDFObject</span><span class="p">:</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">obj</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">objid</span> <span class="o">!=</span> <span class="n">objid</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;objid mismatch: </span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="n">objid</span><span class="si">!r}</span><span class="s2">=</span><span class="si">{</span><span class="n">objid</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">,</span> <span class="n">PDFSyntaxError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Indirect object </span><span class="si">%d</span><span class="s2"> not found at position </span><span class="si">%d</span><span class="s2">: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">objid</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">e</span>
            <span class="p">)</span>
            <span class="c1"># In case of malformed pdf files where the offset in the</span>
            <span class="c1"># xref table doesn&#39;t point exactly at the object</span>
            <span class="c1"># definition (probably more frequent than you think), just</span>
            <span class="c1"># use a regular expression to find the object because we</span>
            <span class="c1"># can do that.</span>
            <span class="n">realpos</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">lastgen</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="sa">rb</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">\s+(\d+)\s+obj&quot;</span> <span class="o">%</span> <span class="n">objid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">):</span>
                <span class="n">genno</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">genno</span> <span class="o">&gt;</span> <span class="n">lastgen</span><span class="p">:</span>
                    <span class="n">lastgen</span> <span class="o">=</span> <span class="n">genno</span>
                    <span class="n">realpos</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">realpos</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Indirect object </span><span class="si">{</span><span class="n">objid</span><span class="si">!r}</span><span class="s2"> not found in document&quot;</span>
                <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">realpos</span><span class="p">)</span>
            <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">objid</span> <span class="o">!=</span> <span class="n">objid</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;objid mismatch: </span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="n">objid</span><span class="si">!r}</span><span class="s2">=</span><span class="si">{</span><span class="n">objid</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">decipher</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">decipher_all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decipher</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">objid</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">genno</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">obj</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDFObject</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get an indirect object from the PDF.</span>

<span class="sd">        Note that the behaviour in the case of a non-existent object,</span>
<span class="sd">        while Pythonic, is not PDFic, as PDF 1.7 sec 7.3.10 states:</span>

<span class="sd">        &gt; An indirect reference to an undefined object shall not be</span>
<span class="sd">        considered an error by a conforming reader; it shall be</span>
<span class="sd">        treated as a reference to the null object.</span>

<span class="sd">        Raises:</span>
<span class="sd">          ValueError: if Document is not initialized</span>
<span class="sd">          IndexError: if objid does not exist in PDF</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Document is not initialized&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">objid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_objs</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">xref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="p">(</span><span class="n">strmid</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">genno</span><span class="p">)</span> <span class="o">=</span> <span class="n">xref</span><span class="o">.</span><span class="n">get_pos</span><span class="p">(</span><span class="n">objid</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">strmid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">stream</span> <span class="o">=</span> <span class="n">stream_value</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">strmid</span><span class="p">])</span>
                        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getobj_objstm</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">objid</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getobj_parse</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">objid</span><span class="p">)</span>
                    <span class="k">break</span>
                <span class="c1"># FIXME: We might not actually want to catch these...</span>
                <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;EOF when searching for object </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">objid</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="k">except</span> <span class="n">PDFSyntaxError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Syntax error when searching for object </span><span class="si">%d</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">objid</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                    <span class="k">continue</span>
            <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Object with ID </span><span class="si">{</span><span class="n">objid</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cached_objs</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_objs</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_font</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objid</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span> <span class="n">spec</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Font</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">objid</span> <span class="ow">and</span> <span class="n">objid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_fonts</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_fonts</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">spec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">LITERAL_FONT</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Font specification Type is not /Font: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">spec</span><span class="p">)</span>
        <span class="c1"># Create a Font object.</span>
        <span class="k">if</span> <span class="s2">&quot;Subtype&quot;</span> <span class="ow">in</span> <span class="n">spec</span><span class="p">:</span>
            <span class="n">subtype</span> <span class="o">=</span> <span class="n">literal_name</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="s2">&quot;Subtype&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Font specification Subtype is not specified: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">spec</span><span class="p">)</span>
            <span class="n">subtype</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">subtype</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;Type1&quot;</span><span class="p">,</span> <span class="s2">&quot;MMType1&quot;</span><span class="p">):</span>
            <span class="c1"># Type1 Font</span>
            <span class="n">font</span><span class="p">:</span> <span class="n">Font</span> <span class="o">=</span> <span class="n">Type1Font</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">subtype</span> <span class="o">==</span> <span class="s2">&quot;TrueType&quot;</span><span class="p">:</span>
            <span class="c1"># TrueType Font</span>
            <span class="n">font</span> <span class="o">=</span> <span class="n">TrueTypeFont</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">subtype</span> <span class="o">==</span> <span class="s2">&quot;Type3&quot;</span><span class="p">:</span>
            <span class="c1"># Type3 Font</span>
            <span class="n">font</span> <span class="o">=</span> <span class="n">Type3Font</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">subtype</span> <span class="o">==</span> <span class="s2">&quot;Type0&quot;</span><span class="p">:</span>
            <span class="c1"># Type0 Font</span>
            <span class="n">dfonts</span> <span class="o">=</span> <span class="n">list_value</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="s2">&quot;DescendantFonts&quot;</span><span class="p">])</span>
            <span class="k">assert</span> <span class="n">dfonts</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dfonts</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Type 0 font should have 1 descendant, has more: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dfonts</span><span class="p">)</span>
            <span class="n">subspec</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span><span class="n">dfonts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="c1"># Merge the root and descendant font dictionaries</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;Encoding&quot;</span><span class="p">,</span> <span class="s2">&quot;ToUnicode&quot;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">spec</span><span class="p">:</span>
                    <span class="n">subspec</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="n">font</span> <span class="o">=</span> <span class="n">CIDFont</span><span class="p">(</span><span class="n">subspec</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Invalid Font spec, creating dummy font: </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">spec</span><span class="p">)</span>
            <span class="c1"># We need a dummy font object to be able to do *something*</span>
            <span class="c1"># (even if it&#39;s the wrong thing) with text objects.</span>
            <span class="n">font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">({},</span> <span class="p">{})</span>
        <span class="k">if</span> <span class="n">objid</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cached_fonts</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span> <span class="o">=</span> <span class="n">font</span>
        <span class="k">return</span> <span class="n">font</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">outlines</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">OutlineItem</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Iterate over the PDF document outline.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;Outlines&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">search</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span> <span class="n">level</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">OutlineItem</span><span class="p">]:</span>
            <span class="n">entry</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;Title&quot;</span> <span class="ow">in</span> <span class="n">entry</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;A&quot;</span> <span class="ow">in</span> <span class="n">entry</span> <span class="ow">or</span> <span class="s2">&quot;Dest&quot;</span> <span class="ow">in</span> <span class="n">entry</span><span class="p">:</span>
                    <span class="n">title</span> <span class="o">=</span> <span class="n">decode_text</span><span class="p">(</span><span class="n">str_value</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;Title&quot;</span><span class="p">]))</span>
                    <span class="n">dest</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Dest&quot;</span><span class="p">)</span>
                    <span class="n">action</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span>
                    <span class="n">se</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;SE&quot;</span><span class="p">)</span>
                    <span class="k">yield</span> <span class="n">OutlineItem</span><span class="p">(</span>
                        <span class="n">level</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">dest</span><span class="p">),</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">action</span><span class="p">),</span> <span class="n">se</span>
                    <span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;First&quot;</span> <span class="ow">in</span> <span class="n">entry</span> <span class="ow">and</span> <span class="s2">&quot;Last&quot;</span> <span class="ow">in</span> <span class="n">entry</span><span class="p">:</span>
                <span class="k">yield from</span> <span class="n">search</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;First&quot;</span><span class="p">],</span> <span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;Next&quot;</span> <span class="ow">in</span> <span class="n">entry</span><span class="p">:</span>
                <span class="k">yield from</span> <span class="n">search</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;Next&quot;</span><span class="p">],</span> <span class="n">level</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">search</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">[</span><span class="s2">&quot;Outlines&quot;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">page_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate page label strings for the PDF document.</span>

<span class="sd">        If the document includes page labels, generates strings, one per page.</span>
<span class="sd">        If not, raise KeyError.</span>

<span class="sd">        The resulting iterator is unbounded (because the page label</span>
<span class="sd">        tree does not actually include all the pages), so it is</span>
<span class="sd">        recommended to use `pages` instead.</span>

<span class="sd">        Raises:</span>
<span class="sd">          KeyError: No page labels are present in the catalog</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>  <span class="c1"># really it cannot be None</span>

        <span class="n">page_labels</span> <span class="o">=</span> <span class="n">PageLabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">[</span><span class="s2">&quot;PageLabels&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">page_labels</span><span class="o">.</span><span class="n">labels</span>

    <span class="n">PageType</span> <span class="o">=</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_pages_from_xrefs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">PageType</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Find pages from the cross-reference tables if the page tree</span>
<span class="sd">        is missing (note that this only happens in invalid PDFs, but</span>
<span class="sd">        it happens.)</span>

<span class="sd">        Returns:</span>
<span class="sd">          an iterator over (objid, dict) pairs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">xref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">object_id</span> <span class="ow">in</span> <span class="n">xref</span><span class="o">.</span><span class="n">objids</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">object_id</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="n">LITERAL_PAGE</span><span class="p">:</span>
                        <span class="k">yield</span> <span class="n">object_id</span><span class="p">,</span> <span class="n">obj</span>
                <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                    <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_page_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">PageType</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over the flattened page tree in reading order, propagating</span>
<span class="sd">        inheritable attributes.  Returns an iterator over (objid, dict) pairs.</span>

<span class="sd">        Raises:</span>
<span class="sd">          KeyError: if there is no page tree.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;Pages&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;No &#39;Pages&#39; entry in catalog&quot;</span><span class="p">)</span>
        <span class="n">stack</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">[</span><span class="s2">&quot;Pages&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">)]</span>
        <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">while</span> <span class="n">stack</span><span class="p">:</span>
            <span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">ObjRef</span><span class="p">):</span>
                <span class="c1"># The PDF specification *requires* both the Pages</span>
                <span class="c1"># element of the catalog and the entries in Kids in</span>
                <span class="c1"># the page tree to be indirect references.</span>
                <span class="n">object_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">objid</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="c1"># Should not happen in a valid PDF, but probably does?</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Page tree contains bare integer: </span><span class="si">%r</span><span class="s2"> in </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
                <span class="n">object_id</span> <span class="o">=</span> <span class="n">obj</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Page tree contains unknown object: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
            <span class="n">page_object</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">object_id</span><span class="p">])</span>

            <span class="c1"># Avoid recursion errors by keeping track of visited nodes</span>
            <span class="c1"># (again, this should never actually happen in a valid PDF)</span>
            <span class="k">if</span> <span class="n">object_id</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Circular reference </span><span class="si">%r</span><span class="s2"> in page tree&quot;</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">object_id</span><span class="p">)</span>

            <span class="c1"># Propagate inheritable attributes</span>
            <span class="n">object_properties</span> <span class="o">=</span> <span class="n">page_object</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">parent</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">INHERITABLE_PAGE_ATTRS</span> <span class="ow">and</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">object_properties</span><span class="p">:</span>
                    <span class="n">object_properties</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>

            <span class="c1"># Recurse, depth-first</span>
            <span class="n">object_type</span> <span class="o">=</span> <span class="n">object_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">object_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Page has no Type, trying type: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">object_properties</span><span class="p">)</span>
                <span class="n">object_type</span> <span class="o">=</span> <span class="n">object_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">object_type</span> <span class="ow">is</span> <span class="n">LITERAL_PAGES</span> <span class="ow">and</span> <span class="s2">&quot;Kids&quot;</span> <span class="ow">in</span> <span class="n">object_properties</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">list_value</span><span class="p">(</span><span class="n">object_properties</span><span class="p">[</span><span class="s2">&quot;Kids&quot;</span><span class="p">])):</span>
                    <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">child</span><span class="p">,</span> <span class="n">object_properties</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">object_type</span> <span class="ow">is</span> <span class="n">LITERAL_PAGE</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">object_id</span><span class="p">,</span> <span class="n">object_properties</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">pages</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;PageList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Pages of the document as an iterable/addressable `PageList` object.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span> <span class="o">=</span> <span class="n">PageList</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;PDF name dictionary (PDF 1.7 sec 7.7.4).</span>

<span class="sd">        Raises:</span>
<span class="sd">          KeyError: if nonexistent.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">dict_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">[</span><span class="s2">&quot;Names&quot;</span><span class="p">])</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dests</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterable of named destinations as (name, destination) tuples</span>
<span class="sd">        (PDF 1.7 sec 12.3.2).</span>

<span class="sd">        Note that we assume the names of destinations are either &quot;name</span>
<span class="sd">        objects&quot; (that&#39;s PDF for UTF-8) or &quot;text strings&quot;, since the</span>
<span class="sd">        PDF spec says (p. 367):</span>

<span class="sd">        &gt; The keys in the name tree may be treated as text strings for</span>
<span class="sd">        &gt; display purposes.</span>

<span class="sd">        therefore, you get them as `str`.</span>

<span class="sd">        Raises:</span>
<span class="sd">          KeyError: if no destination tree exists</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># PDF-1.2 or later</span>
            <span class="n">dests</span> <span class="o">=</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">decode_text</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">NameTree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="s2">&quot;Dests&quot;</span><span class="p">])</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="c1"># PDF-1.1 or prior</span>
            <span class="n">dests</span> <span class="o">=</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">dict_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">[</span><span class="s2">&quot;Dests&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">)</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">dest</span> <span class="ow">in</span> <span class="n">dests</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">name</span><span class="p">,</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">dest</span><span class="p">[</span><span class="s2">&quot;D&quot;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">name</span><span class="p">,</span> <span class="n">dest</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_find_xref</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Internal function used to locate the first XRef.&quot;&quot;&quot;</span>
        <span class="c1"># search the last xref table by scanning the file backwards.</span>
        <span class="n">prev</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">reverse_iter_lines</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">):</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&quot;startxref&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">prev</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Invalid startxref position: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">prev</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="n">start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">prev</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">start</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Invalid negative startxref position: </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="k">elif</span> <span class="n">start</span> <span class="o">&gt;</span> <span class="n">pos</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Invalid startxref position (&gt; </span><span class="si">%d</span><span class="s2">): </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="k">return</span> <span class="n">start</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span>
            <span class="k">elif</span> <span class="n">line</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&quot;xref&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">pos</span>
            <span class="k">elif</span> <span class="n">line</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&quot;endobj&quot;</span><span class="p">:</span>
                <span class="c1"># Okay, we&#39;re probably not in Kansas anymore...</span>
                <span class="k">break</span>
            <span class="k">if</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">prev</span> <span class="o">=</span> <span class="n">line</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No xref table found at end of file&quot;</span><span class="p">)</span>

    <span class="c1"># read xref table</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_read_xref_from</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">start</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">xrefs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">XRef</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reads XRefs from the given location.&quot;&quot;&quot;</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">ObjectParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">nexttoken</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unexpected EOF at </span><span class="si">{start}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">token</span> <span class="ow">is</span> <span class="n">KEYWORD_XREF</span><span class="p">:</span>
            <span class="n">parser</span><span class="o">.</span><span class="n">nextline</span><span class="p">()</span>
            <span class="n">xref</span><span class="p">:</span> <span class="n">XRef</span> <span class="o">=</span> <span class="n">XRefTable</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># It might be an XRefStream, if this is an indirect object...</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">token</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">nexttoken</span><span class="p">()</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">token</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">nexttoken</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">token</span> <span class="ow">is</span> <span class="n">KEYWORD_OBJ</span><span class="p">:</span>
                <span class="c1"># XRefStream: PDF-1.5</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
                <span class="n">xref</span> <span class="o">=</span> <span class="n">XRefStream</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Well, maybe it&#39;s an XRef table without &quot;xref&quot; (but</span>
                <span class="c1"># probably not)</span>
                <span class="n">parser</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
                <span class="n">xref</span> <span class="o">=</span> <span class="n">XRefTable</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span>
        <span class="n">xrefs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xref</span><span class="p">)</span>
        <span class="n">trailer</span> <span class="o">=</span> <span class="n">xref</span><span class="o">.</span><span class="n">trailer</span>
        <span class="c1"># For hybrid-reference files, an additional set of xrefs as a</span>
        <span class="c1"># stream.</span>
        <span class="k">if</span> <span class="s2">&quot;XRefStm&quot;</span> <span class="ow">in</span> <span class="n">trailer</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">trailer</span><span class="p">[</span><span class="s2">&quot;XRefStm&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_xref_from</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">xrefs</span><span class="p">)</span>
        <span class="c1"># Recurse into any previous xref tables or streams</span>
        <span class="k">if</span> <span class="s2">&quot;Prev&quot;</span> <span class="ow">in</span> <span class="n">trailer</span><span class="p">:</span>
            <span class="c1"># find previous xref</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">trailer</span><span class="p">[</span><span class="s2">&quot;Prev&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_xref_from</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">xrefs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="playa.Document.dests" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dests</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterable of named destinations as (name, destination) tuples
(PDF 1.7 sec 12.3.2).</p>
<p>Note that we assume the names of destinations are either "name
objects" (that's PDF for UTF-8) or "text strings", since the
PDF spec says (p. 367):</p>
<blockquote>
<p>The keys in the name tree may be treated as text strings for
display purposes.</p>
</blockquote>
<p>therefore, you get them as <code>str</code>.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>KeyError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if no destination tree exists</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.Document.layout" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">layout</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterate over <code>LayoutDict</code> for all pages.</p>


<details class="danger" open>
  <summary>Deprecated</summary>
  <p>This interface is deprecated and has been moved to
<a href="https://github.com/dhdaines/paves">PAVS</a>.  It will be
removed in PLAYA 0.3.</p>
</details>    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.Document.names" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">names</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>PDF name dictionary (PDF 1.7 sec 7.7.4).</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>KeyError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if nonexistent.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.Document.objects" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">objects</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterate over all indirect objects (including, then expanding object
streams)</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.Document.outlines" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">outlines</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterate over the PDF document outline.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.Document.page_labels" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">page_labels</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Generate page label strings for the PDF document.</p>
<p>If the document includes page labels, generates strings, one per page.
If not, raise KeyError.</p>
<p>The resulting iterator is unbounded (because the page label
tree does not actually include all the pages), so it is
recommended to use <code>pages</code> instead.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>KeyError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>No page labels are present in the catalog</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.Document.pages" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pages</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Pages of the document as an iterable/addressable <code>PageList</code> object.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.Document.structtree" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">structtree</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Return the PDF structure tree.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.Document.tokens" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tokens</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterate over tokens.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="playa.Document.__getitem__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__getitem__</span><span class="p">(</span><span class="n">objid</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get an indirect object from the PDF.</p>
<p>Note that the behaviour in the case of a non-existent object,
while Pythonic, is not PDFic, as PDF 1.7 sec 7.3.10 states:</p>
<blockquote>
<p>An indirect reference to an undefined object shall not be
considered an error by a conforming reader; it shall be
treated as a reference to the null object.</p>
</blockquote>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if Document is not initialized</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>IndexError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if objid does not exist in PDF</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>playa/document.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDFObject</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get an indirect object from the PDF.</span>

<span class="sd">    Note that the behaviour in the case of a non-existent object,</span>
<span class="sd">    while Pythonic, is not PDFic, as PDF 1.7 sec 7.3.10 states:</span>

<span class="sd">    &gt; An indirect reference to an undefined object shall not be</span>
<span class="sd">    considered an error by a conforming reader; it shall be</span>
<span class="sd">    treated as a reference to the null object.</span>

<span class="sd">    Raises:</span>
<span class="sd">      ValueError: if Document is not initialized</span>
<span class="sd">      IndexError: if objid does not exist in PDF</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Document is not initialized&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">objid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_objs</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">xref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="p">(</span><span class="n">strmid</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">genno</span><span class="p">)</span> <span class="o">=</span> <span class="n">xref</span><span class="o">.</span><span class="n">get_pos</span><span class="p">(</span><span class="n">objid</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">strmid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">stream</span> <span class="o">=</span> <span class="n">stream_value</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">strmid</span><span class="p">])</span>
                    <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getobj_objstm</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">objid</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getobj_parse</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">objid</span><span class="p">)</span>
                <span class="k">break</span>
            <span class="c1"># FIXME: We might not actually want to catch these...</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;EOF when searching for object </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">objid</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="k">except</span> <span class="n">PDFSyntaxError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Syntax error when searching for object </span><span class="si">%d</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">objid</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                <span class="k">continue</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Object with ID </span><span class="si">{</span><span class="n">objid</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cached_objs</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_objs</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.Document.__iter__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__iter__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Iterate over top-level <code>IndirectObject</code> (does not expand object streams)</p>

            <details class="quote">
              <summary>Source code in <code>playa/document.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">IndirectObject</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterate over top-level `IndirectObject` (does not expand object streams)&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">obj</span> <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">IndirectObjectParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.Page" class="doc doc-heading">
            <code>Page</code>


</h3>


    <div class="doc doc-contents ">


        <p>An object that holds the information about a page.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>doc</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="playa.document.Document" href="#playa.document.Document">Document</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a Document object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pageid</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the integer PDF object ID associated with the page in the page tree.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>attrs</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a dictionary of page attributes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>label</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>page label string.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>page_idx</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>0-based index of the page in the document.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>space</code>
            </td>
            <td>
                  <code><span title="playa.page.DeviceSpace">DeviceSpace</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the device space to use for interpreting content</p>
              </div>
            </td>
            <td>
                  <code>&#39;screen&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="playa.Page.pageid">pageid</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the integer object ID associated with the page in the page tree</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.Page.attrs">attrs</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a dictionary of page attributes.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.Page.resources">resources</span></code></td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[str, <span title="playa.parser.PDFObject">PDFObject</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a dictionary of resources used by the page.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.Page.mediabox">mediabox</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the physical size of the page.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.Page.cropbox">cropbox</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the crop rectangle of the page.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.Page.rotate">rotate</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the page rotation (in degree).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.Page.label">label</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the page's label (typically, the logical page number).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.Page.page_idx">page_idx</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>0-based index of the page in the document.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.Page.ctm">ctm</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>coordinate transformation matrix from default user space to
   page's device space</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>playa/page.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Page</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;An object that holds the information about a page.</span>

<span class="sd">    Args:</span>
<span class="sd">      doc: a Document object.</span>
<span class="sd">      pageid: the integer PDF object ID associated with the page in the page tree.</span>
<span class="sd">      attrs: a dictionary of page attributes.</span>
<span class="sd">      label: page label string.</span>
<span class="sd">      page_idx: 0-based index of the page in the document.</span>
<span class="sd">      space: the device space to use for interpreting content</span>

<span class="sd">    Attributes:</span>
<span class="sd">      pageid: the integer object ID associated with the page in the page tree</span>
<span class="sd">      attrs: a dictionary of page attributes.</span>
<span class="sd">      resources: a dictionary of resources used by the page.</span>
<span class="sd">      mediabox: the physical size of the page.</span>
<span class="sd">      cropbox: the crop rectangle of the page.</span>
<span class="sd">      rotate: the page rotation (in degree).</span>
<span class="sd">      label: the page&#39;s label (typically, the logical page number).</span>
<span class="sd">      page_idx: 0-based index of the page in the document.</span>
<span class="sd">      ctm: coordinate transformation matrix from default user space to</span>
<span class="sd">           page&#39;s device space</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">doc</span><span class="p">:</span> <span class="s2">&quot;Document&quot;</span><span class="p">,</span>
        <span class="n">pageid</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">attrs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
        <span class="n">label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">page_idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">space</span><span class="p">:</span> <span class="n">DeviceSpace</span> <span class="o">=</span> <span class="s2">&quot;screen&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">docref</span> <span class="o">=</span> <span class="n">_ref_document</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pageid</span> <span class="o">=</span> <span class="n">pageid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="n">attrs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">page_idx</span> <span class="o">=</span> <span class="n">page_idx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">space</span> <span class="o">=</span> <span class="n">space</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lastmod</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;LastModified&quot;</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">]</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Resources&quot;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Resources missing or invalid from Page id </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pageid</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resources</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="s2">&quot;MediaBox&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mediabox</span> <span class="o">=</span> <span class="n">normalize_rect</span><span class="p">(</span><span class="n">parse_rect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;MediaBox&quot;</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;MediaBox missing from Page id </span><span class="si">%d</span><span class="s2"> (and not inherited),&quot;</span>
                <span class="s2">&quot; defaulting to US Letter (612x792)&quot;</span><span class="p">,</span>
                <span class="n">pageid</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mediabox</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">612</span><span class="p">,</span> <span class="mi">792</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cropbox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mediabox</span>
        <span class="k">if</span> <span class="s2">&quot;CropBox&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cropbox</span> <span class="o">=</span> <span class="n">normalize_rect</span><span class="p">(</span><span class="n">parse_rect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;CropBox&quot;</span><span class="p">]))</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Invalid CropBox in /Page, defaulting to MediaBox&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rotate</span> <span class="o">=</span> <span class="p">(</span><span class="n">int_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Rotate&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="o">+</span> <span class="mi">360</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
        <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mediabox</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span>
        <span class="c1"># PDF 1.7 section 8.4.1: Initial value: a matrix that</span>
        <span class="c1"># transforms default user coordinates to device coordinates.</span>
        <span class="c1">#</span>
        <span class="c1"># We keep this as `self.ctm` in order to transform layout</span>
        <span class="c1"># attributes in tagged PDFs which are specified in default</span>
        <span class="c1"># user space (PDF 1.7 section 14.8.5.4.3, table 344)</span>
        <span class="c1">#</span>
        <span class="c1"># &quot;screen&quot; device space: origin is top left of MediaBox</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span> <span class="o">==</span> <span class="s2">&quot;screen&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="n">x0</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
        <span class="c1"># &quot;page&quot; device space: origin is bottom left of MediaBox</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span> <span class="o">==</span> <span class="s2">&quot;page&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="n">x0</span><span class="p">,</span> <span class="o">-</span><span class="n">y0</span><span class="p">)</span>
        <span class="c1"># &quot;default&quot; device space: no transformation or rotation</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span> <span class="o">==</span> <span class="s2">&quot;user&quot;</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;&quot;user&quot; device space is deprecated, use &quot;default&quot; instead&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span> <span class="o">!=</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Unknown device space: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="o">=</span> <span class="n">MATRIX_IDENTITY</span>
            <span class="n">width</span> <span class="o">=</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># If rotation is requested, apply rotation to the initial ctm</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate</span> <span class="o">==</span> <span class="mi">90</span><span class="p">:</span>
            <span class="c1"># x&#39; = y</span>
            <span class="c1"># y&#39; = width - x</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="o">=</span> <span class="n">mult_matrix</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate</span> <span class="o">==</span> <span class="mi">180</span><span class="p">:</span>
            <span class="c1"># x&#39; = width - x</span>
            <span class="c1"># y&#39; = height - y</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="o">=</span> <span class="n">mult_matrix</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate</span> <span class="o">==</span> <span class="mi">270</span><span class="p">:</span>
            <span class="c1"># x&#39; = height - y</span>
            <span class="c1"># y&#39; = x</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="o">=</span> <span class="n">mult_matrix</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Invalid /Rotate: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">annots</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Annots&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beads</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;B&quot;</span><span class="p">)</span>
        <span class="n">contents</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Contents&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">contents</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_contents</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">contents</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_contents</span> <span class="o">=</span> <span class="n">contents</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_contents</span> <span class="o">=</span> <span class="p">[</span><span class="n">contents</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">doc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Document&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get associated document if it exists.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">docref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">_deref_document</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">docref</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">streams</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">ContentStream</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return resolved content streams.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contents</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">stream_value</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">width</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Width of the page in default user space units.&quot;&quot;&quot;</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mediabox</span>
        <span class="k">return</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">height</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Width of the page in default user space units.&quot;&quot;&quot;</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mediabox</span>
        <span class="k">return</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">contents</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">PDFObject</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterator over PDF objects in the content streams.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">ContentParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_contents</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">obj</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;ContentObject&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterator over lazy layout objects.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="n">LazyInterpreter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contents</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">paths</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;PathObject&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterator over lazy path objects.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">obj</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">PathObject</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">images</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;ImageObject&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterator over lazy image objects.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">obj</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">ImageObject</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">texts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;TextObject&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterator over lazy text objects.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">obj</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">TextObject</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">xobjects</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;XObjectObject&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return resolved and rendered Form XObjects.</span>

<span class="sd">        This does *not* return any image or PostScript XObjects.  You</span>
<span class="sd">        can get images via the `images` property.  Apparently you</span>
<span class="sd">        aren&#39;t supposed to use PostScript XObjects for anything, ever.</span>

<span class="sd">        Note that these are the XObjects as rendered on the page, so</span>
<span class="sd">        you may see the same named XObject multiple times.  If you</span>
<span class="sd">        need to access their actual definitions you&#39;ll have to look at</span>
<span class="sd">        `page.resources`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">obj</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">XObjectObject</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">layout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;LayoutDict&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterator over eager layout object dictionaries.</span>

<span class="sd">        Danger: Deprecated</span>
<span class="sd">            This interface is deprecated and has been moved to</span>
<span class="sd">            [PAVS](https://github.com/dhdaines/paves).  It will be</span>
<span class="sd">            removed in PLAYA 0.3.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;The layout property has moved to PAVS (https://github.com/dhdaines/paves)&quot;</span>
            <span class="s2">&quot; and will be removed in PLAYA 0.3&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="n">PageInterpreter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contents</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Token</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterator over tokens in the content streams.&quot;&quot;&quot;</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">ContentParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_contents</span><span class="p">)</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">pos</span><span class="p">,</span> <span class="n">tok</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">nexttoken</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="k">yield</span> <span class="n">tok</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">structtree</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StructTree</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the PDF structure tree.&quot;&quot;&quot;</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="n">_deref_document</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">docref</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">StructTree</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="p">,))</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;Page: Resources=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="si">!r}</span><span class="s2">, MediaBox=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mediabox</span><span class="si">!r}</span><span class="s2">&gt;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="playa.Page.contents" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">contents</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterator over PDF objects in the content streams.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.Page.doc" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">doc</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Get associated document if it exists.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.Page.height" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">height</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Width of the page in default user space units.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.Page.images" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">images</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterator over lazy image objects.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.Page.layout" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">layout</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterator over eager layout object dictionaries.</p>


<details class="danger" open>
  <summary>Deprecated</summary>
  <p>This interface is deprecated and has been moved to
<a href="https://github.com/dhdaines/paves">PAVS</a>.  It will be
removed in PLAYA 0.3.</p>
</details>    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.Page.paths" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">paths</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterator over lazy path objects.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.Page.streams" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">streams</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Return resolved content streams.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.Page.structtree" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">structtree</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Return the PDF structure tree.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.Page.texts" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">texts</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterator over lazy text objects.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.Page.tokens" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tokens</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterator over tokens in the content streams.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.Page.width" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">width</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Width of the page in default user space units.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.Page.xobjects" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">xobjects</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Return resolved and rendered Form XObjects.</p>
<p>This does <em>not</em> return any image or PostScript XObjects.  You
can get images via the <code>images</code> property.  Apparently you
aren't supposed to use PostScript XObjects for anything, ever.</p>
<p>Note that these are the XObjects as rendered on the page, so
you may see the same named XObject multiple times.  If you
need to access their actual definitions you'll have to look at
<code>page.resources</code>.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="playa.Page.__iter__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__iter__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Iterator over lazy layout objects.</p>

            <details class="quote">
              <summary>Source code in <code>playa/page.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;ContentObject&quot;</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterator over lazy layout objects.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="n">LazyInterpreter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contents</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="playa.open" class="doc doc-heading">
            <code class="highlight language-python"><span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">space</span><span class="o">=</span><span class="s1">&#39;screen&#39;</span><span class="p">,</span> <span class="n">max_workers</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mp_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Open a PDF document from a path on the filesystem.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="os.PathLike">PathLike</span>, str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the document to open.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>space</code>
            </td>
            <td>
                  <code><span title="playa.page.DeviceSpace">DeviceSpace</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Device space to use ("screen" for screen-like
   coordinates, "page" for pdfminer.six-like coordinates, "default" for
   default user space with no rotation or translation)</p>
              </div>
            </td>
            <td>
                  <code>&#39;screen&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_workers</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[int, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of worker processes to use for parallel
         processing of pages (if 1, no workers are spawned)</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mp_context</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="multiprocessing.context.BaseContext">BaseContext</span>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Multiprocessing context to use for worker
        processes, see <a href="https://docs.python.org/3/library/multiprocessing.html#contexts-and-start-methods">Contexts and Start
        Methods</a>
        for more information.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>playa/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">open</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">PathLike</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">space</span><span class="p">:</span> <span class="n">DeviceSpace</span> <span class="o">=</span> <span class="s2">&quot;screen&quot;</span><span class="p">,</span>
    <span class="n">max_workers</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">mp_context</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">BaseContext</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Document</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Open a PDF document from a path on the filesystem.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: Path to the document to open.</span>
<span class="sd">        space: Device space to use (&quot;screen&quot; for screen-like</span>
<span class="sd">               coordinates, &quot;page&quot; for pdfminer.six-like coordinates, &quot;default&quot; for</span>
<span class="sd">               default user space with no rotation or translation)</span>
<span class="sd">        max_workers: Number of worker processes to use for parallel</span>
<span class="sd">                     processing of pages (if 1, no workers are spawned)</span>
<span class="sd">        mp_context: Multiprocessing context to use for worker</span>
<span class="sd">                    processes, see [Contexts and Start</span>
<span class="sd">                    Methods](https://docs.python.org/3/library/multiprocessing.html#contexts-and-start-methods)</span>
<span class="sd">                    for more information.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fp</span> <span class="o">=</span> <span class="n">builtins</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
    <span class="n">pdf</span> <span class="o">=</span> <span class="n">Document</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span> <span class="n">space</span><span class="o">=</span><span class="n">space</span><span class="p">)</span>
    <span class="n">pdf</span><span class="o">.</span><span class="n">_fp</span> <span class="o">=</span> <span class="n">fp</span>
    <span class="k">if</span> <span class="n">max_workers</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">max_workers</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">_pool</span> <span class="o">=</span> <span class="n">ProcessPoolExecutor</span><span class="p">(</span>
            <span class="n">max_workers</span><span class="o">=</span><span class="n">max_workers</span><span class="p">,</span>
            <span class="n">mp_context</span><span class="o">=</span><span class="n">mp_context</span><span class="p">,</span>
            <span class="n">initializer</span><span class="o">=</span><span class="n">_init_worker</span><span class="p">,</span>  <span class="c1"># type: ignore[arg-type]</span>
            <span class="n">initargs</span><span class="o">=</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">pdf</span><span class="p">),</span> <span class="n">path</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">space</span><span class="p">),</span>  <span class="c1"># type: ignore[arg-type]</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">pdf</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="playa.document" class="doc doc-heading">
            <code>playa.document</code>


</h2>

    <div class="doc doc-contents first">

        <p>Basic classes for PDF document parsing.</p>








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="playa.document.Document" class="doc doc-heading">
            <code>Document</code>


</h3>


    <div class="doc doc-contents ">


        <p>Representation of a PDF document on disk.</p>
<p>Since PDF documents can be very large and complex, merely creating
a <code>Document</code> does very little aside from opening the file and
verifying that the password is correct and it is, in fact, a PDF.
This may, however, involve a certain amount of file access since
the cross-reference table and trailer must be read in order to
determine this (we do not treat linearized PDFs specially for the
moment).</p>
<p>Some metadata, such as the structure tree and page tree, will be
loaded lazily and cached.  We do not handle modification of PDFs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fp</code>
            </td>
            <td>
                  <code><span title="typing.BinaryIO">BinaryIO</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>File-like object in binary mode.  Will be read using
  <code>mmap</code> if possible, otherwise will be read into memory.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>password</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Password for decryption, if needed.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>space</code>
            </td>
            <td>
                  <code><span title="playa.page.DeviceSpace">DeviceSpace</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the device space to use for interpreting content ("screen"
     or "page")</p>
              </div>
            </td>
            <td>
                  <code>&#39;screen&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>playa/document.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Document</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Representation of a PDF document on disk.</span>

<span class="sd">    Since PDF documents can be very large and complex, merely creating</span>
<span class="sd">    a `Document` does very little aside from opening the file and</span>
<span class="sd">    verifying that the password is correct and it is, in fact, a PDF.</span>
<span class="sd">    This may, however, involve a certain amount of file access since</span>
<span class="sd">    the cross-reference table and trailer must be read in order to</span>
<span class="sd">    determine this (we do not treat linearized PDFs specially for the</span>
<span class="sd">    moment).</span>

<span class="sd">    Some metadata, such as the structure tree and page tree, will be</span>
<span class="sd">    loaded lazily and cached.  We do not handle modification of PDFs.</span>

<span class="sd">    Args:</span>
<span class="sd">      fp: File-like object in binary mode.  Will be read using</span>
<span class="sd">          `mmap` if possible, otherwise will be read into memory.</span>
<span class="sd">      password: Password for decryption, if needed.</span>
<span class="sd">      space: the device space to use for interpreting content (&quot;screen&quot;</span>
<span class="sd">             or &quot;page&quot;)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_fp</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">BinaryIO</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_pages</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;PageList&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_pool</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Executor</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Document&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">,</span> <span class="n">traceback</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># If we were opened from a file then close it</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fp</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fp</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># Shutdown process pool</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pool</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pool</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pool</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">fp</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">,</span>
        <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">space</span><span class="p">:</span> <span class="n">DeviceSpace</span> <span class="o">=</span> <span class="s2">&quot;screen&quot;</span><span class="p">,</span>
        <span class="n">_boss_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">_boss_id</span><span class="p">:</span>
            <span class="c1"># Set this **right away** because it is needed to get</span>
            <span class="c1"># indirect object references right.</span>
            <span class="n">_set_document</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_boss_id</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">in_worker</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">XRef</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">space</span> <span class="o">=</span> <span class="n">space</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encryption</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decipher</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DecipherCallable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cached_objs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parsed_objs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">PDFObject</span><span class="p">],</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cached_fonts</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">object</span><span class="p">,</span> <span class="n">Font</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">TextIOBase</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;fp is not a binary file&quot;</span><span class="p">)</span>
        <span class="c1"># The header is frequently mangled, in which case we will try to read the</span>
        <span class="c1"># file anyway.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_version</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">read_header</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">PDFSyntaxError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;PDF header not found, will try to read the file anyway&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_version</span> <span class="o">=</span> <span class="s2">&quot;UNKNOWN&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="n">mmap</span><span class="o">.</span><span class="n">mmap</span><span class="p">]</span> <span class="o">=</span> <span class="n">mmap</span><span class="o">.</span><span class="n">mmap</span><span class="p">(</span>
                <span class="n">fp</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">access</span><span class="o">=</span><span class="n">mmap</span><span class="o">.</span><span class="n">ACCESS_READ</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="n">io</span><span class="o">.</span><span class="n">UnsupportedOperation</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;mmap not supported on </span><span class="si">%r</span><span class="s2">, reading document into memory&quot;</span><span class="p">,</span> <span class="n">fp</span><span class="p">)</span>
            <span class="n">fp</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_printable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_modifiable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_extractable</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># Getting the XRef table and trailer is done non-lazily</span>
        <span class="c1"># because they contain encryption information among other</span>
        <span class="c1"># things.  As noted above we don&#39;t try to look for the first</span>
        <span class="c1"># page cross-reference table (for linearized PDFs) after the</span>
        <span class="c1"># header, it will instead be loaded with all the rest.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">IndirectObjectParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_xref</span><span class="p">()</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Found xref at </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_xref_from</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">,</span> <span class="ne">StopIteration</span><span class="p">,</span> <span class="n">PDFSyntaxError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Using fallback XRef parsing: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="n">newxref</span> <span class="o">=</span> <span class="n">XRefFallback</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newxref</span><span class="p">)</span>
        <span class="c1"># Now find the trailer</span>
        <span class="k">for</span> <span class="n">xref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">:</span>
            <span class="n">trailer</span> <span class="o">=</span> <span class="n">xref</span><span class="o">.</span><span class="n">trailer</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">trailer</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="c1"># If there&#39;s an encryption info, remember it.</span>
            <span class="k">if</span> <span class="s2">&quot;Encrypt&quot;</span> <span class="ow">in</span> <span class="n">trailer</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;ID&quot;</span> <span class="ow">in</span> <span class="n">trailer</span><span class="p">:</span>
                    <span class="n">id_value</span> <span class="o">=</span> <span class="n">list_value</span><span class="p">(</span><span class="n">trailer</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Some documents may not have a /ID, use two empty</span>
                    <span class="c1"># byte strings instead. Solves</span>
                    <span class="c1"># https://github.com/pdfminer/pdfminer.six/issues/594</span>
                    <span class="n">id_value</span> <span class="o">=</span> <span class="p">(</span><span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">encryption</span> <span class="o">=</span> <span class="p">(</span><span class="n">id_value</span><span class="p">,</span> <span class="n">dict_value</span><span class="p">(</span><span class="n">trailer</span><span class="p">[</span><span class="s2">&quot;Encrypt&quot;</span><span class="p">]))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_password</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;Info&quot;</span> <span class="ow">in</span> <span class="n">trailer</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_value</span><span class="p">(</span><span class="n">trailer</span><span class="p">[</span><span class="s2">&quot;Info&quot;</span><span class="p">]))</span>
                <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Info is a broken reference (incorrect xref table?)&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;Root&quot;</span> <span class="ow">in</span> <span class="n">trailer</span><span class="p">:</span>
                <span class="c1"># Every PDF file must have exactly one /Root dictionary.</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span><span class="n">trailer</span><span class="p">[</span><span class="s2">&quot;Root&quot;</span><span class="p">])</span>
                <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Root is a broken reference (incorrect xref table?)&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No /Root object! - Is this really a PDF?&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">LITERAL_CATALOG</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Catalog not found!&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;Version&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="s2">&quot;Using PDF version </span><span class="si">%r</span><span class="s2"> from catalog instead of </span><span class="si">%r</span><span class="s2"> from header&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">[</span><span class="s2">&quot;Version&quot;</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pdf_version</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">[</span><span class="s2">&quot;Version&quot;</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_initialize_password</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the decryption handler with a given password, if any.</span>

<span class="sd">        Internal function, requires the Encrypt dictionary to have</span>
<span class="sd">        been read from the trailer into self.encryption.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">encryption</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="p">(</span><span class="n">docid</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encryption</span>
        <span class="k">if</span> <span class="n">literal_name</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Filter&quot;</span><span class="p">))</span> <span class="o">!=</span> <span class="s2">&quot;Standard&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PDFEncryptionError</span><span class="p">(</span><span class="s2">&quot;Unknown filter: param=</span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">param</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;V&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="c1"># 3 (PDF 1.4) An unpublished algorithm that permits encryption</span>
        <span class="c1"># key lengths ranging from 40 to 128 bits. This value shall</span>
        <span class="c1"># not appear in a conforming PDF file.</span>
        <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PDFEncryptionError</span><span class="p">(</span><span class="s2">&quot;Unpublished algorithm 3 not supported&quot;</span><span class="p">)</span>
        <span class="n">factory</span> <span class="o">=</span> <span class="n">SECURITY_HANDLERS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="c1"># 0 An algorithm that is undocumented. This value shall not be used.</span>
        <span class="k">if</span> <span class="n">factory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PDFEncryptionError</span><span class="p">(</span><span class="s2">&quot;Unknown algorithm: param=</span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">param</span><span class="p">)</span>
        <span class="n">handler</span> <span class="o">=</span> <span class="n">factory</span><span class="p">(</span><span class="n">docid</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decipher</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">decrypt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_printable</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">is_printable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_modifiable</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">is_modifiable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_extractable</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">is_extractable</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="c1"># Ensure that no extra data leaks into encrypted streams</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">IndirectObject</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over top-level `IndirectObject` (does not expand object streams)&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">obj</span> <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">IndirectObjectParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">objects</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">IndirectObject</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over all indirect objects (including, then expanding object</span>
<span class="sd">        streams)&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">IndirectObjectParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="bp">self</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">obj</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">ContentStream</span><span class="p">)</span>
                <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="n">LITERAL_OBJSTM</span>
            <span class="p">):</span>
                <span class="n">parser</span> <span class="o">=</span> <span class="n">ObjectStreamParser</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">spos</span><span class="p">,</span> <span class="n">sobj</span> <span class="ow">in</span> <span class="n">parser</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">sobj</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Token</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over tokens.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">tok</span> <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">tok</span> <span class="ow">in</span> <span class="n">Lexer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">layout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">LayoutDict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over `LayoutDict` for all pages.</span>

<span class="sd">        Danger: Deprecated</span>
<span class="sd">            This interface is deprecated and has been moved to</span>
<span class="sd">            [PAVS](https://github.com/dhdaines/paves).  It will be</span>
<span class="sd">            removed in PLAYA 0.3.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;The layout property has moved to PAVS (https://github.com/dhdaines/paves)&quot;</span>
            <span class="s2">&quot; and will be removed in PLAYA 0.3&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">cast</span>

        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">page</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pages</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">dic</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">layout</span><span class="p">:</span>
                <span class="n">dic</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">LayoutDict</span><span class="p">,</span> <span class="n">dic</span><span class="p">)</span>  <span class="c1"># ugh</span>
                <span class="n">dic</span><span class="p">[</span><span class="s2">&quot;page_index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">idx</span>
                <span class="n">dic</span><span class="p">[</span><span class="s2">&quot;page_label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">label</span>
                <span class="k">yield</span> <span class="n">dic</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">structtree</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StructTree</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the PDF structure tree.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">StructTree</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_getobj_objstm</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">stream</span><span class="p">:</span> <span class="n">ContentStream</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">objid</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDFObject</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">stream</span><span class="o">.</span><span class="n">objid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parsed_objs</span><span class="p">:</span>
            <span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parsed_objs</span><span class="p">[</span><span class="n">stream</span><span class="o">.</span><span class="n">objid</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_objects</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">stream</span><span class="o">.</span><span class="n">objid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parsed_objs</span><span class="p">[</span><span class="n">stream</span><span class="o">.</span><span class="n">objid</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">index</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">objs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span><span class="s2">&quot;index too big: </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">index</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream</span><span class="p">:</span> <span class="n">ContentStream</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">PDFObject</span><span class="p">],</span> <span class="nb">int</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">LITERAL_OBJSTM</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Content stream Type is not /ObjStm: </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">stream</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">stream</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;N is not defined in content stream: </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">stream</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;N is invalid in content stream: </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">stream</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">ObjectParser</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">objs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PDFObject</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">obj</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">parser</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_getobj_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">objid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDFObject</span><span class="p">:</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">obj</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">objid</span> <span class="o">!=</span> <span class="n">objid</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;objid mismatch: </span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="n">objid</span><span class="si">!r}</span><span class="s2">=</span><span class="si">{</span><span class="n">objid</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">,</span> <span class="n">PDFSyntaxError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Indirect object </span><span class="si">%d</span><span class="s2"> not found at position </span><span class="si">%d</span><span class="s2">: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">objid</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">e</span>
            <span class="p">)</span>
            <span class="c1"># In case of malformed pdf files where the offset in the</span>
            <span class="c1"># xref table doesn&#39;t point exactly at the object</span>
            <span class="c1"># definition (probably more frequent than you think), just</span>
            <span class="c1"># use a regular expression to find the object because we</span>
            <span class="c1"># can do that.</span>
            <span class="n">realpos</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">lastgen</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="sa">rb</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">\s+(\d+)\s+obj&quot;</span> <span class="o">%</span> <span class="n">objid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">):</span>
                <span class="n">genno</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">genno</span> <span class="o">&gt;</span> <span class="n">lastgen</span><span class="p">:</span>
                    <span class="n">lastgen</span> <span class="o">=</span> <span class="n">genno</span>
                    <span class="n">realpos</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">realpos</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Indirect object </span><span class="si">{</span><span class="n">objid</span><span class="si">!r}</span><span class="s2"> not found in document&quot;</span>
                <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">realpos</span><span class="p">)</span>
            <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">objid</span> <span class="o">!=</span> <span class="n">objid</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;objid mismatch: </span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="n">objid</span><span class="si">!r}</span><span class="s2">=</span><span class="si">{</span><span class="n">objid</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">decipher</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">decipher_all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decipher</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">objid</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">genno</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">obj</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDFObject</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get an indirect object from the PDF.</span>

<span class="sd">        Note that the behaviour in the case of a non-existent object,</span>
<span class="sd">        while Pythonic, is not PDFic, as PDF 1.7 sec 7.3.10 states:</span>

<span class="sd">        &gt; An indirect reference to an undefined object shall not be</span>
<span class="sd">        considered an error by a conforming reader; it shall be</span>
<span class="sd">        treated as a reference to the null object.</span>

<span class="sd">        Raises:</span>
<span class="sd">          ValueError: if Document is not initialized</span>
<span class="sd">          IndexError: if objid does not exist in PDF</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Document is not initialized&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">objid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_objs</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">xref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="p">(</span><span class="n">strmid</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">genno</span><span class="p">)</span> <span class="o">=</span> <span class="n">xref</span><span class="o">.</span><span class="n">get_pos</span><span class="p">(</span><span class="n">objid</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">strmid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">stream</span> <span class="o">=</span> <span class="n">stream_value</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">strmid</span><span class="p">])</span>
                        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getobj_objstm</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">objid</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getobj_parse</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">objid</span><span class="p">)</span>
                    <span class="k">break</span>
                <span class="c1"># FIXME: We might not actually want to catch these...</span>
                <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;EOF when searching for object </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">objid</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="k">except</span> <span class="n">PDFSyntaxError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Syntax error when searching for object </span><span class="si">%d</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">objid</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                    <span class="k">continue</span>
            <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Object with ID </span><span class="si">{</span><span class="n">objid</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cached_objs</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_objs</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_font</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objid</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span> <span class="n">spec</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Font</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">objid</span> <span class="ow">and</span> <span class="n">objid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_fonts</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_fonts</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">spec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">LITERAL_FONT</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Font specification Type is not /Font: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">spec</span><span class="p">)</span>
        <span class="c1"># Create a Font object.</span>
        <span class="k">if</span> <span class="s2">&quot;Subtype&quot;</span> <span class="ow">in</span> <span class="n">spec</span><span class="p">:</span>
            <span class="n">subtype</span> <span class="o">=</span> <span class="n">literal_name</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="s2">&quot;Subtype&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Font specification Subtype is not specified: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">spec</span><span class="p">)</span>
            <span class="n">subtype</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">subtype</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;Type1&quot;</span><span class="p">,</span> <span class="s2">&quot;MMType1&quot;</span><span class="p">):</span>
            <span class="c1"># Type1 Font</span>
            <span class="n">font</span><span class="p">:</span> <span class="n">Font</span> <span class="o">=</span> <span class="n">Type1Font</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">subtype</span> <span class="o">==</span> <span class="s2">&quot;TrueType&quot;</span><span class="p">:</span>
            <span class="c1"># TrueType Font</span>
            <span class="n">font</span> <span class="o">=</span> <span class="n">TrueTypeFont</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">subtype</span> <span class="o">==</span> <span class="s2">&quot;Type3&quot;</span><span class="p">:</span>
            <span class="c1"># Type3 Font</span>
            <span class="n">font</span> <span class="o">=</span> <span class="n">Type3Font</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">subtype</span> <span class="o">==</span> <span class="s2">&quot;Type0&quot;</span><span class="p">:</span>
            <span class="c1"># Type0 Font</span>
            <span class="n">dfonts</span> <span class="o">=</span> <span class="n">list_value</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="s2">&quot;DescendantFonts&quot;</span><span class="p">])</span>
            <span class="k">assert</span> <span class="n">dfonts</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dfonts</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Type 0 font should have 1 descendant, has more: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dfonts</span><span class="p">)</span>
            <span class="n">subspec</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span><span class="n">dfonts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="c1"># Merge the root and descendant font dictionaries</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;Encoding&quot;</span><span class="p">,</span> <span class="s2">&quot;ToUnicode&quot;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">spec</span><span class="p">:</span>
                    <span class="n">subspec</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="n">font</span> <span class="o">=</span> <span class="n">CIDFont</span><span class="p">(</span><span class="n">subspec</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Invalid Font spec, creating dummy font: </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">spec</span><span class="p">)</span>
            <span class="c1"># We need a dummy font object to be able to do *something*</span>
            <span class="c1"># (even if it&#39;s the wrong thing) with text objects.</span>
            <span class="n">font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">({},</span> <span class="p">{})</span>
        <span class="k">if</span> <span class="n">objid</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cached_fonts</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span> <span class="o">=</span> <span class="n">font</span>
        <span class="k">return</span> <span class="n">font</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">outlines</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">OutlineItem</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Iterate over the PDF document outline.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;Outlines&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">search</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span> <span class="n">level</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">OutlineItem</span><span class="p">]:</span>
            <span class="n">entry</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;Title&quot;</span> <span class="ow">in</span> <span class="n">entry</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;A&quot;</span> <span class="ow">in</span> <span class="n">entry</span> <span class="ow">or</span> <span class="s2">&quot;Dest&quot;</span> <span class="ow">in</span> <span class="n">entry</span><span class="p">:</span>
                    <span class="n">title</span> <span class="o">=</span> <span class="n">decode_text</span><span class="p">(</span><span class="n">str_value</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;Title&quot;</span><span class="p">]))</span>
                    <span class="n">dest</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Dest&quot;</span><span class="p">)</span>
                    <span class="n">action</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span>
                    <span class="n">se</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;SE&quot;</span><span class="p">)</span>
                    <span class="k">yield</span> <span class="n">OutlineItem</span><span class="p">(</span>
                        <span class="n">level</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">dest</span><span class="p">),</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">action</span><span class="p">),</span> <span class="n">se</span>
                    <span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;First&quot;</span> <span class="ow">in</span> <span class="n">entry</span> <span class="ow">and</span> <span class="s2">&quot;Last&quot;</span> <span class="ow">in</span> <span class="n">entry</span><span class="p">:</span>
                <span class="k">yield from</span> <span class="n">search</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;First&quot;</span><span class="p">],</span> <span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;Next&quot;</span> <span class="ow">in</span> <span class="n">entry</span><span class="p">:</span>
                <span class="k">yield from</span> <span class="n">search</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;Next&quot;</span><span class="p">],</span> <span class="n">level</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">search</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">[</span><span class="s2">&quot;Outlines&quot;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">page_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate page label strings for the PDF document.</span>

<span class="sd">        If the document includes page labels, generates strings, one per page.</span>
<span class="sd">        If not, raise KeyError.</span>

<span class="sd">        The resulting iterator is unbounded (because the page label</span>
<span class="sd">        tree does not actually include all the pages), so it is</span>
<span class="sd">        recommended to use `pages` instead.</span>

<span class="sd">        Raises:</span>
<span class="sd">          KeyError: No page labels are present in the catalog</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>  <span class="c1"># really it cannot be None</span>

        <span class="n">page_labels</span> <span class="o">=</span> <span class="n">PageLabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">[</span><span class="s2">&quot;PageLabels&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">page_labels</span><span class="o">.</span><span class="n">labels</span>

    <span class="n">PageType</span> <span class="o">=</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_pages_from_xrefs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">PageType</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Find pages from the cross-reference tables if the page tree</span>
<span class="sd">        is missing (note that this only happens in invalid PDFs, but</span>
<span class="sd">        it happens.)</span>

<span class="sd">        Returns:</span>
<span class="sd">          an iterator over (objid, dict) pairs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">xref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">object_id</span> <span class="ow">in</span> <span class="n">xref</span><span class="o">.</span><span class="n">objids</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">object_id</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="n">LITERAL_PAGE</span><span class="p">:</span>
                        <span class="k">yield</span> <span class="n">object_id</span><span class="p">,</span> <span class="n">obj</span>
                <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                    <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_page_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">PageType</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over the flattened page tree in reading order, propagating</span>
<span class="sd">        inheritable attributes.  Returns an iterator over (objid, dict) pairs.</span>

<span class="sd">        Raises:</span>
<span class="sd">          KeyError: if there is no page tree.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;Pages&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;No &#39;Pages&#39; entry in catalog&quot;</span><span class="p">)</span>
        <span class="n">stack</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">[</span><span class="s2">&quot;Pages&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">)]</span>
        <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">while</span> <span class="n">stack</span><span class="p">:</span>
            <span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">ObjRef</span><span class="p">):</span>
                <span class="c1"># The PDF specification *requires* both the Pages</span>
                <span class="c1"># element of the catalog and the entries in Kids in</span>
                <span class="c1"># the page tree to be indirect references.</span>
                <span class="n">object_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">objid</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="c1"># Should not happen in a valid PDF, but probably does?</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Page tree contains bare integer: </span><span class="si">%r</span><span class="s2"> in </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
                <span class="n">object_id</span> <span class="o">=</span> <span class="n">obj</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Page tree contains unknown object: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
            <span class="n">page_object</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">object_id</span><span class="p">])</span>

            <span class="c1"># Avoid recursion errors by keeping track of visited nodes</span>
            <span class="c1"># (again, this should never actually happen in a valid PDF)</span>
            <span class="k">if</span> <span class="n">object_id</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Circular reference </span><span class="si">%r</span><span class="s2"> in page tree&quot;</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">object_id</span><span class="p">)</span>

            <span class="c1"># Propagate inheritable attributes</span>
            <span class="n">object_properties</span> <span class="o">=</span> <span class="n">page_object</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">parent</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">INHERITABLE_PAGE_ATTRS</span> <span class="ow">and</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">object_properties</span><span class="p">:</span>
                    <span class="n">object_properties</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>

            <span class="c1"># Recurse, depth-first</span>
            <span class="n">object_type</span> <span class="o">=</span> <span class="n">object_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">object_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Page has no Type, trying type: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">object_properties</span><span class="p">)</span>
                <span class="n">object_type</span> <span class="o">=</span> <span class="n">object_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">object_type</span> <span class="ow">is</span> <span class="n">LITERAL_PAGES</span> <span class="ow">and</span> <span class="s2">&quot;Kids&quot;</span> <span class="ow">in</span> <span class="n">object_properties</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">list_value</span><span class="p">(</span><span class="n">object_properties</span><span class="p">[</span><span class="s2">&quot;Kids&quot;</span><span class="p">])):</span>
                    <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">child</span><span class="p">,</span> <span class="n">object_properties</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">object_type</span> <span class="ow">is</span> <span class="n">LITERAL_PAGE</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">object_id</span><span class="p">,</span> <span class="n">object_properties</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">pages</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;PageList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Pages of the document as an iterable/addressable `PageList` object.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span> <span class="o">=</span> <span class="n">PageList</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;PDF name dictionary (PDF 1.7 sec 7.7.4).</span>

<span class="sd">        Raises:</span>
<span class="sd">          KeyError: if nonexistent.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">dict_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">[</span><span class="s2">&quot;Names&quot;</span><span class="p">])</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dests</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterable of named destinations as (name, destination) tuples</span>
<span class="sd">        (PDF 1.7 sec 12.3.2).</span>

<span class="sd">        Note that we assume the names of destinations are either &quot;name</span>
<span class="sd">        objects&quot; (that&#39;s PDF for UTF-8) or &quot;text strings&quot;, since the</span>
<span class="sd">        PDF spec says (p. 367):</span>

<span class="sd">        &gt; The keys in the name tree may be treated as text strings for</span>
<span class="sd">        &gt; display purposes.</span>

<span class="sd">        therefore, you get them as `str`.</span>

<span class="sd">        Raises:</span>
<span class="sd">          KeyError: if no destination tree exists</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># PDF-1.2 or later</span>
            <span class="n">dests</span> <span class="o">=</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">decode_text</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">NameTree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="s2">&quot;Dests&quot;</span><span class="p">])</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="c1"># PDF-1.1 or prior</span>
            <span class="n">dests</span> <span class="o">=</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">dict_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">[</span><span class="s2">&quot;Dests&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">)</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">dest</span> <span class="ow">in</span> <span class="n">dests</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">name</span><span class="p">,</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">dest</span><span class="p">[</span><span class="s2">&quot;D&quot;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">name</span><span class="p">,</span> <span class="n">dest</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_find_xref</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Internal function used to locate the first XRef.&quot;&quot;&quot;</span>
        <span class="c1"># search the last xref table by scanning the file backwards.</span>
        <span class="n">prev</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">reverse_iter_lines</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">):</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&quot;startxref&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">prev</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Invalid startxref position: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">prev</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="n">start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">prev</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">start</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Invalid negative startxref position: </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="k">elif</span> <span class="n">start</span> <span class="o">&gt;</span> <span class="n">pos</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Invalid startxref position (&gt; </span><span class="si">%d</span><span class="s2">): </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="k">return</span> <span class="n">start</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span>
            <span class="k">elif</span> <span class="n">line</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&quot;xref&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">pos</span>
            <span class="k">elif</span> <span class="n">line</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&quot;endobj&quot;</span><span class="p">:</span>
                <span class="c1"># Okay, we&#39;re probably not in Kansas anymore...</span>
                <span class="k">break</span>
            <span class="k">if</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">prev</span> <span class="o">=</span> <span class="n">line</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No xref table found at end of file&quot;</span><span class="p">)</span>

    <span class="c1"># read xref table</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_read_xref_from</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">start</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">xrefs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">XRef</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reads XRefs from the given location.&quot;&quot;&quot;</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">ObjectParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">nexttoken</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unexpected EOF at </span><span class="si">{start}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">token</span> <span class="ow">is</span> <span class="n">KEYWORD_XREF</span><span class="p">:</span>
            <span class="n">parser</span><span class="o">.</span><span class="n">nextline</span><span class="p">()</span>
            <span class="n">xref</span><span class="p">:</span> <span class="n">XRef</span> <span class="o">=</span> <span class="n">XRefTable</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># It might be an XRefStream, if this is an indirect object...</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">token</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">nexttoken</span><span class="p">()</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">token</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">nexttoken</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">token</span> <span class="ow">is</span> <span class="n">KEYWORD_OBJ</span><span class="p">:</span>
                <span class="c1"># XRefStream: PDF-1.5</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
                <span class="n">xref</span> <span class="o">=</span> <span class="n">XRefStream</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Well, maybe it&#39;s an XRef table without &quot;xref&quot; (but</span>
                <span class="c1"># probably not)</span>
                <span class="n">parser</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
                <span class="n">xref</span> <span class="o">=</span> <span class="n">XRefTable</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span>
        <span class="n">xrefs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xref</span><span class="p">)</span>
        <span class="n">trailer</span> <span class="o">=</span> <span class="n">xref</span><span class="o">.</span><span class="n">trailer</span>
        <span class="c1"># For hybrid-reference files, an additional set of xrefs as a</span>
        <span class="c1"># stream.</span>
        <span class="k">if</span> <span class="s2">&quot;XRefStm&quot;</span> <span class="ow">in</span> <span class="n">trailer</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">trailer</span><span class="p">[</span><span class="s2">&quot;XRefStm&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_xref_from</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">xrefs</span><span class="p">)</span>
        <span class="c1"># Recurse into any previous xref tables or streams</span>
        <span class="k">if</span> <span class="s2">&quot;Prev&quot;</span> <span class="ow">in</span> <span class="n">trailer</span><span class="p">:</span>
            <span class="c1"># find previous xref</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">trailer</span><span class="p">[</span><span class="s2">&quot;Prev&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_xref_from</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">xrefs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="playa.document.Document.dests" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dests</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterable of named destinations as (name, destination) tuples
(PDF 1.7 sec 12.3.2).</p>
<p>Note that we assume the names of destinations are either "name
objects" (that's PDF for UTF-8) or "text strings", since the
PDF spec says (p. 367):</p>
<blockquote>
<p>The keys in the name tree may be treated as text strings for
display purposes.</p>
</blockquote>
<p>therefore, you get them as <code>str</code>.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>KeyError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if no destination tree exists</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.document.Document.layout" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">layout</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterate over <code>LayoutDict</code> for all pages.</p>


<details class="danger" open>
  <summary>Deprecated</summary>
  <p>This interface is deprecated and has been moved to
<a href="https://github.com/dhdaines/paves">PAVS</a>.  It will be
removed in PLAYA 0.3.</p>
</details>    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.document.Document.names" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">names</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>PDF name dictionary (PDF 1.7 sec 7.7.4).</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>KeyError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if nonexistent.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.document.Document.objects" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">objects</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterate over all indirect objects (including, then expanding object
streams)</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.document.Document.outlines" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">outlines</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterate over the PDF document outline.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.document.Document.page_labels" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">page_labels</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Generate page label strings for the PDF document.</p>
<p>If the document includes page labels, generates strings, one per page.
If not, raise KeyError.</p>
<p>The resulting iterator is unbounded (because the page label
tree does not actually include all the pages), so it is
recommended to use <code>pages</code> instead.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>KeyError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>No page labels are present in the catalog</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.document.Document.pages" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pages</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Pages of the document as an iterable/addressable <code>PageList</code> object.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.document.Document.structtree" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">structtree</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Return the PDF structure tree.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.document.Document.tokens" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tokens</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterate over tokens.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="playa.document.Document.__getitem__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__getitem__</span><span class="p">(</span><span class="n">objid</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get an indirect object from the PDF.</p>
<p>Note that the behaviour in the case of a non-existent object,
while Pythonic, is not PDFic, as PDF 1.7 sec 7.3.10 states:</p>
<blockquote>
<p>An indirect reference to an undefined object shall not be
considered an error by a conforming reader; it shall be
treated as a reference to the null object.</p>
</blockquote>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if Document is not initialized</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>IndexError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if objid does not exist in PDF</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>playa/document.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDFObject</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get an indirect object from the PDF.</span>

<span class="sd">    Note that the behaviour in the case of a non-existent object,</span>
<span class="sd">    while Pythonic, is not PDFic, as PDF 1.7 sec 7.3.10 states:</span>

<span class="sd">    &gt; An indirect reference to an undefined object shall not be</span>
<span class="sd">    considered an error by a conforming reader; it shall be</span>
<span class="sd">    treated as a reference to the null object.</span>

<span class="sd">    Raises:</span>
<span class="sd">      ValueError: if Document is not initialized</span>
<span class="sd">      IndexError: if objid does not exist in PDF</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Document is not initialized&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">objid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_objs</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">xref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="p">(</span><span class="n">strmid</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">genno</span><span class="p">)</span> <span class="o">=</span> <span class="n">xref</span><span class="o">.</span><span class="n">get_pos</span><span class="p">(</span><span class="n">objid</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">strmid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">stream</span> <span class="o">=</span> <span class="n">stream_value</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">strmid</span><span class="p">])</span>
                    <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getobj_objstm</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">objid</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getobj_parse</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">objid</span><span class="p">)</span>
                <span class="k">break</span>
            <span class="c1"># FIXME: We might not actually want to catch these...</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;EOF when searching for object </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">objid</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="k">except</span> <span class="n">PDFSyntaxError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Syntax error when searching for object </span><span class="si">%d</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">objid</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                <span class="k">continue</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Object with ID </span><span class="si">{</span><span class="n">objid</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cached_objs</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_objs</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.document.Document.__iter__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__iter__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Iterate over top-level <code>IndirectObject</code> (does not expand object streams)</p>

            <details class="quote">
              <summary>Source code in <code>playa/document.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">IndirectObject</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterate over top-level `IndirectObject` (does not expand object streams)&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">obj</span> <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">IndirectObjectParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.document.PageList" class="doc doc-heading">
            <code>PageList</code>


</h3>


    <div class="doc doc-contents ">


        <p>List of pages indexable by 0-based index or string label.</p>






              <details class="quote">
                <summary>Source code in <code>playa/document.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PageList</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List of pages indexable by 0-based index or string label.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Document</span><span class="p">,</span> <span class="n">pages</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">Page</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">docref</span> <span class="o">=</span> <span class="n">_ref_document</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pages</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pages</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Page</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">page</span><span class="o">.</span><span class="n">label</span><span class="p">:</span> <span class="n">page</span> <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">pages</span> <span class="k">if</span> <span class="n">page</span><span class="o">.</span><span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_init_pages</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_init_pages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Document</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">page_labels</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">page_labels</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
            <span class="n">page_labels</span> <span class="o">=</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">page_objects</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">_get_page_objects</span><span class="p">())</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
            <span class="n">page_objects</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">_get_pages_from_xrefs</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">page_idx</span><span class="p">,</span> <span class="p">((</span><span class="n">objid</span><span class="p">,</span> <span class="n">properties</span><span class="p">),</span> <span class="n">label</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
            <span class="nb">zip</span><span class="p">(</span><span class="n">page_objects</span><span class="p">,</span> <span class="n">page_labels</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">page</span> <span class="o">=</span> <span class="n">Page</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">objid</span><span class="p">,</span> <span class="n">properties</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">page_idx</span><span class="p">,</span> <span class="n">doc</span><span class="o">.</span><span class="n">space</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">page</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Duplicate page label </span><span class="si">%s</span><span class="s2"> at index </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">page_idx</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">page</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">doc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Document&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get associated document if it exists.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_deref_document</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">docref</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pages</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Page</span><span class="p">]:</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pages</span><span class="p">)</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Page</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Page</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">slice</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;PageList&quot;</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;PageList&quot;</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="s2">&quot;PageList&quot;</span><span class="p">:</span> <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">PageList</span><span class="p">(</span><span class="n">_deref_document</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">docref</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">PageList</span><span class="p">(</span><span class="n">_deref_document</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">docref</span><span class="p">),</span> <span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">key</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Page</span><span class="p">],</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply a function over each page, iterating over its results.</span>

<span class="sd">        Args:</span>
<span class="sd">            func: The function to apply to each page.</span>

<span class="sd">        Note:</span>
<span class="sd">            This possibly runs `func` in a separate process.  If its</span>
<span class="sd">            return value is not serializable (by `pickle`) then you</span>
<span class="sd">            will encounter errors.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="n">_deref_document</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">docref</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">doc</span><span class="o">.</span><span class="n">_pool</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">doc</span><span class="o">.</span><span class="n">_pool</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
                <span class="n">call_page</span><span class="p">,</span>
                <span class="n">itertools</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">func</span><span class="p">),</span>
                <span class="p">((</span><span class="nb">id</span><span class="p">(</span><span class="n">doc</span><span class="p">),</span> <span class="n">page</span><span class="o">.</span><span class="n">page_idx</span><span class="p">)</span> <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">page</span><span class="p">)</span> <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="playa.document.PageList.doc" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">doc</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Get associated document if it exists.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="playa.document.PageList.map" class="doc doc-heading">
            <code class="highlight language-python"><span class="nb">map</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Apply a function over each page, iterating over its results.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>func</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<a class="autorefs autorefs-internal" title="playa.page.Page" href="#playa.page.Page">Page</a>], <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function to apply to each page.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>This possibly runs <code>func</code> in a separate process.  If its
return value is not serializable (by <code>pickle</code>) then you
will encounter errors.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>playa/document.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Page</span><span class="p">],</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply a function over each page, iterating over its results.</span>

<span class="sd">    Args:</span>
<span class="sd">        func: The function to apply to each page.</span>

<span class="sd">    Note:</span>
<span class="sd">        This possibly runs `func` in a separate process.  If its</span>
<span class="sd">        return value is not serializable (by `pickle`) then you</span>
<span class="sd">        will encounter errors.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">doc</span> <span class="o">=</span> <span class="n">_deref_document</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">docref</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">doc</span><span class="o">.</span><span class="n">_pool</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">doc</span><span class="o">.</span><span class="n">_pool</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="n">call_page</span><span class="p">,</span>
            <span class="n">itertools</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">func</span><span class="p">),</span>
            <span class="p">((</span><span class="nb">id</span><span class="p">(</span><span class="n">doc</span><span class="p">),</span> <span class="n">page</span><span class="o">.</span><span class="n">page_idx</span><span class="p">)</span> <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">page</span><span class="p">)</span> <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="playa.page" class="doc doc-heading">
            <code>playa.page</code>


</h2>

    <div class="doc doc-contents first">

        <p>Classes for looking at pages and their contents.</p>








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="playa.page.ContentObject" class="doc doc-heading">
            <code>ContentObject</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>Any sort of content object.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.ContentObject.gstate">gstate</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="playa.page.GraphicState" href="#playa.page.GraphicState">GraphicState</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Graphics state.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.ContentObject.ctm">ctm</span></code></td>
            <td>
                  <code><span title="playa.utils.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Coordinate transformation matrix (PDF 1.7 section 8.3.2).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.ContentObject.mcstack">mcstack</span></code></td>
            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="playa.page.MarkedContent" href="#playa.page.MarkedContent">MarkedContent</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Stack of enclosing marked content sections.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>playa/page.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ContentObject</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Any sort of content object.</span>

<span class="sd">    Attributes:</span>
<span class="sd">      gstate: Graphics state.</span>
<span class="sd">      ctm: Coordinate transformation matrix (PDF 1.7 section 8.3.2).</span>
<span class="sd">      mcstack: Stack of enclosing marked content sections.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">gstate</span><span class="p">:</span> <span class="n">GraphicState</span>
    <span class="n">ctm</span><span class="p">:</span> <span class="n">Matrix</span>
    <span class="n">mcstack</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">MarkedContent</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;ContentObject&quot;</span><span class="p">]:</span>
        <span class="k">yield from</span> <span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the number of children of this object (generic implementation).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">object_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Type of this object as a string, e.g. &quot;text&quot;, &quot;path&quot;, &quot;image&quot;.&quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="k">return</span> <span class="n">name</span><span class="p">[:</span> <span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="s2">&quot;Object&quot;</span><span class="p">)]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rect</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The bounding box in device space of this object.&quot;&quot;&quot;</span>
        <span class="c1"># These bboxes have already been computed in device space so</span>
        <span class="c1"># we don&#39;t need all 4 corners!</span>
        <span class="n">points</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
            <span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">))</span> <span class="k">for</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="ow">in</span> <span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">bbox</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">get_bound</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">mcs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">MarkedContent</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The immediately enclosing marked content section.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcstack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcstack</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">mcid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The marked content ID of the nearest enclosing marked</span>
<span class="sd">        content section with an ID.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">mcs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcstack</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">mcs</span><span class="o">.</span><span class="n">mcid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">mcs</span><span class="o">.</span><span class="n">mcid</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="playa.page.ContentObject.bbox" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bbox</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The bounding box in device space of this object.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.ContentObject.mcid" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mcid</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The marked content ID of the nearest enclosing marked
content section with an ID.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.ContentObject.mcs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mcs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The immediately enclosing marked content section.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.ContentObject.object_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">object_type</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Type of this object as a string, e.g. "text", "path", "image".</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="playa.page.ContentObject.__len__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return the number of children of this object (generic implementation).</p>

            <details class="quote">
              <summary>Source code in <code>playa/page.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the number of children of this object (generic implementation).&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.page.DashPattern" class="doc doc-heading">
            <code>DashPattern</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.NamedTuple">NamedTuple</span></code></p>


        <p>Line dash pattern in PDF graphics state (PDF 1.7 section 8.4.3.6).</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.DashPattern.dash">dash</span></code></td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[float, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>lengths of dashes and gaps in user space units</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.DashPattern.phase">phase</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>starting position in the dash pattern</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>playa/page.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DashPattern</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Line dash pattern in PDF graphics state (PDF 1.7 section 8.4.3.6).</span>

<span class="sd">    Attributes:</span>
<span class="sd">      dash: lengths of dashes and gaps in user space units</span>
<span class="sd">      phase: starting position in the dash pattern</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dash</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
    <span class="n">phase</span><span class="p">:</span> <span class="nb">float</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dash</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dash</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.page.GlyphObject" class="doc doc-heading">
            <code>GlyphObject</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="playa.page.ContentObject" href="#playa.page.ContentObject">ContentObject</a></code></p>


        <p>Individual glyph on the page.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.GlyphObject.textstate">textstate</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="playa.page.TextState" href="#playa.page.TextState">TextState</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Text state for this glyph.  This is a <strong>mutable</strong>
object and you should not expect it to be valid outside the
context of iteration over the parent <code>TextObject</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.GlyphObject.cid">cid</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Character ID for this glyph.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.GlyphObject.text">text</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[str, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unicode mapping of this glyph, if any.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.GlyphObject.adv">adv</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>glyph displacement in text space units (horizontal or vertical,
   depending on the writing direction).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.GlyphObject.matrix">matrix</span></code></td>
            <td>
                  <code><span title="playa.utils.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>rendering matrix for this glyph, which transforms text
      space (<em>not glyph space!</em>) coordinates to device space.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.GlyphObject.bbox">bbox</span></code></td>
            <td>
                  <code><span title="playa.utils.Rect">Rect</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>glyph bounding box in device space.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.GlyphObject.corners">corners</span></code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Is the transformed bounding box rotated or skewed such
       that all four corners need to be calculated (derived
       from matrix but precomputed for speed)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>playa/page.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">GlyphObject</span><span class="p">(</span><span class="n">ContentObject</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Individual glyph on the page.</span>

<span class="sd">    Attributes:</span>
<span class="sd">      textstate: Text state for this glyph.  This is a **mutable**</span>
<span class="sd">        object and you should not expect it to be valid outside the</span>
<span class="sd">        context of iteration over the parent `TextObject`.</span>
<span class="sd">      cid: Character ID for this glyph.</span>
<span class="sd">      text: Unicode mapping of this glyph, if any.</span>
<span class="sd">      adv: glyph displacement in text space units (horizontal or vertical,</span>
<span class="sd">           depending on the writing direction).</span>
<span class="sd">      matrix: rendering matrix for this glyph, which transforms text</span>
<span class="sd">              space (*not glyph space!*) coordinates to device space.</span>
<span class="sd">      bbox: glyph bounding box in device space.</span>
<span class="sd">      corners: Is the transformed bounding box rotated or skewed such</span>
<span class="sd">               that all four corners need to be calculated (derived</span>
<span class="sd">               from matrix but precomputed for speed)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">textstate</span><span class="p">:</span> <span class="n">TextState</span>
    <span class="n">cid</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">text</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">matrix</span><span class="p">:</span> <span class="n">Matrix</span>
    <span class="n">adv</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">corners</span><span class="p">:</span> <span class="nb">bool</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fool! You cannot iterate over a GlyphObject!&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rect</span><span class="p">:</span>
        <span class="n">tstate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">textstate</span>
        <span class="n">font</span> <span class="o">=</span> <span class="n">tstate</span><span class="o">.</span><span class="n">font</span>
        <span class="k">assert</span> <span class="n">font</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">font</span><span class="o">.</span><span class="n">vertical</span><span class="p">:</span>
            <span class="n">textdisp</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">char_disp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cid</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">textdisp</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
            <span class="p">(</span><span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">)</span> <span class="o">=</span> <span class="n">textdisp</span>
            <span class="k">if</span> <span class="n">vx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">vx</span> <span class="o">=</span> <span class="n">tstate</span><span class="o">.</span><span class="n">fontsize</span> <span class="o">*</span> <span class="mf">0.5</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">vx</span> <span class="o">=</span> <span class="n">vx</span> <span class="o">*</span> <span class="n">tstate</span><span class="o">.</span><span class="n">fontsize</span> <span class="o">*</span> <span class="mf">0.001</span>
            <span class="n">vy</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1000</span> <span class="o">-</span> <span class="n">vy</span><span class="p">)</span> <span class="o">*</span> <span class="n">tstate</span><span class="o">.</span><span class="n">fontsize</span> <span class="o">*</span> <span class="mf">0.001</span>
            <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">vx</span><span class="p">,</span> <span class="n">vy</span> <span class="o">+</span> <span class="n">tstate</span><span class="o">.</span><span class="n">rise</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">adv</span><span class="p">)</span>
            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">vx</span> <span class="o">+</span> <span class="n">tstate</span><span class="o">.</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">vy</span> <span class="o">+</span> <span class="n">tstate</span><span class="o">.</span><span class="n">rise</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tstate</span><span class="o">.</span><span class="n">descent</span> <span class="o">+</span> <span class="n">tstate</span><span class="o">.</span><span class="n">rise</span><span class="p">)</span>
            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">adv</span><span class="p">,</span> <span class="n">tstate</span><span class="o">.</span><span class="n">descent</span> <span class="o">+</span> <span class="n">tstate</span><span class="o">.</span><span class="n">rise</span> <span class="o">+</span> <span class="n">tstate</span><span class="o">.</span><span class="n">fontsize</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">corners</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">get_bound</span><span class="p">(</span>
                <span class="p">(</span>
                    <span class="n">apply_matrix_pt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">)),</span>
                    <span class="n">apply_matrix_pt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y1</span><span class="p">)),</span>
                    <span class="n">apply_matrix_pt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)),</span>
                    <span class="n">apply_matrix_pt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">)),</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">apply_matrix_pt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">))</span>
            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">apply_matrix_pt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">x1</span> <span class="o">&lt;</span> <span class="n">x0</span><span class="p">:</span>
                <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x0</span>
            <span class="k">if</span> <span class="n">y1</span> <span class="o">&lt;</span> <span class="n">y0</span><span class="p">:</span>
                <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y0</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="playa.page.GlyphObject.mcid" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mcid</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The marked content ID of the nearest enclosing marked
content section with an ID.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.GlyphObject.mcs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mcs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The immediately enclosing marked content section.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.GlyphObject.object_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">object_type</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Type of this object as a string, e.g. "text", "path", "image".</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="playa.page.GlyphObject.__len__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Fool! You cannot iterate over a GlyphObject!</p>

            <details class="quote">
              <summary>Source code in <code>playa/page.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fool! You cannot iterate over a GlyphObject!&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.page.GraphicState" class="doc doc-heading">
            <code>GraphicState</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>PDF Graphics state (PDF 1.7 section 8.4)</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.GraphicState.linewidth">linewidth</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Line width in user space units (sec. 8.4.3.2)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.GraphicState.linecap">linecap</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Line cap style (sec. 8.4.3.3)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.GraphicState.linejoin">linejoin</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Line join style (sec. 8.4.3.4)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.GraphicState.miterlimit">miterlimit</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum length of mitered line joins (sec. 8.4.3.5)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.GraphicState.dash">dash</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="playa.page.DashPattern" href="#playa.page.DashPattern">DashPattern</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dash pattern for stroking (sec 8.4.3.6)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.GraphicState.intent">intent</span></code></td>
            <td>
                  <code><span title="playa.pdftypes.PSLiteral">PSLiteral</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Rendering intent (sec. 8.6.5.8)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.GraphicState.flatness">flatness</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The precision with which curves shall be rendered on
the output device (sec. 10.6.2)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.GraphicState.scolor">scolor</span></code></td>
            <td>
                  <code><span title="playa.color.Color">Color</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Colour used for stroking operations</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.GraphicState.scs">scs</span></code></td>
            <td>
                  <code><span title="playa.color.ColorSpace">ColorSpace</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Colour space used for stroking operations</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.GraphicState.ncolor">ncolor</span></code></td>
            <td>
                  <code><span title="playa.color.Color">Color</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Colour used for non-stroking operations</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.GraphicState.scs">scs</span></code></td>
            <td>
                  <code><span title="playa.color.ColorSpace">ColorSpace</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Colour space used for non-stroking operations</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>playa/page.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">GraphicState</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;PDF Graphics state (PDF 1.7 section 8.4)</span>

<span class="sd">    Attributes:</span>
<span class="sd">      linewidth: Line width in user space units (sec. 8.4.3.2)</span>
<span class="sd">      linecap: Line cap style (sec. 8.4.3.3)</span>
<span class="sd">      linejoin: Line join style (sec. 8.4.3.4)</span>
<span class="sd">      miterlimit: Maximum length of mitered line joins (sec. 8.4.3.5)</span>
<span class="sd">      dash: Dash pattern for stroking (sec 8.4.3.6)</span>
<span class="sd">      intent: Rendering intent (sec. 8.6.5.8)</span>
<span class="sd">      flatness: The precision with which curves shall be rendered on</span>
<span class="sd">        the output device (sec. 10.6.2)</span>
<span class="sd">      scolor: Colour used for stroking operations</span>
<span class="sd">      scs: Colour space used for stroking operations</span>
<span class="sd">      ncolor: Colour used for non-stroking operations</span>
<span class="sd">      scs: Colour space used for non-stroking operations</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">linewidth</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">linecap</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">linejoin</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">miterlimit</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">dash</span><span class="p">:</span> <span class="n">DashPattern</span> <span class="o">=</span> <span class="n">DashPattern</span><span class="p">((),</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">intent</span><span class="p">:</span> <span class="n">PSLiteral</span> <span class="o">=</span> <span class="n">LITERAL_RELATIVE_COLORIMETRIC</span>
    <span class="n">flatness</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="c1"># stroking color</span>
    <span class="n">scolor</span><span class="p">:</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">BASIC_BLACK</span>
    <span class="c1"># stroking color space</span>
    <span class="n">scs</span><span class="p">:</span> <span class="n">ColorSpace</span> <span class="o">=</span> <span class="n">PREDEFINED_COLORSPACE</span><span class="p">[</span><span class="s2">&quot;DeviceGray&quot;</span><span class="p">]</span>
    <span class="c1"># non stroking color</span>
    <span class="n">ncolor</span><span class="p">:</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">BASIC_BLACK</span>
    <span class="c1"># non stroking color space</span>
    <span class="n">ncs</span><span class="p">:</span> <span class="n">ColorSpace</span> <span class="o">=</span> <span class="n">PREDEFINED_COLORSPACE</span><span class="p">[</span><span class="s2">&quot;DeviceGray&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.page.ImageObject" class="doc doc-heading">
            <code>ImageObject</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="playa.page.ContentObject" href="#playa.page.ContentObject">ContentObject</a></code></p>


        <p>An image (either inline or XObject).</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.ImageObject.xobjid">xobjid</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[str, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of XObject (or None for inline images).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.ImageObject.srcsize">srcsize</span></code></td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[int, int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Size of source image in pixels.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.ImageObject.bits">bits</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of bits per component, if required (otherwise 1).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.ImageObject.imagemask">imagemask</span></code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the image is a mask.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.ImageObject.stream">stream</span></code></td>
            <td>
                  <code><span title="playa.pdftypes.ContentStream">ContentStream</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Content stream with image data.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.ImageObject.colorspace">colorspace</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="playa.color.ColorSpace">ColorSpace</span>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Colour space for this image, if required (otherwise
None).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>playa/page.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ImageObject</span><span class="p">(</span><span class="n">ContentObject</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;An image (either inline or XObject).</span>

<span class="sd">    Attributes:</span>
<span class="sd">      xobjid: Name of XObject (or None for inline images).</span>
<span class="sd">      srcsize: Size of source image in pixels.</span>
<span class="sd">      bits: Number of bits per component, if required (otherwise 1).</span>
<span class="sd">      imagemask: True if the image is a mask.</span>
<span class="sd">      stream: Content stream with image data.</span>
<span class="sd">      colorspace: Colour space for this image, if required (otherwise</span>
<span class="sd">        None).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">xobjid</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">srcsize</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
    <span class="n">bits</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">imagemask</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">stream</span><span class="p">:</span> <span class="n">ContentStream</span>
    <span class="n">colorspace</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ColorSpace</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDFObject</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Even though you can __getitem__ from an image you cannot iterate</span>
<span class="sd">        over its keys, sorry about that.  Returns zero.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">buffer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Binary stream content for this image&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">buffer</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rect</span><span class="p">:</span>
        <span class="c1"># PDF 1.7 sec 8.3.24: All images shall be 1 unit wide by 1</span>
        <span class="c1"># unit high in user space, regardless of the number of samples</span>
        <span class="c1"># in the image. To be painted, an image shall be mapped to a</span>
        <span class="c1"># region of the page by temporarily altering the CTM.</span>
        <span class="k">return</span> <span class="n">get_transformed_bound</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="playa.page.ImageObject.buffer" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">buffer</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Binary stream content for this image</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.ImageObject.mcid" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mcid</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The marked content ID of the nearest enclosing marked
content section with an ID.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.ImageObject.mcs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mcs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The immediately enclosing marked content section.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.ImageObject.object_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">object_type</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Type of this object as a string, e.g. "text", "path", "image".</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="playa.page.ImageObject.__len__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Even though you can <strong>getitem</strong> from an image you cannot iterate
over its keys, sorry about that.  Returns zero.</p>

            <details class="quote">
              <summary>Source code in <code>playa/page.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Even though you can __getitem__ from an image you cannot iterate</span>
<span class="sd">    over its keys, sorry about that.  Returns zero.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.page.LayoutDict" class="doc doc-heading">
            <code>LayoutDict</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.TypedDict">TypedDict</span></code></p>


        <p>Dictionary-based layout objects.</p>


<details class="danger" open>
  <summary>Deprecated</summary>
  <p>This interface is deprecated and has been moved to
<a href="https://github.com/dhdaines/paves">PAVS</a>.  It will be
removed in PLAYA 0.3.</p>
</details>        <p>These are somewhat like the <code>T_obj</code> dictionaries returned by
pdfplumber.  The type of coordinates returned are determined by
the <code>space</code> argument passed to <code>Page</code>.  By default, <code>(0, 0)</code> is
the top-left corner of the page, with 72 units per inch.</p>
<p>All values can be converted to strings in some meaningful fashion,
such that you can simply write one of these to a CSV.  You can access
the field names through the <code>__annotations__</code> property:</p>
<pre><code>writer = DictWriter(fieldnames=LayoutDict.__annotations__.keys())
dictwriter.write_rows(writer)
</code></pre>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.object_type">object_type</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of object as a string.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.mcid">mcid</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[int, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Containing marked content section ID (or None if marked
content has no ID, such as artifacts or if there is no logical
structure).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.tag">tag</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[str, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Containing marked content tag name (or None if not in a marked
content section).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.xobjid">xobjid</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[str, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String name of containing Form XObject, if any.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.cid">cid</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Integer character ID of glyph, if <code>object_type == "char"</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.text">text</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[str, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unicode mapping for glyph, if any.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.fontname">fontname</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>str</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.size">size</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Font size in device space.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.glyph_offset_x">glyph_offset_x</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Horizontal offset (in device space) of glyph
from start of line.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.glyph_offset_y">glyph_offset_y</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Vertical offset (in device space) of glyph from
start of line.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.render_mode">render_mode</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Text rendering mode.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.upright">upright</span></code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>FIXME: Not really sure what this means.  pdfminer.six?</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.x0">x0</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum x coordinate of bounding box (top or bottom
depending on device space).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.x1">x1</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum x coordinate of bounding box (top or bottom
depending on device space).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.y0">y0</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum y coordinate of bounding box (left or right
depending on device space).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.x1">x1</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum x coordinate of bounding box (left or right
depending on device space).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.stroking_colorspace">stroking_colorspace</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String name of colour space for stroking
operations.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.stroking_color">stroking_color</span></code></td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[float, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Numeric parameters for stroking color.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.stroking_pattern">stroking_pattern</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[str, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of stroking pattern, if any.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.non_stroking_colorspace">non_stroking_colorspace</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String name of colour space for non-stroking
operations.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.non_stroking_color">non_stroking_color</span></code></td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[float, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Numeric parameters for non-stroking color.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.non_stroking_pattern">non_stroking_pattern</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[str, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of stroking pattern, if any.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.path_ops">path_ops</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sequence of path operations (e.g. <code>"mllh"</code> for a
triangle or <code>"mlllh"</code> for a quadrilateral)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.dash_pattern">dash_pattern</span></code></td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[float, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sequence of user space units for alternating
stroke and non-stroke segments of dash pattern, <code>()</code> for solid
line. (Cannot be in device space because this would depend on
which direction the line or curve is drawn).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.dash_phase">dash_phase</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial position in <code>dash_pattern</code> in user space
units.  (see above for why it's in user space)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.evenodd">evenodd</span></code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Was this path filled with Even-Odd (if <code>True</code>) or
Nonzero-Winding-Number rule (if <code>False</code>)?  Note that this is
<strong>meaningless</strong> for determining if a path is actually filled
since subpaths have already been decomposed.  If you really
care then use the lazy API instead.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.stroke">stroke</span></code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Is this path stroked?</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.fill">fill</span></code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Is this path filled?</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.linewidth">linewidth</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Line width in user space units (again, not possible
to transform to device space).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.pts_x">pts_x</span></code></td>
            <td>
                  <code><span title="typing.List">List</span>[float]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>X coordinates of path endpoints, one for each character
in <code>path_ops</code>.  This is optimized for CSV/DataFrame output, if
you care about the control points then use the lazy API.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.pts_y">pts_y</span></code></td>
            <td>
                  <code><span title="typing.List">List</span>[float]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Y coordinates of path endpoints, one for each character
in <code>path_ops</code>.  This is optimized for CSV/DataFrame output, if
you care about the control points then use the lazy API.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.stream">stream</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="typing.Tuple">Tuple</span>[int, int], None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Object number and generation number for the content
stream associated with an image, or <code>None</code> for inline images.
If you want image data then use the lazy API.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.imagemask">imagemask</span></code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Is this image a mask?</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.image_colorspace">image_colorspace</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="playa.color.ColorSpace">ColorSpace</span>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String description of image colour space, or
<code>None</code> if irrelevant/forbidden,</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.srcsize">srcsize</span></code></td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[int, int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Source dimensions of image in pixels.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.LayoutDict.bits">bits</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of bits per channel of image.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>playa/page.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">LayoutDict</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Dictionary-based layout objects.</span>

<span class="sd">    Danger: Deprecated</span>
<span class="sd">        This interface is deprecated and has been moved to</span>
<span class="sd">        [PAVS](https://github.com/dhdaines/paves).  It will be</span>
<span class="sd">        removed in PLAYA 0.3.</span>

<span class="sd">    These are somewhat like the `T_obj` dictionaries returned by</span>
<span class="sd">    pdfplumber.  The type of coordinates returned are determined by</span>
<span class="sd">    the `space` argument passed to `Page`.  By default, `(0, 0)` is</span>
<span class="sd">    the top-left corner of the page, with 72 units per inch.</span>

<span class="sd">    All values can be converted to strings in some meaningful fashion,</span>
<span class="sd">    such that you can simply write one of these to a CSV.  You can access</span>
<span class="sd">    the field names through the `__annotations__` property:</span>

<span class="sd">        writer = DictWriter(fieldnames=LayoutDict.__annotations__.keys())</span>
<span class="sd">        dictwriter.write_rows(writer)</span>

<span class="sd">    Attributes:</span>
<span class="sd">      object_type: Type of object as a string.</span>
<span class="sd">      mcid: Containing marked content section ID (or None if marked</span>
<span class="sd">        content has no ID, such as artifacts or if there is no logical</span>
<span class="sd">        structure).</span>
<span class="sd">      tag: Containing marked content tag name (or None if not in a marked</span>
<span class="sd">        content section).</span>
<span class="sd">      xobjid: String name of containing Form XObject, if any.</span>
<span class="sd">      cid: Integer character ID of glyph, if `object_type == &quot;char&quot;`.</span>
<span class="sd">      text: Unicode mapping for glyph, if any.</span>
<span class="sd">      fontname: str</span>
<span class="sd">      size: Font size in device space.</span>
<span class="sd">      glyph_offset_x: Horizontal offset (in device space) of glyph</span>
<span class="sd">        from start of line.</span>
<span class="sd">      glyph_offset_y: Vertical offset (in device space) of glyph from</span>
<span class="sd">        start of line.</span>
<span class="sd">      render_mode: Text rendering mode.</span>
<span class="sd">      upright: FIXME: Not really sure what this means.  pdfminer.six?</span>
<span class="sd">      x0: Minimum x coordinate of bounding box (top or bottom</span>
<span class="sd">        depending on device space).</span>
<span class="sd">      x1: Maximum x coordinate of bounding box (top or bottom</span>
<span class="sd">        depending on device space).</span>
<span class="sd">      y0: Minimum y coordinate of bounding box (left or right</span>
<span class="sd">        depending on device space).</span>
<span class="sd">      x1: Minimum x coordinate of bounding box (left or right</span>
<span class="sd">        depending on device space).</span>
<span class="sd">      stroking_colorspace: String name of colour space for stroking</span>
<span class="sd">        operations.</span>
<span class="sd">      stroking_color: Numeric parameters for stroking color.</span>
<span class="sd">      stroking_pattern: Name of stroking pattern, if any.</span>
<span class="sd">      non_stroking_colorspace: String name of colour space for non-stroking</span>
<span class="sd">        operations.</span>
<span class="sd">      non_stroking_color: Numeric parameters for non-stroking color.</span>
<span class="sd">      non_stroking_pattern: Name of stroking pattern, if any.</span>
<span class="sd">      path_ops: Sequence of path operations (e.g. `&quot;mllh&quot;` for a</span>
<span class="sd">        triangle or `&quot;mlllh&quot;` for a quadrilateral)</span>
<span class="sd">      dash_pattern: Sequence of user space units for alternating</span>
<span class="sd">        stroke and non-stroke segments of dash pattern, `()` for solid</span>
<span class="sd">        line. (Cannot be in device space because this would depend on</span>
<span class="sd">        which direction the line or curve is drawn).</span>
<span class="sd">      dash_phase: Initial position in `dash_pattern` in user space</span>
<span class="sd">        units.  (see above for why it&#39;s in user space)</span>
<span class="sd">      evenodd: Was this path filled with Even-Odd (if `True`) or</span>
<span class="sd">        Nonzero-Winding-Number rule (if `False`)?  Note that this is</span>
<span class="sd">        **meaningless** for determining if a path is actually filled</span>
<span class="sd">        since subpaths have already been decomposed.  If you really</span>
<span class="sd">        care then use the lazy API instead.</span>
<span class="sd">      stroke: Is this path stroked?</span>
<span class="sd">      fill: Is this path filled?</span>
<span class="sd">      linewidth: Line width in user space units (again, not possible</span>
<span class="sd">        to transform to device space).</span>
<span class="sd">      pts_x: X coordinates of path endpoints, one for each character</span>
<span class="sd">        in `path_ops`.  This is optimized for CSV/DataFrame output, if</span>
<span class="sd">        you care about the control points then use the lazy API.</span>
<span class="sd">      pts_y: Y coordinates of path endpoints, one for each character</span>
<span class="sd">        in `path_ops`.  This is optimized for CSV/DataFrame output, if</span>
<span class="sd">        you care about the control points then use the lazy API.</span>
<span class="sd">      stream: Object number and generation number for the content</span>
<span class="sd">        stream associated with an image, or `None` for inline images.</span>
<span class="sd">        If you want image data then use the lazy API.</span>
<span class="sd">      imagemask: Is this image a mask?</span>
<span class="sd">      image_colorspace: String description of image colour space, or</span>
<span class="sd">        `None` if irrelevant/forbidden,</span>
<span class="sd">      srcsize: Source dimensions of image in pixels.</span>
<span class="sd">      bits: Number of bits per channel of image.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">object_type</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">mcid</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">tag</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">xobjid</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">cid</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">text</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">fontname</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">size</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">glyph_offset_x</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">glyph_offset_y</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">render_mode</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">upright</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">x0</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">y0</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">x1</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">y1</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">stroking_colorspace</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">stroking_color</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
    <span class="n">stroking_pattern</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">non_stroking_colorspace</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">non_stroking_color</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
    <span class="n">non_stroking_pattern</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">path_ops</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">dash_pattern</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
    <span class="n">dash_phase</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">evenodd</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">stroke</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">fill</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">linewidth</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">pts_x</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
    <span class="n">pts_y</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
    <span class="n">stream</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">imagemask</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">image_colorspace</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ColorSpace</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">srcsize</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
    <span class="n">bits</span><span class="p">:</span> <span class="nb">int</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.page.MarkedContent" class="doc doc-heading">
            <code>MarkedContent</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.NamedTuple">NamedTuple</span></code></p>


        <p>Marked content point or section in a PDF page.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.MarkedContent.mcid">mcid</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[int, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Marked content section ID, or <code>None</code> for a marked content point.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.MarkedContent.tag">tag</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of tag for this marked content.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.MarkedContent.props">props</span></code></td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[str, <span title="playa.parser.PDFObject">PDFObject</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Marked content property dictionary.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>playa/page.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MarkedContent</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Marked content point or section in a PDF page.</span>

<span class="sd">    Attributes:</span>
<span class="sd">      mcid: Marked content section ID, or `None` for a marked content point.</span>
<span class="sd">      tag: Name of tag for this marked content.</span>
<span class="sd">      props: Marked content property dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">mcid</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">tag</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">props</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.page.Page" class="doc doc-heading">
            <code>Page</code>


</h3>


    <div class="doc doc-contents ">


        <p>An object that holds the information about a page.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>doc</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="playa.document.Document" href="#playa.document.Document">Document</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a Document object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pageid</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the integer PDF object ID associated with the page in the page tree.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>attrs</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a dictionary of page attributes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>label</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>page label string.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>page_idx</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>0-based index of the page in the document.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>space</code>
            </td>
            <td>
                  <code><span title="playa.page.DeviceSpace">DeviceSpace</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the device space to use for interpreting content</p>
              </div>
            </td>
            <td>
                  <code>&#39;screen&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.Page.pageid">pageid</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the integer object ID associated with the page in the page tree</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.Page.attrs">attrs</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a dictionary of page attributes.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.Page.resources">resources</span></code></td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[str, <span title="playa.parser.PDFObject">PDFObject</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a dictionary of resources used by the page.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.Page.mediabox">mediabox</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the physical size of the page.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.Page.cropbox">cropbox</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the crop rectangle of the page.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.Page.rotate">rotate</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the page rotation (in degree).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.Page.label">label</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the page's label (typically, the logical page number).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.Page.page_idx">page_idx</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>0-based index of the page in the document.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.Page.ctm">ctm</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>coordinate transformation matrix from default user space to
   page's device space</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>playa/page.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Page</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;An object that holds the information about a page.</span>

<span class="sd">    Args:</span>
<span class="sd">      doc: a Document object.</span>
<span class="sd">      pageid: the integer PDF object ID associated with the page in the page tree.</span>
<span class="sd">      attrs: a dictionary of page attributes.</span>
<span class="sd">      label: page label string.</span>
<span class="sd">      page_idx: 0-based index of the page in the document.</span>
<span class="sd">      space: the device space to use for interpreting content</span>

<span class="sd">    Attributes:</span>
<span class="sd">      pageid: the integer object ID associated with the page in the page tree</span>
<span class="sd">      attrs: a dictionary of page attributes.</span>
<span class="sd">      resources: a dictionary of resources used by the page.</span>
<span class="sd">      mediabox: the physical size of the page.</span>
<span class="sd">      cropbox: the crop rectangle of the page.</span>
<span class="sd">      rotate: the page rotation (in degree).</span>
<span class="sd">      label: the page&#39;s label (typically, the logical page number).</span>
<span class="sd">      page_idx: 0-based index of the page in the document.</span>
<span class="sd">      ctm: coordinate transformation matrix from default user space to</span>
<span class="sd">           page&#39;s device space</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">doc</span><span class="p">:</span> <span class="s2">&quot;Document&quot;</span><span class="p">,</span>
        <span class="n">pageid</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">attrs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
        <span class="n">label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">page_idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">space</span><span class="p">:</span> <span class="n">DeviceSpace</span> <span class="o">=</span> <span class="s2">&quot;screen&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">docref</span> <span class="o">=</span> <span class="n">_ref_document</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pageid</span> <span class="o">=</span> <span class="n">pageid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="n">attrs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">page_idx</span> <span class="o">=</span> <span class="n">page_idx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">space</span> <span class="o">=</span> <span class="n">space</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lastmod</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;LastModified&quot;</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">]</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Resources&quot;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Resources missing or invalid from Page id </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pageid</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resources</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="s2">&quot;MediaBox&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mediabox</span> <span class="o">=</span> <span class="n">normalize_rect</span><span class="p">(</span><span class="n">parse_rect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;MediaBox&quot;</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;MediaBox missing from Page id </span><span class="si">%d</span><span class="s2"> (and not inherited),&quot;</span>
                <span class="s2">&quot; defaulting to US Letter (612x792)&quot;</span><span class="p">,</span>
                <span class="n">pageid</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mediabox</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">612</span><span class="p">,</span> <span class="mi">792</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cropbox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mediabox</span>
        <span class="k">if</span> <span class="s2">&quot;CropBox&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cropbox</span> <span class="o">=</span> <span class="n">normalize_rect</span><span class="p">(</span><span class="n">parse_rect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;CropBox&quot;</span><span class="p">]))</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Invalid CropBox in /Page, defaulting to MediaBox&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rotate</span> <span class="o">=</span> <span class="p">(</span><span class="n">int_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Rotate&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="o">+</span> <span class="mi">360</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
        <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mediabox</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span>
        <span class="c1"># PDF 1.7 section 8.4.1: Initial value: a matrix that</span>
        <span class="c1"># transforms default user coordinates to device coordinates.</span>
        <span class="c1">#</span>
        <span class="c1"># We keep this as `self.ctm` in order to transform layout</span>
        <span class="c1"># attributes in tagged PDFs which are specified in default</span>
        <span class="c1"># user space (PDF 1.7 section 14.8.5.4.3, table 344)</span>
        <span class="c1">#</span>
        <span class="c1"># &quot;screen&quot; device space: origin is top left of MediaBox</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span> <span class="o">==</span> <span class="s2">&quot;screen&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="n">x0</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
        <span class="c1"># &quot;page&quot; device space: origin is bottom left of MediaBox</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span> <span class="o">==</span> <span class="s2">&quot;page&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="n">x0</span><span class="p">,</span> <span class="o">-</span><span class="n">y0</span><span class="p">)</span>
        <span class="c1"># &quot;default&quot; device space: no transformation or rotation</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span> <span class="o">==</span> <span class="s2">&quot;user&quot;</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;&quot;user&quot; device space is deprecated, use &quot;default&quot; instead&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span> <span class="o">!=</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Unknown device space: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="o">=</span> <span class="n">MATRIX_IDENTITY</span>
            <span class="n">width</span> <span class="o">=</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># If rotation is requested, apply rotation to the initial ctm</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate</span> <span class="o">==</span> <span class="mi">90</span><span class="p">:</span>
            <span class="c1"># x&#39; = y</span>
            <span class="c1"># y&#39; = width - x</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="o">=</span> <span class="n">mult_matrix</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate</span> <span class="o">==</span> <span class="mi">180</span><span class="p">:</span>
            <span class="c1"># x&#39; = width - x</span>
            <span class="c1"># y&#39; = height - y</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="o">=</span> <span class="n">mult_matrix</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate</span> <span class="o">==</span> <span class="mi">270</span><span class="p">:</span>
            <span class="c1"># x&#39; = height - y</span>
            <span class="c1"># y&#39; = x</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="o">=</span> <span class="n">mult_matrix</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Invalid /Rotate: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">annots</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Annots&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beads</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;B&quot;</span><span class="p">)</span>
        <span class="n">contents</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Contents&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">contents</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_contents</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">contents</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_contents</span> <span class="o">=</span> <span class="n">contents</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_contents</span> <span class="o">=</span> <span class="p">[</span><span class="n">contents</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">doc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Document&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get associated document if it exists.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">docref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">_deref_document</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">docref</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">streams</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">ContentStream</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return resolved content streams.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contents</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">stream_value</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">width</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Width of the page in default user space units.&quot;&quot;&quot;</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mediabox</span>
        <span class="k">return</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">height</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Width of the page in default user space units.&quot;&quot;&quot;</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mediabox</span>
        <span class="k">return</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">contents</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">PDFObject</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterator over PDF objects in the content streams.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">ContentParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_contents</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">obj</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;ContentObject&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterator over lazy layout objects.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="n">LazyInterpreter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contents</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">paths</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;PathObject&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterator over lazy path objects.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">obj</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">PathObject</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">images</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;ImageObject&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterator over lazy image objects.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">obj</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">ImageObject</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">texts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;TextObject&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterator over lazy text objects.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">obj</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">TextObject</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">xobjects</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;XObjectObject&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return resolved and rendered Form XObjects.</span>

<span class="sd">        This does *not* return any image or PostScript XObjects.  You</span>
<span class="sd">        can get images via the `images` property.  Apparently you</span>
<span class="sd">        aren&#39;t supposed to use PostScript XObjects for anything, ever.</span>

<span class="sd">        Note that these are the XObjects as rendered on the page, so</span>
<span class="sd">        you may see the same named XObject multiple times.  If you</span>
<span class="sd">        need to access their actual definitions you&#39;ll have to look at</span>
<span class="sd">        `page.resources`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">obj</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">XObjectObject</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">layout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;LayoutDict&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterator over eager layout object dictionaries.</span>

<span class="sd">        Danger: Deprecated</span>
<span class="sd">            This interface is deprecated and has been moved to</span>
<span class="sd">            [PAVS](https://github.com/dhdaines/paves).  It will be</span>
<span class="sd">            removed in PLAYA 0.3.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;The layout property has moved to PAVS (https://github.com/dhdaines/paves)&quot;</span>
            <span class="s2">&quot; and will be removed in PLAYA 0.3&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="n">PageInterpreter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contents</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Token</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterator over tokens in the content streams.&quot;&quot;&quot;</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">ContentParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_contents</span><span class="p">)</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">pos</span><span class="p">,</span> <span class="n">tok</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">nexttoken</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="k">yield</span> <span class="n">tok</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">structtree</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StructTree</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the PDF structure tree.&quot;&quot;&quot;</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="n">_deref_document</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">docref</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">StructTree</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="p">,))</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;Page: Resources=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="si">!r}</span><span class="s2">, MediaBox=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mediabox</span><span class="si">!r}</span><span class="s2">&gt;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="playa.page.Page.contents" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">contents</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterator over PDF objects in the content streams.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.Page.doc" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">doc</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Get associated document if it exists.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.Page.height" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">height</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Width of the page in default user space units.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.Page.images" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">images</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterator over lazy image objects.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.Page.layout" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">layout</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterator over eager layout object dictionaries.</p>


<details class="danger" open>
  <summary>Deprecated</summary>
  <p>This interface is deprecated and has been moved to
<a href="https://github.com/dhdaines/paves">PAVS</a>.  It will be
removed in PLAYA 0.3.</p>
</details>    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.Page.paths" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">paths</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterator over lazy path objects.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.Page.streams" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">streams</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Return resolved content streams.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.Page.structtree" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">structtree</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Return the PDF structure tree.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.Page.texts" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">texts</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterator over lazy text objects.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.Page.tokens" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tokens</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterator over tokens in the content streams.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.Page.width" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">width</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Width of the page in default user space units.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.Page.xobjects" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">xobjects</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Return resolved and rendered Form XObjects.</p>
<p>This does <em>not</em> return any image or PostScript XObjects.  You
can get images via the <code>images</code> property.  Apparently you
aren't supposed to use PostScript XObjects for anything, ever.</p>
<p>Note that these are the XObjects as rendered on the page, so
you may see the same named XObject multiple times.  If you
need to access their actual definitions you'll have to look at
<code>page.resources</code>.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="playa.page.Page.__iter__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__iter__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Iterator over lazy layout objects.</p>

            <details class="quote">
              <summary>Source code in <code>playa/page.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;ContentObject&quot;</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterator over lazy layout objects.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="n">LazyInterpreter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contents</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.page.PathObject" class="doc doc-heading">
            <code>PathObject</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="playa.page.ContentObject" href="#playa.page.ContentObject">ContentObject</a></code></p>


        <p>A path object.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.PathObject.raw_segments">raw_segments</span></code></td>
            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="playa.page.PathSegment" href="#playa.page.PathSegment">PathSegment</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Segments in path (in user space).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.PathObject.stroke">stroke</span></code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the outline of the path is stroked.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.PathObject.fill">fill</span></code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the path is filled.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.PathObject.evenodd">evenodd</span></code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the filling of complex paths uses the even-odd
winding rule, False if the non-zero winding number rule is
used (PDF 1.7 section 8.5.3.3)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>playa/page.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">PathObject</span><span class="p">(</span><span class="n">ContentObject</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A path object.</span>

<span class="sd">    Attributes:</span>
<span class="sd">      raw_segments: Segments in path (in user space).</span>
<span class="sd">      stroke: True if the outline of the path is stroked.</span>
<span class="sd">      fill: True if the path is filled.</span>
<span class="sd">      evenodd: True if the filling of complex paths uses the even-odd</span>
<span class="sd">        winding rule, False if the non-zero winding number rule is</span>
<span class="sd">        used (PDF 1.7 section 8.5.3.3)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">raw_segments</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PathSegment</span><span class="p">]</span>
    <span class="n">stroke</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">fill</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">evenodd</span><span class="p">:</span> <span class="nb">bool</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of subpaths.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">seg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_segments</span> <span class="k">if</span> <span class="n">seg</span><span class="o">.</span><span class="n">operator</span> <span class="o">==</span> <span class="s2">&quot;m&quot;</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over subpaths.</span>

<span class="sd">        If there is only a single subpath, it will still be iterated</span>
<span class="sd">        over.  This means that some care must be taken (for example,</span>
<span class="sd">        checking if `len(path) == 1`) to avoid endless recursion.</span>

<span class="sd">        Note: subpaths inherit the values of `fill` and `evenodd` from</span>
<span class="sd">        the parent path, but these values are no longer meaningful</span>
<span class="sd">        since the winding rules must be applied to the composite path</span>
<span class="sd">        as a whole (this is not a bug, just don&#39;t rely on them to know</span>
<span class="sd">        which regions are filled or not).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># FIXME: Is there an itertool or a more_itertool for this?</span>
        <span class="n">segs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">seg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_segments</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">seg</span><span class="o">.</span><span class="n">operator</span> <span class="o">==</span> <span class="s2">&quot;m&quot;</span> <span class="ow">and</span> <span class="n">segs</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">PathObject</span><span class="p">(</span>
                    <span class="n">gstate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="p">,</span>
                    <span class="n">ctm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">,</span>
                    <span class="n">mcstack</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mcstack</span><span class="p">,</span>
                    <span class="n">raw_segments</span><span class="o">=</span><span class="n">segs</span><span class="p">,</span>
                    <span class="n">stroke</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stroke</span><span class="p">,</span>
                    <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill</span><span class="p">,</span>
                    <span class="n">evenodd</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">evenodd</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">segs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">segs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">seg</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">segs</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">PathObject</span><span class="p">(</span>
                <span class="n">gstate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="p">,</span>
                <span class="n">ctm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">,</span>
                <span class="n">mcstack</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mcstack</span><span class="p">,</span>
                <span class="n">raw_segments</span><span class="o">=</span><span class="n">segs</span><span class="p">,</span>
                <span class="n">stroke</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stroke</span><span class="p">,</span>
                <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill</span><span class="p">,</span>
                <span class="n">evenodd</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">evenodd</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">segments</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">PathSegment</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get path segments in device space.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">PathSegment</span><span class="p">(</span>
                <span class="n">p</span><span class="o">.</span><span class="n">operator</span><span class="p">,</span>
                <span class="nb">tuple</span><span class="p">(</span><span class="n">apply_matrix_pt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">,</span> <span class="n">point</span><span class="p">)</span> <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">points</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_segments</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rect</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get bounding box of path in device space as defined by its</span>
<span class="sd">        points and control points.&quot;&quot;&quot;</span>
        <span class="c1"># First get the bounding box in user space (fast)</span>
        <span class="n">bbox</span> <span class="o">=</span> <span class="n">get_bound</span><span class="p">(</span>
            <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">points</span> <span class="k">for</span> <span class="n">seg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_segments</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="c1"># Transform it and get the new bounding box</span>
        <span class="k">return</span> <span class="n">get_transformed_bound</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">,</span> <span class="n">bbox</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="playa.page.PathObject.bbox" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bbox</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Get bounding box of path in device space as defined by its
points and control points.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.PathObject.mcid" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mcid</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The marked content ID of the nearest enclosing marked
content section with an ID.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.PathObject.mcs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mcs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The immediately enclosing marked content section.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.PathObject.object_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">object_type</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Type of this object as a string, e.g. "text", "path", "image".</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.PathObject.segments" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">segments</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Get path segments in device space.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="playa.page.PathObject.__iter__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__iter__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Iterate over subpaths.</p>
<p>If there is only a single subpath, it will still be iterated
over.  This means that some care must be taken (for example,
checking if <code>len(path) == 1</code>) to avoid endless recursion.</p>
<p>Note: subpaths inherit the values of <code>fill</code> and <code>evenodd</code> from
the parent path, but these values are no longer meaningful
since the winding rules must be applied to the composite path
as a whole (this is not a bug, just don't rely on them to know
which regions are filled or not).</p>

            <details class="quote">
              <summary>Source code in <code>playa/page.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterate over subpaths.</span>

<span class="sd">    If there is only a single subpath, it will still be iterated</span>
<span class="sd">    over.  This means that some care must be taken (for example,</span>
<span class="sd">    checking if `len(path) == 1`) to avoid endless recursion.</span>

<span class="sd">    Note: subpaths inherit the values of `fill` and `evenodd` from</span>
<span class="sd">    the parent path, but these values are no longer meaningful</span>
<span class="sd">    since the winding rules must be applied to the composite path</span>
<span class="sd">    as a whole (this is not a bug, just don&#39;t rely on them to know</span>
<span class="sd">    which regions are filled or not).</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># FIXME: Is there an itertool or a more_itertool for this?</span>
    <span class="n">segs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">seg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_segments</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">seg</span><span class="o">.</span><span class="n">operator</span> <span class="o">==</span> <span class="s2">&quot;m&quot;</span> <span class="ow">and</span> <span class="n">segs</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">PathObject</span><span class="p">(</span>
                <span class="n">gstate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="p">,</span>
                <span class="n">ctm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">,</span>
                <span class="n">mcstack</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mcstack</span><span class="p">,</span>
                <span class="n">raw_segments</span><span class="o">=</span><span class="n">segs</span><span class="p">,</span>
                <span class="n">stroke</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stroke</span><span class="p">,</span>
                <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill</span><span class="p">,</span>
                <span class="n">evenodd</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">evenodd</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">segs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">segs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">seg</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">segs</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">PathObject</span><span class="p">(</span>
            <span class="n">gstate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="p">,</span>
            <span class="n">ctm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">,</span>
            <span class="n">mcstack</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mcstack</span><span class="p">,</span>
            <span class="n">raw_segments</span><span class="o">=</span><span class="n">segs</span><span class="p">,</span>
            <span class="n">stroke</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stroke</span><span class="p">,</span>
            <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill</span><span class="p">,</span>
            <span class="n">evenodd</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">evenodd</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.page.PathObject.__len__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Number of subpaths.</p>

            <details class="quote">
              <summary>Source code in <code>playa/page.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Number of subpaths.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">seg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_segments</span> <span class="k">if</span> <span class="n">seg</span><span class="o">.</span><span class="n">operator</span> <span class="o">==</span> <span class="s2">&quot;m&quot;</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.page.PathSegment" class="doc doc-heading">
            <code>PathSegment</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.NamedTuple">NamedTuple</span></code></p>


        <p>Segment in a PDF graphics path.</p>






              <details class="quote">
                <summary>Source code in <code>playa/page.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PathSegment</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Segment in a PDF graphics path.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">operator</span><span class="p">:</span> <span class="n">PathOperator</span>
    <span class="n">points</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Point</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.page.TagObject" class="doc doc-heading">
            <code>TagObject</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="playa.page.ContentObject" href="#playa.page.ContentObject">ContentObject</a></code></p>


        <p>A marked content tag..</p>






              <details class="quote">
                <summary>Source code in <code>playa/page.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TagObject</span><span class="p">(</span><span class="n">ContentObject</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A marked content tag..&quot;&quot;&quot;</span>

    <span class="n">_mcs</span><span class="p">:</span> <span class="n">MarkedContent</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A tag has no contents, iterating over it returns nothing.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">mcs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">MarkedContent</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The marked content tag for this object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mcs</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">mcid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The marked content ID of the nearest enclosing marked</span>
<span class="sd">        content section with an ID.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mcs</span><span class="o">.</span><span class="n">mcid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mcs</span><span class="o">.</span><span class="n">mcid</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">mcid</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rect</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A tag has no content and thus no bounding box.</span>

<span class="sd">        To avoid needlessly complicating user code this returns</span>
<span class="sd">        `BBOX_NONE` instead of `None` or throwing a exception.</span>
<span class="sd">        Because that is a specific object, you can reliably check for</span>
<span class="sd">        it with:</span>

<span class="sd">            if obj.bbox is BBOX_NONE:</span>
<span class="sd">                ...</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">BBOX_NONE</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="playa.page.TagObject.bbox" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bbox</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>A tag has no content and thus no bounding box.</p>
<p>To avoid needlessly complicating user code this returns
<code>BBOX_NONE</code> instead of <code>None</code> or throwing a exception.
Because that is a specific object, you can reliably check for
it with:</p>
<pre><code>if obj.bbox is BBOX_NONE:
    ...
</code></pre>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.TagObject.mcid" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mcid</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The marked content ID of the nearest enclosing marked
content section with an ID.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.TagObject.mcs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mcs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The marked content tag for this object.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.TagObject.object_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">object_type</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Type of this object as a string, e.g. "text", "path", "image".</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="playa.page.TagObject.__len__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>A tag has no contents, iterating over it returns nothing.</p>

            <details class="quote">
              <summary>Source code in <code>playa/page.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A tag has no contents, iterating over it returns nothing.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.page.TextObject" class="doc doc-heading">
            <code>TextObject</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="playa.page.ContentObject" href="#playa.page.ContentObject">ContentObject</a></code></p>


        <p>Text object (contains one or more glyphs).</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.TextObject.textstate">textstate</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="playa.page.TextState" href="#playa.page.TextState">TextState</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Text state for this object.  This is a <strong>mutable</strong>
object and you should not expect it to be valid outside the
context of iteration over the parent <code>TextObject</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.TextObject.args">args</span></code></td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Union">Union</span>[bytes, float]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Strings or position adjustments</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>playa/page.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span>
<span class="normal">2074</span>
<span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span>
<span class="normal">2082</span>
<span class="normal">2083</span>
<span class="normal">2084</span>
<span class="normal">2085</span>
<span class="normal">2086</span>
<span class="normal">2087</span>
<span class="normal">2088</span>
<span class="normal">2089</span>
<span class="normal">2090</span>
<span class="normal">2091</span>
<span class="normal">2092</span>
<span class="normal">2093</span>
<span class="normal">2094</span>
<span class="normal">2095</span>
<span class="normal">2096</span>
<span class="normal">2097</span>
<span class="normal">2098</span>
<span class="normal">2099</span>
<span class="normal">2100</span>
<span class="normal">2101</span>
<span class="normal">2102</span>
<span class="normal">2103</span>
<span class="normal">2104</span>
<span class="normal">2105</span>
<span class="normal">2106</span>
<span class="normal">2107</span>
<span class="normal">2108</span>
<span class="normal">2109</span>
<span class="normal">2110</span>
<span class="normal">2111</span>
<span class="normal">2112</span>
<span class="normal">2113</span>
<span class="normal">2114</span>
<span class="normal">2115</span>
<span class="normal">2116</span>
<span class="normal">2117</span>
<span class="normal">2118</span>
<span class="normal">2119</span>
<span class="normal">2120</span>
<span class="normal">2121</span>
<span class="normal">2122</span>
<span class="normal">2123</span>
<span class="normal">2124</span>
<span class="normal">2125</span>
<span class="normal">2126</span>
<span class="normal">2127</span>
<span class="normal">2128</span>
<span class="normal">2129</span>
<span class="normal">2130</span>
<span class="normal">2131</span>
<span class="normal">2132</span>
<span class="normal">2133</span>
<span class="normal">2134</span>
<span class="normal">2135</span>
<span class="normal">2136</span>
<span class="normal">2137</span>
<span class="normal">2138</span>
<span class="normal">2139</span>
<span class="normal">2140</span>
<span class="normal">2141</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TextObject</span><span class="p">(</span><span class="n">ContentObject</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Text object (contains one or more glyphs).</span>

<span class="sd">    Attributes:</span>
<span class="sd">      textstate: Text state for this object.  This is a **mutable**</span>
<span class="sd">        object and you should not expect it to be valid outside the</span>
<span class="sd">        context of iteration over the parent `TextObject`.</span>
<span class="sd">      args: Strings or position adjustments</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">textstate</span><span class="p">:</span> <span class="n">TextState</span>
    <span class="n">args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span>
    <span class="n">_chars</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">GlyphObject</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate glyphs for this text object&quot;&quot;&quot;</span>
        <span class="n">tstate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">textstate</span>
        <span class="n">font</span> <span class="o">=</span> <span class="n">tstate</span><span class="o">.</span><span class="n">font</span>
        <span class="c1"># If no font is set, we cannot do anything, since even calling</span>
        <span class="c1"># TJ with a displacement and no text effects requires us at</span>
        <span class="c1"># least to know the fontsize.</span>
        <span class="k">if</span> <span class="n">font</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;No font is set, will not update text state or output text: </span><span class="si">%r</span><span class="s2"> TJ&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="c1"># Extract all the elements so we can translate efficiently</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="n">mult_matrix</span><span class="p">(</span><span class="n">tstate</span><span class="o">.</span><span class="n">line_matrix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">)</span>
        <span class="c1"># Pre-determine if we need to recompute the bound for rotated glyphs</span>
        <span class="n">corners</span> <span class="o">=</span> <span class="n">b</span> <span class="o">*</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">a</span> <span class="o">*</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="mi">0</span>
        <span class="c1"># Apply horizontal scaling</span>
        <span class="n">scaling</span> <span class="o">=</span> <span class="n">tstate</span><span class="o">.</span><span class="n">scaling</span> <span class="o">*</span> <span class="mf">0.01</span>
        <span class="n">charspace</span> <span class="o">=</span> <span class="n">tstate</span><span class="o">.</span><span class="n">charspace</span> <span class="o">*</span> <span class="n">scaling</span>
        <span class="n">wordspace</span> <span class="o">=</span> <span class="n">tstate</span><span class="o">.</span><span class="n">wordspace</span> <span class="o">*</span> <span class="n">scaling</span>
        <span class="n">vert</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">vertical</span>
        <span class="k">if</span> <span class="n">font</span><span class="o">.</span><span class="n">multibyte</span><span class="p">:</span>
            <span class="n">wordspace</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">tstate</span><span class="o">.</span><span class="n">glyph_offset</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">y</span> <span class="k">if</span> <span class="n">vert</span> <span class="k">else</span> <span class="n">x</span>
        <span class="n">needcharspace</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
                <span class="n">dxscale</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="o">*</span> <span class="n">tstate</span><span class="o">.</span><span class="n">fontsize</span> <span class="o">*</span> <span class="n">scaling</span>
                <span class="n">pos</span> <span class="o">-=</span> <span class="n">obj</span> <span class="o">*</span> <span class="n">dxscale</span>
                <span class="n">needcharspace</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">cid</span><span class="p">,</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">font</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">needcharspace</span><span class="p">:</span>
                        <span class="n">pos</span> <span class="o">+=</span> <span class="n">charspace</span>
                    <span class="n">tstate</span><span class="o">.</span><span class="n">glyph_offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span> <span class="k">if</span> <span class="n">vert</span> <span class="k">else</span> <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
                    <span class="n">textwidth</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">char_width</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span>
                    <span class="n">adv</span> <span class="o">=</span> <span class="n">textwidth</span> <span class="o">*</span> <span class="n">tstate</span><span class="o">.</span><span class="n">fontsize</span> <span class="o">*</span> <span class="n">scaling</span>
                    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">tstate</span><span class="o">.</span><span class="n">glyph_offset</span>
                    <span class="n">glyph</span> <span class="o">=</span> <span class="n">GlyphObject</span><span class="p">(</span>
                        <span class="n">gstate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="p">,</span>
                        <span class="n">ctm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">,</span>
                        <span class="n">mcstack</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mcstack</span><span class="p">,</span>
                        <span class="n">textstate</span><span class="o">=</span><span class="n">tstate</span><span class="p">,</span>
                        <span class="n">cid</span><span class="o">=</span><span class="n">cid</span><span class="p">,</span>
                        <span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span>
                        <span class="c1"># Do pre-translation internally (taking rotation into account)</span>
                        <span class="n">matrix</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">x</span> <span class="o">*</span> <span class="n">a</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="n">c</span> <span class="o">+</span> <span class="n">e</span><span class="p">,</span> <span class="n">x</span> <span class="o">*</span> <span class="n">b</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="n">d</span> <span class="o">+</span> <span class="n">f</span><span class="p">),</span>
                        <span class="n">adv</span><span class="o">=</span><span class="n">adv</span><span class="p">,</span>
                        <span class="n">corners</span><span class="o">=</span><span class="n">corners</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="k">yield</span> <span class="n">glyph</span>
                    <span class="n">pos</span> <span class="o">+=</span> <span class="n">adv</span>
                    <span class="k">if</span> <span class="n">cid</span> <span class="o">==</span> <span class="mi">32</span> <span class="ow">and</span> <span class="n">wordspace</span><span class="p">:</span>
                        <span class="n">pos</span> <span class="o">+=</span> <span class="n">wordspace</span>
                    <span class="n">needcharspace</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">tstate</span><span class="o">.</span><span class="n">glyph_offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span> <span class="k">if</span> <span class="n">vert</span> <span class="k">else</span> <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">chars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the Unicode characters (in stream order) for this object.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_chars</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_chars</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_chars</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">font</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">textstate</span><span class="o">.</span><span class="n">font</span>
        <span class="k">assert</span> <span class="n">font</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;No font was selected&quot;</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">for</span> <span class="n">cid</span><span class="p">,</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">font</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_chars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_chars</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the number of glyphs that would result from iterating over</span>
<span class="sd">        this object.</span>

<span class="sd">        Important: this is the number of glyphs, *not* the number of</span>
<span class="sd">        Unicode characters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nglyphs</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">font</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">textstate</span><span class="o">.</span><span class="n">font</span>
        <span class="k">assert</span> <span class="n">font</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;No font was selected&quot;</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">nglyphs</span> <span class="o">+=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">font</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">nglyphs</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="playa.page.TextObject.bbox" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bbox</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The bounding box in device space of this object.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.TextObject.chars" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">chars</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Get the Unicode characters (in stream order) for this object.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.TextObject.mcid" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mcid</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The marked content ID of the nearest enclosing marked
content section with an ID.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.TextObject.mcs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mcs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The immediately enclosing marked content section.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.TextObject.object_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">object_type</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Type of this object as a string, e.g. "text", "path", "image".</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="playa.page.TextObject.__iter__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__iter__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Generate glyphs for this text object</p>

            <details class="quote">
              <summary>Source code in <code>playa/page.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span>
<span class="normal">2074</span>
<span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span>
<span class="normal">2082</span>
<span class="normal">2083</span>
<span class="normal">2084</span>
<span class="normal">2085</span>
<span class="normal">2086</span>
<span class="normal">2087</span>
<span class="normal">2088</span>
<span class="normal">2089</span>
<span class="normal">2090</span>
<span class="normal">2091</span>
<span class="normal">2092</span>
<span class="normal">2093</span>
<span class="normal">2094</span>
<span class="normal">2095</span>
<span class="normal">2096</span>
<span class="normal">2097</span>
<span class="normal">2098</span>
<span class="normal">2099</span>
<span class="normal">2100</span>
<span class="normal">2101</span>
<span class="normal">2102</span>
<span class="normal">2103</span>
<span class="normal">2104</span>
<span class="normal">2105</span>
<span class="normal">2106</span>
<span class="normal">2107</span>
<span class="normal">2108</span>
<span class="normal">2109</span>
<span class="normal">2110</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">GlyphObject</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate glyphs for this text object&quot;&quot;&quot;</span>
    <span class="n">tstate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">textstate</span>
    <span class="n">font</span> <span class="o">=</span> <span class="n">tstate</span><span class="o">.</span><span class="n">font</span>
    <span class="c1"># If no font is set, we cannot do anything, since even calling</span>
    <span class="c1"># TJ with a displacement and no text effects requires us at</span>
    <span class="c1"># least to know the fontsize.</span>
    <span class="k">if</span> <span class="n">font</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;No font is set, will not update text state or output text: </span><span class="si">%r</span><span class="s2"> TJ&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="c1"># Extract all the elements so we can translate efficiently</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="n">mult_matrix</span><span class="p">(</span><span class="n">tstate</span><span class="o">.</span><span class="n">line_matrix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">)</span>
    <span class="c1"># Pre-determine if we need to recompute the bound for rotated glyphs</span>
    <span class="n">corners</span> <span class="o">=</span> <span class="n">b</span> <span class="o">*</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">a</span> <span class="o">*</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="mi">0</span>
    <span class="c1"># Apply horizontal scaling</span>
    <span class="n">scaling</span> <span class="o">=</span> <span class="n">tstate</span><span class="o">.</span><span class="n">scaling</span> <span class="o">*</span> <span class="mf">0.01</span>
    <span class="n">charspace</span> <span class="o">=</span> <span class="n">tstate</span><span class="o">.</span><span class="n">charspace</span> <span class="o">*</span> <span class="n">scaling</span>
    <span class="n">wordspace</span> <span class="o">=</span> <span class="n">tstate</span><span class="o">.</span><span class="n">wordspace</span> <span class="o">*</span> <span class="n">scaling</span>
    <span class="n">vert</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">vertical</span>
    <span class="k">if</span> <span class="n">font</span><span class="o">.</span><span class="n">multibyte</span><span class="p">:</span>
        <span class="n">wordspace</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">tstate</span><span class="o">.</span><span class="n">glyph_offset</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">y</span> <span class="k">if</span> <span class="n">vert</span> <span class="k">else</span> <span class="n">x</span>
    <span class="n">needcharspace</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="n">dxscale</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="o">*</span> <span class="n">tstate</span><span class="o">.</span><span class="n">fontsize</span> <span class="o">*</span> <span class="n">scaling</span>
            <span class="n">pos</span> <span class="o">-=</span> <span class="n">obj</span> <span class="o">*</span> <span class="n">dxscale</span>
            <span class="n">needcharspace</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">cid</span><span class="p">,</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">font</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">needcharspace</span><span class="p">:</span>
                    <span class="n">pos</span> <span class="o">+=</span> <span class="n">charspace</span>
                <span class="n">tstate</span><span class="o">.</span><span class="n">glyph_offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span> <span class="k">if</span> <span class="n">vert</span> <span class="k">else</span> <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
                <span class="n">textwidth</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">char_width</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span>
                <span class="n">adv</span> <span class="o">=</span> <span class="n">textwidth</span> <span class="o">*</span> <span class="n">tstate</span><span class="o">.</span><span class="n">fontsize</span> <span class="o">*</span> <span class="n">scaling</span>
                <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">tstate</span><span class="o">.</span><span class="n">glyph_offset</span>
                <span class="n">glyph</span> <span class="o">=</span> <span class="n">GlyphObject</span><span class="p">(</span>
                    <span class="n">gstate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="p">,</span>
                    <span class="n">ctm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">,</span>
                    <span class="n">mcstack</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mcstack</span><span class="p">,</span>
                    <span class="n">textstate</span><span class="o">=</span><span class="n">tstate</span><span class="p">,</span>
                    <span class="n">cid</span><span class="o">=</span><span class="n">cid</span><span class="p">,</span>
                    <span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span>
                    <span class="c1"># Do pre-translation internally (taking rotation into account)</span>
                    <span class="n">matrix</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">x</span> <span class="o">*</span> <span class="n">a</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="n">c</span> <span class="o">+</span> <span class="n">e</span><span class="p">,</span> <span class="n">x</span> <span class="o">*</span> <span class="n">b</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="n">d</span> <span class="o">+</span> <span class="n">f</span><span class="p">),</span>
                    <span class="n">adv</span><span class="o">=</span><span class="n">adv</span><span class="p">,</span>
                    <span class="n">corners</span><span class="o">=</span><span class="n">corners</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">yield</span> <span class="n">glyph</span>
                <span class="n">pos</span> <span class="o">+=</span> <span class="n">adv</span>
                <span class="k">if</span> <span class="n">cid</span> <span class="o">==</span> <span class="mi">32</span> <span class="ow">and</span> <span class="n">wordspace</span><span class="p">:</span>
                    <span class="n">pos</span> <span class="o">+=</span> <span class="n">wordspace</span>
                <span class="n">needcharspace</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">tstate</span><span class="o">.</span><span class="n">glyph_offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span> <span class="k">if</span> <span class="n">vert</span> <span class="k">else</span> <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.page.TextObject.__len__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return the number of glyphs that would result from iterating over
this object.</p>
<p>Important: this is the number of glyphs, <em>not</em> the number of
Unicode characters.</p>

            <details class="quote">
              <summary>Source code in <code>playa/page.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2127</span>
<span class="normal">2128</span>
<span class="normal">2129</span>
<span class="normal">2130</span>
<span class="normal">2131</span>
<span class="normal">2132</span>
<span class="normal">2133</span>
<span class="normal">2134</span>
<span class="normal">2135</span>
<span class="normal">2136</span>
<span class="normal">2137</span>
<span class="normal">2138</span>
<span class="normal">2139</span>
<span class="normal">2140</span>
<span class="normal">2141</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the number of glyphs that would result from iterating over</span>
<span class="sd">    this object.</span>

<span class="sd">    Important: this is the number of glyphs, *not* the number of</span>
<span class="sd">    Unicode characters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nglyphs</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">font</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">textstate</span><span class="o">.</span><span class="n">font</span>
    <span class="k">assert</span> <span class="n">font</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;No font was selected&quot;</span>
    <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">nglyphs</span> <span class="o">+=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">font</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">nglyphs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.page.TextState" class="doc doc-heading">
            <code>TextState</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>PDF Text State (PDF 1.7 section 9.3.1).</p>
<p>Exceptionally, the line matrix and text matrix are represented
more compactly with the line matrix itself in <code>line_matrix</code>, which
gets translated by <code>glyph_offset</code> for the current glyph (note:
expressed in <strong>user space</strong>), which pdfminer confusingly called
<code>linematrix</code>, to produce the text matrix.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.TextState.line_matrix">line_matrix</span></code></td>
            <td>
                  <code><span title="playa.utils.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The text line matrix, which defines (in user
space) the start of the current line of text, which may or may
not correspond to an actual line because PDF is a presentation
format.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.TextState.glyph_offset">glyph_offset</span></code></td>
            <td>
                  <code><span title="playa.utils.Point">Point</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The offset of the current glyph with relation to
the line matrix (in user space).  To get this in device space
you may use <code>playa.utils.apply_matrix_norm</code> with
<code>TextObject.ctm</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.TextState.font">font</span></code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="playa.font.Font">Font</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current font.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.TextState.fontsize">fontsize</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current font size, <strong>in text space units</strong>.
This is often just 1.0 as it relies on the text matrix (you
may use <code>line_matrix</code> here) to scale it to the actual size in
user space.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.TextState.charspace">charspace</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Extra spacing to add between each glyph, in
text space units.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.TextState.wordspace">wordspace</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The width of a space, defined curiously as <code>cid==32</code>
(But PDF Is A prESeNTaTion fORmAT sO ThERe maY NOt Be aNY
SpACeS!!), in text space units.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.TextState.scaling">scaling</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The horizontal scaling factor as defined by the PDF
standard.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.TextState.leading">leading</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The leading as defined by the PDF standard.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.TextState.render_mode">render_mode</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The PDF rendering mode.  The really important one
here is 3, which means "don't render the text".  You might
want to use this to detect invisible text.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.TextState.rise">rise</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The text rise (superscript or subscript position), in text
space units.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.TextState.descent">descent</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The font's descent (scaled by the font size), in text
space units (this is not really part of the text state but is
kept here to avoid recomputing it on every glyph)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>playa/page.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TextState</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;PDF Text State (PDF 1.7 section 9.3.1).</span>

<span class="sd">    Exceptionally, the line matrix and text matrix are represented</span>
<span class="sd">    more compactly with the line matrix itself in `line_matrix`, which</span>
<span class="sd">    gets translated by `glyph_offset` for the current glyph (note:</span>
<span class="sd">    expressed in **user space**), which pdfminer confusingly called</span>
<span class="sd">    `linematrix`, to produce the text matrix.</span>

<span class="sd">    Attributes:</span>
<span class="sd">      line_matrix: The text line matrix, which defines (in user</span>
<span class="sd">        space) the start of the current line of text, which may or may</span>
<span class="sd">        not correspond to an actual line because PDF is a presentation</span>
<span class="sd">        format.</span>
<span class="sd">      glyph_offset: The offset of the current glyph with relation to</span>
<span class="sd">        the line matrix (in user space).  To get this in device space</span>
<span class="sd">        you may use `playa.utils.apply_matrix_norm` with</span>
<span class="sd">        `TextObject.ctm`.</span>
<span class="sd">      font: The current font.</span>
<span class="sd">      fontsize: The current font size, **in text space units**.</span>
<span class="sd">        This is often just 1.0 as it relies on the text matrix (you</span>
<span class="sd">        may use `line_matrix` here) to scale it to the actual size in</span>
<span class="sd">        user space.</span>
<span class="sd">      charspace: Extra spacing to add between each glyph, in</span>
<span class="sd">        text space units.</span>
<span class="sd">      wordspace: The width of a space, defined curiously as `cid==32`</span>
<span class="sd">        (But PDF Is A prESeNTaTion fORmAT sO ThERe maY NOt Be aNY</span>
<span class="sd">        SpACeS!!), in text space units.</span>
<span class="sd">      scaling: The horizontal scaling factor as defined by the PDF</span>
<span class="sd">        standard.</span>
<span class="sd">      leading: The leading as defined by the PDF standard.</span>
<span class="sd">      render_mode: The PDF rendering mode.  The really important one</span>
<span class="sd">        here is 3, which means &quot;don&#39;t render the text&quot;.  You might</span>
<span class="sd">        want to use this to detect invisible text.</span>
<span class="sd">      rise: The text rise (superscript or subscript position), in text</span>
<span class="sd">        space units.</span>
<span class="sd">      descent: The font&#39;s descent (scaled by the font size), in text</span>
<span class="sd">        space units (this is not really part of the text state but is</span>
<span class="sd">        kept here to avoid recomputing it on every glyph)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">line_matrix</span><span class="p">:</span> <span class="n">Matrix</span> <span class="o">=</span> <span class="n">MATRIX_IDENTITY</span>
    <span class="n">glyph_offset</span><span class="p">:</span> <span class="n">Point</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">font</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Font</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">fontsize</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">charspace</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">wordspace</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">scaling</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="n">leading</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">render_mode</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">rise</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">descent</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reset the text state&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_matrix</span> <span class="o">=</span> <span class="n">MATRIX_IDENTITY</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">glyph_offset</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="playa.page.TextState.reset" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reset</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Reset the text state</p>

            <details class="quote">
              <summary>Source code in <code>playa/page.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reset the text state&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">line_matrix</span> <span class="o">=</span> <span class="n">MATRIX_IDENTITY</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">glyph_offset</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.page.XObjectObject" class="doc doc-heading">
            <code>XObjectObject</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="playa.page.ContentObject" href="#playa.page.ContentObject">ContentObject</a></code></p>


        <p>An eXternal Object, in the context of a page.</p>
<p>There are a couple of kinds of XObjects.  Here we are only
concerned with "Form XObjects" which, despite their name, have
nothing at all to do with fillable forms.  Instead they are like
little embeddable PDF pages, possibly with their own resources,
definitely with their own definition of "user space".</p>
<p>Image XObjects are handled by <code>ImageObject</code>.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.XObjectObject.xobjid">xobjid</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of this XObject (in the page resources).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="playa.page.XObjectObject.page" href="#playa.page.XObjectObject.page">page</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="playa.page.Page" href="#playa.page.Page">Page</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Weak reference to containing page.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.XObjectObject.stream">stream</span></code></td>
            <td>
                  <code><span title="playa.pdftypes.ContentStream">ContentStream</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Content stream with PDF operators.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.XObjectObject.resources">resources</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[None, <span title="typing.Dict">Dict</span>[str, <span title="playa.parser.PDFObject">PDFObject</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Resources specific to this XObject, if any.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>playa/page.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">XObjectObject</span><span class="p">(</span><span class="n">ContentObject</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;An eXternal Object, in the context of a page.</span>

<span class="sd">    There are a couple of kinds of XObjects.  Here we are only</span>
<span class="sd">    concerned with &quot;Form XObjects&quot; which, despite their name, have</span>
<span class="sd">    nothing at all to do with fillable forms.  Instead they are like</span>
<span class="sd">    little embeddable PDF pages, possibly with their own resources,</span>
<span class="sd">    definitely with their own definition of &quot;user space&quot;.</span>

<span class="sd">    Image XObjects are handled by `ImageObject`.</span>

<span class="sd">    Attributes:</span>
<span class="sd">      xobjid: Name of this XObject (in the page resources).</span>
<span class="sd">      page: Weak reference to containing page.</span>
<span class="sd">      stream: Content stream with PDF operators.</span>
<span class="sd">      resources: Resources specific to this XObject, if any.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">xobjid</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">stream</span><span class="p">:</span> <span class="n">ContentStream</span>
    <span class="n">resources</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">]]</span>
    <span class="n">_pageref</span><span class="p">:</span> <span class="n">PageRef</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDFObject</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">page</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Page</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the page (if it exists, raising RuntimeError if not).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_deref_page</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pageref</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rect</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the bounding box of this XObject in device space.&quot;&quot;&quot;</span>
        <span class="c1"># It is a required attribute!</span>
        <span class="k">return</span> <span class="n">get_transformed_bound</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">,</span> <span class="n">parse_rect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">[</span><span class="s2">&quot;BBox&quot;</span><span class="p">]))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">buffer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Raw stream content for this XObject&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">buffer</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Token</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over tokens in the XObject&#39;s content stream.&quot;&quot;&quot;</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">ContentParser</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">])</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">pos</span><span class="p">,</span> <span class="n">tok</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">nexttoken</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="k">yield</span> <span class="n">tok</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">layout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;LayoutDict&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterator over eager layout object dictionaries.</span>

<span class="sd">        Danger: Deprecated</span>
<span class="sd">            This interface is deprecated and has been moved to</span>
<span class="sd">            [PAVS](https://github.com/dhdaines/paves).  It will be</span>
<span class="sd">            removed in PLAYA 0.3.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;The layout property has moved to PAVS (https://github.com/dhdaines/paves)&quot;</span>
            <span class="s2">&quot; and will be removed in PLAYA 0.3&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="n">PageInterpreter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">contents</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">PDFObject</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterator over PDF objects in the content stream.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">ContentParser</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">]):</span>
            <span class="k">yield</span> <span class="n">obj</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;ContentObject&quot;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="n">LazyInterpreter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="playa.page.XObjectObject.bbox" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bbox</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Get the bounding box of this XObject in device space.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.XObjectObject.buffer" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">buffer</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Raw stream content for this XObject</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.XObjectObject.contents" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">contents</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterator over PDF objects in the content stream.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.XObjectObject.layout" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">layout</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterator over eager layout object dictionaries.</p>


<details class="danger" open>
  <summary>Deprecated</summary>
  <p>This interface is deprecated and has been moved to
<a href="https://github.com/dhdaines/paves">PAVS</a>.  It will be
removed in PLAYA 0.3.</p>
</details>    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.XObjectObject.mcid" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mcid</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The marked content ID of the nearest enclosing marked
content section with an ID.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.XObjectObject.mcs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mcs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The immediately enclosing marked content section.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.XObjectObject.object_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">object_type</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Type of this object as a string, e.g. "text", "path", "image".</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.XObjectObject.page" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">page</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Get the page (if it exists, raising RuntimeError if not).</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.XObjectObject.tokens" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tokens</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterate over tokens in the XObject's content stream.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="playa.page.XObjectObject.__len__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return the number of children of this object (generic implementation).</p>

            <details class="quote">
              <summary>Source code in <code>playa/page.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the number of children of this object (generic implementation).&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="playa.structtree" class="doc doc-heading">
            <code>playa.structtree</code>


</h2>

    <div class="doc doc-contents first">

        <p>PDF logical structure trees.</p>








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="playa.structtree.StructElement" class="doc doc-heading">
            <code>StructElement</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="playa.structtree.Findable">Findable</span></code></p>







              <details class="quote">
                <summary>Source code in <code>playa/structtree.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">StructElement</span><span class="p">(</span><span class="n">Findable</span><span class="p">):</span>
    <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">revision</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="nb">id</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">lang</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">alt_text</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">actual_text</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">title</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">page_idx</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">attributes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">mcids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">children</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;StructElement&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">page_number</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
        <span class="k">return</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">page_idx</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">page_idx</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;StructElement&quot;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">all_mcids</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Collect all MCIDs (with their page indices) inside a</span>
<span class="sd">        structure element.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># MCIDs are meaningless without a page object</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcids</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">page_idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="c1"># Collect them depth-first to preserve ordering</span>
            <span class="k">for</span> <span class="n">mcid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcids</span><span class="p">:</span>
                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">page_idx</span><span class="p">,</span> <span class="n">mcid</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">d</span><span class="p">:</span>
            <span class="n">el</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">el</span><span class="o">.</span><span class="n">mcids</span><span class="p">:</span>
                <span class="k">assert</span> <span class="n">el</span><span class="o">.</span><span class="n">page_idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="k">for</span> <span class="n">mcid</span> <span class="ow">in</span> <span class="n">el</span><span class="o">.</span><span class="n">mcids</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">el</span><span class="o">.</span><span class="n">page_idx</span><span class="p">,</span> <span class="n">mcid</span>
            <span class="n">d</span><span class="o">.</span><span class="n">extendleft</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">el</span><span class="o">.</span><span class="n">children</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="playa.structtree.StructElement.all_mcids" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">all_mcids</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Collect all MCIDs (with their page indices) inside a
structure element.</p>

            <details class="quote">
              <summary>Source code in <code>playa/structtree.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">all_mcids</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Collect all MCIDs (with their page indices) inside a</span>
<span class="sd">    structure element.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># MCIDs are meaningless without a page object</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcids</span><span class="p">:</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">page_idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="c1"># Collect them depth-first to preserve ordering</span>
        <span class="k">for</span> <span class="n">mcid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcids</span><span class="p">:</span>
            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">page_idx</span><span class="p">,</span> <span class="n">mcid</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">d</span><span class="p">:</span>
        <span class="n">el</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">el</span><span class="o">.</span><span class="n">mcids</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">el</span><span class="o">.</span><span class="n">page_idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">mcid</span> <span class="ow">in</span> <span class="n">el</span><span class="o">.</span><span class="n">mcids</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">el</span><span class="o">.</span><span class="n">page_idx</span><span class="p">,</span> <span class="n">mcid</span>
        <span class="n">d</span><span class="o">.</span><span class="n">extendleft</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">el</span><span class="o">.</span><span class="n">children</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.structtree.StructElement.find" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find</span><span class="p">(</span><span class="n">matcher</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Find the first matching element in subtree.</p>
<p>The <code>matcher</code> argument is either an element name, a regular
expression, or a function taking a <code>StructElement</code> and
returning <code>True</code> if the element matches.</p>

            <details class="quote">
              <summary>Source code in <code>playa/structtree.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">find</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">matcher</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Pattern</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">MatchFunc</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;StructElement&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Find the first matching element in subtree.</span>

<span class="sd">    The `matcher` argument is either an element name, a regular</span>
<span class="sd">    expression, or a function taking a `StructElement` and</span>
<span class="sd">    returning `True` if the element matches.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="n">_find_all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">,</span> <span class="n">matcher</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.structtree.StructElement.find_all" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find_all</span><span class="p">(</span><span class="n">matcher</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Iterate depth-first over matching elements in subtree.</p>
<p>The <code>matcher</code> argument is either an element name, a regular
expression, or a function taking a <code>StructElement</code> and
returning <code>True</code> if the element matches.</p>

            <details class="quote">
              <summary>Source code in <code>playa/structtree.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">find_all</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">matcher</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Pattern</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">MatchFunc</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;StructElement&quot;</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterate depth-first over matching elements in subtree.</span>

<span class="sd">    The `matcher` argument is either an element name, a regular</span>
<span class="sd">    expression, or a function taking a `StructElement` and</span>
<span class="sd">    returning `True` if the element matches.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_find_all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">,</span> <span class="n">matcher</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.structtree.StructTree" class="doc doc-heading">
            <code>StructTree</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="playa.structtree.Findable">Findable</span></code></p>


        <p>Parse the structure tree of a PDF.</p>
<p>This class creates a representation of the portion of the
structure tree that reaches marked content sections for a document
or a subset of its pages.  Note that this is slightly different
from the behaviour of other PDF libraries which will also include
structure elements with no content.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>KeyError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the PDF has no structure tree.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>doc</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="playa.document.Document" href="#playa.document.Document">Document</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Document from which to extract structure tree</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pages</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="typing.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="playa.page.Page" href="#playa.page.Page">Page</a>], None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of (index, page) pairs - indices will be used to
     identify pages in the tree through the <code>page_idx</code>
     attribute of <code>StructElement</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>playa/structtree.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">StructTree</span><span class="p">(</span><span class="n">Findable</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse the structure tree of a PDF.</span>

<span class="sd">    This class creates a representation of the portion of the</span>
<span class="sd">    structure tree that reaches marked content sections for a document</span>
<span class="sd">    or a subset of its pages.  Note that this is slightly different</span>
<span class="sd">    from the behaviour of other PDF libraries which will also include</span>
<span class="sd">    structure elements with no content.</span>

<span class="sd">    Raises:</span>
<span class="sd">      KeyError: If the PDF has no structure tree.</span>

<span class="sd">    Args:</span>
<span class="sd">      doc: Document from which to extract structure tree</span>
<span class="sd">      pages: List of (index, page) pairs - indices will be used to</span>
<span class="sd">             identify pages in the tree through the `page_idx`</span>
<span class="sd">             attribute of `StructElement`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">page</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Page&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">doc</span><span class="p">:</span> <span class="s2">&quot;Document&quot;</span><span class="p">,</span>
        <span class="n">pages</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="s2">&quot;Page&quot;</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="s2">&quot;StructTreeRoot&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">catalog</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Catalog has no &#39;StructTreeRoot&#39; entry&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">catalog</span><span class="p">[</span><span class="s2">&quot;StructTreeRoot&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">role_map</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;RoleMap&quot;</span><span class="p">,</span> <span class="p">{}))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">class_map</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ClassMap&quot;</span><span class="p">,</span> <span class="p">{}))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">StructElement</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">page_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]]</span>

        <span class="k">if</span> <span class="n">pages</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">page_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">page</span><span class="o">.</span><span class="n">pageid</span><span class="p">:</span> <span class="n">page</span><span class="o">.</span><span class="n">page_idx</span> <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">pages</span><span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parse_struct_tree</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pagelist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pages</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">page_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">page</span><span class="o">.</span><span class="n">pageid</span><span class="p">:</span> <span class="n">page</span><span class="o">.</span><span class="n">page_idx</span> <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">pagelist</span><span class="p">}</span>
            <span class="n">parent_tree_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ParentTree&quot;</span><span class="p">)</span>
            <span class="c1"># If we have a single page then we will work backwards from</span>
            <span class="c1"># its ParentTree - this is because structure elements could</span>
            <span class="c1"># span multiple pages, and the &quot;Pg&quot; attribute is *optional*,</span>
            <span class="c1"># so this is the approved way to get a page&#39;s structure...</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pagelist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">parent_tree_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">page</span> <span class="o">=</span> <span class="n">pagelist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">parent_tree</span> <span class="o">=</span> <span class="n">NumberTree</span><span class="p">(</span><span class="n">parent_tree_obj</span><span class="p">)</span>
                <span class="c1"># If there is no marked content in the structure tree for</span>
                <span class="c1"># this page (which can happen even when there is a</span>
                <span class="c1"># structure tree) then there is no `StructParents`.</span>
                <span class="c1"># Note however that if there are XObjects in a page,</span>
                <span class="c1"># *they* may have `StructParent` (not `StructParents`)</span>
                <span class="k">if</span> <span class="s2">&quot;StructParents&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
                    <span class="k">return</span>
                <span class="n">parent_id</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;StructParents&quot;</span><span class="p">]</span>
                <span class="n">parent_array</span> <span class="o">=</span> <span class="n">list_value</span><span class="p">(</span><span class="n">parent_tree</span><span class="p">[</span><span class="n">parent_id</span><span class="p">])</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent_array</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>  <span class="c1"># srsly</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_parse_parent_tree</span><span class="p">(</span><span class="n">parent_array</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># ...EXCEPT that the ParentTree is sometimes missing, in which</span>
                <span class="c1"># case we fall back to the non-approved way.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_parse_struct_tree</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_make_attributes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">attrs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">revision</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="n">attr_obj_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PDFObject</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">attrs</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">attr_obj</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">attrs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="c1"># It could be a list of attribute objects (why?)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attr_obj</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">attr_obj_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">resolve1</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">attr_obj</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">attr_obj_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attr_obj</span><span class="p">)</span>
        <span class="n">attr_objs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">PSLiteral</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">prev_obj</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">aobj</span> <span class="ow">in</span> <span class="n">attr_obj_list</span><span class="p">:</span>
            <span class="c1"># If we find a revision number, which might &quot;follow the</span>
            <span class="c1"># revision object&quot; (the spec is not clear about what this</span>
            <span class="c1"># should look like but it implies they are simply adjacent</span>
            <span class="c1"># in a flat array), then use it to decide whether to take</span>
            <span class="c1"># the previous object...</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">aobj</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">aobj</span> <span class="o">==</span> <span class="n">revision</span> <span class="ow">and</span> <span class="n">prev_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">attr_objs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prev_obj</span><span class="p">)</span>
                <span class="n">prev_obj</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">aobj</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">aobj</span><span class="p">,</span> <span class="n">PSLiteral</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">prev_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">attr_objs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prev_obj</span><span class="p">)</span>
                <span class="n">prev_obj</span> <span class="o">=</span> <span class="n">aobj</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Structure attribute of unknown type: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">aobj</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">prev_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">attr_objs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prev_obj</span><span class="p">)</span>
        <span class="c1"># Now merge all the attribute objects in the collected to a</span>
        <span class="c1"># single set (again, the spec doesn&#39;t really explain this but</span>
        <span class="c1"># does say that attributes in /A supersede those in /C)</span>
        <span class="n">attr</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">attr_objs</span><span class="p">:</span>
            <span class="c1"># They should all be resolved by now!</span>
            <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">ObjRef</span><span class="p">)</span>
            <span class="c1"># A class name</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">PSLiteral</span><span class="p">):</span>
                <span class="n">key</span> <span class="o">=</span> <span class="n">decode_text</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_map</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Unknown attribute class </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="n">class_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_map</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">class_obj</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">PSLiteral</span><span class="p">):</span>
                        <span class="n">attr</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">decode_text</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">attr</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">class_obj</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">attr_objs</span><span class="p">:</span>
            <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">ObjRef</span><span class="p">)</span>
            <span class="c1"># An attribute dict</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">PSLiteral</span><span class="p">):</span>
                        <span class="n">attr</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">decode_text</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">attr</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">attr</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_make_element</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">StructElement</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]]:</span>
        <span class="c1"># We hopefully caught these earlier</span>
        <span class="k">assert</span> <span class="s2">&quot;MCID&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;Uncaught MCR: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">obj</span>
        <span class="k">assert</span> <span class="s2">&quot;Obj&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;Uncaught OBJR: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">obj</span>
        <span class="c1"># Get page index if necessary</span>
        <span class="n">page_idx</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="s2">&quot;Pg&quot;</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
            <span class="n">page_objid</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;Pg&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">objid</span>
            <span class="k">assert</span> <span class="n">page_objid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">page_dict</span><span class="p">,</span> <span class="s2">&quot;Object on unparsed page: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">obj</span>
            <span class="n">page_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">page_dict</span><span class="p">[</span><span class="n">page_objid</span><span class="p">]</span>
        <span class="n">obj_tag</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;S&quot;</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
            <span class="n">obj_tag</span> <span class="o">=</span> <span class="n">decode_text</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="s2">&quot;S&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">obj_tag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">role_map</span><span class="p">:</span>
                <span class="n">obj_tag</span> <span class="o">=</span> <span class="n">decode_text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">role_map</span><span class="p">[</span><span class="n">obj_tag</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">children</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="s2">&quot;K&quot;</span><span class="p">])</span> <span class="k">if</span> <span class="s2">&quot;K&quot;</span> <span class="ow">in</span> <span class="n">obj</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">children</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>  <span class="c1"># ugh... isinstance...</span>
            <span class="n">children</span> <span class="o">=</span> <span class="p">[</span><span class="n">children</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">children</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>  <span class="c1"># a single object.. ugh...</span>
            <span class="n">children</span> <span class="o">=</span> <span class="p">[</span><span class="n">obj</span><span class="p">[</span><span class="s2">&quot;K&quot;</span><span class="p">]]</span>
        <span class="n">revision</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">)</span>
        <span class="n">attributes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_attributes</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">revision</span><span class="p">)</span>
        <span class="n">element_id</span> <span class="o">=</span> <span class="n">decode_text</span><span class="p">(</span><span class="n">resolve1</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">]))</span> <span class="k">if</span> <span class="s2">&quot;ID&quot;</span> <span class="ow">in</span> <span class="n">obj</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">decode_text</span><span class="p">(</span><span class="n">resolve1</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">]))</span> <span class="k">if</span> <span class="s2">&quot;T&quot;</span> <span class="ow">in</span> <span class="n">obj</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">lang</span> <span class="o">=</span> <span class="n">decode_text</span><span class="p">(</span><span class="n">resolve1</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="s2">&quot;Lang&quot;</span><span class="p">]))</span> <span class="k">if</span> <span class="s2">&quot;Lang&quot;</span> <span class="ow">in</span> <span class="n">obj</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">alt_text</span> <span class="o">=</span> <span class="n">decode_text</span><span class="p">(</span><span class="n">resolve1</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="s2">&quot;Alt&quot;</span><span class="p">]))</span> <span class="k">if</span> <span class="s2">&quot;Alt&quot;</span> <span class="ow">in</span> <span class="n">obj</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">actual_text</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">decode_text</span><span class="p">(</span><span class="n">resolve1</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="s2">&quot;ActualText&quot;</span><span class="p">]))</span> <span class="k">if</span> <span class="s2">&quot;ActualText&quot;</span> <span class="ow">in</span> <span class="n">obj</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="p">)</span>
        <span class="n">element</span> <span class="o">=</span> <span class="n">StructElement</span><span class="p">(</span>
            <span class="nb">type</span><span class="o">=</span><span class="n">obj_tag</span><span class="p">,</span>
            <span class="nb">id</span><span class="o">=</span><span class="n">element_id</span><span class="p">,</span>
            <span class="n">page_idx</span><span class="o">=</span><span class="n">page_idx</span><span class="p">,</span>
            <span class="n">revision</span><span class="o">=</span><span class="n">revision</span><span class="p">,</span>
            <span class="n">lang</span><span class="o">=</span><span class="n">lang</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
            <span class="n">alt_text</span><span class="o">=</span><span class="n">alt_text</span><span class="p">,</span>
            <span class="n">actual_text</span><span class="o">=</span><span class="n">actual_text</span><span class="p">,</span>
            <span class="n">attributes</span><span class="o">=</span><span class="n">attributes</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">element</span><span class="p">,</span> <span class="n">children</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_parse_parent_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_array</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Populate the structure tree using the leaves of the parent tree for</span>
<span class="sd">        a given page.&quot;&quot;&quot;</span>
        <span class="c1"># First walk backwards from the leaves to the root, tracking references</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">parent_array</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">found_root</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">while</span> <span class="n">d</span><span class="p">:</span>
            <span class="n">ref</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
            <span class="c1"># In the case where an MCID is not associated with any</span>
            <span class="c1"># structure, there will be None in the parent tree</span>
            <span class="c1"># (previously it was KWD(&quot;null&quot;) but we now parse that</span>
            <span class="c1"># properly as None)</span>
            <span class="k">if</span> <span class="n">ref</span> <span class="ow">is</span> <span class="n">KEYWORD_NULL</span> <span class="ow">or</span> <span class="n">ref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="nb">repr</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>  <span class="c1"># This means the XRef tables are borked</span>
            <span class="c1"># This is required! It&#39;s in the spec!</span>
            <span class="k">if</span> <span class="s2">&quot;Type&quot;</span> <span class="ow">in</span> <span class="n">obj</span> <span class="ow">and</span> <span class="n">decode_text</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="s2">&quot;Type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;StructTreeRoot&quot;</span><span class="p">:</span>
                <span class="n">found_root</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># We hope that these are actual elements and not</span>
                <span class="c1"># references or marked-content sections...</span>
                <span class="n">element</span><span class="p">,</span> <span class="n">children</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_element</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
                <span class="c1"># We have no page tree so we assume this page was parsed</span>
                <span class="k">assert</span> <span class="n">element</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="n">s</span><span class="p">[</span><span class="nb">repr</span><span class="p">(</span><span class="n">ref</span><span class="p">)]</span> <span class="o">=</span> <span class="n">element</span><span class="p">,</span> <span class="n">children</span>
                <span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">])</span>
        <span class="c1"># If we didn&#39;t reach the root something is quite wrong!</span>
        <span class="k">assert</span> <span class="n">found_root</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_children</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">on_parsed_page</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;Pg&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="n">page_objid</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;Pg&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">objid</span>
        <span class="k">return</span> <span class="n">page_objid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">page_dict</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_parse_struct_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Populate the structure tree starting from the root, skipping</span>
<span class="sd">        unparsed pages and empty elements.&quot;&quot;&quot;</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">[</span><span class="s2">&quot;K&quot;</span><span class="p">])</span>

        <span class="c1"># It could just be a single object ... it&#39;s in the spec (argh)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">root</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">[</span><span class="s2">&quot;K&quot;</span><span class="p">]]</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">while</span> <span class="n">d</span><span class="p">:</span>
            <span class="n">ref</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
            <span class="c1"># In case the tree is actually a DAG and not a tree...</span>
            <span class="k">if</span> <span class="nb">repr</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>  <span class="c1"># pragma: nocover (shouldn&#39;t happen)</span>
                <span class="k">continue</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span>
            <span class="c1"># Deref top-level OBJR skipping refs to unparsed pages</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">&quot;Obj&quot;</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_parsed_page</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="n">ref</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;Obj&quot;</span><span class="p">]</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span>
            <span class="n">element</span><span class="p">,</span> <span class="n">children</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_element</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="c1"># Similar to above, delay resolving the children to avoid</span>
            <span class="c1"># tree-recursion.</span>
            <span class="n">s</span><span class="p">[</span><span class="nb">repr</span><span class="p">(</span><span class="n">ref</span><span class="p">)]</span> <span class="o">=</span> <span class="n">element</span><span class="p">,</span> <span class="n">children</span>
            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">children</span><span class="p">:</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_parsed_page</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
                        <span class="k">continue</span>
                    <span class="k">if</span> <span class="s2">&quot;Obj&quot;</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
                        <span class="n">child</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;Obj&quot;</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="s2">&quot;MCID&quot;</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
                        <span class="k">continue</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">ObjRef</span><span class="p">):</span>
                    <span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>

        <span class="c1"># Traverse depth-first, removing empty elements (unsure how to</span>
        <span class="c1"># do this non-recursively)</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">prune</span><span class="p">(</span><span class="n">elements</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
            <span class="n">next_elements</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                    <span class="n">next_elements</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_parsed_page</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
                        <span class="k">continue</span>
                    <span class="k">if</span> <span class="s2">&quot;MCID&quot;</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
                        <span class="n">next_elements</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="s2">&quot;MCID&quot;</span><span class="p">])</span>
                        <span class="k">continue</span>
                    <span class="k">elif</span> <span class="s2">&quot;Obj&quot;</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
                        <span class="n">ref</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;Obj&quot;</span><span class="p">]</span>
                <span class="n">element</span><span class="p">,</span> <span class="n">children</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="nb">repr</span><span class="p">(</span><span class="n">ref</span><span class="p">)]</span>
                <span class="n">children</span> <span class="o">=</span> <span class="n">prune</span><span class="p">(</span><span class="n">children</span><span class="p">)</span>
                <span class="c1"># See assertions below</span>
                <span class="k">if</span> <span class="n">element</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">children</span><span class="p">:</span>
                    <span class="k">del</span> <span class="n">s</span><span class="p">[</span><span class="nb">repr</span><span class="p">(</span><span class="n">ref</span><span class="p">)]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">s</span><span class="p">[</span><span class="nb">repr</span><span class="p">(</span><span class="n">ref</span><span class="p">)]</span> <span class="o">=</span> <span class="n">element</span><span class="p">,</span> <span class="n">children</span>
                    <span class="n">next_elements</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">next_elements</span>

        <span class="n">prune</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_children</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_resolve_children</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seen</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Resolve children starting from the tree root based on references we</span>
<span class="sd">        saw when traversing the structure tree.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">[</span><span class="s2">&quot;K&quot;</span><span class="p">])</span>
        <span class="c1"># It could just be a single object ... it&#39;s in the spec (argh)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">root</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">[</span><span class="s2">&quot;K&quot;</span><span class="p">]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">children</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Create top-level self.children</span>
        <span class="n">parsed_root</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="n">root</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">&quot;Obj&quot;</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_parsed_page</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="n">ref</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;Obj&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">repr</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span> <span class="ow">in</span> <span class="n">seen</span><span class="p">:</span>
                <span class="n">parsed_root</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">parsed_root</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">d</span><span class="p">:</span>
            <span class="n">ref</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
            <span class="n">element</span><span class="p">,</span> <span class="n">children</span> <span class="o">=</span> <span class="n">seen</span><span class="p">[</span><span class="nb">repr</span><span class="p">(</span><span class="n">ref</span><span class="p">)]</span>
            <span class="k">assert</span> <span class="n">element</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Unparsed element&quot;</span>
            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">children</span><span class="p">:</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                    <span class="c1"># FIXME: This might fail! (but that indicates a</span>
                    <span class="c1"># programming failure as MCIDs should never occur</span>
                    <span class="c1"># without a page object)</span>
                    <span class="n">element</span><span class="o">.</span><span class="n">mcids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="c1"># Skip out-of-page MCIDS and OBJRs (FIXME: do we</span>
                    <span class="c1"># *really* want to do this? Perhaps we should</span>
                    <span class="c1"># store the page indices directly with the MCIDs?)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_parsed_page</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
                        <span class="k">continue</span>
                    <span class="k">if</span> <span class="s2">&quot;MCID&quot;</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
                        <span class="c1"># FIXME: This might fail, for the same reasons!</span>
                        <span class="k">assert</span> <span class="n">element</span><span class="o">.</span><span class="n">page_idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                        <span class="n">element</span><span class="o">.</span><span class="n">mcids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="s2">&quot;MCID&quot;</span><span class="p">])</span>
                    <span class="k">elif</span> <span class="s2">&quot;Obj&quot;</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
                        <span class="n">child</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;Obj&quot;</span><span class="p">]</span>
                <span class="c1"># NOTE: if, not elif, in case of OBJR above</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">ObjRef</span><span class="p">):</span>
                    <span class="n">child_element</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">seen</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">child</span><span class="p">),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">child_element</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">element</span><span class="o">.</span><span class="n">children</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child_element</span><span class="p">)</span>
                        <span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">children</span> <span class="o">=</span> <span class="p">[</span><span class="n">seen</span><span class="p">[</span><span class="nb">repr</span><span class="p">(</span><span class="n">ref</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="n">parsed_root</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">StructElement</span><span class="p">]:</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="playa.structtree.StructTree.find" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find</span><span class="p">(</span><span class="n">matcher</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Find the first matching element in subtree.</p>
<p>The <code>matcher</code> argument is either an element name, a regular
expression, or a function taking a <code>StructElement</code> and
returning <code>True</code> if the element matches.</p>

            <details class="quote">
              <summary>Source code in <code>playa/structtree.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">find</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">matcher</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Pattern</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">MatchFunc</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;StructElement&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Find the first matching element in subtree.</span>

<span class="sd">    The `matcher` argument is either an element name, a regular</span>
<span class="sd">    expression, or a function taking a `StructElement` and</span>
<span class="sd">    returning `True` if the element matches.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="n">_find_all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">,</span> <span class="n">matcher</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.structtree.StructTree.find_all" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find_all</span><span class="p">(</span><span class="n">matcher</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Iterate depth-first over matching elements in subtree.</p>
<p>The <code>matcher</code> argument is either an element name, a regular
expression, or a function taking a <code>StructElement</code> and
returning <code>True</code> if the element matches.</p>

            <details class="quote">
              <summary>Source code in <code>playa/structtree.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">find_all</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">matcher</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Pattern</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">MatchFunc</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;StructElement&quot;</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterate depth-first over matching elements in subtree.</span>

<span class="sd">    The `matcher` argument is either an element name, a regular</span>
<span class="sd">    expression, or a function taking a `StructElement` and</span>
<span class="sd">    returning `True` if the element matches.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_find_all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">,</span> <span class="n">matcher</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="playa.worker" class="doc doc-heading">
            <code>playa.worker</code>


</h2>

    <div class="doc doc-contents first">

        <p>Worker subprocess related functions and data.</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="playa.worker.in_worker" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">in_worker</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Are we currently in a worker process?</p>

            <details class="quote">
              <summary>Source code in <code>playa/worker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">in_worker</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Are we currently in a worker process?&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">__pdf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; David Huggins-Daines 2024-present
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
    
  </body>
</html>