
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="PLAYA ain't a LAYout Analyzer">
      
      
        <meta name="author" content="David Huggins-Daines">
      
      
        <link rel="canonical" href="https://dhdaines.github.io/playa/0.6.1/reference/">
      
      
        <link rel="prev" href="../cli/">
      
      
        <link rel="next" href="../data/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>Reference - PLAYA</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6f8fc17f.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="PLAYA" class="md-header__button md-logo" aria-label="PLAYA" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PLAYA
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Reference
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/dhdaines/playa" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    dhdaines/playa
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="PLAYA" class="md-nav__button md-logo" aria-label="PLAYA" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    PLAYA
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/dhdaines/playa" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    dhdaines/playa
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CLI
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Reference
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Reference
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#playa" class="md-nav__link">
    <span class="md-ellipsis">
      playa
    </span>
  </a>
  
    <nav class="md-nav" aria-label="playa">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.open" class="md-nav__link">
    <span class="md-ellipsis">
      open
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parse" class="md-nav__link">
    <span class="md-ellipsis">
      parse
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#playa.document" class="md-nav__link">
    <span class="md-ellipsis">
      document
    </span>
  </a>
  
    <nav class="md-nav" aria-label="document">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.document.Destinations" class="md-nav__link">
    <span class="md-ellipsis">
      Destinations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Destinations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.document.Destinations.doc" class="md-nav__link">
    <span class="md-ellipsis">
      doc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Destinations.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Destinations.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      __iter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Destinations.items" class="md-nav__link">
    <span class="md-ellipsis">
      items
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document" class="md-nav__link">
    <span class="md-ellipsis">
      Document
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Document">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.destinations" class="md-nav__link">
    <span class="md-ellipsis">
      destinations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.fonts" class="md-nav__link">
    <span class="md-ellipsis">
      fonts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.names" class="md-nav__link">
    <span class="md-ellipsis">
      names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.objects" class="md-nav__link">
    <span class="md-ellipsis">
      objects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.outline" class="md-nav__link">
    <span class="md-ellipsis">
      outline
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.page_labels" class="md-nav__link">
    <span class="md-ellipsis">
      page_labels
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.pages" class="md-nav__link">
    <span class="md-ellipsis">
      pages
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.structure" class="md-nav__link">
    <span class="md-ellipsis">
      structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.tokens" class="md-nav__link">
    <span class="md-ellipsis">
      tokens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      __iter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document._find_xref" class="md-nav__link">
    <span class="md-ellipsis">
      _find_xref
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document._get_page_objects" class="md-nav__link">
    <span class="md-ellipsis">
      _get_page_objects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document._get_pages_from_xrefs" class="md-nav__link">
    <span class="md-ellipsis">
      _get_pages_from_xrefs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document._initialize_password" class="md-nav__link">
    <span class="md-ellipsis">
      _initialize_password
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document._read_xref_from" class="md-nav__link">
    <span class="md-ellipsis">
      _read_xref_from
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.PageLabels" class="md-nav__link">
    <span class="md-ellipsis">
      PageLabels
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PageLabels">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.document.PageLabels._format_page_label" class="md-nav__link">
    <span class="md-ellipsis">
      _format_page_label
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.PageList" class="md-nav__link">
    <span class="md-ellipsis">
      PageList
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PageList">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.document.PageList.doc" class="md-nav__link">
    <span class="md-ellipsis">
      doc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.PageList.by_id" class="md-nav__link">
    <span class="md-ellipsis">
      by_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.PageList.map" class="md-nav__link">
    <span class="md-ellipsis">
      map
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.call_page" class="md-nav__link">
    <span class="md-ellipsis">
      call_page
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#playa.page" class="md-nav__link">
    <span class="md-ellipsis">
      page
    </span>
  </a>
  
    <nav class="md-nav" aria-label="page">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.page.Annotation" class="md-nav__link">
    <span class="md-ellipsis">
      Annotation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Annotation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.page.Annotation.bbox" class="md-nav__link">
    <span class="md-ellipsis">
      bbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Annotation.contents" class="md-nav__link">
    <span class="md-ellipsis">
      contents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Annotation.mtime" class="md-nav__link">
    <span class="md-ellipsis">
      mtime
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Annotation.name" class="md-nav__link">
    <span class="md-ellipsis">
      name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Annotation.page" class="md-nav__link">
    <span class="md-ellipsis">
      page
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page" class="md-nav__link">
    <span class="md-ellipsis">
      Page
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Page">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.annotations" class="md-nav__link">
    <span class="md-ellipsis">
      annotations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.contents" class="md-nav__link">
    <span class="md-ellipsis">
      contents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.doc" class="md-nav__link">
    <span class="md-ellipsis">
      doc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.fonts" class="md-nav__link">
    <span class="md-ellipsis">
      fonts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.glyphs" class="md-nav__link">
    <span class="md-ellipsis">
      glyphs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.height" class="md-nav__link">
    <span class="md-ellipsis">
      height
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.images" class="md-nav__link">
    <span class="md-ellipsis">
      images
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.mcid_texts" class="md-nav__link">
    <span class="md-ellipsis">
      mcid_texts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.parent_key" class="md-nav__link">
    <span class="md-ellipsis">
      parent_key
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.paths" class="md-nav__link">
    <span class="md-ellipsis">
      paths
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.streams" class="md-nav__link">
    <span class="md-ellipsis">
      streams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.structure" class="md-nav__link">
    <span class="md-ellipsis">
      structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.texts" class="md-nav__link">
    <span class="md-ellipsis">
      texts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.tokens" class="md-nav__link">
    <span class="md-ellipsis">
      tokens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.width" class="md-nav__link">
    <span class="md-ellipsis">
      width
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.xobjects" class="md-nav__link">
    <span class="md-ellipsis">
      xobjects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      __iter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.extract_text" class="md-nav__link">
    <span class="md-ellipsis">
      extract_text
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.extract_text_tagged" class="md-nav__link">
    <span class="md-ellipsis">
      extract_text_tagged
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.extract_text_untagged" class="md-nav__link">
    <span class="md-ellipsis">
      extract_text_untagged
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.flatten" class="md-nav__link">
    <span class="md-ellipsis">
      flatten
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#playa.content" class="md-nav__link">
    <span class="md-ellipsis">
      content
    </span>
  </a>
  
    <nav class="md-nav" aria-label="content">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.content.ContentObject" class="md-nav__link">
    <span class="md-ellipsis">
      ContentObject
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ContentObject">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.content.ContentObject.bbox" class="md-nav__link">
    <span class="md-ellipsis">
      bbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.ContentObject.doc" class="md-nav__link">
    <span class="md-ellipsis">
      doc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.ContentObject.mcid" class="md-nav__link">
    <span class="md-ellipsis">
      mcid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.ContentObject.mcs" class="md-nav__link">
    <span class="md-ellipsis">
      mcs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.ContentObject.object_type" class="md-nav__link">
    <span class="md-ellipsis">
      object_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.ContentObject.page" class="md-nav__link">
    <span class="md-ellipsis">
      page
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.ContentObject.parent" class="md-nav__link">
    <span class="md-ellipsis">
      parent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.ContentObject.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.DashPattern" class="md-nav__link">
    <span class="md-ellipsis">
      DashPattern
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.GlyphObject" class="md-nav__link">
    <span class="md-ellipsis">
      GlyphObject
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GlyphObject">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.content.GlyphObject.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      __iter__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.GraphicState" class="md-nav__link">
    <span class="md-ellipsis">
      GraphicState
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.ImageObject" class="md-nav__link">
    <span class="md-ellipsis">
      ImageObject
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ImageObject">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.content.ImageObject.buffer" class="md-nav__link">
    <span class="md-ellipsis">
      buffer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.ImageObject.parent" class="md-nav__link">
    <span class="md-ellipsis">
      parent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.ImageObject.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.MarkedContent" class="md-nav__link">
    <span class="md-ellipsis">
      MarkedContent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.PathObject" class="md-nav__link">
    <span class="md-ellipsis">
      PathObject
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PathObject">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.content.PathObject.bbox" class="md-nav__link">
    <span class="md-ellipsis">
      bbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.PathObject.segments" class="md-nav__link">
    <span class="md-ellipsis">
      segments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.PathSegment" class="md-nav__link">
    <span class="md-ellipsis">
      PathSegment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.TagObject" class="md-nav__link">
    <span class="md-ellipsis">
      TagObject
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TagObject">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.content.TagObject.bbox" class="md-nav__link">
    <span class="md-ellipsis">
      bbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.TagObject.mcid" class="md-nav__link">
    <span class="md-ellipsis">
      mcid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.TagObject.mcs" class="md-nav__link">
    <span class="md-ellipsis">
      mcs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.TagObject.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.TextObject" class="md-nav__link">
    <span class="md-ellipsis">
      TextObject
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TextObject">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.content.TextObject.chars" class="md-nav__link">
    <span class="md-ellipsis">
      chars
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.TextObject.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      __iter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.TextObject.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.XObjectObject" class="md-nav__link">
    <span class="md-ellipsis">
      XObjectObject
    </span>
  </a>
  
    <nav class="md-nav" aria-label="XObjectObject">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.content.XObjectObject.bbox" class="md-nav__link">
    <span class="md-ellipsis">
      bbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.XObjectObject.buffer" class="md-nav__link">
    <span class="md-ellipsis">
      buffer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.XObjectObject.contents" class="md-nav__link">
    <span class="md-ellipsis">
      contents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.XObjectObject.mcid_texts" class="md-nav__link">
    <span class="md-ellipsis">
      mcid_texts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.XObjectObject.parent" class="md-nav__link">
    <span class="md-ellipsis">
      parent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.XObjectObject.structure" class="md-nav__link">
    <span class="md-ellipsis">
      structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.XObjectObject.tokens" class="md-nav__link">
    <span class="md-ellipsis">
      tokens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.XObjectObject.from_stream" class="md-nav__link">
    <span class="md-ellipsis">
      from_stream
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#playa.structure" class="md-nav__link">
    <span class="md-ellipsis">
      structure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.structure.ContentItem" class="md-nav__link">
    <span class="md-ellipsis">
      ContentItem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ContentItem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.structure.ContentItem.bbox" class="md-nav__link">
    <span class="md-ellipsis">
      bbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.ContentItem.doc" class="md-nav__link">
    <span class="md-ellipsis">
      doc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.ContentItem.page" class="md-nav__link">
    <span class="md-ellipsis">
      page
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.ContentItem.text" class="md-nav__link">
    <span class="md-ellipsis">
      text
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.ContentObject" class="md-nav__link">
    <span class="md-ellipsis">
      ContentObject
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ContentObject">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.structure.ContentObject.bbox" class="md-nav__link">
    <span class="md-ellipsis">
      bbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.ContentObject.doc" class="md-nav__link">
    <span class="md-ellipsis">
      doc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.ContentObject.obj" class="md-nav__link">
    <span class="md-ellipsis">
      obj
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.ContentObject.page" class="md-nav__link">
    <span class="md-ellipsis">
      page
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.ContentObject.type" class="md-nav__link">
    <span class="md-ellipsis">
      type
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.Element" class="md-nav__link">
    <span class="md-ellipsis">
      Element
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Element">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.structure.Element.bbox" class="md-nav__link">
    <span class="md-ellipsis">
      bbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.Element.contents" class="md-nav__link">
    <span class="md-ellipsis">
      contents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.Element.doc" class="md-nav__link">
    <span class="md-ellipsis">
      doc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.Element.page" class="md-nav__link">
    <span class="md-ellipsis">
      page
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.Element.role" class="md-nav__link">
    <span class="md-ellipsis">
      role
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.Element.type" class="md-nav__link">
    <span class="md-ellipsis">
      type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.Element.from_dict" class="md-nav__link">
    <span class="md-ellipsis">
      from_dict
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.Findable" class="md-nav__link">
    <span class="md-ellipsis">
      Findable
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Findable">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.structure.Findable.find" class="md-nav__link">
    <span class="md-ellipsis">
      find
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.Findable.find_all" class="md-nav__link">
    <span class="md-ellipsis">
      find_all
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.Tree" class="md-nav__link">
    <span class="md-ellipsis">
      Tree
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tree">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.structure.Tree.contents" class="md-nav__link">
    <span class="md-ellipsis">
      contents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.Tree.doc" class="md-nav__link">
    <span class="md-ellipsis">
      doc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.Tree.parent_tree" class="md-nav__link">
    <span class="md-ellipsis">
      parent_tree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.Tree.role_map" class="md-nav__link">
    <span class="md-ellipsis">
      role_map
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#playa.outline" class="md-nav__link">
    <span class="md-ellipsis">
      outline
    </span>
  </a>
  
    <nav class="md-nav" aria-label="outline">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.outline.Action" class="md-nav__link">
    <span class="md-ellipsis">
      Action
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Action">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.outline.Action.destination" class="md-nav__link">
    <span class="md-ellipsis">
      destination
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.outline.Action.doc" class="md-nav__link">
    <span class="md-ellipsis">
      doc
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.outline.Destination" class="md-nav__link">
    <span class="md-ellipsis">
      Destination
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.outline.Outline" class="md-nav__link">
    <span class="md-ellipsis">
      Outline
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Outline">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.outline.Outline.destination" class="md-nav__link">
    <span class="md-ellipsis">
      destination
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.outline.Outline.doc" class="md-nav__link">
    <span class="md-ellipsis">
      doc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.outline.Outline.element" class="md-nav__link">
    <span class="md-ellipsis">
      element
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#playa.font" class="md-nav__link">
    <span class="md-ellipsis">
      font
    </span>
  </a>
  
    <nav class="md-nav" aria-label="font">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.font.CIDFont" class="md-nav__link">
    <span class="md-ellipsis">
      CIDFont
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CIDFont">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.font.CIDFont.char_bbox" class="md-nav__link">
    <span class="md-ellipsis">
      char_bbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.font.CIDFont.get_cmap_from_spec" class="md-nav__link">
    <span class="md-ellipsis">
      get_cmap_from_spec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.font.CIDFont.position" class="md-nav__link">
    <span class="md-ellipsis">
      position
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.font.CIDFont.vdisp" class="md-nav__link">
    <span class="md-ellipsis">
      vdisp
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.font.Font" class="md-nav__link">
    <span class="md-ellipsis">
      Font
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Font">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.font.Font.char_bbox" class="md-nav__link">
    <span class="md-ellipsis">
      char_bbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.font.Font.hdisp" class="md-nav__link">
    <span class="md-ellipsis">
      hdisp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.font.Font.position" class="md-nav__link">
    <span class="md-ellipsis">
      position
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.font.Font.vdisp" class="md-nav__link">
    <span class="md-ellipsis">
      vdisp
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.font.Type1Font" class="md-nav__link">
    <span class="md-ellipsis">
      Type1Font
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Type1Font">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.font.Type1Font.char_bbox" class="md-nav__link">
    <span class="md-ellipsis">
      char_bbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.font.Type1Font.hdisp" class="md-nav__link">
    <span class="md-ellipsis">
      hdisp
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.font.Type3Font" class="md-nav__link">
    <span class="md-ellipsis">
      Type3Font
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Type3Font">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.font.Type3Font.char_bbox" class="md-nav__link">
    <span class="md-ellipsis">
      char_bbox
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#playa.parser" class="md-nav__link">
    <span class="md-ellipsis">
      parser
    </span>
  </a>
  
    <nav class="md-nav" aria-label="parser">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.parser.ContentParser" class="md-nav__link">
    <span class="md-ellipsis">
      ContentParser
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ContentParser">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.parser.ContentParser.nexttoken" class="md-nav__link">
    <span class="md-ellipsis">
      nexttoken
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.IndirectObjectParser" class="md-nav__link">
    <span class="md-ellipsis">
      IndirectObjectParser
    </span>
  </a>
  
    <nav class="md-nav" aria-label="IndirectObjectParser">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.parser.IndirectObjectParser.doc" class="md-nav__link">
    <span class="md-ellipsis">
      doc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.IndirectObjectParser.reset" class="md-nav__link">
    <span class="md-ellipsis">
      reset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.IndirectObjectParser.seek" class="md-nav__link">
    <span class="md-ellipsis">
      seek
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.Lexer" class="md-nav__link">
    <span class="md-ellipsis">
      Lexer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lexer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.parser.Lexer.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      __iter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.Lexer.__next__" class="md-nav__link">
    <span class="md-ellipsis">
      __next__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.Lexer.nextline" class="md-nav__link">
    <span class="md-ellipsis">
      nextline
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.Lexer.read" class="md-nav__link">
    <span class="md-ellipsis">
      read
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.Lexer.seek" class="md-nav__link">
    <span class="md-ellipsis">
      seek
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.Lexer.tell" class="md-nav__link">
    <span class="md-ellipsis">
      tell
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.ObjectParser" class="md-nav__link">
    <span class="md-ellipsis">
      ObjectParser
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ObjectParser">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.parser.ObjectParser.doc" class="md-nav__link">
    <span class="md-ellipsis">
      doc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.ObjectParser.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      __iter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.ObjectParser.__next__" class="md-nav__link">
    <span class="md-ellipsis">
      __next__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.ObjectParser.get_inline_image" class="md-nav__link">
    <span class="md-ellipsis">
      get_inline_image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.ObjectParser.get_object_reference" class="md-nav__link">
    <span class="md-ellipsis">
      get_object_reference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.ObjectParser.newstream" class="md-nav__link">
    <span class="md-ellipsis">
      newstream
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.ObjectParser.nextline" class="md-nav__link">
    <span class="md-ellipsis">
      nextline
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.ObjectParser.nexttoken" class="md-nav__link">
    <span class="md-ellipsis">
      nexttoken
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.ObjectParser.pop_to" class="md-nav__link">
    <span class="md-ellipsis">
      pop_to
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.ObjectParser.read" class="md-nav__link">
    <span class="md-ellipsis">
      read
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.ObjectParser.reset" class="md-nav__link">
    <span class="md-ellipsis">
      reset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.ObjectParser.seek" class="md-nav__link">
    <span class="md-ellipsis">
      seek
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.ObjectParser.tell" class="md-nav__link">
    <span class="md-ellipsis">
      tell
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.ObjectStreamParser" class="md-nav__link">
    <span class="md-ellipsis">
      ObjectStreamParser
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.reverse_iter_lines" class="md-nav__link">
    <span class="md-ellipsis">
      reverse_iter_lines
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#playa.worker" class="md-nav__link">
    <span class="md-ellipsis">
      worker
    </span>
  </a>
  
    <nav class="md-nav" aria-label="worker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.worker.in_worker" class="md-nav__link">
    <span class="md-ellipsis">
      in_worker
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data API
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#playa" class="md-nav__link">
    <span class="md-ellipsis">
      playa
    </span>
  </a>
  
    <nav class="md-nav" aria-label="playa">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.open" class="md-nav__link">
    <span class="md-ellipsis">
      open
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parse" class="md-nav__link">
    <span class="md-ellipsis">
      parse
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#playa.document" class="md-nav__link">
    <span class="md-ellipsis">
      document
    </span>
  </a>
  
    <nav class="md-nav" aria-label="document">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.document.Destinations" class="md-nav__link">
    <span class="md-ellipsis">
      Destinations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Destinations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.document.Destinations.doc" class="md-nav__link">
    <span class="md-ellipsis">
      doc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Destinations.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Destinations.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      __iter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Destinations.items" class="md-nav__link">
    <span class="md-ellipsis">
      items
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document" class="md-nav__link">
    <span class="md-ellipsis">
      Document
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Document">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.destinations" class="md-nav__link">
    <span class="md-ellipsis">
      destinations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.fonts" class="md-nav__link">
    <span class="md-ellipsis">
      fonts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.names" class="md-nav__link">
    <span class="md-ellipsis">
      names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.objects" class="md-nav__link">
    <span class="md-ellipsis">
      objects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.outline" class="md-nav__link">
    <span class="md-ellipsis">
      outline
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.page_labels" class="md-nav__link">
    <span class="md-ellipsis">
      page_labels
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.pages" class="md-nav__link">
    <span class="md-ellipsis">
      pages
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.structure" class="md-nav__link">
    <span class="md-ellipsis">
      structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.tokens" class="md-nav__link">
    <span class="md-ellipsis">
      tokens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      __iter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document._find_xref" class="md-nav__link">
    <span class="md-ellipsis">
      _find_xref
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document._get_page_objects" class="md-nav__link">
    <span class="md-ellipsis">
      _get_page_objects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document._get_pages_from_xrefs" class="md-nav__link">
    <span class="md-ellipsis">
      _get_pages_from_xrefs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document._initialize_password" class="md-nav__link">
    <span class="md-ellipsis">
      _initialize_password
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.Document._read_xref_from" class="md-nav__link">
    <span class="md-ellipsis">
      _read_xref_from
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.PageLabels" class="md-nav__link">
    <span class="md-ellipsis">
      PageLabels
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PageLabels">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.document.PageLabels._format_page_label" class="md-nav__link">
    <span class="md-ellipsis">
      _format_page_label
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.PageList" class="md-nav__link">
    <span class="md-ellipsis">
      PageList
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PageList">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.document.PageList.doc" class="md-nav__link">
    <span class="md-ellipsis">
      doc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.PageList.by_id" class="md-nav__link">
    <span class="md-ellipsis">
      by_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.PageList.map" class="md-nav__link">
    <span class="md-ellipsis">
      map
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.document.call_page" class="md-nav__link">
    <span class="md-ellipsis">
      call_page
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#playa.page" class="md-nav__link">
    <span class="md-ellipsis">
      page
    </span>
  </a>
  
    <nav class="md-nav" aria-label="page">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.page.Annotation" class="md-nav__link">
    <span class="md-ellipsis">
      Annotation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Annotation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.page.Annotation.bbox" class="md-nav__link">
    <span class="md-ellipsis">
      bbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Annotation.contents" class="md-nav__link">
    <span class="md-ellipsis">
      contents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Annotation.mtime" class="md-nav__link">
    <span class="md-ellipsis">
      mtime
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Annotation.name" class="md-nav__link">
    <span class="md-ellipsis">
      name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Annotation.page" class="md-nav__link">
    <span class="md-ellipsis">
      page
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page" class="md-nav__link">
    <span class="md-ellipsis">
      Page
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Page">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.annotations" class="md-nav__link">
    <span class="md-ellipsis">
      annotations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.contents" class="md-nav__link">
    <span class="md-ellipsis">
      contents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.doc" class="md-nav__link">
    <span class="md-ellipsis">
      doc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.fonts" class="md-nav__link">
    <span class="md-ellipsis">
      fonts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.glyphs" class="md-nav__link">
    <span class="md-ellipsis">
      glyphs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.height" class="md-nav__link">
    <span class="md-ellipsis">
      height
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.images" class="md-nav__link">
    <span class="md-ellipsis">
      images
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.mcid_texts" class="md-nav__link">
    <span class="md-ellipsis">
      mcid_texts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.parent_key" class="md-nav__link">
    <span class="md-ellipsis">
      parent_key
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.paths" class="md-nav__link">
    <span class="md-ellipsis">
      paths
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.streams" class="md-nav__link">
    <span class="md-ellipsis">
      streams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.structure" class="md-nav__link">
    <span class="md-ellipsis">
      structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.texts" class="md-nav__link">
    <span class="md-ellipsis">
      texts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.tokens" class="md-nav__link">
    <span class="md-ellipsis">
      tokens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.width" class="md-nav__link">
    <span class="md-ellipsis">
      width
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.xobjects" class="md-nav__link">
    <span class="md-ellipsis">
      xobjects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      __iter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.extract_text" class="md-nav__link">
    <span class="md-ellipsis">
      extract_text
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.extract_text_tagged" class="md-nav__link">
    <span class="md-ellipsis">
      extract_text_tagged
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.extract_text_untagged" class="md-nav__link">
    <span class="md-ellipsis">
      extract_text_untagged
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.page.Page.flatten" class="md-nav__link">
    <span class="md-ellipsis">
      flatten
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#playa.content" class="md-nav__link">
    <span class="md-ellipsis">
      content
    </span>
  </a>
  
    <nav class="md-nav" aria-label="content">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.content.ContentObject" class="md-nav__link">
    <span class="md-ellipsis">
      ContentObject
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ContentObject">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.content.ContentObject.bbox" class="md-nav__link">
    <span class="md-ellipsis">
      bbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.ContentObject.doc" class="md-nav__link">
    <span class="md-ellipsis">
      doc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.ContentObject.mcid" class="md-nav__link">
    <span class="md-ellipsis">
      mcid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.ContentObject.mcs" class="md-nav__link">
    <span class="md-ellipsis">
      mcs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.ContentObject.object_type" class="md-nav__link">
    <span class="md-ellipsis">
      object_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.ContentObject.page" class="md-nav__link">
    <span class="md-ellipsis">
      page
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.ContentObject.parent" class="md-nav__link">
    <span class="md-ellipsis">
      parent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.ContentObject.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.DashPattern" class="md-nav__link">
    <span class="md-ellipsis">
      DashPattern
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.GlyphObject" class="md-nav__link">
    <span class="md-ellipsis">
      GlyphObject
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GlyphObject">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.content.GlyphObject.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      __iter__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.GraphicState" class="md-nav__link">
    <span class="md-ellipsis">
      GraphicState
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.ImageObject" class="md-nav__link">
    <span class="md-ellipsis">
      ImageObject
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ImageObject">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.content.ImageObject.buffer" class="md-nav__link">
    <span class="md-ellipsis">
      buffer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.ImageObject.parent" class="md-nav__link">
    <span class="md-ellipsis">
      parent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.ImageObject.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.MarkedContent" class="md-nav__link">
    <span class="md-ellipsis">
      MarkedContent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.PathObject" class="md-nav__link">
    <span class="md-ellipsis">
      PathObject
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PathObject">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.content.PathObject.bbox" class="md-nav__link">
    <span class="md-ellipsis">
      bbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.PathObject.segments" class="md-nav__link">
    <span class="md-ellipsis">
      segments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.PathSegment" class="md-nav__link">
    <span class="md-ellipsis">
      PathSegment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.TagObject" class="md-nav__link">
    <span class="md-ellipsis">
      TagObject
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TagObject">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.content.TagObject.bbox" class="md-nav__link">
    <span class="md-ellipsis">
      bbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.TagObject.mcid" class="md-nav__link">
    <span class="md-ellipsis">
      mcid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.TagObject.mcs" class="md-nav__link">
    <span class="md-ellipsis">
      mcs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.TagObject.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.TextObject" class="md-nav__link">
    <span class="md-ellipsis">
      TextObject
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TextObject">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.content.TextObject.chars" class="md-nav__link">
    <span class="md-ellipsis">
      chars
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.TextObject.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      __iter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.TextObject.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.XObjectObject" class="md-nav__link">
    <span class="md-ellipsis">
      XObjectObject
    </span>
  </a>
  
    <nav class="md-nav" aria-label="XObjectObject">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.content.XObjectObject.bbox" class="md-nav__link">
    <span class="md-ellipsis">
      bbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.XObjectObject.buffer" class="md-nav__link">
    <span class="md-ellipsis">
      buffer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.XObjectObject.contents" class="md-nav__link">
    <span class="md-ellipsis">
      contents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.XObjectObject.mcid_texts" class="md-nav__link">
    <span class="md-ellipsis">
      mcid_texts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.XObjectObject.parent" class="md-nav__link">
    <span class="md-ellipsis">
      parent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.XObjectObject.structure" class="md-nav__link">
    <span class="md-ellipsis">
      structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.XObjectObject.tokens" class="md-nav__link">
    <span class="md-ellipsis">
      tokens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.content.XObjectObject.from_stream" class="md-nav__link">
    <span class="md-ellipsis">
      from_stream
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#playa.structure" class="md-nav__link">
    <span class="md-ellipsis">
      structure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.structure.ContentItem" class="md-nav__link">
    <span class="md-ellipsis">
      ContentItem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ContentItem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.structure.ContentItem.bbox" class="md-nav__link">
    <span class="md-ellipsis">
      bbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.ContentItem.doc" class="md-nav__link">
    <span class="md-ellipsis">
      doc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.ContentItem.page" class="md-nav__link">
    <span class="md-ellipsis">
      page
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.ContentItem.text" class="md-nav__link">
    <span class="md-ellipsis">
      text
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.ContentObject" class="md-nav__link">
    <span class="md-ellipsis">
      ContentObject
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ContentObject">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.structure.ContentObject.bbox" class="md-nav__link">
    <span class="md-ellipsis">
      bbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.ContentObject.doc" class="md-nav__link">
    <span class="md-ellipsis">
      doc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.ContentObject.obj" class="md-nav__link">
    <span class="md-ellipsis">
      obj
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.ContentObject.page" class="md-nav__link">
    <span class="md-ellipsis">
      page
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.ContentObject.type" class="md-nav__link">
    <span class="md-ellipsis">
      type
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.Element" class="md-nav__link">
    <span class="md-ellipsis">
      Element
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Element">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.structure.Element.bbox" class="md-nav__link">
    <span class="md-ellipsis">
      bbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.Element.contents" class="md-nav__link">
    <span class="md-ellipsis">
      contents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.Element.doc" class="md-nav__link">
    <span class="md-ellipsis">
      doc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.Element.page" class="md-nav__link">
    <span class="md-ellipsis">
      page
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.Element.role" class="md-nav__link">
    <span class="md-ellipsis">
      role
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.Element.type" class="md-nav__link">
    <span class="md-ellipsis">
      type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.Element.from_dict" class="md-nav__link">
    <span class="md-ellipsis">
      from_dict
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.Findable" class="md-nav__link">
    <span class="md-ellipsis">
      Findable
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Findable">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.structure.Findable.find" class="md-nav__link">
    <span class="md-ellipsis">
      find
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.Findable.find_all" class="md-nav__link">
    <span class="md-ellipsis">
      find_all
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.Tree" class="md-nav__link">
    <span class="md-ellipsis">
      Tree
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tree">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.structure.Tree.contents" class="md-nav__link">
    <span class="md-ellipsis">
      contents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.Tree.doc" class="md-nav__link">
    <span class="md-ellipsis">
      doc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.Tree.parent_tree" class="md-nav__link">
    <span class="md-ellipsis">
      parent_tree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.structure.Tree.role_map" class="md-nav__link">
    <span class="md-ellipsis">
      role_map
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#playa.outline" class="md-nav__link">
    <span class="md-ellipsis">
      outline
    </span>
  </a>
  
    <nav class="md-nav" aria-label="outline">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.outline.Action" class="md-nav__link">
    <span class="md-ellipsis">
      Action
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Action">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.outline.Action.destination" class="md-nav__link">
    <span class="md-ellipsis">
      destination
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.outline.Action.doc" class="md-nav__link">
    <span class="md-ellipsis">
      doc
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.outline.Destination" class="md-nav__link">
    <span class="md-ellipsis">
      Destination
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.outline.Outline" class="md-nav__link">
    <span class="md-ellipsis">
      Outline
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Outline">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.outline.Outline.destination" class="md-nav__link">
    <span class="md-ellipsis">
      destination
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.outline.Outline.doc" class="md-nav__link">
    <span class="md-ellipsis">
      doc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.outline.Outline.element" class="md-nav__link">
    <span class="md-ellipsis">
      element
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#playa.font" class="md-nav__link">
    <span class="md-ellipsis">
      font
    </span>
  </a>
  
    <nav class="md-nav" aria-label="font">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.font.CIDFont" class="md-nav__link">
    <span class="md-ellipsis">
      CIDFont
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CIDFont">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.font.CIDFont.char_bbox" class="md-nav__link">
    <span class="md-ellipsis">
      char_bbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.font.CIDFont.get_cmap_from_spec" class="md-nav__link">
    <span class="md-ellipsis">
      get_cmap_from_spec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.font.CIDFont.position" class="md-nav__link">
    <span class="md-ellipsis">
      position
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.font.CIDFont.vdisp" class="md-nav__link">
    <span class="md-ellipsis">
      vdisp
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.font.Font" class="md-nav__link">
    <span class="md-ellipsis">
      Font
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Font">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.font.Font.char_bbox" class="md-nav__link">
    <span class="md-ellipsis">
      char_bbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.font.Font.hdisp" class="md-nav__link">
    <span class="md-ellipsis">
      hdisp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.font.Font.position" class="md-nav__link">
    <span class="md-ellipsis">
      position
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.font.Font.vdisp" class="md-nav__link">
    <span class="md-ellipsis">
      vdisp
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.font.Type1Font" class="md-nav__link">
    <span class="md-ellipsis">
      Type1Font
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Type1Font">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.font.Type1Font.char_bbox" class="md-nav__link">
    <span class="md-ellipsis">
      char_bbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.font.Type1Font.hdisp" class="md-nav__link">
    <span class="md-ellipsis">
      hdisp
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.font.Type3Font" class="md-nav__link">
    <span class="md-ellipsis">
      Type3Font
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Type3Font">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.font.Type3Font.char_bbox" class="md-nav__link">
    <span class="md-ellipsis">
      char_bbox
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#playa.parser" class="md-nav__link">
    <span class="md-ellipsis">
      parser
    </span>
  </a>
  
    <nav class="md-nav" aria-label="parser">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.parser.ContentParser" class="md-nav__link">
    <span class="md-ellipsis">
      ContentParser
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ContentParser">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.parser.ContentParser.nexttoken" class="md-nav__link">
    <span class="md-ellipsis">
      nexttoken
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.IndirectObjectParser" class="md-nav__link">
    <span class="md-ellipsis">
      IndirectObjectParser
    </span>
  </a>
  
    <nav class="md-nav" aria-label="IndirectObjectParser">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.parser.IndirectObjectParser.doc" class="md-nav__link">
    <span class="md-ellipsis">
      doc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.IndirectObjectParser.reset" class="md-nav__link">
    <span class="md-ellipsis">
      reset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.IndirectObjectParser.seek" class="md-nav__link">
    <span class="md-ellipsis">
      seek
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.Lexer" class="md-nav__link">
    <span class="md-ellipsis">
      Lexer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lexer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.parser.Lexer.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      __iter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.Lexer.__next__" class="md-nav__link">
    <span class="md-ellipsis">
      __next__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.Lexer.nextline" class="md-nav__link">
    <span class="md-ellipsis">
      nextline
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.Lexer.read" class="md-nav__link">
    <span class="md-ellipsis">
      read
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.Lexer.seek" class="md-nav__link">
    <span class="md-ellipsis">
      seek
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.Lexer.tell" class="md-nav__link">
    <span class="md-ellipsis">
      tell
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.ObjectParser" class="md-nav__link">
    <span class="md-ellipsis">
      ObjectParser
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ObjectParser">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.parser.ObjectParser.doc" class="md-nav__link">
    <span class="md-ellipsis">
      doc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.ObjectParser.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      __iter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.ObjectParser.__next__" class="md-nav__link">
    <span class="md-ellipsis">
      __next__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.ObjectParser.get_inline_image" class="md-nav__link">
    <span class="md-ellipsis">
      get_inline_image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.ObjectParser.get_object_reference" class="md-nav__link">
    <span class="md-ellipsis">
      get_object_reference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.ObjectParser.newstream" class="md-nav__link">
    <span class="md-ellipsis">
      newstream
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.ObjectParser.nextline" class="md-nav__link">
    <span class="md-ellipsis">
      nextline
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.ObjectParser.nexttoken" class="md-nav__link">
    <span class="md-ellipsis">
      nexttoken
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.ObjectParser.pop_to" class="md-nav__link">
    <span class="md-ellipsis">
      pop_to
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.ObjectParser.read" class="md-nav__link">
    <span class="md-ellipsis">
      read
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.ObjectParser.reset" class="md-nav__link">
    <span class="md-ellipsis">
      reset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.ObjectParser.seek" class="md-nav__link">
    <span class="md-ellipsis">
      seek
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.ObjectParser.tell" class="md-nav__link">
    <span class="md-ellipsis">
      tell
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.ObjectStreamParser" class="md-nav__link">
    <span class="md-ellipsis">
      ObjectStreamParser
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playa.parser.reverse_iter_lines" class="md-nav__link">
    <span class="md-ellipsis">
      reverse_iter_lines
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#playa.worker" class="md-nav__link">
    <span class="md-ellipsis">
      worker
    </span>
  </a>
  
    <nav class="md-nav" aria-label="worker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playa.worker.in_worker" class="md-nav__link">
    <span class="md-ellipsis">
      in_worker
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="reference">Reference</h1>


<div class="doc doc-object doc-module">



<h2 id="playa" class="doc doc-heading">
            <code>playa</code>


</h2>

    <div class="doc doc-contents first">

        <p>PLAYA ain't a LAYout Analyzer... but it can help you get stuff
out of PDFs.</p>
<p>Basic usage:</p>
<pre><code>with playa.open(path) as pdf:
    for page in pdf.pages:
        print(f"page {page.label}:")
        for obj in page:
            print(f"    {obj.object_type} at {obj.bbox}")
            if obj.object_type == "text":
                print(f"        chars: {obj.chars}")
</code></pre>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="playa.open" class="doc doc-heading">
            <code class="highlight language-python"><span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">space</span><span class="o">=</span><span class="s1">&#39;screen&#39;</span><span class="p">,</span> <span class="n">max_workers</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mp_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Open a PDF document from a path on the filesystem.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="os.PathLike">PathLike</span>, str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the document to open.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>space</code>
            </td>
            <td>
                  <code><span title="playa.page.DeviceSpace">DeviceSpace</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Device space to use ("screen" for screen-like
   coordinates, "page" for pdfminer.six-like coordinates, "default" for
   default user space with no rotation or translation)</p>
              </div>
            </td>
            <td>
                  <code>&#39;screen&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_workers</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[int, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of worker processes to use for parallel
         processing of pages (if 1, no workers are spawned)</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mp_context</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="multiprocessing.context.BaseContext">BaseContext</span>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Multiprocessing context to use for worker
        processes, see <a href="https://docs.python.org/3/library/multiprocessing.html#contexts-and-start-methods">Contexts and Start
        Methods</a>
        for more information.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>playa/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span>
<span class="normal">99</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">open</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">PathLike</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">space</span><span class="p">:</span> <span class="n">DeviceSpace</span> <span class="o">=</span> <span class="s2">&quot;screen&quot;</span><span class="p">,</span>
    <span class="n">max_workers</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">mp_context</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">BaseContext</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Document</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Open a PDF document from a path on the filesystem.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: Path to the document to open.</span>
<span class="sd">        space: Device space to use (&quot;screen&quot; for screen-like</span>
<span class="sd">               coordinates, &quot;page&quot; for pdfminer.six-like coordinates, &quot;default&quot; for</span>
<span class="sd">               default user space with no rotation or translation)</span>
<span class="sd">        max_workers: Number of worker processes to use for parallel</span>
<span class="sd">                     processing of pages (if 1, no workers are spawned)</span>
<span class="sd">        mp_context: Multiprocessing context to use for worker</span>
<span class="sd">                    processes, see [Contexts and Start</span>
<span class="sd">                    Methods](https://docs.python.org/3/library/multiprocessing.html#contexts-and-start-methods)</span>
<span class="sd">                    for more information.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fp</span> <span class="o">=</span> <span class="n">builtins</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
    <span class="n">pdf</span> <span class="o">=</span> <span class="n">Document</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span> <span class="n">space</span><span class="o">=</span><span class="n">space</span><span class="p">)</span>
    <span class="n">pdf</span><span class="o">.</span><span class="n">_fp</span> <span class="o">=</span> <span class="n">fp</span>
    <span class="k">if</span> <span class="n">max_workers</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">max_workers</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">_pool</span> <span class="o">=</span> <span class="n">ProcessPoolExecutor</span><span class="p">(</span>
            <span class="n">max_workers</span><span class="o">=</span><span class="n">max_workers</span><span class="p">,</span>
            <span class="n">mp_context</span><span class="o">=</span><span class="n">mp_context</span><span class="p">,</span>
            <span class="n">initializer</span><span class="o">=</span><span class="n">_init_worker</span><span class="p">,</span>  <span class="c1"># type: ignore[arg-type]</span>
            <span class="n">initargs</span><span class="o">=</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">pdf</span><span class="p">),</span> <span class="n">path</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">space</span><span class="p">),</span>  <span class="c1"># type: ignore[arg-type]</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">pdf</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="playa.parse" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">space</span><span class="o">=</span><span class="s1">&#39;screen&#39;</span><span class="p">,</span> <span class="n">max_workers</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mp_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Read a PDF document from binary data.</p>


<details class="note" open>
  <summary>Potential slowness</summary>
  <p>When using multiple processes, this results in the entire
buffer being copied to the worker processes for the moment,
which may cause some overhead.  It is preferable to use <code>open</code>
on a filesystem path if possible, since that uses
memory-mapped I/O.</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>buffer</code>
            </td>
            <td>
                  <code>bytes</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Buffer containing PDF data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>space</code>
            </td>
            <td>
                  <code><span title="playa.page.DeviceSpace">DeviceSpace</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Device space to use ("screen" for screen-like
   coordinates, "page" for pdfminer.six-like coordinates, "default" for
   default user space with no rotation or translation)</p>
              </div>
            </td>
            <td>
                  <code>&#39;screen&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_workers</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[int, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of worker processes to use for parallel
         processing of pages (if 1, no workers are spawned)</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mp_context</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="multiprocessing.context.BaseContext">BaseContext</span>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Multiprocessing context to use for worker
        processes, see <a href="https://docs.python.org/3/library/multiprocessing.html#contexts-and-start-methods">Contexts and Start
        Methods</a>
        for more information.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>playa/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">parse</span><span class="p">(</span>
    <span class="n">buffer</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">space</span><span class="p">:</span> <span class="n">DeviceSpace</span> <span class="o">=</span> <span class="s2">&quot;screen&quot;</span><span class="p">,</span>
    <span class="n">max_workers</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">mp_context</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">BaseContext</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Document</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read a PDF document from binary data.</span>

<span class="sd">    Note: Potential slowness</span>
<span class="sd">        When using multiple processes, this results in the entire</span>
<span class="sd">        buffer being copied to the worker processes for the moment,</span>
<span class="sd">        which may cause some overhead.  It is preferable to use `open`</span>
<span class="sd">        on a filesystem path if possible, since that uses</span>
<span class="sd">        memory-mapped I/O.</span>

<span class="sd">    Args:</span>
<span class="sd">        buffer: Buffer containing PDF data.</span>
<span class="sd">        space: Device space to use (&quot;screen&quot; for screen-like</span>
<span class="sd">               coordinates, &quot;page&quot; for pdfminer.six-like coordinates, &quot;default&quot; for</span>
<span class="sd">               default user space with no rotation or translation)</span>
<span class="sd">        max_workers: Number of worker processes to use for parallel</span>
<span class="sd">                     processing of pages (if 1, no workers are spawned)</span>
<span class="sd">        mp_context: Multiprocessing context to use for worker</span>
<span class="sd">                    processes, see [Contexts and Start</span>
<span class="sd">                    Methods](https://docs.python.org/3/library/multiprocessing.html#contexts-and-start-methods)</span>
<span class="sd">                    for more information.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pdf</span> <span class="o">=</span> <span class="n">Document</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span> <span class="n">space</span><span class="o">=</span><span class="n">space</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">max_workers</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">max_workers</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">_pool</span> <span class="o">=</span> <span class="n">ProcessPoolExecutor</span><span class="p">(</span>
            <span class="n">max_workers</span><span class="o">=</span><span class="n">max_workers</span><span class="p">,</span>
            <span class="n">mp_context</span><span class="o">=</span><span class="n">mp_context</span><span class="p">,</span>
            <span class="n">initializer</span><span class="o">=</span><span class="n">_init_worker_buffer</span><span class="p">,</span>  <span class="c1"># type: ignore[arg-type]</span>
            <span class="n">initargs</span><span class="o">=</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">pdf</span><span class="p">),</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">space</span><span class="p">),</span>  <span class="c1"># type: ignore[arg-type]</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">pdf</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="playa.document" class="doc doc-heading">
            <code>playa.document</code>


</h2>

    <div class="doc doc-contents first">

        <p>Basic classes for PDF document parsing.</p>








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="playa.document.Destinations" class="doc doc-heading">
            <code>Destinations</code>


</h3>


    <div class="doc doc-contents ">


        <p>Mapping of named destinations.</p>
<p>These either come as a NameTree or a dict, depending on the
version of the PDF standard, so this abstracts that away.</p>






              <details class="quote">
                <summary>Source code in <code>playa/document.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Destinations</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Mapping of named destinations.</span>

<span class="sd">    These either come as a NameTree or a dict, depending on the</span>
<span class="sd">    version of the PDF standard, so this abstracts that away.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dests_dict</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">dests_tree</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">NameTree</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Document</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_docref</span> <span class="o">=</span> <span class="n">_ref_document</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dests</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Destination</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="s2">&quot;Dests&quot;</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">catalog</span><span class="p">:</span>
            <span class="c1"># PDF-1.1: dictionary</span>
            <span class="n">dests_dict</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">catalog</span><span class="p">[</span><span class="s2">&quot;Dests&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dests_dict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dests_dict</span> <span class="o">=</span> <span class="n">dests_dict</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;Dests entry in catalog is not dictionary: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests_dict</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dests_dict</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="s2">&quot;Names&quot;</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">catalog</span><span class="p">:</span>
            <span class="n">names</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">catalog</span><span class="p">[</span><span class="s2">&quot;Names&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Names entry in catalog is not dictionary: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="s2">&quot;Dests&quot;</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
                <span class="n">dests</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="s2">&quot;Dests&quot;</span><span class="p">])</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Dests entry in names is not dictionary: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dests</span><span class="p">)</span>
                    <span class="k">return</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dests_tree</span> <span class="o">=</span> <span class="n">NameTree</span><span class="p">(</span><span class="n">dests</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over names of destinations.</span>

<span class="sd">        Danger: Beware of corrupted PDFs</span>
<span class="sd">            This simply iterates over the names listed in the PDF, and</span>
<span class="sd">            does not attempt to actually parse the destinations</span>
<span class="sd">            (because that&#39;s pretty slow).  If the PDF is broken, you</span>
<span class="sd">            may encounter exceptions when actually trying to access</span>
<span class="sd">            them by name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests_dict</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests_tree</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">kb</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests_tree</span><span class="p">:</span>
                <span class="n">ks</span> <span class="o">=</span> <span class="n">decode_text</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span>
                <span class="k">yield</span> <span class="n">ks</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Destination</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over named destinations.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">dest</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests</span><span class="p">:</span>
                    <span class="n">dest</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dests_dict</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">dests</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_dest</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                <span class="k">yield</span> <span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests_tree</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests_tree</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">decode_text</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests</span><span class="p">:</span>
                    <span class="n">dest</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">dests</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_dest</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                <span class="k">yield</span> <span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">PSLiteral</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Destination</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a named destination.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: The name of the destination.</span>

<span class="sd">        Raises:</span>
<span class="sd">            KeyError: If no such destination exists.</span>
<span class="sd">            TypeError: If the PDF is damaged and the destinations tree</span>
<span class="sd">                contains something unexpected or missing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">decode_text</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">PSLiteral</span><span class="p">):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">literal_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># This will raise KeyError or TypeError if necessary, so</span>
            <span class="c1"># we don&#39;t have to do it explicitly</span>
            <span class="n">dest</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dests_dict</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dests</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_dest</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests_tree</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># This is not at all efficient, but we need to decode</span>
            <span class="c1"># the keys (and we cache the result...)</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests_tree</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">decode_text</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                    <span class="n">dest</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">dests</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_dest</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                    <span class="k">break</span>
        <span class="c1"># This will also raise KeyError if necessary</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_create_dest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dest</span><span class="p">:</span> <span class="n">PDFObject</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Destination</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Destination</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="p">,</span> <span class="n">dest</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">&quot;D&quot;</span> <span class="ow">in</span> <span class="n">dest</span><span class="p">:</span>
            <span class="n">destlist</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">dest</span><span class="p">[</span><span class="s2">&quot;D&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destlist</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Invalid destination for </span><span class="si">%s</span><span class="s2">: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">dest</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Destination</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="p">,</span> <span class="n">destlist</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Invalid destination for </span><span class="si">%s</span><span class="s2">: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">dest</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">doc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Document&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get associated document if it exists.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_deref_document</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_docref</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="playa.document.Destinations.doc" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">doc</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Get associated document if it exists.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="playa.document.Destinations.__getitem__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__getitem__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get a named destination.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[bytes, str, <span title="playa.parser.PSLiteral">PSLiteral</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the destination.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>KeyError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If no such destination exists.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>TypeError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the PDF is damaged and the destinations tree
contains something unexpected or missing.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>playa/document.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">PSLiteral</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Destination</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a named destination.</span>

<span class="sd">    Args:</span>
<span class="sd">        name: The name of the destination.</span>

<span class="sd">    Raises:</span>
<span class="sd">        KeyError: If no such destination exists.</span>
<span class="sd">        TypeError: If the PDF is damaged and the destinations tree</span>
<span class="sd">            contains something unexpected or missing.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">decode_text</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">PSLiteral</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">literal_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># This will raise KeyError or TypeError if necessary, so</span>
        <span class="c1"># we don&#39;t have to do it explicitly</span>
        <span class="n">dest</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dests_dict</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dests</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_dest</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests_tree</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># This is not at all efficient, but we need to decode</span>
        <span class="c1"># the keys (and we cache the result...)</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests_tree</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">decode_text</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                <span class="n">dest</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dests</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_dest</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                <span class="k">break</span>
    <span class="c1"># This will also raise KeyError if necessary</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.document.Destinations.__iter__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__iter__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Iterate over names of destinations.</p>


<details class="danger" open>
  <summary>Beware of corrupted PDFs</summary>
  <p>This simply iterates over the names listed in the PDF, and
does not attempt to actually parse the destinations
(because that's pretty slow).  If the PDF is broken, you
may encounter exceptions when actually trying to access
them by name.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>playa/document.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterate over names of destinations.</span>

<span class="sd">    Danger: Beware of corrupted PDFs</span>
<span class="sd">        This simply iterates over the names listed in the PDF, and</span>
<span class="sd">        does not attempt to actually parse the destinations</span>
<span class="sd">        (because that&#39;s pretty slow).  If the PDF is broken, you</span>
<span class="sd">        may encounter exceptions when actually trying to access</span>
<span class="sd">        them by name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests_dict</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests_tree</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">kb</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests_tree</span><span class="p">:</span>
            <span class="n">ks</span> <span class="o">=</span> <span class="n">decode_text</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span>
            <span class="k">yield</span> <span class="n">ks</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.document.Destinations.items" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">items</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Iterate over named destinations.</p>

            <details class="quote">
              <summary>Source code in <code>playa/document.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Destination</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterate over named destinations.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">dest</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests</span><span class="p">:</span>
                <span class="n">dest</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dests_dict</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dests</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_dest</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">yield</span> <span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests_tree</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests_tree</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">decode_text</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests</span><span class="p">:</span>
                <span class="n">dest</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dests</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_dest</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">yield</span> <span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dests</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.document.Document" class="doc doc-heading">
            <code>Document</code>


</h3>


    <div class="doc doc-contents ">


        <p>Representation of a PDF document.</p>
<p>Since PDF documents can be very large and complex, merely creating
a <code>Document</code> does very little aside from verifying that the
password is correct and getting a minimal amount of metadata.  In
general, PLAYA will try to open just about anything as a PDF, so
you should not expect the constructor to fail here if you give it
nonsense (something else may fail later on).</p>
<p>Some metadata, such as the structure tree and page tree, will be
loaded lazily and cached.  We do not handle modification of PDFs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fp</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="typing.BinaryIO">BinaryIO</span>, bytes]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>File-like object in binary mode, or a buffer with binary data.
  Files will be read using <code>mmap</code> if possible.  They do not need
  to be seekable, as if <code>mmap</code> fails the entire file will simply
  be read into memory (so a pipe or socket ought to work).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>password</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Password for decryption, if needed.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>space</code>
            </td>
            <td>
                  <code><span title="playa.page.DeviceSpace">DeviceSpace</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the device space to use for interpreting content ("screen"
  or "page")</p>
              </div>
            </td>
            <td>
                  <code>&#39;screen&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>TypeError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if <code>fp</code> is a file opened in text mode (don't do that!)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="playa.exceptions.PDFEncryptionError">PDFEncryptionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if the PDF has an unsupported encryption scheme</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="playa.exceptions.PDFPasswordIncorrect">PDFPasswordIncorrect</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if the password is incorrect</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>playa/document.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Document</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Representation of a PDF document.</span>

<span class="sd">    Since PDF documents can be very large and complex, merely creating</span>
<span class="sd">    a `Document` does very little aside from verifying that the</span>
<span class="sd">    password is correct and getting a minimal amount of metadata.  In</span>
<span class="sd">    general, PLAYA will try to open just about anything as a PDF, so</span>
<span class="sd">    you should not expect the constructor to fail here if you give it</span>
<span class="sd">    nonsense (something else may fail later on).</span>

<span class="sd">    Some metadata, such as the structure tree and page tree, will be</span>
<span class="sd">    loaded lazily and cached.  We do not handle modification of PDFs.</span>

<span class="sd">    Args:</span>
<span class="sd">      fp: File-like object in binary mode, or a buffer with binary data.</span>
<span class="sd">          Files will be read using `mmap` if possible.  They do not need</span>
<span class="sd">          to be seekable, as if `mmap` fails the entire file will simply</span>
<span class="sd">          be read into memory (so a pipe or socket ought to work).</span>
<span class="sd">      password: Password for decryption, if needed.</span>
<span class="sd">      space: the device space to use for interpreting content (&quot;screen&quot;</span>
<span class="sd">          or &quot;page&quot;)</span>

<span class="sd">    Raises:</span>
<span class="sd">      TypeError: if `fp` is a file opened in text mode (don&#39;t do that!)</span>
<span class="sd">      PDFEncryptionError: if the PDF has an unsupported encryption scheme</span>
<span class="sd">      PDFPasswordIncorrect: if the password is incorrect</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_fp</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">BinaryIO</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_pages</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;PageList&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_pool</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Executor</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_outline</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Outline&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_destinations</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Destinations&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_structure</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Tree&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">_fontmap</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Font</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Document&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">,</span> <span class="n">traceback</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># If we were opened from a file then close it</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fp</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fp</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># Shutdown process pool</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pool</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pool</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pool</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">fp</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">BinaryIO</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span>
        <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">space</span><span class="p">:</span> <span class="n">DeviceSpace</span> <span class="o">=</span> <span class="s2">&quot;screen&quot;</span><span class="p">,</span>
        <span class="n">_boss_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">_boss_id</span><span class="p">:</span>
            <span class="c1"># Set this **right away** because it is needed to get</span>
            <span class="c1"># indirect object references right.</span>
            <span class="n">_set_document</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_boss_id</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">in_worker</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">XRef</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">space</span> <span class="o">=</span> <span class="n">space</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encryption</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decipher</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DecipherCallable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cached_objs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parsed_objs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">PDFObject</span><span class="p">],</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cached_fonts</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Font</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">TextIOBase</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;fp is not a binary file&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_version</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span> <span class="o">=</span> <span class="n">_open_input</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_printable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_modifiable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_extractable</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># Getting the XRef table and trailer is done non-lazily</span>
        <span class="c1"># because they contain encryption information among other</span>
        <span class="c1"># things.  As noted above we don&#39;t try to look for the first</span>
        <span class="c1"># page cross-reference table (for linearized PDFs) after the</span>
        <span class="c1"># header, it will instead be loaded with all the rest.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">IndirectObjectParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xrefpos</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_xrefs</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="s2">&quot;Failed to parse xref table, falling back to object parser: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">e</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">newxref</span> <span class="o">=</span> <span class="n">XRefFallback</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newxref</span><span class="p">)</span>
        <span class="c1"># Now find the trailer</span>
        <span class="k">for</span> <span class="n">xref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">:</span>
            <span class="n">trailer</span> <span class="o">=</span> <span class="n">xref</span><span class="o">.</span><span class="n">trailer</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">trailer</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="c1"># If there&#39;s an encryption info, remember it.</span>
            <span class="k">if</span> <span class="s2">&quot;Encrypt&quot;</span> <span class="ow">in</span> <span class="n">trailer</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;ID&quot;</span> <span class="ow">in</span> <span class="n">trailer</span><span class="p">:</span>
                    <span class="n">id_value</span> <span class="o">=</span> <span class="n">list_value</span><span class="p">(</span><span class="n">trailer</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Some documents may not have a /ID, use two empty</span>
                    <span class="c1"># byte strings instead. Solves</span>
                    <span class="c1"># https://github.com/pdfminer/pdfminer.six/issues/594</span>
                    <span class="n">id_value</span> <span class="o">=</span> <span class="p">(</span><span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">encryption</span> <span class="o">=</span> <span class="p">(</span><span class="n">id_value</span><span class="p">,</span> <span class="n">dict_value</span><span class="p">(</span><span class="n">trailer</span><span class="p">[</span><span class="s2">&quot;Encrypt&quot;</span><span class="p">]))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_password</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;Info&quot;</span> <span class="ow">in</span> <span class="n">trailer</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_value</span><span class="p">(</span><span class="n">trailer</span><span class="p">[</span><span class="s2">&quot;Info&quot;</span><span class="p">]))</span>
                <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Info is a broken reference (incorrect xref table?)&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;Root&quot;</span> <span class="ow">in</span> <span class="n">trailer</span><span class="p">:</span>
                <span class="c1"># Every PDF file must have exactly one /Root dictionary.</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span><span class="n">trailer</span><span class="p">[</span><span class="s2">&quot;Root&quot;</span><span class="p">])</span>
                <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Root is a broken reference (incorrect xref table?)&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No /Root object! - Is this really a PDF?&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">LITERAL_CATALOG</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Catalog not found!&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;Version&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="s2">&quot;Using PDF version </span><span class="si">%r</span><span class="s2"> from catalog instead of </span><span class="si">%r</span><span class="s2"> from header&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">[</span><span class="s2">&quot;Version&quot;</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pdf_version</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_version</span> <span class="o">=</span> <span class="n">literal_name</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">[</span><span class="s2">&quot;Version&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_tagged</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">markinfo</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;MarkInfo&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">markinfo</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_tagged</span> <span class="o">=</span> <span class="ow">not</span> <span class="ow">not</span> <span class="n">markinfo</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Marked&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_read_xrefs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">xrefpos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_xref</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span><span class="s2">&quot;No xref table found at end of file&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_xref_from</span><span class="p">(</span><span class="n">xrefpos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">,</span> <span class="ne">StopIteration</span><span class="p">,</span> <span class="n">PDFSyntaxError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Checking for two PDFs in a trenchcoat: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="n">xrefpos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_detect_concatenation</span><span class="p">(</span><span class="n">xrefpos</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">xrefpos</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span><span class="s2">&quot;Failed to read xref table at end of file&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_xref_from</span><span class="p">(</span><span class="n">xrefpos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">,</span> <span class="ne">StopIteration</span><span class="p">,</span> <span class="n">PDFSyntaxError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span>
                <span class="s2">&quot;Failed to read xref table with adjusted offset&quot;</span>
            <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_detect_concatenation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xrefpos</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="c1"># Detect the case where two (or more) PDFs have been</span>
        <span class="c1"># concatenated, or where somebody tried an &quot;incremental</span>
        <span class="c1"># update&quot; without updating the xref table</span>
        <span class="n">filestart</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;</span><span class="si">%%</span><span class="s2">EOF&quot;</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Found ultimate </span><span class="si">%%</span><span class="s2">EOF at </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filestart</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filestart</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">filestart</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;</span><span class="si">%%</span><span class="s2">EOF&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">filestart</span><span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Found penultimate </span><span class="si">%%</span><span class="s2">EOF at </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filestart</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filestart</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">filestart</span> <span class="o">+=</span> <span class="mi">5</span>
            <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">[</span><span class="n">filestart</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">):</span>
                <span class="n">filestart</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">parser</span> <span class="o">=</span> <span class="n">ObjectParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">filestart</span> <span class="o">+</span> <span class="n">xrefpos</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">nexttoken</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unexpected EOF at </span><span class="si">{</span><span class="n">filestart</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">token</span> <span class="ow">is</span> <span class="n">KEYWORD_XREF</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                    <span class="s2">&quot;Found two PDFs in a trenchcoat at </span><span class="si">%d</span><span class="s2"> &quot;</span>
                    <span class="s2">&quot;(second xref is at </span><span class="si">%d</span><span class="s2"> not </span><span class="si">%d</span><span class="s2">)&quot;</span><span class="p">,</span>
                    <span class="n">filestart</span><span class="p">,</span>
                    <span class="n">pos</span><span class="p">,</span>
                    <span class="n">xrefpos</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">filestart</span>
                <span class="k">return</span> <span class="n">pos</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_initialize_password</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the decryption handler with a given password, if any.</span>

<span class="sd">        Internal function, requires the Encrypt dictionary to have</span>
<span class="sd">        been read from the trailer into self.encryption.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">encryption</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="p">(</span><span class="n">docid</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encryption</span>
        <span class="k">if</span> <span class="n">literal_name</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Filter&quot;</span><span class="p">))</span> <span class="o">!=</span> <span class="s2">&quot;Standard&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PDFEncryptionError</span><span class="p">(</span><span class="s2">&quot;Unknown filter: param=</span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">param</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;V&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="c1"># 3 (PDF 1.4) An unpublished algorithm that permits encryption</span>
        <span class="c1"># key lengths ranging from 40 to 128 bits. This value shall</span>
        <span class="c1"># not appear in a conforming PDF file.</span>
        <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PDFEncryptionError</span><span class="p">(</span><span class="s2">&quot;Unpublished algorithm 3 not supported&quot;</span><span class="p">)</span>
        <span class="n">factory</span> <span class="o">=</span> <span class="n">SECURITY_HANDLERS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="c1"># 0 An algorithm that is undocumented. This value shall not be used.</span>
        <span class="k">if</span> <span class="n">factory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PDFEncryptionError</span><span class="p">(</span><span class="s2">&quot;Unknown algorithm: param=</span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">param</span><span class="p">)</span>
        <span class="n">handler</span> <span class="o">=</span> <span class="n">factory</span><span class="p">(</span><span class="n">docid</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decipher</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">decrypt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_printable</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">is_printable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_modifiable</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">is_modifiable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_extractable</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">is_extractable</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="c1"># Ensure that no extra data leaks into encrypted streams</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">decipher</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decipher</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">IndirectObject</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over top-level `IndirectObject` (does not expand object streams)&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">obj</span>
            <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">IndirectObjectParser</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">strict</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">objects</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">IndirectObject</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over all indirect objects (including, then expanding object</span>
<span class="sd">        streams)&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">IndirectObjectParser</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">strict</span>
        <span class="p">):</span>
            <span class="k">yield</span> <span class="n">obj</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">ContentStream</span><span class="p">)</span>
                <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="n">LITERAL_OBJSTM</span>
            <span class="p">):</span>
                <span class="n">parser</span> <span class="o">=</span> <span class="n">ObjectStreamParser</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">sobj</span> <span class="ow">in</span> <span class="n">parser</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">sobj</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Token</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over tokens.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">tok</span> <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">tok</span> <span class="ow">in</span> <span class="n">Lexer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">structure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Tree</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Logical structure of this document, if any.</span>

<span class="sd">        In the case where no logical structure tree exists, this will</span>
<span class="sd">        be `None`.  Otherwise you may iterate over it, search it, etc.</span>
<span class="sd">        We do this instead of simply returning an empty structure</span>
<span class="sd">        tree because the vast majority of PDFs have no logical</span>
<span class="sd">        structure.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_structure&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_structure</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_structure</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">KeyError</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_structure</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_structure</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_getobj_objstm</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">stream</span><span class="p">:</span> <span class="n">ContentStream</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">objid</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDFObject</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">stream</span><span class="o">.</span><span class="n">objid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parsed_objs</span><span class="p">:</span>
            <span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parsed_objs</span><span class="p">[</span><span class="n">stream</span><span class="o">.</span><span class="n">objid</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_objects</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">stream</span><span class="o">.</span><span class="n">objid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parsed_objs</span><span class="p">[</span><span class="n">stream</span><span class="o">.</span><span class="n">objid</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">index</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">objs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span><span class="s2">&quot;index too big: </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">index</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream</span><span class="p">:</span> <span class="n">ContentStream</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">PDFObject</span><span class="p">],</span> <span class="nb">int</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">LITERAL_OBJSTM</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Content stream Type is not /ObjStm: </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">stream</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">stream</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;N is not defined in content stream: </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">stream</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;N is invalid in content stream: </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">stream</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">ObjectParser</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">objs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PDFObject</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">obj</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">parser</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_getobj_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">objid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDFObject</span><span class="p">:</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">obj</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">objid</span> <span class="o">!=</span> <span class="n">objid</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;objid mismatch: </span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="n">objid</span><span class="si">!r}</span><span class="s2">=</span><span class="si">{</span><span class="n">objid</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">,</span> <span class="n">PDFSyntaxError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Indirect object </span><span class="si">%d</span><span class="s2"> not found at position </span><span class="si">%d</span><span class="s2">: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">objid</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">e</span>
            <span class="p">)</span>
            <span class="c1"># In case of malformed pdf files where the offset in the</span>
            <span class="c1"># xref table doesn&#39;t point exactly at the object</span>
            <span class="c1"># definition (probably more frequent than you think), just</span>
            <span class="c1"># use a regular expression to find the object because we</span>
            <span class="c1"># can do that.</span>
            <span class="n">realpos</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">lastgen</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="sa">rb</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">\s+(\d+)\s+obj&quot;</span> <span class="o">%</span> <span class="n">objid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">):</span>
                <span class="n">genno</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">genno</span> <span class="o">&gt;</span> <span class="n">lastgen</span><span class="p">:</span>
                    <span class="n">lastgen</span> <span class="o">=</span> <span class="n">genno</span>
                    <span class="n">realpos</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">realpos</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Indirect object </span><span class="si">{</span><span class="n">objid</span><span class="si">!r}</span><span class="s2"> not found in document&quot;</span>
                <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">realpos</span><span class="p">)</span>
            <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">objid</span> <span class="o">!=</span> <span class="n">objid</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;objid mismatch: </span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="n">objid</span><span class="si">!r}</span><span class="s2">=</span><span class="si">{</span><span class="n">objid</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">obj</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDFObject</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get an indirect object from the PDF.</span>

<span class="sd">        Note that the behaviour in the case of a non-existent object</span>
<span class="sd">        (raising `IndexError`), while Pythonic, is not PDFic, as PDF</span>
<span class="sd">        1.7 sec 7.3.10 states:</span>

<span class="sd">        &gt; An indirect reference to an undefined object shall not be</span>
<span class="sd">        considered an error by a conforming reader; it shall be</span>
<span class="sd">        treated as a reference to the null object.</span>

<span class="sd">        Raises:</span>
<span class="sd">          ValueError: if Document is not initialized</span>
<span class="sd">          IndexError: if objid does not exist in PDF</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Document is not initialized&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">objid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_objs</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">xref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="p">(</span><span class="n">strmid</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">genno</span><span class="p">)</span> <span class="o">=</span> <span class="n">xref</span><span class="o">.</span><span class="n">get_pos</span><span class="p">(</span><span class="n">objid</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">strmid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">stream</span> <span class="o">=</span> <span class="n">stream_value</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">strmid</span><span class="p">])</span>
                        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getobj_objstm</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">objid</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getobj_parse</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">objid</span><span class="p">)</span>
                    <span class="k">break</span>
                <span class="c1"># FIXME: We might not actually want to catch these...</span>
                <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;EOF when searching for object </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">objid</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="k">except</span> <span class="n">PDFSyntaxError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Syntax error when searching for object </span><span class="si">%d</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">objid</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                    <span class="k">continue</span>
            <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Object with ID </span><span class="si">{</span><span class="n">objid</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cached_objs</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_objs</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_font</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">objid</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">spec</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Font</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">objid</span> <span class="ow">and</span> <span class="n">objid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_fonts</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_fonts</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">spec</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Font</span><span class="p">({},</span> <span class="p">{})</span>
        <span class="c1"># Create a Font object, hopefully</span>
        <span class="n">font</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Font</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">spec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">LITERAL_FONT</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Font Type is not /Font: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">spec</span><span class="p">)</span>
        <span class="n">subtype</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Subtype&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">subtype</span> <span class="ow">in</span> <span class="p">(</span><span class="n">LITERAL_TYPE1</span><span class="p">,</span> <span class="n">LITERAL_MMTYPE1</span><span class="p">):</span>
            <span class="n">font</span> <span class="o">=</span> <span class="n">Type1Font</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">subtype</span> <span class="ow">is</span> <span class="n">LITERAL_TRUETYPE</span><span class="p">:</span>
            <span class="n">font</span> <span class="o">=</span> <span class="n">TrueTypeFont</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">subtype</span> <span class="o">==</span> <span class="n">LITERAL_TYPE3</span><span class="p">:</span>
            <span class="n">font</span> <span class="o">=</span> <span class="n">Type3Font</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">subtype</span> <span class="o">==</span> <span class="n">LITERAL_TYPE0</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;DescendantFonts&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">spec</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Type0 font has no DescendantFonts: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">spec</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dfonts</span> <span class="o">=</span> <span class="n">list_value</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="s2">&quot;DescendantFonts&quot;</span><span class="p">])</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dfonts</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                        <span class="s2">&quot;Type 0 font should have 1 descendant, has more: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dfonts</span>
                    <span class="p">)</span>
                <span class="n">subspec</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">dfonts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subspec</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Invalid descendant font: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">subspec</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">subspec</span> <span class="o">=</span> <span class="n">subspec</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                    <span class="c1"># Merge the root and descendant font dictionaries</span>
                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;Encoding&quot;</span><span class="p">,</span> <span class="s2">&quot;ToUnicode&quot;</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">spec</span><span class="p">:</span>
                            <span class="n">subspec</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">font</span> <span class="o">=</span> <span class="n">CIDFont</span><span class="p">(</span><span class="n">subspec</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Unknown Subtype in font: </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">spec</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">font</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># We need a dummy font object to be able to do *something*</span>
            <span class="c1"># (even if it&#39;s the wrong thing) with text objects.</span>
            <span class="n">font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">({},</span> <span class="p">{})</span>
        <span class="k">if</span> <span class="n">objid</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cached_fonts</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span> <span class="o">=</span> <span class="n">font</span>
        <span class="k">return</span> <span class="n">font</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">fonts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Font</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the mapping of font names to fonts for this document.</span>

<span class="sd">        Note that this can be quite slow the first time it&#39;s accessed</span>
<span class="sd">        as it must scan every single page in the document.</span>

<span class="sd">        Note: Font names may collide.</span>
<span class="sd">            Font names are generally understood to be globally unique</span>
<span class="sd">            &lt;del&gt;in the neighbourhood&lt;/del&gt; in the document, but there&#39;s no</span>
<span class="sd">            guarantee that this is the case.  In keeping with the</span>
<span class="sd">            &quot;incremental update&quot; philosophy dear to PDF, you get the</span>
<span class="sd">            last font with a given name.</span>

<span class="sd">        Danger: Do not rely on this being a `dict`.</span>
<span class="sd">            Currently this is implemented eagerly, but in the future it</span>
<span class="sd">            may return a lazy object which only loads fonts on demand.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fontmap</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fontmap</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fontmap</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Font</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">page</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pages</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">font</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">fonts</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_fontmap</span><span class="p">[</span><span class="n">font</span><span class="o">.</span><span class="n">fontname</span><span class="p">]</span> <span class="o">=</span> <span class="n">font</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fontmap</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">outline</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Outline</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Document outline, if any.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;Outlines&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_outline</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_outline</span> <span class="o">=</span> <span class="n">Outline</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;Invalid Outlines entry in catalog: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">[</span><span class="s2">&quot;Outlines&quot;</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_outline</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">page_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate page label strings for the PDF document.</span>

<span class="sd">        If the document includes page labels, generates strings, one per page.</span>
<span class="sd">        If not, raise KeyError.</span>

<span class="sd">        The resulting iterator is unbounded (because the page label</span>
<span class="sd">        tree does not actually include all the pages), so it is</span>
<span class="sd">        recommended to use `pages` instead.</span>

<span class="sd">        Raises:</span>
<span class="sd">          KeyError: No page labels are present in the catalog</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>  <span class="c1"># really it cannot be None</span>

        <span class="n">page_labels</span> <span class="o">=</span> <span class="n">PageLabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">[</span><span class="s2">&quot;PageLabels&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">page_labels</span><span class="o">.</span><span class="n">labels</span>

    <span class="n">PageType</span> <span class="o">=</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_pages_from_xrefs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">PageType</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Find pages from the cross-reference tables if the page tree</span>
<span class="sd">        is missing (note that this only happens in invalid PDFs, but</span>
<span class="sd">        it happens.)</span>

<span class="sd">        Returns:</span>
<span class="sd">          an iterator over (objid, dict) pairs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">xref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">object_id</span> <span class="ow">in</span> <span class="n">xref</span><span class="o">.</span><span class="n">objids</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">object_id</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="n">LITERAL_PAGE</span><span class="p">:</span>
                        <span class="k">yield</span> <span class="n">object_id</span><span class="p">,</span> <span class="n">obj</span>
                <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                    <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_page_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">PageType</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over the flattened page tree in reading order, propagating</span>
<span class="sd">        inheritable attributes.  Returns an iterator over (objid, dict) pairs.</span>

<span class="sd">        Raises:</span>
<span class="sd">          KeyError: if there is no page tree.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;Pages&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;No &#39;Pages&#39; entry in catalog&quot;</span><span class="p">)</span>
        <span class="n">stack</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">[</span><span class="s2">&quot;Pages&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">)]</span>
        <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">while</span> <span class="n">stack</span><span class="p">:</span>
            <span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">ObjRef</span><span class="p">):</span>
                <span class="c1"># The PDF specification *requires* both the Pages</span>
                <span class="c1"># element of the catalog and the entries in Kids in</span>
                <span class="c1"># the page tree to be indirect references.</span>
                <span class="n">object_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">objid</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="c1"># Should not happen in a valid PDF, but probably does?</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Page tree contains bare integer: </span><span class="si">%r</span><span class="s2"> in </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
                <span class="n">object_id</span> <span class="o">=</span> <span class="n">obj</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Page tree contains unknown object: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
            <span class="n">page_object</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">object_id</span><span class="p">])</span>

            <span class="c1"># Avoid recursion errors by keeping track of visited nodes</span>
            <span class="c1"># (again, this should never actually happen in a valid PDF)</span>
            <span class="k">if</span> <span class="n">object_id</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Circular reference </span><span class="si">%r</span><span class="s2"> in page tree&quot;</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">object_id</span><span class="p">)</span>

            <span class="c1"># Propagate inheritable attributes</span>
            <span class="n">object_properties</span> <span class="o">=</span> <span class="n">page_object</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">parent</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">INHERITABLE_PAGE_ATTRS</span> <span class="ow">and</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">object_properties</span><span class="p">:</span>
                    <span class="n">object_properties</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>

            <span class="c1"># Recurse, depth-first</span>
            <span class="n">object_type</span> <span class="o">=</span> <span class="n">object_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">object_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Page has no Type, trying type: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">object_properties</span><span class="p">)</span>
                <span class="n">object_type</span> <span class="o">=</span> <span class="n">object_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">object_type</span> <span class="ow">is</span> <span class="n">LITERAL_PAGES</span> <span class="ow">and</span> <span class="s2">&quot;Kids&quot;</span> <span class="ow">in</span> <span class="n">object_properties</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">list_value</span><span class="p">(</span><span class="n">object_properties</span><span class="p">[</span><span class="s2">&quot;Kids&quot;</span><span class="p">])):</span>
                    <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">child</span><span class="p">,</span> <span class="n">object_properties</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">object_type</span> <span class="ow">is</span> <span class="n">LITERAL_PAGE</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">object_id</span><span class="p">,</span> <span class="n">object_properties</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">pages</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;PageList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Pages of the document as an iterable/addressable `PageList` object.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span> <span class="o">=</span> <span class="n">PageList</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;PDF name dictionary (PDF 1.7 sec 7.7.4).</span>

<span class="sd">        Raises:</span>
<span class="sd">          KeyError: if nonexistent.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">dict_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">[</span><span class="s2">&quot;Names&quot;</span><span class="p">])</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">destinations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Destinations&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Named destinations as an iterable/addressable `Destinations` object.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_destinations</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_destinations</span> <span class="o">=</span> <span class="n">Destinations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_destinations</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_find_xref</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Internal function used to locate the first XRef.&quot;&quot;&quot;</span>
        <span class="c1"># search the last xref table by scanning the file backwards.</span>
        <span class="n">prev</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">reverse_iter_lines</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">):</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&quot;startxref&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">prev</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Invalid startxref position: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">prev</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="n">start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">prev</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">start</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid negative startxref position: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">start</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">start</span> <span class="o">&gt;</span> <span class="n">pos</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;Invalid startxref position (&gt; </span><span class="si">%d</span><span class="s2">): </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="k">return</span> <span class="n">start</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span>
            <span class="k">elif</span> <span class="n">line</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&quot;xref&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">pos</span>
            <span class="k">elif</span> <span class="n">line</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&quot;endobj&quot;</span><span class="p">:</span>
                <span class="c1"># Okay, we&#39;re probably not in Kansas anymore...</span>
                <span class="k">break</span>
            <span class="k">if</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">prev</span> <span class="o">=</span> <span class="n">line</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No xref table found at end of file&quot;</span><span class="p">)</span>

    <span class="c1"># read xref table</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_read_xref_from</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">start</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">xrefs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">XRef</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reads XRefs from the given location.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">start</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xrefpos</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Detected circular xref chain at </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">ObjectParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">nexttoken</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unexpected EOF at </span><span class="si">{</span><span class="n">start</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">token</span> <span class="ow">is</span> <span class="n">KEYWORD_XREF</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Reading xref table at </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
            <span class="n">parser</span><span class="o">.</span><span class="n">nextline</span><span class="p">()</span>
            <span class="n">xref</span><span class="p">:</span> <span class="n">XRef</span> <span class="o">=</span> <span class="n">XRefTable</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># It might be an XRefStream, if this is an indirect object...</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">token</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">nexttoken</span><span class="p">()</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">token</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">nexttoken</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">token</span> <span class="ow">is</span> <span class="n">KEYWORD_OBJ</span><span class="p">:</span>
                <span class="c1"># XRefStream: PDF-1.5</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
                <span class="n">xref</span> <span class="o">=</span> <span class="n">XRefStream</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Well, maybe it&#39;s an XRef table without &quot;xref&quot; (but</span>
                <span class="c1"># probably not)</span>
                <span class="n">parser</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
                <span class="n">xref</span> <span class="o">=</span> <span class="n">XRefTable</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xrefpos</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
        <span class="n">xrefs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xref</span><span class="p">)</span>
        <span class="n">trailer</span> <span class="o">=</span> <span class="n">xref</span><span class="o">.</span><span class="n">trailer</span>
        <span class="c1"># For hybrid-reference files, an additional set of xrefs as a</span>
        <span class="c1"># stream.</span>
        <span class="k">if</span> <span class="s2">&quot;XRefStm&quot;</span> <span class="ow">in</span> <span class="n">trailer</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">trailer</span><span class="p">[</span><span class="s2">&quot;XRefStm&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_xref_from</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">xrefs</span><span class="p">)</span>
        <span class="c1"># Recurse into any previous xref tables or streams</span>
        <span class="k">if</span> <span class="s2">&quot;Prev&quot;</span> <span class="ow">in</span> <span class="n">trailer</span><span class="p">:</span>
            <span class="c1"># find previous xref</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">trailer</span><span class="p">[</span><span class="s2">&quot;Prev&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_xref_from</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">xrefs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="playa.document.Document.destinations" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">destinations</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Named destinations as an iterable/addressable <code>Destinations</code> object.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.document.Document.fonts" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fonts</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Get the mapping of font names to fonts for this document.</p>
<p>Note that this can be quite slow the first time it's accessed
as it must scan every single page in the document.</p>


<details class="note" open>
  <summary>Font names may collide.</summary>
  <p>Font names are generally understood to be globally unique
<del>in the neighbourhood</del> in the document, but there's no
guarantee that this is the case.  In keeping with the
"incremental update" philosophy dear to PDF, you get the
last font with a given name.</p>
</details>

<details class="danger" open>
  <summary>Do not rely on this being a <code>dict</code>.</summary>
  <p>Currently this is implemented eagerly, but in the future it
may return a lazy object which only loads fonts on demand.</p>
</details>    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.document.Document.names" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">names</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>PDF name dictionary (PDF 1.7 sec 7.7.4).</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>KeyError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if nonexistent.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.document.Document.objects" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">objects</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterate over all indirect objects (including, then expanding object
streams)</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.document.Document.outline" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">outline</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Document outline, if any.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.document.Document.page_labels" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">page_labels</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Generate page label strings for the PDF document.</p>
<p>If the document includes page labels, generates strings, one per page.
If not, raise KeyError.</p>
<p>The resulting iterator is unbounded (because the page label
tree does not actually include all the pages), so it is
recommended to use <code>pages</code> instead.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>KeyError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>No page labels are present in the catalog</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.document.Document.pages" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pages</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Pages of the document as an iterable/addressable <code>PageList</code> object.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.document.Document.structure" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">structure</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Logical structure of this document, if any.</p>
<p>In the case where no logical structure tree exists, this will
be <code>None</code>.  Otherwise you may iterate over it, search it, etc.
We do this instead of simply returning an empty structure
tree because the vast majority of PDFs have no logical
structure.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.document.Document.tokens" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tokens</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterate over tokens.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="playa.document.Document.__getitem__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__getitem__</span><span class="p">(</span><span class="n">objid</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get an indirect object from the PDF.</p>
<p>Note that the behaviour in the case of a non-existent object
(raising <code>IndexError</code>), while Pythonic, is not PDFic, as PDF
1.7 sec 7.3.10 states:</p>
<blockquote>
<p>An indirect reference to an undefined object shall not be
considered an error by a conforming reader; it shall be
treated as a reference to the null object.</p>
</blockquote>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if Document is not initialized</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>IndexError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if objid does not exist in PDF</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>playa/document.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDFObject</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get an indirect object from the PDF.</span>

<span class="sd">    Note that the behaviour in the case of a non-existent object</span>
<span class="sd">    (raising `IndexError`), while Pythonic, is not PDFic, as PDF</span>
<span class="sd">    1.7 sec 7.3.10 states:</span>

<span class="sd">    &gt; An indirect reference to an undefined object shall not be</span>
<span class="sd">    considered an error by a conforming reader; it shall be</span>
<span class="sd">    treated as a reference to the null object.</span>

<span class="sd">    Raises:</span>
<span class="sd">      ValueError: if Document is not initialized</span>
<span class="sd">      IndexError: if objid does not exist in PDF</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Document is not initialized&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">objid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_objs</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">xref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="p">(</span><span class="n">strmid</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">genno</span><span class="p">)</span> <span class="o">=</span> <span class="n">xref</span><span class="o">.</span><span class="n">get_pos</span><span class="p">(</span><span class="n">objid</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">strmid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">stream</span> <span class="o">=</span> <span class="n">stream_value</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">strmid</span><span class="p">])</span>
                    <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getobj_objstm</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">objid</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getobj_parse</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">objid</span><span class="p">)</span>
                <span class="k">break</span>
            <span class="c1"># FIXME: We might not actually want to catch these...</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;EOF when searching for object </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">objid</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="k">except</span> <span class="n">PDFSyntaxError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Syntax error when searching for object </span><span class="si">%d</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">objid</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                <span class="k">continue</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Object with ID </span><span class="si">{</span><span class="n">objid</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cached_objs</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_objs</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.document.Document.__iter__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__iter__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Iterate over top-level <code>IndirectObject</code> (does not expand object streams)</p>

            <details class="quote">
              <summary>Source code in <code>playa/document.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">IndirectObject</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterate over top-level `IndirectObject` (does not expand object streams)&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">obj</span>
        <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">IndirectObjectParser</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">strict</span>
        <span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.document.Document._find_xref" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_find_xref</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Internal function used to locate the first XRef.</p>

            <details class="quote">
              <summary>Source code in <code>playa/document.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_find_xref</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Internal function used to locate the first XRef.&quot;&quot;&quot;</span>
    <span class="c1"># search the last xref table by scanning the file backwards.</span>
    <span class="n">prev</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">reverse_iter_lines</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&quot;startxref&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">prev</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Invalid startxref position: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">prev</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="n">start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">prev</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">start</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid negative startxref position: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">start</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">start</span> <span class="o">&gt;</span> <span class="n">pos</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Invalid startxref position (&gt; </span><span class="si">%d</span><span class="s2">): </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="n">start</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span>
        <span class="k">elif</span> <span class="n">line</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&quot;xref&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pos</span>
        <span class="k">elif</span> <span class="n">line</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&quot;endobj&quot;</span><span class="p">:</span>
            <span class="c1"># Okay, we&#39;re probably not in Kansas anymore...</span>
            <span class="k">break</span>
        <span class="k">if</span> <span class="n">line</span><span class="p">:</span>
            <span class="n">prev</span> <span class="o">=</span> <span class="n">line</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No xref table found at end of file&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.document.Document._get_page_objects" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_get_page_objects</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Iterate over the flattened page tree in reading order, propagating
inheritable attributes.  Returns an iterator over (objid, dict) pairs.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>KeyError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if there is no page tree.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>playa/document.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_get_page_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">PageType</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterate over the flattened page tree in reading order, propagating</span>
<span class="sd">    inheritable attributes.  Returns an iterator over (objid, dict) pairs.</span>

<span class="sd">    Raises:</span>
<span class="sd">      KeyError: if there is no page tree.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;Pages&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;No &#39;Pages&#39; entry in catalog&quot;</span><span class="p">)</span>
    <span class="n">stack</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">[</span><span class="s2">&quot;Pages&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">)]</span>
    <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">while</span> <span class="n">stack</span><span class="p">:</span>
        <span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">ObjRef</span><span class="p">):</span>
            <span class="c1"># The PDF specification *requires* both the Pages</span>
            <span class="c1"># element of the catalog and the entries in Kids in</span>
            <span class="c1"># the page tree to be indirect references.</span>
            <span class="n">object_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">objid</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="c1"># Should not happen in a valid PDF, but probably does?</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Page tree contains bare integer: </span><span class="si">%r</span><span class="s2"> in </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
            <span class="n">object_id</span> <span class="o">=</span> <span class="n">obj</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Page tree contains unknown object: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
        <span class="n">page_object</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">object_id</span><span class="p">])</span>

        <span class="c1"># Avoid recursion errors by keeping track of visited nodes</span>
        <span class="c1"># (again, this should never actually happen in a valid PDF)</span>
        <span class="k">if</span> <span class="n">object_id</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Circular reference </span><span class="si">%r</span><span class="s2"> in page tree&quot;</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">object_id</span><span class="p">)</span>

        <span class="c1"># Propagate inheritable attributes</span>
        <span class="n">object_properties</span> <span class="o">=</span> <span class="n">page_object</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">parent</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">INHERITABLE_PAGE_ATTRS</span> <span class="ow">and</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">object_properties</span><span class="p">:</span>
                <span class="n">object_properties</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>

        <span class="c1"># Recurse, depth-first</span>
        <span class="n">object_type</span> <span class="o">=</span> <span class="n">object_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">object_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Page has no Type, trying type: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">object_properties</span><span class="p">)</span>
            <span class="n">object_type</span> <span class="o">=</span> <span class="n">object_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">object_type</span> <span class="ow">is</span> <span class="n">LITERAL_PAGES</span> <span class="ow">and</span> <span class="s2">&quot;Kids&quot;</span> <span class="ow">in</span> <span class="n">object_properties</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">list_value</span><span class="p">(</span><span class="n">object_properties</span><span class="p">[</span><span class="s2">&quot;Kids&quot;</span><span class="p">])):</span>
                <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">child</span><span class="p">,</span> <span class="n">object_properties</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">object_type</span> <span class="ow">is</span> <span class="n">LITERAL_PAGE</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">object_id</span><span class="p">,</span> <span class="n">object_properties</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.document.Document._get_pages_from_xrefs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_get_pages_from_xrefs</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Find pages from the cross-reference tables if the page tree
is missing (note that this only happens in invalid PDFs, but
it happens.)</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Iterator">Iterator</span>[<span title="typing.Tuple">Tuple</span>[int, <span title="playa.document.Document.PageType">PageType</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>an iterator over (objid, dict) pairs.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>playa/document.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_get_pages_from_xrefs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">PageType</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Find pages from the cross-reference tables if the page tree</span>
<span class="sd">    is missing (note that this only happens in invalid PDFs, but</span>
<span class="sd">    it happens.)</span>

<span class="sd">    Returns:</span>
<span class="sd">      an iterator over (objid, dict) pairs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">xref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xrefs</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">object_id</span> <span class="ow">in</span> <span class="n">xref</span><span class="o">.</span><span class="n">objids</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">object_id</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="n">LITERAL_PAGE</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">object_id</span><span class="p">,</span> <span class="n">obj</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.document.Document._initialize_password" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_initialize_password</span><span class="p">(</span><span class="n">password</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Initialize the decryption handler with a given password, if any.</p>
<p>Internal function, requires the Encrypt dictionary to have
been read from the trailer into self.encryption.</p>

            <details class="quote">
              <summary>Source code in <code>playa/document.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_initialize_password</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the decryption handler with a given password, if any.</span>

<span class="sd">    Internal function, requires the Encrypt dictionary to have</span>
<span class="sd">    been read from the trailer into self.encryption.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">encryption</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="p">(</span><span class="n">docid</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encryption</span>
    <span class="k">if</span> <span class="n">literal_name</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Filter&quot;</span><span class="p">))</span> <span class="o">!=</span> <span class="s2">&quot;Standard&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">PDFEncryptionError</span><span class="p">(</span><span class="s2">&quot;Unknown filter: param=</span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">param</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;V&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="c1"># 3 (PDF 1.4) An unpublished algorithm that permits encryption</span>
    <span class="c1"># key lengths ranging from 40 to 128 bits. This value shall</span>
    <span class="c1"># not appear in a conforming PDF file.</span>
    <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">PDFEncryptionError</span><span class="p">(</span><span class="s2">&quot;Unpublished algorithm 3 not supported&quot;</span><span class="p">)</span>
    <span class="n">factory</span> <span class="o">=</span> <span class="n">SECURITY_HANDLERS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="c1"># 0 An algorithm that is undocumented. This value shall not be used.</span>
    <span class="k">if</span> <span class="n">factory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">PDFEncryptionError</span><span class="p">(</span><span class="s2">&quot;Unknown algorithm: param=</span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">param</span><span class="p">)</span>
    <span class="n">handler</span> <span class="o">=</span> <span class="n">factory</span><span class="p">(</span><span class="n">docid</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">decipher</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">decrypt</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_printable</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">is_printable</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_modifiable</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">is_modifiable</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_extractable</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">is_extractable</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="c1"># Ensure that no extra data leaks into encrypted streams</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">strict</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">decipher</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decipher</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.document.Document._read_xref_from" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_read_xref_from</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">xrefs</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Reads XRefs from the given location.</p>

            <details class="quote">
              <summary>Source code in <code>playa/document.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_read_xref_from</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">start</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">xrefs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">XRef</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reads XRefs from the given location.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">start</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xrefpos</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Detected circular xref chain at </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">ObjectParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">nexttoken</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unexpected EOF at </span><span class="si">{</span><span class="n">start</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">token</span> <span class="ow">is</span> <span class="n">KEYWORD_XREF</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Reading xref table at </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">nextline</span><span class="p">()</span>
        <span class="n">xref</span><span class="p">:</span> <span class="n">XRef</span> <span class="o">=</span> <span class="n">XRefTable</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># It might be an XRefStream, if this is an indirect object...</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">token</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">nexttoken</span><span class="p">()</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">token</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">nexttoken</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">token</span> <span class="ow">is</span> <span class="n">KEYWORD_OBJ</span><span class="p">:</span>
            <span class="c1"># XRefStream: PDF-1.5</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
            <span class="n">xref</span> <span class="o">=</span> <span class="n">XRefStream</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Well, maybe it&#39;s an XRef table without &quot;xref&quot; (but</span>
            <span class="c1"># probably not)</span>
            <span class="n">parser</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
            <span class="n">xref</span> <span class="o">=</span> <span class="n">XRefTable</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_xrefpos</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
    <span class="n">xrefs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xref</span><span class="p">)</span>
    <span class="n">trailer</span> <span class="o">=</span> <span class="n">xref</span><span class="o">.</span><span class="n">trailer</span>
    <span class="c1"># For hybrid-reference files, an additional set of xrefs as a</span>
    <span class="c1"># stream.</span>
    <span class="k">if</span> <span class="s2">&quot;XRefStm&quot;</span> <span class="ow">in</span> <span class="n">trailer</span><span class="p">:</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">trailer</span><span class="p">[</span><span class="s2">&quot;XRefStm&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_xref_from</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">xrefs</span><span class="p">)</span>
    <span class="c1"># Recurse into any previous xref tables or streams</span>
    <span class="k">if</span> <span class="s2">&quot;Prev&quot;</span> <span class="ow">in</span> <span class="n">trailer</span><span class="p">:</span>
        <span class="c1"># find previous xref</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">trailer</span><span class="p">[</span><span class="s2">&quot;Prev&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_xref_from</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">xrefs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.document.PageLabels" class="doc doc-heading">
            <code>PageLabels</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="playa.data_structures.NumberTree">NumberTree</span></code></p>


        <p>PageLabels from the document catalog.</p>
<p>See Section 12.4.2 in the PDF 1.7 Reference.</p>






              <details class="quote">
                <summary>Source code in <code>playa/document.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PageLabels</span><span class="p">(</span><span class="n">NumberTree</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;PageLabels from the document catalog.</span>

<span class="sd">    See Section 12.4.2 in the PDF 1.7 Reference.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">labels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="n">itor</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">start</span><span class="p">,</span> <span class="n">label_dict_unchecked</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">itor</span><span class="p">)</span>
            <span class="c1"># The tree must begin with page index 0</span>
            <span class="k">if</span> <span class="n">start</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;PageLabels tree is missing page index 0&quot;</span><span class="p">)</span>
                <span class="c1"># Try to cope, by assuming empty labels for the initial pages</span>
                <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;PageLabels tree is empty&quot;</span><span class="p">)</span>
            <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">label_dict_unchecked</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>  <span class="c1"># forever!</span>
            <span class="n">label_dict</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span><span class="n">label_dict_unchecked</span><span class="p">)</span>
            <span class="n">style</span> <span class="o">=</span> <span class="n">label_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;S&quot;</span><span class="p">)</span>
            <span class="n">prefix</span> <span class="o">=</span> <span class="n">decode_text</span><span class="p">(</span><span class="n">str_value</span><span class="p">(</span><span class="n">label_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">)))</span>
            <span class="n">first_value</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">label_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;St&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">next_start</span><span class="p">,</span> <span class="n">label_dict_unchecked</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">itor</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="c1"># This is the last specified range. It continues until the end</span>
                <span class="c1"># of the document.</span>
                <span class="n">values</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">first_value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">range_length</span> <span class="o">=</span> <span class="n">next_start</span> <span class="o">-</span> <span class="n">start</span>
                <span class="n">values</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_value</span><span class="p">,</span> <span class="n">first_value</span> <span class="o">+</span> <span class="n">range_length</span><span class="p">)</span>
                <span class="n">start</span> <span class="o">=</span> <span class="n">next_start</span>

            <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_page_label</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">style</span><span class="p">)</span>
                <span class="k">yield</span> <span class="n">prefix</span> <span class="o">+</span> <span class="n">label</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_format_page_label</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">style</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Format page label value in a specific style&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">style</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">elif</span> <span class="n">style</span> <span class="ow">is</span> <span class="n">LIT</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">):</span>  <span class="c1"># Decimal arabic numerals</span>
            <span class="n">label</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">style</span> <span class="ow">is</span> <span class="n">LIT</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">):</span>  <span class="c1"># Uppercase roman numerals</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">format_int_roman</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">style</span> <span class="ow">is</span> <span class="n">LIT</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">):</span>  <span class="c1"># Lowercase roman numerals</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">format_int_roman</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">style</span> <span class="ow">is</span> <span class="n">LIT</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">):</span>  <span class="c1"># Uppercase letters A-Z, AA-ZZ...</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">format_int_alpha</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">style</span> <span class="ow">is</span> <span class="n">LIT</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">):</span>  <span class="c1"># Lowercase letters a-z, aa-zz...</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">format_int_alpha</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Unknown page label style: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">style</span><span class="p">)</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">return</span> <span class="n">label</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="playa.document.PageLabels._format_page_label" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_format_page_label</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">style</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Format page label value in a specific style</p>

            <details class="quote">
              <summary>Source code in <code>playa/document.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">_format_page_label</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">style</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Format page label value in a specific style&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">style</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">elif</span> <span class="n">style</span> <span class="ow">is</span> <span class="n">LIT</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">):</span>  <span class="c1"># Decimal arabic numerals</span>
        <span class="n">label</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">style</span> <span class="ow">is</span> <span class="n">LIT</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">):</span>  <span class="c1"># Uppercase roman numerals</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">format_int_roman</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">style</span> <span class="ow">is</span> <span class="n">LIT</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">):</span>  <span class="c1"># Lowercase roman numerals</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">format_int_roman</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">style</span> <span class="ow">is</span> <span class="n">LIT</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">):</span>  <span class="c1"># Uppercase letters A-Z, AA-ZZ...</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">format_int_alpha</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">style</span> <span class="ow">is</span> <span class="n">LIT</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">):</span>  <span class="c1"># Lowercase letters a-z, aa-zz...</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">format_int_alpha</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Unknown page label style: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">style</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">return</span> <span class="n">label</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.document.PageList" class="doc doc-heading">
            <code>PageList</code>


</h3>


    <div class="doc doc-contents ">


        <p>List of pages indexable by 0-based index or string label.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="playa.document.PageList.have_labels">have_labels</span></code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If pages have explicit labels in the PDF.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>playa/document.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PageList</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List of pages indexable by 0-based index or string label.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        have_labels: If pages have explicit labels in the PDF.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">have_labels</span><span class="p">:</span> <span class="nb">bool</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Document</span><span class="p">,</span> <span class="n">pages</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">Page</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">docref</span> <span class="o">=</span> <span class="n">_ref_document</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pages</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pages</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Page</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">page</span><span class="o">.</span><span class="n">label</span><span class="p">:</span> <span class="n">page</span> <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">pages</span> <span class="k">if</span> <span class="n">page</span><span class="o">.</span><span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">have_labels</span> <span class="o">=</span> <span class="ow">not</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_init_pages</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_init_pages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Document</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">page_labels</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">page_labels</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">have_labels</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
            <span class="n">page_labels</span> <span class="o">=</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">have_labels</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_objids</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">page_objects</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">_get_page_objects</span><span class="p">())</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
            <span class="n">page_objects</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">_get_pages_from_xrefs</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">page_idx</span><span class="p">,</span> <span class="p">((</span><span class="n">objid</span><span class="p">,</span> <span class="n">properties</span><span class="p">),</span> <span class="n">label</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
            <span class="nb">zip</span><span class="p">(</span><span class="n">page_objects</span><span class="p">,</span> <span class="n">page_labels</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">page</span> <span class="o">=</span> <span class="n">Page</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">objid</span><span class="p">,</span> <span class="n">properties</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">page_idx</span><span class="p">,</span> <span class="n">doc</span><span class="o">.</span><span class="n">space</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">page</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_objids</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span> <span class="o">=</span> <span class="n">page</span>
            <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Duplicate page label </span><span class="si">%s</span><span class="s2"> at index </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">page_idx</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">page</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">doc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Document&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get associated document if it exists.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_deref_document</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">docref</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pages</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Page</span><span class="p">]:</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pages</span><span class="p">)</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Page</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Page</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">slice</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;PageList&quot;</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;PageList&quot;</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="s2">&quot;PageList&quot;</span><span class="p">:</span> <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">PageList</span><span class="p">(</span><span class="n">_deref_document</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">docref</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">PageList</span><span class="p">(</span><span class="n">_deref_document</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">docref</span><span class="p">),</span> <span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">key</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Page</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a page by its indirect object ID.</span>

<span class="sd">        Args:</span>
<span class="sd">            objid: Indirect object ID for the page object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            the page in question.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_objids</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Page</span><span class="p">],</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply a function over each page, iterating over its results.</span>

<span class="sd">        Args:</span>
<span class="sd">            func: The function to apply to each page.</span>

<span class="sd">        Note:</span>
<span class="sd">            This possibly runs `func` in a separate process.  If its</span>
<span class="sd">            return value is not serializable (by `pickle`) then you</span>
<span class="sd">            will encounter errors.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="n">_deref_document</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">docref</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">doc</span><span class="o">.</span><span class="n">_pool</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">doc</span><span class="o">.</span><span class="n">_pool</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
                <span class="n">call_page</span><span class="p">,</span>
                <span class="n">itertools</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">func</span><span class="p">),</span>
                <span class="p">((</span><span class="nb">id</span><span class="p">(</span><span class="n">doc</span><span class="p">),</span> <span class="n">page</span><span class="o">.</span><span class="n">page_idx</span><span class="p">)</span> <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">page</span><span class="p">)</span> <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="playa.document.PageList.doc" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">doc</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Get associated document if it exists.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="playa.document.PageList.by_id" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">by_id</span><span class="p">(</span><span class="n">objid</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get a page by its indirect object ID.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>objid</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Indirect object ID for the page object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="playa.page.Page" href="#playa.page.Page">Page</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the page in question.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>playa/document.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Page</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a page by its indirect object ID.</span>

<span class="sd">    Args:</span>
<span class="sd">        objid: Indirect object ID for the page object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        the page in question.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_objids</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.document.PageList.map" class="doc doc-heading">
            <code class="highlight language-python"><span class="nb">map</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Apply a function over each page, iterating over its results.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>func</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<a class="autorefs autorefs-internal" title="playa.page.Page" href="#playa.page.Page">Page</a>], <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function to apply to each page.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>This possibly runs <code>func</code> in a separate process.  If its
return value is not serializable (by <code>pickle</code>) then you
will encounter errors.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>playa/document.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Page</span><span class="p">],</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply a function over each page, iterating over its results.</span>

<span class="sd">    Args:</span>
<span class="sd">        func: The function to apply to each page.</span>

<span class="sd">    Note:</span>
<span class="sd">        This possibly runs `func` in a separate process.  If its</span>
<span class="sd">        return value is not serializable (by `pickle`) then you</span>
<span class="sd">        will encounter errors.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">doc</span> <span class="o">=</span> <span class="n">_deref_document</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">docref</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">doc</span><span class="o">.</span><span class="n">_pool</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">doc</span><span class="o">.</span><span class="n">_pool</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="n">call_page</span><span class="p">,</span>
            <span class="n">itertools</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">func</span><span class="p">),</span>
            <span class="p">((</span><span class="nb">id</span><span class="p">(</span><span class="n">doc</span><span class="p">),</span> <span class="n">page</span><span class="o">.</span><span class="n">page_idx</span><span class="p">)</span> <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">page</span><span class="p">)</span> <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="playa.document.call_page" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">call_page</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">pageref</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Call a function on a page in a worker process.</p>

            <details class="quote">
              <summary>Source code in <code>playa/document.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">call_page</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Page</span><span class="p">],</span> <span class="n">Any</span><span class="p">],</span> <span class="n">pageref</span><span class="p">:</span> <span class="n">PageRef</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Call a function on a page in a worker process.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">_deref_page</span><span class="p">(</span><span class="n">pageref</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="playa.page" class="doc doc-heading">
            <code>playa.page</code>


</h2>

    <div class="doc doc-contents first">

        <p>Classes for looking at pages and their contents.</p>








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="playa.page.Annotation" class="doc doc-heading">
            <code>Annotation</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>PDF annotation (PDF 1.7 section 12.5).</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.Annotation.subtype">subtype</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of annotation.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.Annotation.rect">rect</span></code></td>
            <td>
                  <code><span title="playa.pdftypes.Rect">Rect</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Annotation rectangle (location on page) in <em>default user space</em></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="playa.page.Annotation.bbox" href="#playa.page.Annotation.bbox">bbox</a></code></td>
            <td>
                  <code><span title="playa.pdftypes.Rect">Rect</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Annotation rectangle in <em>device space</em></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.Annotation.props">props</span></code></td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[str, <span title="playa.parser.PDFObject">PDFObject</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Annotation dictionary containing all other properties
     (PDF 1.7 sec. 12.5.2).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>playa/page.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Annotation</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;PDF annotation (PDF 1.7 section 12.5).</span>

<span class="sd">    Attributes:</span>
<span class="sd">      subtype: Type of annotation.</span>
<span class="sd">      rect: Annotation rectangle (location on page) in *default user space*</span>
<span class="sd">      bbox: Annotation rectangle in *device space*</span>
<span class="sd">      props: Annotation dictionary containing all other properties</span>
<span class="sd">             (PDF 1.7 sec. 12.5.2).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_pageref</span><span class="p">:</span> <span class="n">PageRef</span>
    <span class="n">subtype</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">rect</span><span class="p">:</span> <span class="n">Rect</span>
    <span class="n">props</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">]</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">PDFObject</span><span class="p">,</span> <span class="n">page</span><span class="p">:</span> <span class="n">Page</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Annotation&quot;</span><span class="p">:</span>
        <span class="n">annot</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">subtype</span> <span class="o">=</span> <span class="n">annot</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Subtype&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">subtype</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subtype</span><span class="p">,</span> <span class="n">PSLiteral</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span><span class="s2">&quot;Invalid annotation Subtype </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">subtype</span><span class="p">,))</span>
        <span class="n">rect</span> <span class="o">=</span> <span class="n">rect_value</span><span class="p">(</span><span class="n">annot</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Rect&quot;</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Annotation</span><span class="p">(</span>
            <span class="n">_pageref</span><span class="o">=</span><span class="n">page</span><span class="o">.</span><span class="n">pageref</span><span class="p">,</span>
            <span class="n">subtype</span><span class="o">=</span><span class="n">literal_name</span><span class="p">(</span><span class="n">subtype</span><span class="p">),</span>
            <span class="n">rect</span><span class="o">=</span><span class="n">rect</span><span class="p">,</span>
            <span class="n">props</span><span class="o">=</span><span class="n">annot</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">page</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Page</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Containing page for this annotation.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_deref_page</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pageref</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rect</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Bounding box for this annotation in device space.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">transform_bbox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">ctm</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">contents</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Text contents of annotation.&quot;&quot;&quot;</span>
        <span class="n">contents</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Contents&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">contents</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">contents</span><span class="p">,</span> <span class="p">(</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Invalid annotation contents: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">contents</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">decode_text</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Annotation name, uniquely identifying this annotation.&quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;NM&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Invalid annotation name: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">decode_text</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">mtime</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;String describing date and time when annotation was most recently</span>
<span class="sd">        modified.</span>

<span class="sd">        The date *should* be in the format `D:YYYYMMDDHHmmSSOHH&#39;mm`</span>
<span class="sd">        but this is in no way required (and unlikely to be implemented</span>
<span class="sd">        consistently, if history is any guide).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mtime</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">mtime</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mtime</span><span class="p">,</span> <span class="p">(</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Invalid annotation modification date: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">mtime</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">decode_text</span><span class="p">(</span><span class="n">mtime</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="playa.page.Annotation.bbox" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bbox</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Bounding box for this annotation in device space.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.Annotation.contents" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">contents</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Text contents of annotation.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.Annotation.mtime" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mtime</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>String describing date and time when annotation was most recently
modified.</p>
<p>The date <em>should</em> be in the format <code>D:YYYYMMDDHHmmSSOHH'mm</code>
but this is in no way required (and unlikely to be implemented
consistently, if history is any guide).</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.Annotation.name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">name</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Annotation name, uniquely identifying this annotation.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.Annotation.page" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">page</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Containing page for this annotation.</p>
    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.page.Page" class="doc doc-heading">
            <code>Page</code>


</h3>


    <div class="doc doc-contents ">


        <p>An object that holds the information about a page.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>doc</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="playa.document.Document" href="#playa.document.Document">Document</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a Document object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pageid</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the integer PDF object ID associated with the page in the page tree.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>attrs</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a dictionary of page attributes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>label</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>page label string.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>page_idx</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>0-based index of the page in the document.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>space</code>
            </td>
            <td>
                  <code><span title="playa.page.DeviceSpace">DeviceSpace</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the device space to use for interpreting content</p>
              </div>
            </td>
            <td>
                  <code>&#39;screen&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.Page.pageid">pageid</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the integer object ID associated with the page in the page tree</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.Page.attrs">attrs</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a dictionary of page attributes.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.Page.resources">resources</span></code></td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[str, <span title="playa.parser.PDFObject">PDFObject</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a dictionary of resources used by the page.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.Page.mediabox">mediabox</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the physical size of the page.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.Page.cropbox">cropbox</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the crop rectangle of the page.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.Page.rotate">rotate</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the page rotation (in degree).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.Page.label">label</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the page's label (typically, the logical page number).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.Page.page_idx">page_idx</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>0-based index of the page in the document.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.page.Page.ctm">ctm</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>coordinate transformation matrix from default user space to
   page's device space</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>playa/page.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Page</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;An object that holds the information about a page.</span>

<span class="sd">    Args:</span>
<span class="sd">      doc: a Document object.</span>
<span class="sd">      pageid: the integer PDF object ID associated with the page in the page tree.</span>
<span class="sd">      attrs: a dictionary of page attributes.</span>
<span class="sd">      label: page label string.</span>
<span class="sd">      page_idx: 0-based index of the page in the document.</span>
<span class="sd">      space: the device space to use for interpreting content</span>

<span class="sd">    Attributes:</span>
<span class="sd">      pageid: the integer object ID associated with the page in the page tree</span>
<span class="sd">      attrs: a dictionary of page attributes.</span>
<span class="sd">      resources: a dictionary of resources used by the page.</span>
<span class="sd">      mediabox: the physical size of the page.</span>
<span class="sd">      cropbox: the crop rectangle of the page.</span>
<span class="sd">      rotate: the page rotation (in degree).</span>
<span class="sd">      label: the page&#39;s label (typically, the logical page number).</span>
<span class="sd">      page_idx: 0-based index of the page in the document.</span>
<span class="sd">      ctm: coordinate transformation matrix from default user space to</span>
<span class="sd">           page&#39;s device space</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_fontmap</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Font</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_structmap</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Element&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">doc</span><span class="p">:</span> <span class="s2">&quot;Document&quot;</span><span class="p">,</span>
        <span class="n">pageid</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">attrs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
        <span class="n">label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">page_idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">space</span><span class="p">:</span> <span class="n">DeviceSpace</span> <span class="o">=</span> <span class="s2">&quot;screen&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">docref</span> <span class="o">=</span> <span class="n">_ref_document</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pageid</span> <span class="o">=</span> <span class="n">pageid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="n">attrs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">page_idx</span> <span class="o">=</span> <span class="n">page_idx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">space</span> <span class="o">=</span> <span class="n">space</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pageref</span> <span class="o">=</span> <span class="n">_ref_page</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lastmod</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;LastModified&quot;</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">]</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Resources&quot;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Resources missing or invalid from Page id </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pageid</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resources</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mediabox</span> <span class="o">=</span> <span class="n">normalize_rect</span><span class="p">(</span><span class="n">rect_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;MediaBox&quot;</span><span class="p">]))</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;MediaBox missing from Page id </span><span class="si">%d</span><span class="s2"> (and not inherited),&quot;</span>
                <span class="s2">&quot; defaulting to US Letter (612x792)&quot;</span><span class="p">,</span>
                <span class="n">pageid</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mediabox</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">612</span><span class="p">,</span> <span class="mi">792</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">PDFSyntaxError</span><span class="p">):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;MediaBox </span><span class="si">%r</span><span class="s2"> invalid in Page id </span><span class="si">%d</span><span class="s2">,&quot;</span>
                <span class="s2">&quot; defaulting to US Letter (612x792)&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;MediaBox&quot;</span><span class="p">],</span>
                <span class="n">pageid</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mediabox</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">612</span><span class="p">,</span> <span class="mi">792</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cropbox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mediabox</span>
        <span class="k">if</span> <span class="s2">&quot;CropBox&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cropbox</span> <span class="o">=</span> <span class="n">normalize_rect</span><span class="p">(</span><span class="n">rect_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;CropBox&quot;</span><span class="p">]))</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">PDFSyntaxError</span><span class="p">):</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;Invalid CropBox </span><span class="si">%r</span><span class="s2"> in /Page, defaulting to MediaBox&quot;</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;CropBox&quot;</span><span class="p">],</span>
                <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rotate</span> <span class="o">=</span> <span class="p">(</span><span class="n">int_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Rotate&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="o">+</span> <span class="mi">360</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
        <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mediabox</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span>
        <span class="c1"># PDF 1.7 section 8.4.1: Initial value: a matrix that</span>
        <span class="c1"># transforms default user coordinates to device coordinates.</span>
        <span class="c1">#</span>
        <span class="c1"># We keep this as `self.ctm` in order to transform layout</span>
        <span class="c1"># attributes in tagged PDFs which are specified in default</span>
        <span class="c1"># user space (PDF 1.7 section 14.8.5.4.3, table 344)</span>
        <span class="c1">#</span>
        <span class="c1"># &quot;screen&quot; device space: origin is top left of MediaBox</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span> <span class="o">==</span> <span class="s2">&quot;screen&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="n">x0</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
        <span class="c1"># &quot;page&quot; device space: origin is bottom left of MediaBox</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span> <span class="o">==</span> <span class="s2">&quot;page&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="n">x0</span><span class="p">,</span> <span class="o">-</span><span class="n">y0</span><span class="p">)</span>
        <span class="c1"># &quot;default&quot; device space: no transformation or rotation</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span> <span class="o">!=</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Unknown device space: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="o">=</span> <span class="n">MATRIX_IDENTITY</span>
            <span class="n">width</span> <span class="o">=</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># If rotation is requested, apply rotation to the initial ctm</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate</span> <span class="o">==</span> <span class="mi">90</span><span class="p">:</span>
            <span class="c1"># x&#39; = y</span>
            <span class="c1"># y&#39; = width - x</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="o">=</span> <span class="n">mult_matrix</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate</span> <span class="o">==</span> <span class="mi">180</span><span class="p">:</span>
            <span class="c1"># x&#39; = width - x</span>
            <span class="c1"># y&#39; = height - y</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="o">=</span> <span class="n">mult_matrix</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate</span> <span class="o">==</span> <span class="mi">270</span><span class="p">:</span>
            <span class="c1"># x&#39; = height - y</span>
            <span class="c1"># y&#39; = x</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="o">=</span> <span class="n">mult_matrix</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Invalid /Rotate: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate</span><span class="p">)</span>

        <span class="n">contents</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Contents&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">contents</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_contents</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">contents</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_contents</span> <span class="o">=</span> <span class="n">contents</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_contents</span> <span class="o">=</span> <span class="p">[</span><span class="n">contents</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">annotations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;Annotation&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Lazily iterate over page annotations.&quot;&quot;&quot;</span>
        <span class="n">alist</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Annots&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">alist</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">alist</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Invalid Annots list: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">alist</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">alist</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">Annotation</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">PDFSyntaxError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Invalid object </span><span class="si">%r</span><span class="s2"> in Annots: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                <span class="k">continue</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">doc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Document&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get associated document if it exists.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_deref_document</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">docref</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">streams</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">ContentStream</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return resolved content streams.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contents</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">stream_value</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Found non-stream in contents: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">width</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Width of the page in default user space units.&quot;&quot;&quot;</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mediabox</span>
        <span class="k">return</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">height</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Width of the page in default user space units.&quot;&quot;&quot;</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mediabox</span>
        <span class="k">return</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">contents</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">PDFObject</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterator over PDF objects in the content streams.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">ContentParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_contents</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">obj</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;ContentObject&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterator over lazy layout objects.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="n">LazyInterpreter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contents</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">paths</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;PathObject&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterator over lazy path objects.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">PathObject</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">images</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;ImageObject&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterator over lazy image objects.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">ImageObject</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">texts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;TextObject&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterator over lazy text objects.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">TextObject</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">glyphs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;GlyphObject&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterator over lazy glyph objects.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">TextObject</span><span class="p">):</span>
            <span class="k">yield from</span> <span class="n">text</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">xobjects</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;XObjectObject&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return resolved and rendered Form XObjects.</span>

<span class="sd">        This does *not* return any image or PostScript XObjects.  You</span>
<span class="sd">        can get images via the `images` property.  Apparently you</span>
<span class="sd">        aren&#39;t supposed to use PostScript XObjects for anything, ever.</span>

<span class="sd">        Note that these are the XObjects as rendered on the page, so</span>
<span class="sd">        you may see the same named XObject multiple times.  If you</span>
<span class="sd">        need to access their actual definitions you&#39;ll have to look at</span>
<span class="sd">        `page.resources`.</span>

<span class="sd">        This will also return Form XObjects within Form XObjects,</span>
<span class="sd">        except in the case of circular reference chains.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Set</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">xobjects_one</span><span class="p">(</span>
            <span class="n">itor</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="s2">&quot;ContentObject&quot;</span><span class="p">],</span> <span class="n">parents</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;XObjectObject&quot;</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">itor</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">XObjectObject</span><span class="p">)</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">xobjid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">parents</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">obj</span>
                    <span class="k">yield from</span> <span class="n">xobjects_one</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">parents</span> <span class="o">|</span> <span class="p">{</span><span class="n">obj</span><span class="o">.</span><span class="n">xobjid</span><span class="p">})</span>

        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">xobjects_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">set</span><span class="p">()):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">XObjectObject</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">obj</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Token</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterator over tokens in the content streams.&quot;&quot;&quot;</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">ContentParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_contents</span><span class="p">)</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">pos</span><span class="p">,</span> <span class="n">tok</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">nexttoken</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="k">yield</span> <span class="n">tok</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">parent_key</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parent tree key for this page, if any.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;StructParents&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">int_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;StructParents&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">structure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Element&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Mapping of marked content IDs to logical structure elements.</span>

<span class="sd">        This is actually a list of logical structure elements</span>
<span class="sd">        corresponding to marked content IDs, or `None` for indices</span>
<span class="sd">        which do not correspond to a marked content ID.  Note that</span>
<span class="sd">        because structure elements may contain multiple marked content</span>
<span class="sd">        sections, the same element may occur multiple times in this</span>
<span class="sd">        list.</span>

<span class="sd">        Note: This is not the same as `playa.Document.structure`.</span>
<span class="sd">            PDF documents have logical structure, but PDF pages **do</span>
<span class="sd">            not**, and it is dishonest to pretend otherwise (as some</span>
<span class="sd">            code I once wrote unfortunately does).  What they do have</span>
<span class="sd">            is marked content sections which correspond to content</span>
<span class="sd">            items in the logical structure tree.</span>

<span class="sd">        Danger: Do not rely on this being a `list`.</span>
<span class="sd">            Currently this is implemented eagerly, but in the future it</span>
<span class="sd">            may return a lazy object.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">playa.structure</span><span class="w"> </span><span class="kn">import</span> <span class="n">Element</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_structmap</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_structmap</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_structmap</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">structure</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_structmap</span>
        <span class="n">parent_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent_key</span>
        <span class="k">if</span> <span class="n">parent_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_structmap</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">parents</span> <span class="o">=</span> <span class="n">list_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">parent_tree</span><span class="p">[</span><span class="n">parent_key</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_structmap</span>
        <span class="c1"># Elements can contain multiple marked content sections, so</span>
        <span class="c1"># don&#39;t create redundant Element objects for these</span>
        <span class="n">elements</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Element</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">parents</span><span class="p">:</span>
            <span class="n">objid</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">objid</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">ObjRef</span><span class="p">)</span> <span class="k">else</span> <span class="nb">id</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">objid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
                <span class="n">elements</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span> <span class="o">=</span> <span class="n">Element</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="p">,</span> <span class="n">dict_value</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_structmap</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elements</span><span class="p">[</span><span class="n">objid</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_structmap</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">fonts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Font</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Mapping of resource names to fonts for this page.</span>

<span class="sd">        Note: This is not the same as `playa.Document.fonts`.</span>
<span class="sd">            The resource names (e.g. `F1`, `F42`, `FooBar`) here are</span>
<span class="sd">            specific to a page (or Form XObject) resource dictionary</span>
<span class="sd">            and have no relation to the font name as commonly</span>
<span class="sd">            understood (e.g. `Helvetica`,</span>
<span class="sd">            `WQERQE+Arial-SuperBold-HJRE-UTF-8`).  Since font names are</span>
<span class="sd">            generally considered to be globally unique, it may be</span>
<span class="sd">            possible to access fonts by them in the future.</span>

<span class="sd">        Danger: Do not rely on this being a `dict`.</span>
<span class="sd">            Currently this is implemented eagerly, but in the future it</span>
<span class="sd">            may return a lazy object which only loads fonts on demand.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fontmap</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fontmap</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fontmap</span> <span class="o">=</span> <span class="n">_make_fontmap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Font&quot;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fontmap</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;Page: Resources=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="si">!r}</span><span class="s2">, MediaBox=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mediabox</span><span class="si">!r}</span><span class="s2">&gt;&quot;</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">flatten</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;ContentObject&quot;</span><span class="p">]:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">flatten</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">CO</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">CO</span><span class="p">]:</span> <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">flatten</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">filter_class</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">Type</span><span class="p">[</span><span class="n">CO</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">CO</span><span class="p">,</span> <span class="s2">&quot;ContentObject&quot;</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over content objects, recursing into form XObjects.&quot;&quot;&quot;</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Set</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">flatten_one</span><span class="p">(</span>
            <span class="n">itor</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="s2">&quot;ContentObject&quot;</span><span class="p">],</span> <span class="n">parents</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;ContentObject&quot;</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">itor</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">XObjectObject</span><span class="p">)</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">xobjid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">parents</span><span class="p">:</span>
                    <span class="k">yield from</span> <span class="n">flatten_one</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">parents</span> <span class="o">|</span> <span class="p">{</span><span class="n">obj</span><span class="o">.</span><span class="n">xobjid</span><span class="p">})</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">obj</span>

        <span class="k">if</span> <span class="n">filter_class</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">yield from</span> <span class="n">flatten_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">set</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">flatten_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">set</span><span class="p">()):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">filter_class</span><span class="p">):</span>
                    <span class="k">yield</span> <span class="n">obj</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">mcid_texts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Mapping of marked content IDs to Unicode text strings.</span>

<span class="sd">        For use in text extraction from tagged PDFs.</span>

<span class="sd">        Danger: Do not rely on this being a `dict`.</span>
<span class="sd">            Currently this is implemented eagerly, but in the future it</span>
<span class="sd">            may return a lazy object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_textmap&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_textmap</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_textmap</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="n">_extract_mcid_texts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_textmap</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">extract_text</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Do some best-effort text extraction.</span>

<span class="sd">        This necessarily involves a few heuristics, so don&#39;t get your</span>
<span class="sd">        hopes up.  It will attempt to use marked content information</span>
<span class="sd">        for a tagged PDF, otherwise it will fall back on the character</span>
<span class="sd">        displacement and line matrix to determine word and line breaks.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">is_tagged</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_text_tagged</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_text_untagged</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">extract_text_untagged</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get text from a page of an untagged PDF.&quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">_extract_text_from_obj</span><span class="p">(</span>
            <span class="n">obj</span><span class="p">:</span> <span class="s2">&quot;TextObject&quot;</span><span class="p">,</span> <span class="n">vertical</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">prev_end</span><span class="p">:</span> <span class="nb">float</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Try to get text from a text object.&quot;&quot;&quot;</span>
            <span class="n">chars</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">glyph</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
                <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">glyph</span><span class="o">.</span><span class="n">origin</span>
                <span class="n">off</span> <span class="o">=</span> <span class="n">y</span> <span class="k">if</span> <span class="n">vertical</span> <span class="k">else</span> <span class="n">x</span>
                <span class="c1"># 0.5 here is a heuristic!!!</span>
                <span class="k">if</span> <span class="n">prev_end</span> <span class="ow">and</span> <span class="n">off</span> <span class="o">-</span> <span class="n">prev_end</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">chars</span> <span class="ow">and</span> <span class="n">chars</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot; &quot;</span><span class="p">:</span>
                        <span class="n">chars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">glyph</span><span class="o">.</span><span class="n">text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">chars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">glyph</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
                <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">glyph</span><span class="o">.</span><span class="n">displacement</span>
                <span class="n">prev_end</span> <span class="o">=</span> <span class="n">off</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span> <span class="k">if</span> <span class="n">vertical</span> <span class="k">else</span> <span class="n">dx</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">chars</span><span class="p">),</span> <span class="n">prev_end</span>

        <span class="n">prev_end</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">prev_origin</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Point</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">strings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">texts</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">text</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">font</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">vertical</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">vertical</span>
            <span class="c1"># Track changes to the translation component of text</span>
            <span class="c1"># rendering matrix to (yes, heuristically) detect newlines</span>
            <span class="c1"># and spaces between text objects</span>
            <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">origin</span>
            <span class="n">off</span> <span class="o">=</span> <span class="n">dy</span> <span class="k">if</span> <span class="n">vertical</span> <span class="k">else</span> <span class="n">dx</span>
            <span class="k">if</span> <span class="n">strings</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_line</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">prev_origin</span><span class="p">):</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">strings</span><span class="p">))</span>
                <span class="n">strings</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="c1"># 0.5 here is a heuristic!!!</span>
            <span class="k">if</span> <span class="n">strings</span> <span class="ow">and</span> <span class="n">off</span> <span class="o">-</span> <span class="n">prev_end</span> <span class="o">&gt;</span> <span class="mf">0.5</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">strings</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">):</span>
                <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
            <span class="n">textstr</span><span class="p">,</span> <span class="n">prev_end</span> <span class="o">=</span> <span class="n">_extract_text_from_obj</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">vertical</span><span class="p">,</span> <span class="n">off</span><span class="p">)</span>
            <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">textstr</span><span class="p">)</span>
            <span class="n">prev_origin</span> <span class="o">=</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">strings</span><span class="p">))</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_next_line</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">TextObject</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">prev_offset</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Point</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">text</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">text</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">font</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">prev_offset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">origin</span>

        <span class="c1"># Vertical text (usually) means right-to-left lines</span>
        <span class="k">if</span> <span class="n">text</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">vertical</span><span class="p">:</span>
            <span class="n">line_offset</span> <span class="o">=</span> <span class="n">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">prev_offset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># The CTM isn&#39;t useful here because we actually do care</span>
            <span class="c1"># about the final device space, and we just want to know</span>
            <span class="c1"># which way is up and which way is down.</span>
            <span class="n">dy</span> <span class="o">=</span> <span class="n">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">prev_offset</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span> <span class="o">==</span> <span class="s2">&quot;screen&quot;</span><span class="p">:</span>
                <span class="n">line_offset</span> <span class="o">=</span> <span class="o">-</span><span class="n">dy</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">line_offset</span> <span class="o">=</span> <span class="n">dy</span>
        <span class="k">return</span> <span class="n">line_offset</span> <span class="o">&lt;</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">extract_text_tagged</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get text from a page of a tagged PDF.&quot;&quot;&quot;</span>
        <span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">strings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">prev_mcid</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">prev_origin</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Point</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># TODO: Iteration over marked content sections and getting</span>
        <span class="c1"># their text, origin, and displacement, will be refactored</span>
        <span class="k">for</span> <span class="n">mcs</span><span class="p">,</span> <span class="n">texts</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">texts</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;mcs&quot;</span><span class="p">)):</span>
            <span class="n">text</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">TextObject</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="c1"># TODO: Artifact can also be a structure element, but</span>
            <span class="c1"># also, any content outside the structure tree is</span>
            <span class="c1"># considered an artifact</span>
            <span class="k">if</span> <span class="n">mcs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">mcs</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="s2">&quot;Artifact&quot;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">:</span>
                    <span class="n">prev_origin</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">origin</span>
                <span class="k">continue</span>
            <span class="n">actual_text</span> <span class="o">=</span> <span class="n">mcs</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ActualText&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">actual_text</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="nb">reversed</span> <span class="o">=</span> <span class="n">mcs</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="s2">&quot;ReversedChars&quot;</span>
                <span class="n">c</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">:</span>  <span class="c1"># noqa: B031</span>
                    <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">chars</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="nb">reversed</span> <span class="k">else</span> <span class="n">text</span><span class="o">.</span><span class="n">chars</span><span class="p">)</span>
                <span class="n">chars</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">actual_text</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)</span>
                <span class="n">chars</span> <span class="o">=</span> <span class="n">actual_text</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;UTF-16&quot;</span><span class="p">)</span>
                <span class="c1"># Consume all text objects to ensure correct graphicstate</span>
                <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">:</span>  <span class="c1"># noqa: B031</span>
                    <span class="k">pass</span>

            <span class="c1"># Remove soft hyphens</span>
            <span class="n">chars</span> <span class="o">=</span> <span class="n">chars</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\xad</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="c1"># There *might* be a line break, determine based on origin</span>
            <span class="k">if</span> <span class="n">mcs</span><span class="o">.</span><span class="n">mcid</span> <span class="o">!=</span> <span class="n">prev_mcid</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_line</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">prev_origin</span><span class="p">):</span>
                    <span class="n">lines</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">strings</span><span class="p">)))</span>
                    <span class="n">strings</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                <span class="n">prev_mcid</span> <span class="o">=</span> <span class="n">mcs</span><span class="o">.</span><span class="n">mcid</span>
            <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chars</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">prev_origin</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">origin</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">strings</span><span class="p">)))</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="playa.page.Page.annotations" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">annotations</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Lazily iterate over page annotations.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.Page.contents" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">contents</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterator over PDF objects in the content streams.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.Page.doc" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">doc</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Get associated document if it exists.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.Page.fonts" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fonts</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Mapping of resource names to fonts for this page.</p>


<details class="note" open>
  <summary>This is not the same as <code>playa.Document.fonts</code>.</summary>
  <p>The resource names (e.g. <code>F1</code>, <code>F42</code>, <code>FooBar</code>) here are
specific to a page (or Form XObject) resource dictionary
and have no relation to the font name as commonly
understood (e.g. <code>Helvetica</code>,
<code>WQERQE+Arial-SuperBold-HJRE-UTF-8</code>).  Since font names are
generally considered to be globally unique, it may be
possible to access fonts by them in the future.</p>
</details>

<details class="danger" open>
  <summary>Do not rely on this being a <code>dict</code>.</summary>
  <p>Currently this is implemented eagerly, but in the future it
may return a lazy object which only loads fonts on demand.</p>
</details>    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.Page.glyphs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">glyphs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterator over lazy glyph objects.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.Page.height" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">height</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Width of the page in default user space units.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.Page.images" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">images</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterator over lazy image objects.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.Page.mcid_texts" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mcid_texts</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Mapping of marked content IDs to Unicode text strings.</p>
<p>For use in text extraction from tagged PDFs.</p>


<details class="danger" open>
  <summary>Do not rely on this being a <code>dict</code>.</summary>
  <p>Currently this is implemented eagerly, but in the future it
may return a lazy object.</p>
</details>    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.Page.parent_key" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parent_key</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Parent tree key for this page, if any.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.Page.paths" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">paths</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterator over lazy path objects.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.Page.streams" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">streams</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Return resolved content streams.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.Page.structure" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">structure</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Mapping of marked content IDs to logical structure elements.</p>
<p>This is actually a list of logical structure elements
corresponding to marked content IDs, or <code>None</code> for indices
which do not correspond to a marked content ID.  Note that
because structure elements may contain multiple marked content
sections, the same element may occur multiple times in this
list.</p>


<details class="note" open>
  <summary>This is not the same as <code>playa.Document.structure</code>.</summary>
  <p>PDF documents have logical structure, but PDF pages <strong>do
not</strong>, and it is dishonest to pretend otherwise (as some
code I once wrote unfortunately does).  What they do have
is marked content sections which correspond to content
items in the logical structure tree.</p>
</details>

<details class="danger" open>
  <summary>Do not rely on this being a <code>list</code>.</summary>
  <p>Currently this is implemented eagerly, but in the future it
may return a lazy object.</p>
</details>    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.Page.texts" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">texts</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterator over lazy text objects.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.Page.tokens" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tokens</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterator over tokens in the content streams.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.Page.width" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">width</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Width of the page in default user space units.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.page.Page.xobjects" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">xobjects</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Return resolved and rendered Form XObjects.</p>
<p>This does <em>not</em> return any image or PostScript XObjects.  You
can get images via the <code>images</code> property.  Apparently you
aren't supposed to use PostScript XObjects for anything, ever.</p>
<p>Note that these are the XObjects as rendered on the page, so
you may see the same named XObject multiple times.  If you
need to access their actual definitions you'll have to look at
<code>page.resources</code>.</p>
<p>This will also return Form XObjects within Form XObjects,
except in the case of circular reference chains.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="playa.page.Page.__iter__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__iter__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Iterator over lazy layout objects.</p>

            <details class="quote">
              <summary>Source code in <code>playa/page.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;ContentObject&quot;</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterator over lazy layout objects.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="n">LazyInterpreter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contents</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.page.Page.extract_text" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extract_text</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Do some best-effort text extraction.</p>
<p>This necessarily involves a few heuristics, so don't get your
hopes up.  It will attempt to use marked content information
for a tagged PDF, otherwise it will fall back on the character
displacement and line matrix to determine word and line breaks.</p>

            <details class="quote">
              <summary>Source code in <code>playa/page.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">extract_text</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Do some best-effort text extraction.</span>

<span class="sd">    This necessarily involves a few heuristics, so don&#39;t get your</span>
<span class="sd">    hopes up.  It will attempt to use marked content information</span>
<span class="sd">    for a tagged PDF, otherwise it will fall back on the character</span>
<span class="sd">    displacement and line matrix to determine word and line breaks.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">is_tagged</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_text_tagged</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_text_untagged</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.page.Page.extract_text_tagged" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extract_text_tagged</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get text from a page of a tagged PDF.</p>

            <details class="quote">
              <summary>Source code in <code>playa/page.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">extract_text_tagged</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get text from a page of a tagged PDF.&quot;&quot;&quot;</span>
    <span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">strings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">prev_mcid</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">prev_origin</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Point</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># TODO: Iteration over marked content sections and getting</span>
    <span class="c1"># their text, origin, and displacement, will be refactored</span>
    <span class="k">for</span> <span class="n">mcs</span><span class="p">,</span> <span class="n">texts</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">texts</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;mcs&quot;</span><span class="p">)):</span>
        <span class="n">text</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">TextObject</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># TODO: Artifact can also be a structure element, but</span>
        <span class="c1"># also, any content outside the structure tree is</span>
        <span class="c1"># considered an artifact</span>
        <span class="k">if</span> <span class="n">mcs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">mcs</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="s2">&quot;Artifact&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">:</span>
                <span class="n">prev_origin</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">origin</span>
            <span class="k">continue</span>
        <span class="n">actual_text</span> <span class="o">=</span> <span class="n">mcs</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ActualText&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">actual_text</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">reversed</span> <span class="o">=</span> <span class="n">mcs</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="s2">&quot;ReversedChars&quot;</span>
            <span class="n">c</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">:</span>  <span class="c1"># noqa: B031</span>
                <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">chars</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="nb">reversed</span> <span class="k">else</span> <span class="n">text</span><span class="o">.</span><span class="n">chars</span><span class="p">)</span>
            <span class="n">chars</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">actual_text</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)</span>
            <span class="n">chars</span> <span class="o">=</span> <span class="n">actual_text</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;UTF-16&quot;</span><span class="p">)</span>
            <span class="c1"># Consume all text objects to ensure correct graphicstate</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">:</span>  <span class="c1"># noqa: B031</span>
                <span class="k">pass</span>

        <span class="c1"># Remove soft hyphens</span>
        <span class="n">chars</span> <span class="o">=</span> <span class="n">chars</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\xad</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="c1"># There *might* be a line break, determine based on origin</span>
        <span class="k">if</span> <span class="n">mcs</span><span class="o">.</span><span class="n">mcid</span> <span class="o">!=</span> <span class="n">prev_mcid</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_line</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">prev_origin</span><span class="p">):</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">strings</span><span class="p">)))</span>
                <span class="n">strings</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">prev_mcid</span> <span class="o">=</span> <span class="n">mcs</span><span class="o">.</span><span class="n">mcid</span>
        <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chars</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">prev_origin</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">origin</span>
    <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">strings</span><span class="p">)))</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.page.Page.extract_text_untagged" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extract_text_untagged</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get text from a page of an untagged PDF.</p>

            <details class="quote">
              <summary>Source code in <code>playa/page.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">extract_text_untagged</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get text from a page of an untagged PDF.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_extract_text_from_obj</span><span class="p">(</span>
        <span class="n">obj</span><span class="p">:</span> <span class="s2">&quot;TextObject&quot;</span><span class="p">,</span> <span class="n">vertical</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">prev_end</span><span class="p">:</span> <span class="nb">float</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Try to get text from a text object.&quot;&quot;&quot;</span>
        <span class="n">chars</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">glyph</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">glyph</span><span class="o">.</span><span class="n">origin</span>
            <span class="n">off</span> <span class="o">=</span> <span class="n">y</span> <span class="k">if</span> <span class="n">vertical</span> <span class="k">else</span> <span class="n">x</span>
            <span class="c1"># 0.5 here is a heuristic!!!</span>
            <span class="k">if</span> <span class="n">prev_end</span> <span class="ow">and</span> <span class="n">off</span> <span class="o">-</span> <span class="n">prev_end</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">chars</span> <span class="ow">and</span> <span class="n">chars</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot; &quot;</span><span class="p">:</span>
                    <span class="n">chars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">glyph</span><span class="o">.</span><span class="n">text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">chars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">glyph</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">glyph</span><span class="o">.</span><span class="n">displacement</span>
            <span class="n">prev_end</span> <span class="o">=</span> <span class="n">off</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span> <span class="k">if</span> <span class="n">vertical</span> <span class="k">else</span> <span class="n">dx</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">chars</span><span class="p">),</span> <span class="n">prev_end</span>

    <span class="n">prev_end</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">prev_origin</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Point</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">strings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">texts</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">text</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">font</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">vertical</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">vertical</span>
        <span class="c1"># Track changes to the translation component of text</span>
        <span class="c1"># rendering matrix to (yes, heuristically) detect newlines</span>
        <span class="c1"># and spaces between text objects</span>
        <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">origin</span>
        <span class="n">off</span> <span class="o">=</span> <span class="n">dy</span> <span class="k">if</span> <span class="n">vertical</span> <span class="k">else</span> <span class="n">dx</span>
        <span class="k">if</span> <span class="n">strings</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_line</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">prev_origin</span><span class="p">):</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">strings</span><span class="p">))</span>
            <span class="n">strings</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="c1"># 0.5 here is a heuristic!!!</span>
        <span class="k">if</span> <span class="n">strings</span> <span class="ow">and</span> <span class="n">off</span> <span class="o">-</span> <span class="n">prev_end</span> <span class="o">&gt;</span> <span class="mf">0.5</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">strings</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">):</span>
            <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="n">textstr</span><span class="p">,</span> <span class="n">prev_end</span> <span class="o">=</span> <span class="n">_extract_text_from_obj</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">vertical</span><span class="p">,</span> <span class="n">off</span><span class="p">)</span>
        <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">textstr</span><span class="p">)</span>
        <span class="n">prev_origin</span> <span class="o">=</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span>
    <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">strings</span><span class="p">))</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.page.Page.flatten" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">flatten</span><span class="p">(</span><span class="n">filter_class</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>
          <div class="doc-overloads">
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">flatten</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">ContentObject</span><span class="p">]</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class="nf">flatten</span><span class="p">(</span><span class="n">filter_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">CO</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">CO</span><span class="p">]</span>
</code></pre></div>          </div>


    <div class="doc doc-contents ">

        <p>Iterate over content objects, recursing into form XObjects.</p>

            <details class="quote">
              <summary>Source code in <code>playa/page.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">flatten</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">filter_class</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">Type</span><span class="p">[</span><span class="n">CO</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">CO</span><span class="p">,</span> <span class="s2">&quot;ContentObject&quot;</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterate over content objects, recursing into form XObjects.&quot;&quot;&quot;</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Set</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">flatten_one</span><span class="p">(</span>
        <span class="n">itor</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="s2">&quot;ContentObject&quot;</span><span class="p">],</span> <span class="n">parents</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;ContentObject&quot;</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">itor</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">XObjectObject</span><span class="p">)</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">xobjid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">parents</span><span class="p">:</span>
                <span class="k">yield from</span> <span class="n">flatten_one</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">parents</span> <span class="o">|</span> <span class="p">{</span><span class="n">obj</span><span class="o">.</span><span class="n">xobjid</span><span class="p">})</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">obj</span>

    <span class="k">if</span> <span class="n">filter_class</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">yield from</span> <span class="n">flatten_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">set</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">flatten_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">set</span><span class="p">()):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">filter_class</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">obj</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="playa.content" class="doc doc-heading">
            <code>playa.content</code>


</h2>

    <div class="doc doc-contents first">

        <p>PDF content objects created by the interpreter.</p>








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="playa.content.ContentObject" class="doc doc-heading">
            <code>ContentObject</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>Any sort of content object.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.ContentObject.gstate">gstate</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="playa.content.GraphicState" href="#playa.content.GraphicState">GraphicState</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Graphics state.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.ContentObject.ctm">ctm</span></code></td>
            <td>
                  <code><span title="playa.pdftypes.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Coordinate transformation matrix (PDF 1.7 section 8.3.2).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.ContentObject.mcstack">mcstack</span></code></td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<a class="autorefs autorefs-internal" title="playa.content.MarkedContent" href="#playa.content.MarkedContent">MarkedContent</a>, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Stack of enclosing marked content sections.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>playa/content.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ContentObject</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Any sort of content object.</span>

<span class="sd">    Attributes:</span>
<span class="sd">      gstate: Graphics state.</span>
<span class="sd">      ctm: Coordinate transformation matrix (PDF 1.7 section 8.3.2).</span>
<span class="sd">      mcstack: Stack of enclosing marked content sections.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_pageref</span><span class="p">:</span> <span class="n">PageRef</span>
    <span class="n">_parentkey</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">gstate</span><span class="p">:</span> <span class="n">GraphicState</span>
    <span class="n">ctm</span><span class="p">:</span> <span class="n">Matrix</span>
    <span class="n">mcstack</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">MarkedContent</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;ContentObject&quot;</span><span class="p">]:</span>
        <span class="k">yield from</span> <span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the number of children of this object (generic implementation).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">object_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Type of this object as a string, e.g. &quot;text&quot;, &quot;path&quot;, &quot;image&quot;.&quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="k">return</span> <span class="n">name</span><span class="p">[:</span> <span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="s2">&quot;Object&quot;</span><span class="p">)]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rect</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The bounding box in device space of this object.&quot;&quot;&quot;</span>
        <span class="c1"># These bboxes have already been computed in device space so</span>
        <span class="c1"># we don&#39;t need all 4 corners!</span>
        <span class="n">points</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
            <span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">))</span> <span class="k">for</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="ow">in</span> <span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">bbox</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">get_bound</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">mcs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">MarkedContent</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The immediately enclosing marked content section.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcstack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcstack</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">mcid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The marked content ID of the nearest enclosing marked</span>
<span class="sd">        content section with an ID.</span>

<span class="sd">        This is notably what you should use (and what `parent` uses)</span>
<span class="sd">        to find the parent logical structure element, because (PDF</span>
<span class="sd">        14.7.5.1.1):</span>

<span class="sd">        &gt; A marked-content sequence corresponding to a structure</span>
<span class="sd">        content item shall not have another marked-content sequence</span>
<span class="sd">        for a structure content item nested within it though</span>
<span class="sd">        non-structural marked-content shall be allowed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_mcid&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mcid</span>
        <span class="k">for</span> <span class="n">mcs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcstack</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">mcs</span><span class="o">.</span><span class="n">mcid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_mcid</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="n">mcs</span><span class="o">.</span><span class="n">mcid</span>
                <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_mcid</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mcid</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">parent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Element&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The enclosing logical structure element, if any.&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">playa.structure</span><span class="w"> </span><span class="kn">import</span> <span class="n">Element</span>

        <span class="c1"># Use `mcid` and not `mcs` here (see docs for `mcid`)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_parent&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Element&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">parent_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parentkey</span>
        <span class="k">if</span> <span class="n">parent_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span>
        <span class="n">structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">structure</span>
        <span class="k">if</span> <span class="n">structure</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span>
        <span class="n">mcid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcid</span>
        <span class="k">if</span> <span class="n">mcid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span>
        <span class="n">parents</span> <span class="o">=</span> <span class="n">list_value</span><span class="p">(</span><span class="n">structure</span><span class="o">.</span><span class="n">parent_tree</span><span class="p">[</span><span class="n">parent_key</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">mcid</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">parents</span><span class="p">):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Invalid marked content ID: </span><span class="si">%d</span><span class="s2"> (page has </span><span class="si">%d</span><span class="s2"> MCIDs)&quot;</span><span class="p">,</span> <span class="n">mcid</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">parents</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">Element</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="p">,</span> <span class="n">dict_value</span><span class="p">(</span><span class="n">parents</span><span class="p">[</span><span class="n">mcid</span><span class="p">]))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">page</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Page&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The page containing this content object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_deref_page</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pageref</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">doc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Document&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The document containing this content object.&quot;&quot;&quot;</span>
        <span class="n">docref</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pageref</span>
        <span class="k">return</span> <span class="n">_deref_document</span><span class="p">(</span><span class="n">docref</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="playa.content.ContentObject.bbox" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bbox</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The bounding box in device space of this object.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.content.ContentObject.doc" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">doc</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The document containing this content object.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.content.ContentObject.mcid" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mcid</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The marked content ID of the nearest enclosing marked
content section with an ID.</p>
<p>This is notably what you should use (and what <code>parent</code> uses)
to find the parent logical structure element, because (PDF
14.7.5.1.1):</p>
<blockquote>
<p>A marked-content sequence corresponding to a structure
content item shall not have another marked-content sequence
for a structure content item nested within it though
non-structural marked-content shall be allowed.</p>
</blockquote>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.content.ContentObject.mcs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mcs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The immediately enclosing marked content section.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.content.ContentObject.object_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">object_type</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Type of this object as a string, e.g. "text", "path", "image".</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.content.ContentObject.page" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">page</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The page containing this content object.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.content.ContentObject.parent" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parent</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The enclosing logical structure element, if any.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="playa.content.ContentObject.__len__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return the number of children of this object (generic implementation).</p>

            <details class="quote">
              <summary>Source code in <code>playa/content.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the number of children of this object (generic implementation).&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.content.DashPattern" class="doc doc-heading">
            <code>DashPattern</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.NamedTuple">NamedTuple</span></code></p>


        <p>Line dash pattern in PDF graphics state (PDF 1.7 section 8.4.3.6).</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.DashPattern.dash">dash</span></code></td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[float, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>lengths of dashes and gaps in user space units</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.DashPattern.phase">phase</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>starting position in the dash pattern</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>playa/content.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DashPattern</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Line dash pattern in PDF graphics state (PDF 1.7 section 8.4.3.6).</span>

<span class="sd">    Attributes:</span>
<span class="sd">      dash: lengths of dashes and gaps in user space units</span>
<span class="sd">      phase: starting position in the dash pattern</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dash</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
    <span class="n">phase</span><span class="p">:</span> <span class="nb">float</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dash</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dash</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.content.GlyphObject" class="doc doc-heading">
            <code>GlyphObject</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="playa.content.ContentObject" href="#playa.content.ContentObject">ContentObject</a></code></p>


        <p>Individual glyph on the page.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GlyphObject.font">font</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="playa.font.Font" href="#playa.font.Font">Font</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Font for this glyph.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GlyphObject.size">size</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Effective font size for this glyph.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GlyphObject.cid">cid</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Character ID for this glyph.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GlyphObject.text">text</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[str, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unicode mapping of this glyph, if any.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GlyphObject.matrix">matrix</span></code></td>
            <td>
                  <code><span title="playa.pdftypes.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Rendering matrix <code>T_rm</code> for this glyph, which transforms
      text space coordinates to device space (PDF 2.0 section
      9.4.4).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GlyphObject.origin">origin</span></code></td>
            <td>
                  <code><span title="playa.pdftypes.Point">Point</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Origin of this glyph in device space.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GlyphObject.displacement">displacement</span></code></td>
            <td>
                  <code><span title="playa.pdftypes.Point">Point</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Vector to the origin of the next glyph in device space.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GlyphObject.bbox">bbox</span></code></td>
            <td>
                  <code><span title="playa.pdftypes.Rect">Rect</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>glyph bounding box in device space.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>playa/content.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">GlyphObject</span><span class="p">(</span><span class="n">ContentObject</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Individual glyph on the page.</span>

<span class="sd">    Attributes:</span>
<span class="sd">      font: Font for this glyph.</span>
<span class="sd">      size: Effective font size for this glyph.</span>
<span class="sd">      cid: Character ID for this glyph.</span>
<span class="sd">      text: Unicode mapping of this glyph, if any.</span>
<span class="sd">      matrix: Rendering matrix `T_rm` for this glyph, which transforms</span>
<span class="sd">              text space coordinates to device space (PDF 2.0 section</span>
<span class="sd">              9.4.4).</span>
<span class="sd">      origin: Origin of this glyph in device space.</span>
<span class="sd">      displacement: Vector to the origin of the next glyph in device space.</span>
<span class="sd">      bbox: glyph bounding box in device space.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">cid</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">text</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">matrix</span><span class="p">:</span> <span class="n">Matrix</span>
    <span class="n">_displacement</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">_corners</span><span class="p">:</span> <span class="nb">bool</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">ContentObject</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Possibly iterate over paths in a glyph.</span>

<span class="sd">        For Type3 fonts, you can iterate over paths (or anything</span>
<span class="sd">        else) inside a glyph, in the coordinate space defined by the</span>
<span class="sd">        text rendering matrix.</span>

<span class="sd">        Otherwise, you can&#39;t do that, and you get nothing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">playa.interp</span><span class="w"> </span><span class="kn">import</span> <span class="n">Type3Interpreter</span>

        <span class="n">font</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font</span>
        <span class="n">itor</span><span class="p">:</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">ContentObject</span><span class="p">]</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(())</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">font</span><span class="p">,</span> <span class="n">Type3Font</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">itor</span>
        <span class="n">gid</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">encoding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cid</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">gid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Unknown CID </span><span class="si">%d</span><span class="s2"> in Type3 font </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cid</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">itor</span>
        <span class="n">charproc</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">font</span><span class="o">.</span><span class="n">charprocs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">gid</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">charproc</span><span class="p">,</span> <span class="n">ContentStream</span><span class="p">):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;CharProc </span><span class="si">%s</span><span class="s2"> not found in font </span><span class="si">%r</span><span class="s2"> &quot;</span><span class="p">,</span> <span class="n">gid</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">itor</span>

        <span class="n">interp</span> <span class="o">=</span> <span class="n">Type3Interpreter</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="p">,</span>
            <span class="p">[</span><span class="n">charproc</span><span class="p">],</span>
            <span class="n">font</span><span class="o">.</span><span class="n">resources</span><span class="p">,</span>
            <span class="n">ctm</span><span class="o">=</span><span class="n">mult_matrix</span><span class="p">(</span><span class="n">font</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">),</span>
            <span class="c1"># NOTE: no copy here because an interpreter always creates</span>
            <span class="c1"># a new graphics state.</span>
            <span class="n">gstate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">itor</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">interp</span><span class="p">)</span>
        <span class="c1"># TODO: We *could* try to get and use the d1 information here</span>
        <span class="c1"># but if we do that, we need to do it everywhere the glyph is</span>
        <span class="c1"># used so that the bbox will be consistent</span>
        <span class="k">return</span> <span class="n">itor</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">font</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Font</span><span class="p">:</span>
        <span class="n">font</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">font</span>
        <span class="k">assert</span> <span class="n">font</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">font</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">vert</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">font</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">vertical</span>
        <span class="k">return</span> <span class="n">_font_size</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span> <span class="n">vert</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">origin</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Point</span><span class="p">:</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span>
        <span class="k">return</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">displacement</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Point</span><span class="p">:</span>
        <span class="c1"># Equivalent to:</span>
        <span class="c1"># apply_matrix_norm(self.matrix,</span>
        <span class="c1">#                   (0, self._displacement)</span>
        <span class="c1">#                   if font.vertical else</span>
        <span class="c1">#                   (self._displacement, 0))</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">vertical</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">c</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_displacement</span><span class="p">,</span> <span class="n">d</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_displacement</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_displacement</span><span class="p">,</span> <span class="n">b</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_displacement</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rect</span><span class="p">:</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">char_bbox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cid</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_corners</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">get_bound</span><span class="p">(</span>
                <span class="p">(</span>
                    <span class="n">apply_matrix_pt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">)),</span>
                    <span class="n">apply_matrix_pt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y1</span><span class="p">)),</span>
                    <span class="n">apply_matrix_pt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)),</span>
                    <span class="n">apply_matrix_pt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">)),</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">apply_matrix_pt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">))</span>
            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">apply_matrix_pt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">x1</span> <span class="o">&lt;</span> <span class="n">x0</span><span class="p">:</span>
                <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x0</span>
            <span class="k">if</span> <span class="n">y1</span> <span class="o">&lt;</span> <span class="n">y0</span><span class="p">:</span>
                <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y0</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="playa.content.GlyphObject.__iter__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__iter__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Possibly iterate over paths in a glyph.</p>
<p>For Type3 fonts, you can iterate over paths (or anything
else) inside a glyph, in the coordinate space defined by the
text rendering matrix.</p>
<p>Otherwise, you can't do that, and you get nothing.</p>

            <details class="quote">
              <summary>Source code in <code>playa/content.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">ContentObject</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Possibly iterate over paths in a glyph.</span>

<span class="sd">    For Type3 fonts, you can iterate over paths (or anything</span>
<span class="sd">    else) inside a glyph, in the coordinate space defined by the</span>
<span class="sd">    text rendering matrix.</span>

<span class="sd">    Otherwise, you can&#39;t do that, and you get nothing.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">playa.interp</span><span class="w"> </span><span class="kn">import</span> <span class="n">Type3Interpreter</span>

    <span class="n">font</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font</span>
    <span class="n">itor</span><span class="p">:</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">ContentObject</span><span class="p">]</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(())</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">font</span><span class="p">,</span> <span class="n">Type3Font</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">itor</span>
    <span class="n">gid</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">encoding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cid</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">gid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Unknown CID </span><span class="si">%d</span><span class="s2"> in Type3 font </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cid</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">itor</span>
    <span class="n">charproc</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">font</span><span class="o">.</span><span class="n">charprocs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">gid</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">charproc</span><span class="p">,</span> <span class="n">ContentStream</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;CharProc </span><span class="si">%s</span><span class="s2"> not found in font </span><span class="si">%r</span><span class="s2"> &quot;</span><span class="p">,</span> <span class="n">gid</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">itor</span>

    <span class="n">interp</span> <span class="o">=</span> <span class="n">Type3Interpreter</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="p">,</span>
        <span class="p">[</span><span class="n">charproc</span><span class="p">],</span>
        <span class="n">font</span><span class="o">.</span><span class="n">resources</span><span class="p">,</span>
        <span class="n">ctm</span><span class="o">=</span><span class="n">mult_matrix</span><span class="p">(</span><span class="n">font</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">),</span>
        <span class="c1"># NOTE: no copy here because an interpreter always creates</span>
        <span class="c1"># a new graphics state.</span>
        <span class="n">gstate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">itor</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">interp</span><span class="p">)</span>
    <span class="c1"># TODO: We *could* try to get and use the d1 information here</span>
    <span class="c1"># but if we do that, we need to do it everywhere the glyph is</span>
    <span class="c1"># used so that the bbox will be consistent</span>
    <span class="k">return</span> <span class="n">itor</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.content.GraphicState" class="doc doc-heading">
            <code>GraphicState</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>PDF graphics state (PDF 1.7 section 8.4) including text state
(PDF 1.7 section 9.3.1), but excluding coordinate transformations.</p>
<p>Contrary to the pretensions of pdfminer.six, the text state is for
the most part not at all separate from the graphics state, and can
be updated outside the confines of <code>BT</code> and <code>ET</code> operators, thus
there is no advantage and only confusion that comes from treating
it separately.</p>
<p>The only state that does not persist outside <code>BT</code> / <code>ET</code> pairs is
the text coordinate space (line matrix and text rendering matrix),
and it is also the only part that is updated during iteration over
a <code>TextObject</code>.</p>
<p>For historical reasons the main coordinate transformation matrix,
though it is also part of the graphics state, is also stored
separately.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GraphicState.clipping_path">clipping_path</span></code></td>
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current clipping path (sec. 8.5.4)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GraphicState.linewidth">linewidth</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Line width in user space units (sec. 8.4.3.2)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GraphicState.linecap">linecap</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Line cap style (sec. 8.4.3.3)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GraphicState.linejoin">linejoin</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Line join style (sec. 8.4.3.4)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GraphicState.miterlimit">miterlimit</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum length of mitered line joins (sec. 8.4.3.5)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GraphicState.dash">dash</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="playa.content.DashPattern" href="#playa.content.DashPattern">DashPattern</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dash pattern for stroking (sec 8.4.3.6)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GraphicState.intent">intent</span></code></td>
            <td>
                  <code><span title="playa.pdftypes.PSLiteral">PSLiteral</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Rendering intent (sec. 8.6.5.8)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GraphicState.stroke_adjustment">stroke_adjustment</span></code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A flag specifying whether to compensate for
possible rasterization effects when stroking a path with a line
width that is small relative to the pixel resolution of the output
device (sec. 10.7.5)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GraphicState.blend_mode">blend_mode</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="playa.pdftypes.PSLiteral">PSLiteral</span>, <span title="typing.List">List</span>[<span title="playa.pdftypes.PSLiteral">PSLiteral</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current blend mode that shall be used in the
transparent imaging model (sec. 11.3.5)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GraphicState.smask">smask</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[None, <span title="typing.Dict">Dict</span>[str, <span title="playa.pdftypes.PDFObject">PDFObject</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A soft-mask dictionary (sec. 11.6.5.1) or None</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GraphicState.salpha">salpha</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The constant shape or constant opacity value used for
stroking operations (sec. 11.3.7.2 &amp; 11.6.4.4)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GraphicState.nalpha">nalpha</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The constant shape or constant opacity value used for
non-stroking operations</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GraphicState.alpha_source">alpha_source</span></code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A flag specifying whether the current soft mask and
alpha constant parameters shall be interpreted as shape values
(true) or opacity values (false). This flag also governs the
interpretation of the SMask entry, if any, in an image dictionary</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GraphicState.black_pt_comp">black_pt_comp</span></code></td>
            <td>
                  <code><span title="playa.pdftypes.PSLiteral">PSLiteral</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The black point compensation algorithm that shall be
used when converting CIE-based colours (sec. 8.6.5.9)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GraphicState.flatness">flatness</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The precision with which curves shall be rendered on
the output device (sec. 10.6.2)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GraphicState.scolor">scolor</span></code></td>
            <td>
                  <code><span title="playa.color.Color">Color</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Colour used for stroking operations</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GraphicState.scs">scs</span></code></td>
            <td>
                  <code><span title="playa.color.ColorSpace">ColorSpace</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Colour space used for stroking operations</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GraphicState.ncolor">ncolor</span></code></td>
            <td>
                  <code><span title="playa.color.Color">Color</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Colour used for non-stroking operations</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GraphicState.ncs">ncs</span></code></td>
            <td>
                  <code><span title="playa.color.ColorSpace">ColorSpace</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Colour space used for non-stroking operations</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GraphicState.font">font</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="playa.font.Font" href="#playa.font.Font">Font</a>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current font.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GraphicState.fontsize">fontsize</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The "font size" parameter, which is <strong>not</strong> the font
size in points as you might understand it, but rather a
scaling factor applied to text space (so, it affects not only
text size but position as well).  Since most reasonable people
find that behaviour rather confusing, this is often just 1.0,
and PDFs rely on the text matrix to set the size of text.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GraphicState.charspace">charspace</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Extra spacing to add after each glyph, expressed in
unscaled text space units, meaning it is not affected by
<code>fontsize</code>.  <strong>BUT</strong> it will be modified by <code>scaling</code> for
horizontal writing mode (so, most of the time).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GraphicState.wordspace">wordspace</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Extra spacing to add after a space glyph, defined
very specifically as the glyph encoded by the single-byte
character code 32 (SPOILER: it is probably a space).  Also
expressed in unscaled text space units, but modified by
<code>scaling</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GraphicState.scaling">scaling</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The horizontal scaling factor as defined by the PDF
standard (that is, divided by 100).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GraphicState.leading">leading</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The leading as defined by the PDF standard, in unscaled
text space units.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GraphicState.render_mode">render_mode</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The PDF rendering mode.  The really important one
here is 3, which means "don't render the text".  You might
want to use this to detect invisible text.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GraphicState.rise">rise</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The text rise (superscript or subscript position), in
unscaled text space units.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.GraphicState.knockout">knockout</span></code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The text knockout flag, shall determine the behaviour of
overlapping glyphs within a text object in the transparent imaging
model (sec. 9.3.8)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>playa/content.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">GraphicState</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;PDF graphics state (PDF 1.7 section 8.4) including text state</span>
<span class="sd">    (PDF 1.7 section 9.3.1), but excluding coordinate transformations.</span>

<span class="sd">    Contrary to the pretensions of pdfminer.six, the text state is for</span>
<span class="sd">    the most part not at all separate from the graphics state, and can</span>
<span class="sd">    be updated outside the confines of `BT` and `ET` operators, thus</span>
<span class="sd">    there is no advantage and only confusion that comes from treating</span>
<span class="sd">    it separately.</span>

<span class="sd">    The only state that does not persist outside `BT` / `ET` pairs is</span>
<span class="sd">    the text coordinate space (line matrix and text rendering matrix),</span>
<span class="sd">    and it is also the only part that is updated during iteration over</span>
<span class="sd">    a `TextObject`.</span>

<span class="sd">    For historical reasons the main coordinate transformation matrix,</span>
<span class="sd">    though it is also part of the graphics state, is also stored</span>
<span class="sd">    separately.</span>

<span class="sd">    Attributes:</span>
<span class="sd">      clipping_path: The current clipping path (sec. 8.5.4)</span>
<span class="sd">      linewidth: Line width in user space units (sec. 8.4.3.2)</span>
<span class="sd">      linecap: Line cap style (sec. 8.4.3.3)</span>
<span class="sd">      linejoin: Line join style (sec. 8.4.3.4)</span>
<span class="sd">      miterlimit: Maximum length of mitered line joins (sec. 8.4.3.5)</span>
<span class="sd">      dash: Dash pattern for stroking (sec 8.4.3.6)</span>
<span class="sd">      intent: Rendering intent (sec. 8.6.5.8)</span>
<span class="sd">      stroke_adjustment: A flag specifying whether to compensate for</span>
<span class="sd">        possible rasterization effects when stroking a path with a line</span>
<span class="sd">        width that is small relative to the pixel resolution of the output</span>
<span class="sd">        device (sec. 10.7.5)</span>
<span class="sd">      blend_mode: The current blend mode that shall be used in the</span>
<span class="sd">        transparent imaging model (sec. 11.3.5)</span>
<span class="sd">      smask: A soft-mask dictionary (sec. 11.6.5.1) or None</span>
<span class="sd">      salpha: The constant shape or constant opacity value used for</span>
<span class="sd">        stroking operations (sec. 11.3.7.2 &amp; 11.6.4.4)</span>
<span class="sd">      nalpha: The constant shape or constant opacity value used for</span>
<span class="sd">        non-stroking operations</span>
<span class="sd">      alpha_source: A flag specifying whether the current soft mask and</span>
<span class="sd">        alpha constant parameters shall be interpreted as shape values</span>
<span class="sd">        (true) or opacity values (false). This flag also governs the</span>
<span class="sd">        interpretation of the SMask entry, if any, in an image dictionary</span>
<span class="sd">      black_pt_comp: The black point compensation algorithm that shall be</span>
<span class="sd">        used when converting CIE-based colours (sec. 8.6.5.9)</span>
<span class="sd">      flatness: The precision with which curves shall be rendered on</span>
<span class="sd">        the output device (sec. 10.6.2)</span>
<span class="sd">      scolor: Colour used for stroking operations</span>
<span class="sd">      scs: Colour space used for stroking operations</span>
<span class="sd">      ncolor: Colour used for non-stroking operations</span>
<span class="sd">      ncs: Colour space used for non-stroking operations</span>
<span class="sd">      font: The current font.</span>
<span class="sd">      fontsize: The &quot;font size&quot; parameter, which is **not** the font</span>
<span class="sd">        size in points as you might understand it, but rather a</span>
<span class="sd">        scaling factor applied to text space (so, it affects not only</span>
<span class="sd">        text size but position as well).  Since most reasonable people</span>
<span class="sd">        find that behaviour rather confusing, this is often just 1.0,</span>
<span class="sd">        and PDFs rely on the text matrix to set the size of text.</span>
<span class="sd">      charspace: Extra spacing to add after each glyph, expressed in</span>
<span class="sd">        unscaled text space units, meaning it is not affected by</span>
<span class="sd">        `fontsize`.  **BUT** it will be modified by `scaling` for</span>
<span class="sd">        horizontal writing mode (so, most of the time).</span>
<span class="sd">      wordspace: Extra spacing to add after a space glyph, defined</span>
<span class="sd">        very specifically as the glyph encoded by the single-byte</span>
<span class="sd">        character code 32 (SPOILER: it is probably a space).  Also</span>
<span class="sd">        expressed in unscaled text space units, but modified by</span>
<span class="sd">        `scaling`.</span>
<span class="sd">      scaling: The horizontal scaling factor as defined by the PDF</span>
<span class="sd">        standard (that is, divided by 100).</span>
<span class="sd">      leading: The leading as defined by the PDF standard, in unscaled</span>
<span class="sd">        text space units.</span>
<span class="sd">      render_mode: The PDF rendering mode.  The really important one</span>
<span class="sd">        here is 3, which means &quot;don&#39;t render the text&quot;.  You might</span>
<span class="sd">        want to use this to detect invisible text.</span>
<span class="sd">      rise: The text rise (superscript or subscript position), in</span>
<span class="sd">        unscaled text space units.</span>
<span class="sd">      knockout: The text knockout flag, shall determine the behaviour of</span>
<span class="sd">        overlapping glyphs within a text object in the transparent imaging</span>
<span class="sd">        model (sec. 9.3.8)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">clipping_path</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># TODO</span>
    <span class="n">linewidth</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">linecap</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">linejoin</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">miterlimit</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">dash</span><span class="p">:</span> <span class="n">DashPattern</span> <span class="o">=</span> <span class="n">SOLID_LINE</span>
    <span class="n">intent</span><span class="p">:</span> <span class="n">PSLiteral</span> <span class="o">=</span> <span class="n">LITERAL_RELATIVE_COLORIMETRIC</span>
    <span class="n">stroke_adjustment</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">blend_mode</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">PSLiteral</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">PSLiteral</span><span class="p">]]</span> <span class="o">=</span> <span class="n">LITERAL_NORMAL</span>
    <span class="n">smask</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">salpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">nalpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">alpha_source</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">black_pt_comp</span><span class="p">:</span> <span class="n">PSLiteral</span> <span class="o">=</span> <span class="n">LITERAL_DEFAULT</span>
    <span class="n">flatness</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">scolor</span><span class="p">:</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">BASIC_BLACK</span>
    <span class="n">scs</span><span class="p">:</span> <span class="n">ColorSpace</span> <span class="o">=</span> <span class="n">PREDEFINED_COLORSPACE</span><span class="p">[</span><span class="s2">&quot;DeviceGray&quot;</span><span class="p">]</span>
    <span class="n">ncolor</span><span class="p">:</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">BASIC_BLACK</span>
    <span class="n">ncs</span><span class="p">:</span> <span class="n">ColorSpace</span> <span class="o">=</span> <span class="n">PREDEFINED_COLORSPACE</span><span class="p">[</span><span class="s2">&quot;DeviceGray&quot;</span><span class="p">]</span>
    <span class="n">font</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Font</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">fontsize</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">charspace</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">wordspace</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">scaling</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="n">leading</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">render_mode</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">rise</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">knockout</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.content.ImageObject" class="doc doc-heading">
            <code>ImageObject</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="playa.content.ContentObject" href="#playa.content.ContentObject">ContentObject</a></code></p>


        <p>An image (either inline or XObject).</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.ImageObject.xobjid">xobjid</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[str, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of XObject (or None for inline images).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.ImageObject.srcsize">srcsize</span></code></td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[int, int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Size of source image in pixels.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.ImageObject.bits">bits</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of bits per component, if required (otherwise 1).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.ImageObject.imagemask">imagemask</span></code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the image is a mask.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.ImageObject.stream">stream</span></code></td>
            <td>
                  <code><span title="playa.pdftypes.ContentStream">ContentStream</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Content stream with image data.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.ImageObject.colorspace">colorspace</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="playa.color.ColorSpace">ColorSpace</span>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Colour space for this image, if required (otherwise
None).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>playa/content.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ImageObject</span><span class="p">(</span><span class="n">ContentObject</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;An image (either inline or XObject).</span>

<span class="sd">    Attributes:</span>
<span class="sd">      xobjid: Name of XObject (or None for inline images).</span>
<span class="sd">      srcsize: Size of source image in pixels.</span>
<span class="sd">      bits: Number of bits per component, if required (otherwise 1).</span>
<span class="sd">      imagemask: True if the image is a mask.</span>
<span class="sd">      stream: Content stream with image data.</span>
<span class="sd">      colorspace: Colour space for this image, if required (otherwise</span>
<span class="sd">        None).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">xobjid</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">srcsize</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
    <span class="n">bits</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">imagemask</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">stream</span><span class="p">:</span> <span class="n">ContentStream</span>
    <span class="n">colorspace</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ColorSpace</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDFObject</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">PDFObject</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDFObject</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Even though you can __getitem__ from an image you cannot iterate</span>
<span class="sd">        over its keys, sorry about that.  Returns zero.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">parent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Element&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The enclosing logical structure element, if any.&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">playa.structure</span><span class="w"> </span><span class="kn">import</span> <span class="n">Element</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_parent&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parentkey</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span>
        <span class="c1"># No structure, no parent!</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">structure</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">parent_tree</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_parentkey</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">Element</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span>
                <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">buffer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Binary stream content for this image&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">buffer</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rect</span><span class="p">:</span>
        <span class="c1"># PDF 1.7 sec 8.3.24: All images shall be 1 unit wide by 1</span>
        <span class="c1"># unit high in user space, regardless of the number of samples</span>
        <span class="c1"># in the image. To be painted, an image shall be mapped to a</span>
        <span class="c1"># region of the page by temporarily altering the CTM.</span>
        <span class="k">return</span> <span class="n">transform_bbox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="playa.content.ImageObject.buffer" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">buffer</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Binary stream content for this image</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.content.ImageObject.parent" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parent</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The enclosing logical structure element, if any.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="playa.content.ImageObject.__len__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Even though you can <strong>getitem</strong> from an image you cannot iterate
over its keys, sorry about that.  Returns zero.</p>

            <details class="quote">
              <summary>Source code in <code>playa/content.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Even though you can __getitem__ from an image you cannot iterate</span>
<span class="sd">    over its keys, sorry about that.  Returns zero.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.content.MarkedContent" class="doc doc-heading">
            <code>MarkedContent</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.NamedTuple">NamedTuple</span></code></p>


        <p>Marked content point or section in a PDF page or Form XObject.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.MarkedContent.mcid">mcid</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[int, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Marked content section ID, or <code>None</code> for a marked content point.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.MarkedContent.tag">tag</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of tag for this marked content.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.MarkedContent.props">props</span></code></td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[str, <span title="playa.pdftypes.PDFObject">PDFObject</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Marked content property dictionary.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>playa/content.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MarkedContent</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Marked content point or section in a PDF page or Form XObject.</span>

<span class="sd">    Attributes:</span>
<span class="sd">      mcid: Marked content section ID, or `None` for a marked content point.</span>
<span class="sd">      tag: Name of tag for this marked content.</span>
<span class="sd">      props: Marked content property dictionary.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">mcid</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">tag</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">props</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.content.PathObject" class="doc doc-heading">
            <code>PathObject</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="playa.content.ContentObject" href="#playa.content.ContentObject">ContentObject</a></code></p>


        <p>A path object.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.PathObject.raw_segments">raw_segments</span></code></td>
            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="playa.content.PathSegment" href="#playa.content.PathSegment">PathSegment</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Segments in path (in user space).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.PathObject.stroke">stroke</span></code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the outline of the path is stroked.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.PathObject.fill">fill</span></code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the path is filled.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.PathObject.evenodd">evenodd</span></code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the filling of complex paths uses the even-odd
winding rule, False if the non-zero winding number rule is
used (PDF 1.7 section 8.5.3.3)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>playa/content.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">PathObject</span><span class="p">(</span><span class="n">ContentObject</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A path object.</span>

<span class="sd">    Attributes:</span>
<span class="sd">      raw_segments: Segments in path (in user space).</span>
<span class="sd">      stroke: True if the outline of the path is stroked.</span>
<span class="sd">      fill: True if the path is filled.</span>
<span class="sd">      evenodd: True if the filling of complex paths uses the even-odd</span>
<span class="sd">        winding rule, False if the non-zero winding number rule is</span>
<span class="sd">        used (PDF 1.7 section 8.5.3.3)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">raw_segments</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PathSegment</span><span class="p">]</span>
    <span class="n">stroke</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">fill</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">evenodd</span><span class="p">:</span> <span class="nb">bool</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">segments</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">PathSegment</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get path segments in device space.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">PathSegment</span><span class="p">(</span>
                <span class="n">p</span><span class="o">.</span><span class="n">operator</span><span class="p">,</span>
                <span class="nb">tuple</span><span class="p">(</span><span class="n">apply_matrix_pt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">,</span> <span class="n">point</span><span class="p">)</span> <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">points</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_segments</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rect</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get bounding box of path in device space as defined by its</span>
<span class="sd">        points and control points.&quot;&quot;&quot;</span>
        <span class="c1"># First get the bounding box in user space (fast)</span>
        <span class="n">bbox</span> <span class="o">=</span> <span class="n">get_bound</span><span class="p">(</span>
            <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">points</span> <span class="k">for</span> <span class="n">seg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_segments</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="c1"># Transform it and get the new bounding box</span>
        <span class="k">return</span> <span class="n">transform_bbox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">,</span> <span class="n">bbox</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="playa.content.PathObject.bbox" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bbox</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Get bounding box of path in device space as defined by its
points and control points.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.content.PathObject.segments" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">segments</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Get path segments in device space.</p>
    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.content.PathSegment" class="doc doc-heading">
            <code>PathSegment</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.NamedTuple">NamedTuple</span></code></p>


        <p>Segment in a PDF graphics path.</p>






              <details class="quote">
                <summary>Source code in <code>playa/content.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PathSegment</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Segment in a PDF graphics path.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">operator</span><span class="p">:</span> <span class="n">PathOperator</span>
    <span class="n">points</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Point</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.content.TagObject" class="doc doc-heading">
            <code>TagObject</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="playa.content.ContentObject" href="#playa.content.ContentObject">ContentObject</a></code></p>


        <p>A marked content tag..</p>






              <details class="quote">
                <summary>Source code in <code>playa/content.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TagObject</span><span class="p">(</span><span class="n">ContentObject</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A marked content tag..&quot;&quot;&quot;</span>

    <span class="n">_mcs</span><span class="p">:</span> <span class="n">MarkedContent</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A tag has no contents, iterating over it returns nothing.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">mcs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MarkedContent</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The marked content tag for this object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mcs</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">mcid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The marked content ID of the nearest enclosing marked</span>
<span class="sd">        content section with an ID.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mcs</span><span class="o">.</span><span class="n">mcid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mcs</span><span class="o">.</span><span class="n">mcid</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">mcid</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rect</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A tag has no content and thus no bounding box.</span>

<span class="sd">        To avoid needlessly complicating user code this returns</span>
<span class="sd">        `BBOX_NONE` instead of `None` or throwing a exception.</span>
<span class="sd">        Because that is a specific object, you can reliably check for</span>
<span class="sd">        it with:</span>

<span class="sd">            if obj.bbox is BBOX_NONE:</span>
<span class="sd">                ...</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">BBOX_NONE</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="playa.content.TagObject.bbox" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bbox</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>A tag has no content and thus no bounding box.</p>
<p>To avoid needlessly complicating user code this returns
<code>BBOX_NONE</code> instead of <code>None</code> or throwing a exception.
Because that is a specific object, you can reliably check for
it with:</p>
<pre><code>if obj.bbox is BBOX_NONE:
    ...
</code></pre>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.content.TagObject.mcid" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mcid</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The marked content ID of the nearest enclosing marked
content section with an ID.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.content.TagObject.mcs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mcs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The marked content tag for this object.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="playa.content.TagObject.__len__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>A tag has no contents, iterating over it returns nothing.</p>

            <details class="quote">
              <summary>Source code in <code>playa/content.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A tag has no contents, iterating over it returns nothing.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.content.TextObject" class="doc doc-heading">
            <code>TextObject</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="playa.content.ContentObject" href="#playa.content.ContentObject">ContentObject</a></code></p>


        <p>Text object (contains one or more glyphs).</p>
<p>Attributes:</p>
<p>matrix: Initial rendering matrix <code>T_rm</code> for this text object,
          which transforms text space coordinates to device space
          (PDF 2.0 section 9.4.4).
  origin: Origin of this text object in device space.
  displacement: Vector to the origin of the next text object in
                device space.
  size: Effective font size for this text object.
  text_matrix: Text matrix <code>T_m</code> for this text object, which
               transforms text space coordinates to user space.
  line_matrix: Text line matrix <code>T_lm</code> for this text object, which
               is the text matrix at the beginning of the "current
               line" (PDF 2.0 section 9.4.1).  Note that this is
               <strong>not</strong> reliable for detecting line breaks.
  scaling_matrix: The anonymous but rather important matrix which
                  applies font size, horizontal scaling and rise to
                  obtain the rendering matrix (PDF 2.0 sec 9.4.4).
  args: Strings or position adjustments.
  bbox: Text bounding box in device space.</p>






              <details class="quote">
                <summary>Source code in <code>playa/content.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TextObject</span><span class="p">(</span><span class="n">ContentObject</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Text object (contains one or more glyphs).</span>

<span class="sd">    Attributes:</span>

<span class="sd">      matrix: Initial rendering matrix `T_rm` for this text object,</span>
<span class="sd">              which transforms text space coordinates to device space</span>
<span class="sd">              (PDF 2.0 section 9.4.4).</span>
<span class="sd">      origin: Origin of this text object in device space.</span>
<span class="sd">      displacement: Vector to the origin of the next text object in</span>
<span class="sd">                    device space.</span>
<span class="sd">      size: Effective font size for this text object.</span>
<span class="sd">      text_matrix: Text matrix `T_m` for this text object, which</span>
<span class="sd">                   transforms text space coordinates to user space.</span>
<span class="sd">      line_matrix: Text line matrix `T_lm` for this text object, which</span>
<span class="sd">                   is the text matrix at the beginning of the &quot;current</span>
<span class="sd">                   line&quot; (PDF 2.0 section 9.4.1).  Note that this is</span>
<span class="sd">                   **not** reliable for detecting line breaks.</span>
<span class="sd">      scaling_matrix: The anonymous but rather important matrix which</span>
<span class="sd">                      applies font size, horizontal scaling and rise to</span>
<span class="sd">                      obtain the rendering matrix (PDF 2.0 sec 9.4.4).</span>
<span class="sd">      args: Strings or position adjustments.</span>
<span class="sd">      bbox: Text bounding box in device space.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span>
    <span class="n">line_matrix</span><span class="p">:</span> <span class="n">Matrix</span>
    <span class="n">_glyph_offset</span><span class="p">:</span> <span class="n">Point</span>

    <span class="n">_matrix</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Matrix</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_chars</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_bbox</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Rect</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_next_glyph_offset</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Point</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">GlyphObject</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate glyphs for this text object&quot;&quot;&quot;</span>
        <span class="n">glyph_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_glyph_offset</span>
        <span class="n">font</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">font</span>
        <span class="c1"># If no font is set, we cannot do anything, since even calling</span>
        <span class="c1"># TJ with a displacement and no text effects requires us at</span>
        <span class="c1"># least to know the fontsize.</span>
        <span class="k">if</span> <span class="n">font</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;No font is set, will not update text state or output text: </span><span class="si">%r</span><span class="s2"> TJ&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_next_glyph_offset</span> <span class="o">=</span> <span class="n">glyph_offset</span>
            <span class="k">return</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

        <span class="n">tlm_ctm</span> <span class="o">=</span> <span class="n">mult_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line_matrix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">)</span>
        <span class="c1"># Pre-determine if we need to recompute the bound for rotated glyphs</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">tlm_ctm</span>
        <span class="n">corners</span> <span class="o">=</span> <span class="n">b</span> <span class="o">*</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">a</span> <span class="o">*</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="mi">0</span>
        <span class="n">fontsize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">fontsize</span>
        <span class="n">horizontal_scaling</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">scaling</span> <span class="o">*</span> <span class="mf">0.01</span>
        <span class="c1"># PDF 2.0 section 9.3.2: The character-spacing parameter, Tc,</span>
        <span class="c1"># shall be a number specified in unscaled text space units</span>
        <span class="c1"># (although it shall be subject to scaling by the Th parameter</span>
        <span class="c1"># if the writing mode is horizontal).</span>
        <span class="n">scaled_charspace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">charspace</span> <span class="o">/</span> <span class="n">fontsize</span>
        <span class="c1"># Section 9.3.3: Word spacing &quot;works the same way&quot;</span>
        <span class="n">scaled_wordspace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">wordspace</span> <span class="o">/</span> <span class="n">fontsize</span>

        <span class="c1"># PDF 2.0 section 9.4.4: Conceptually, the entire</span>
        <span class="c1"># transformation from text space to device space can be</span>
        <span class="c1"># represented by a text rendering matrix, T_rm:</span>
        <span class="c1">#</span>
        <span class="c1"># (scaling_matrix @ text_matrix @ glyph.ctm)</span>
        <span class="c1">#</span>
        <span class="c1"># Note that scaling_matrix and text_matrix are constant across</span>
        <span class="c1"># glyphs in a TextObject, and scaling_matrix is always</span>
        <span class="c1"># diagonal (thus the mult_matrix call below can be optimized)</span>
        <span class="n">scaling_matrix</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">fontsize</span> <span class="o">*</span> <span class="n">horizontal_scaling</span><span class="p">,</span>
            <span class="mi">0</span><span class="p">,</span>
            <span class="mi">0</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="p">,</span>
            <span class="mi">0</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">rise</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">vert</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">vertical</span>
        <span class="c1"># FIXME: THIS IS NOT TRUE!!!  We need a test for it though.</span>
        <span class="k">if</span> <span class="n">font</span><span class="o">.</span><span class="n">multibyte</span><span class="p">:</span>
            <span class="n">scaled_wordspace</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">glyph_offset</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">y</span> <span class="k">if</span> <span class="n">vert</span> <span class="k">else</span> <span class="n">x</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
                <span class="n">pos</span> <span class="o">-=</span> <span class="n">obj</span> <span class="o">*</span> <span class="mf">0.001</span> <span class="o">*</span> <span class="n">fontsize</span> <span class="o">*</span> <span class="n">horizontal_scaling</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">cid</span><span class="p">,</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">font</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
                    <span class="n">glyph_offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span> <span class="k">if</span> <span class="n">vert</span> <span class="k">else</span> <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
                    <span class="n">disp</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">vdisp</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span> <span class="k">if</span> <span class="n">vert</span> <span class="k">else</span> <span class="n">font</span><span class="o">.</span><span class="n">hdisp</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span>
                    <span class="n">disp</span> <span class="o">+=</span> <span class="n">scaled_charspace</span>
                    <span class="k">if</span> <span class="n">cid</span> <span class="o">==</span> <span class="mi">32</span><span class="p">:</span>
                        <span class="n">disp</span> <span class="o">+=</span> <span class="n">scaled_wordspace</span>
                    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mult_matrix</span><span class="p">(</span>
                        <span class="n">scaling_matrix</span><span class="p">,</span> <span class="n">translate_matrix</span><span class="p">(</span><span class="n">tlm_ctm</span><span class="p">,</span> <span class="n">glyph_offset</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="n">glyph</span> <span class="o">=</span> <span class="n">GlyphObject</span><span class="p">(</span>
                        <span class="n">_pageref</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_pageref</span><span class="p">,</span>
                        <span class="n">_parentkey</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_parentkey</span><span class="p">,</span>
                        <span class="n">gstate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="p">,</span>
                        <span class="n">ctm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">,</span>
                        <span class="n">mcstack</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mcstack</span><span class="p">,</span>
                        <span class="n">cid</span><span class="o">=</span><span class="n">cid</span><span class="p">,</span>
                        <span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span>
                        <span class="n">matrix</span><span class="o">=</span><span class="n">matrix</span><span class="p">,</span>
                        <span class="n">_displacement</span><span class="o">=</span><span class="n">disp</span><span class="p">,</span>
                        <span class="n">_corners</span><span class="o">=</span><span class="n">corners</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="k">yield</span> <span class="n">glyph</span>
                    <span class="c1"># This implements the proper scaling of charspace/wordspace</span>
                    <span class="k">if</span> <span class="n">vert</span><span class="p">:</span>
                        <span class="n">pos</span> <span class="o">+=</span> <span class="n">disp</span> <span class="o">*</span> <span class="n">fontsize</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">pos</span> <span class="o">+=</span> <span class="n">disp</span> <span class="o">*</span> <span class="n">fontsize</span> <span class="o">*</span> <span class="n">horizontal_scaling</span>
        <span class="n">glyph_offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span> <span class="k">if</span> <span class="n">vert</span> <span class="k">else</span> <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_glyph_offset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_next_glyph_offset</span> <span class="o">=</span> <span class="n">glyph_offset</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_next_glyph_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Point</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update only the glyph offset without calculating anything else.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_glyph_offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_glyph_offset</span>
        <span class="n">font</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">font</span>
        <span class="n">fontsize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">fontsize</span>
        <span class="k">if</span> <span class="n">font</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;No font is set, will not update text state or output text: </span><span class="si">%r</span><span class="s2"> TJ&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_next_glyph_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_glyph_offset</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_glyph_offset</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_next_glyph_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_glyph_offset</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_glyph_offset</span>

        <span class="n">horizontal_scaling</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">scaling</span> <span class="o">*</span> <span class="mf">0.01</span>
        <span class="n">charspace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">charspace</span>
        <span class="n">wordspace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">wordspace</span>
        <span class="n">vert</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">vertical</span>
        <span class="k">if</span> <span class="n">font</span><span class="o">.</span><span class="n">multibyte</span><span class="p">:</span>
            <span class="n">wordspace</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_glyph_offset</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">y</span> <span class="k">if</span> <span class="n">vert</span> <span class="k">else</span> <span class="n">x</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">vert</span><span class="p">:</span>
            <span class="c1"># Scale charspace and wordspace, PDF 2.0 section 9.3.2</span>
            <span class="n">charspace</span> <span class="o">*=</span> <span class="n">horizontal_scaling</span>
            <span class="n">wordspace</span> <span class="o">*=</span> <span class="n">horizontal_scaling</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
                <span class="n">pos</span> <span class="o">-=</span> <span class="n">obj</span> <span class="o">*</span> <span class="mf">0.001</span> <span class="o">*</span> <span class="n">fontsize</span> <span class="o">*</span> <span class="n">horizontal_scaling</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">cid</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">font</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
                    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span> <span class="k">if</span> <span class="n">vert</span> <span class="k">else</span> <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">vert</span><span class="p">:</span>
                        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">font</span><span class="p">,</span> <span class="n">CIDFont</span><span class="p">)</span>
                        <span class="n">pos</span> <span class="o">+=</span> <span class="n">font</span><span class="o">.</span><span class="n">vdisp</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span> <span class="o">*</span> <span class="n">fontsize</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">hdisp</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">hdisp</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span>
                        <span class="n">pos</span> <span class="o">+=</span> <span class="n">hdisp</span> <span class="o">*</span> <span class="n">fontsize</span> <span class="o">*</span> <span class="n">horizontal_scaling</span>
                    <span class="n">pos</span> <span class="o">+=</span> <span class="n">charspace</span>
                    <span class="k">if</span> <span class="n">cid</span> <span class="o">==</span> <span class="mi">32</span><span class="p">:</span>
                        <span class="n">pos</span> <span class="o">+=</span> <span class="n">wordspace</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_next_glyph_offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span> <span class="k">if</span> <span class="n">vert</span> <span class="k">else</span> <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_glyph_offset</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matrix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matrix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_matrix</span> <span class="o">=</span> <span class="n">mult_matrix</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scaling_matrix</span><span class="p">,</span> <span class="n">mult_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text_matrix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matrix</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">vert</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">font</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">vertical</span>
        <span class="k">return</span> <span class="n">_font_size</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span> <span class="n">vert</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">scaling_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">horizontal_scaling</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">scaling</span> <span class="o">*</span> <span class="mf">0.01</span>
        <span class="n">fontsize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">fontsize</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">fontsize</span> <span class="o">*</span> <span class="n">horizontal_scaling</span><span class="p">,</span>
            <span class="mi">0</span><span class="p">,</span>
            <span class="mi">0</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="p">,</span>
            <span class="mi">0</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">rise</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">text_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">translate_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line_matrix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_glyph_offset</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">origin</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Point</span><span class="p">:</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span>
        <span class="k">return</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">displacement</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Point</span><span class="p">:</span>
        <span class="n">matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span>
        <span class="c1"># FIXME: This should be either cached or optimized</span>
        <span class="n">next_matrix</span> <span class="o">=</span> <span class="n">mult_matrix</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scaling_matrix</span><span class="p">,</span>
            <span class="n">mult_matrix</span><span class="p">(</span>
                <span class="n">translate_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line_matrix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_next_glyph_offset</span><span class="p">()),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">next_matrix</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">matrix</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">next_matrix</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">matrix</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rect</span><span class="p">:</span>
        <span class="c1"># We specialize this to avoid it having side effects on the</span>
        <span class="c1"># text state (already it&#39;s a bit of a footgun that __iter__</span>
        <span class="c1"># does that...), but also because we know all glyphs have the</span>
        <span class="c1"># same text matrix and thus we can avoid a lot of multiply</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bbox</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bbox</span>
        <span class="n">matrix</span> <span class="o">=</span> <span class="n">mult_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line_matrix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">)</span>
        <span class="n">font</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">font</span>
        <span class="n">fontsize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">fontsize</span>
        <span class="n">rise</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">rise</span>
        <span class="k">if</span> <span class="n">font</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;No font is set, will not update text state or output text: </span><span class="si">%r</span><span class="s2"> TJ&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bbox</span> <span class="o">=</span> <span class="n">BBOX_NONE</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_next_glyph_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_glyph_offset</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bbox</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bbox</span> <span class="o">=</span> <span class="n">BBOX_NONE</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_next_glyph_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_glyph_offset</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bbox</span>

        <span class="n">horizontal_scaling</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">scaling</span> <span class="o">*</span> <span class="mf">0.01</span>
        <span class="n">charspace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">charspace</span>
        <span class="n">wordspace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">wordspace</span>
        <span class="n">vert</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">vertical</span>
        <span class="k">if</span> <span class="n">font</span><span class="o">.</span><span class="n">multibyte</span><span class="p">:</span>
            <span class="n">wordspace</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_glyph_offset</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">y</span> <span class="k">if</span> <span class="n">vert</span> <span class="k">else</span> <span class="n">x</span>
        <span class="n">x0</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">x</span>
        <span class="n">y0</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">rise</span>
        <span class="n">fast_path</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">vert</span><span class="p">:</span>
            <span class="c1"># Scale charspace and wordspace, PDF 2.0 section 9.3.2</span>
            <span class="n">charspace</span> <span class="o">*=</span> <span class="n">horizontal_scaling</span>
            <span class="n">wordspace</span> <span class="o">*=</span> <span class="n">horizontal_scaling</span>
            <span class="c1"># Detect the most frequent case, horizontal writing with</span>
            <span class="c1"># diagonal font.matrix</span>
            <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">matrix</span>
            <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">fast_path</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">y0</span> <span class="o">+=</span> <span class="n">d</span> <span class="o">*</span> <span class="n">font</span><span class="o">.</span><span class="n">descent</span> <span class="o">*</span> <span class="n">fontsize</span>
                <span class="n">y1</span> <span class="o">+=</span> <span class="n">d</span> <span class="o">*</span> <span class="n">font</span><span class="o">.</span><span class="n">ascent</span> <span class="o">*</span> <span class="n">fontsize</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
                <span class="n">pos</span> <span class="o">-=</span> <span class="n">obj</span> <span class="o">*</span> <span class="mf">0.001</span> <span class="o">*</span> <span class="n">fontsize</span> <span class="o">*</span> <span class="n">horizontal_scaling</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">cid</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">font</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
                    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span> <span class="k">if</span> <span class="n">vert</span> <span class="k">else</span> <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">vert</span><span class="p">:</span>
                        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">font</span><span class="p">,</span> <span class="n">CIDFont</span><span class="p">)</span>
                        <span class="n">pos</span> <span class="o">+=</span> <span class="n">font</span><span class="o">.</span><span class="n">vdisp</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span> <span class="o">*</span> <span class="n">fontsize</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">hdisp</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">hdisp</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span>
                        <span class="n">pos</span> <span class="o">+=</span> <span class="n">hdisp</span> <span class="o">*</span> <span class="n">fontsize</span> <span class="o">*</span> <span class="n">horizontal_scaling</span>
                    <span class="k">if</span> <span class="n">fast_path</span><span class="p">:</span>
                        <span class="n">x1</span> <span class="o">=</span> <span class="n">pos</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">gx0</span><span class="p">,</span> <span class="n">gy0</span><span class="p">,</span> <span class="n">gx1</span><span class="p">,</span> <span class="n">gy1</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">char_bbox</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span>
                        <span class="n">gx0</span> <span class="o">*=</span> <span class="n">fontsize</span> <span class="o">*</span> <span class="n">horizontal_scaling</span>
                        <span class="n">gx1</span> <span class="o">*=</span> <span class="n">fontsize</span> <span class="o">*</span> <span class="n">horizontal_scaling</span>
                        <span class="n">gy0</span> <span class="o">*=</span> <span class="n">fontsize</span>
                        <span class="n">gy0</span> <span class="o">+=</span> <span class="n">rise</span>
                        <span class="n">gy1</span> <span class="o">*=</span> <span class="n">fontsize</span>
                        <span class="n">gy1</span> <span class="o">+=</span> <span class="n">rise</span>
                        <span class="n">x0</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">gx0</span><span class="p">)</span>
                        <span class="n">y0</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">gy0</span><span class="p">)</span>
                        <span class="n">x1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">gx1</span><span class="p">)</span>
                        <span class="n">y1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">gy1</span><span class="p">)</span>
                    <span class="n">pos</span> <span class="o">+=</span> <span class="n">charspace</span>
                    <span class="k">if</span> <span class="n">cid</span> <span class="o">==</span> <span class="mi">32</span><span class="p">:</span>
                        <span class="n">pos</span> <span class="o">+=</span> <span class="n">wordspace</span>
        <span class="c1"># Update this because we can!</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_glyph_offset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_next_glyph_offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span> <span class="k">if</span> <span class="n">vert</span> <span class="k">else</span> <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bbox</span> <span class="o">=</span> <span class="n">transform_bbox</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bbox</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">chars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the Unicode characters (in stream order) for this object.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_chars</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_chars</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_chars</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">font</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">font</span>
        <span class="k">assert</span> <span class="n">font</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;No font was selected&quot;</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">font</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_chars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_chars</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the number of glyphs that would result from iterating over</span>
<span class="sd">        this object.</span>

<span class="sd">        Important: this is the number of glyphs, *not* the number of</span>
<span class="sd">        Unicode characters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nglyphs</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">font</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">font</span>
        <span class="k">assert</span> <span class="n">font</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;No font was selected&quot;</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">nglyphs</span> <span class="o">+=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">font</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">nglyphs</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="playa.content.TextObject.chars" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">chars</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Get the Unicode characters (in stream order) for this object.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="playa.content.TextObject.__iter__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__iter__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Generate glyphs for this text object</p>

            <details class="quote">
              <summary>Source code in <code>playa/content.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">GlyphObject</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate glyphs for this text object&quot;&quot;&quot;</span>
    <span class="n">glyph_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_glyph_offset</span>
    <span class="n">font</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">font</span>
    <span class="c1"># If no font is set, we cannot do anything, since even calling</span>
    <span class="c1"># TJ with a displacement and no text effects requires us at</span>
    <span class="c1"># least to know the fontsize.</span>
    <span class="k">if</span> <span class="n">font</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;No font is set, will not update text state or output text: </span><span class="si">%r</span><span class="s2"> TJ&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_next_glyph_offset</span> <span class="o">=</span> <span class="n">glyph_offset</span>
        <span class="k">return</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

    <span class="n">tlm_ctm</span> <span class="o">=</span> <span class="n">mult_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line_matrix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">)</span>
    <span class="c1"># Pre-determine if we need to recompute the bound for rotated glyphs</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">tlm_ctm</span>
    <span class="n">corners</span> <span class="o">=</span> <span class="n">b</span> <span class="o">*</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">a</span> <span class="o">*</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="mi">0</span>
    <span class="n">fontsize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">fontsize</span>
    <span class="n">horizontal_scaling</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">scaling</span> <span class="o">*</span> <span class="mf">0.01</span>
    <span class="c1"># PDF 2.0 section 9.3.2: The character-spacing parameter, Tc,</span>
    <span class="c1"># shall be a number specified in unscaled text space units</span>
    <span class="c1"># (although it shall be subject to scaling by the Th parameter</span>
    <span class="c1"># if the writing mode is horizontal).</span>
    <span class="n">scaled_charspace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">charspace</span> <span class="o">/</span> <span class="n">fontsize</span>
    <span class="c1"># Section 9.3.3: Word spacing &quot;works the same way&quot;</span>
    <span class="n">scaled_wordspace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">wordspace</span> <span class="o">/</span> <span class="n">fontsize</span>

    <span class="c1"># PDF 2.0 section 9.4.4: Conceptually, the entire</span>
    <span class="c1"># transformation from text space to device space can be</span>
    <span class="c1"># represented by a text rendering matrix, T_rm:</span>
    <span class="c1">#</span>
    <span class="c1"># (scaling_matrix @ text_matrix @ glyph.ctm)</span>
    <span class="c1">#</span>
    <span class="c1"># Note that scaling_matrix and text_matrix are constant across</span>
    <span class="c1"># glyphs in a TextObject, and scaling_matrix is always</span>
    <span class="c1"># diagonal (thus the mult_matrix call below can be optimized)</span>
    <span class="n">scaling_matrix</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">fontsize</span> <span class="o">*</span> <span class="n">horizontal_scaling</span><span class="p">,</span>
        <span class="mi">0</span><span class="p">,</span>
        <span class="mi">0</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="p">,</span>
        <span class="mi">0</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">rise</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">vert</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">vertical</span>
    <span class="c1"># FIXME: THIS IS NOT TRUE!!!  We need a test for it though.</span>
    <span class="k">if</span> <span class="n">font</span><span class="o">.</span><span class="n">multibyte</span><span class="p">:</span>
        <span class="n">scaled_wordspace</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">glyph_offset</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">y</span> <span class="k">if</span> <span class="n">vert</span> <span class="k">else</span> <span class="n">x</span>
    <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="n">pos</span> <span class="o">-=</span> <span class="n">obj</span> <span class="o">*</span> <span class="mf">0.001</span> <span class="o">*</span> <span class="n">fontsize</span> <span class="o">*</span> <span class="n">horizontal_scaling</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">cid</span><span class="p">,</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">font</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
                <span class="n">glyph_offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span> <span class="k">if</span> <span class="n">vert</span> <span class="k">else</span> <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
                <span class="n">disp</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">vdisp</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span> <span class="k">if</span> <span class="n">vert</span> <span class="k">else</span> <span class="n">font</span><span class="o">.</span><span class="n">hdisp</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span>
                <span class="n">disp</span> <span class="o">+=</span> <span class="n">scaled_charspace</span>
                <span class="k">if</span> <span class="n">cid</span> <span class="o">==</span> <span class="mi">32</span><span class="p">:</span>
                    <span class="n">disp</span> <span class="o">+=</span> <span class="n">scaled_wordspace</span>
                <span class="n">matrix</span> <span class="o">=</span> <span class="n">mult_matrix</span><span class="p">(</span>
                    <span class="n">scaling_matrix</span><span class="p">,</span> <span class="n">translate_matrix</span><span class="p">(</span><span class="n">tlm_ctm</span><span class="p">,</span> <span class="n">glyph_offset</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">glyph</span> <span class="o">=</span> <span class="n">GlyphObject</span><span class="p">(</span>
                    <span class="n">_pageref</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_pageref</span><span class="p">,</span>
                    <span class="n">_parentkey</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_parentkey</span><span class="p">,</span>
                    <span class="n">gstate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="p">,</span>
                    <span class="n">ctm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">,</span>
                    <span class="n">mcstack</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mcstack</span><span class="p">,</span>
                    <span class="n">cid</span><span class="o">=</span><span class="n">cid</span><span class="p">,</span>
                    <span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span>
                    <span class="n">matrix</span><span class="o">=</span><span class="n">matrix</span><span class="p">,</span>
                    <span class="n">_displacement</span><span class="o">=</span><span class="n">disp</span><span class="p">,</span>
                    <span class="n">_corners</span><span class="o">=</span><span class="n">corners</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">yield</span> <span class="n">glyph</span>
                <span class="c1"># This implements the proper scaling of charspace/wordspace</span>
                <span class="k">if</span> <span class="n">vert</span><span class="p">:</span>
                    <span class="n">pos</span> <span class="o">+=</span> <span class="n">disp</span> <span class="o">*</span> <span class="n">fontsize</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">pos</span> <span class="o">+=</span> <span class="n">disp</span> <span class="o">*</span> <span class="n">fontsize</span> <span class="o">*</span> <span class="n">horizontal_scaling</span>
    <span class="n">glyph_offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span> <span class="k">if</span> <span class="n">vert</span> <span class="k">else</span> <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_glyph_offset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_next_glyph_offset</span> <span class="o">=</span> <span class="n">glyph_offset</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.content.TextObject.__len__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return the number of glyphs that would result from iterating over
this object.</p>
<p>Important: this is the number of glyphs, <em>not</em> the number of
Unicode characters.</p>

            <details class="quote">
              <summary>Source code in <code>playa/content.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the number of glyphs that would result from iterating over</span>
<span class="sd">    this object.</span>

<span class="sd">    Important: this is the number of glyphs, *not* the number of</span>
<span class="sd">    Unicode characters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nglyphs</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">font</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="o">.</span><span class="n">font</span>
    <span class="k">assert</span> <span class="n">font</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;No font was selected&quot;</span>
    <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">nglyphs</span> <span class="o">+=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">font</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">nglyphs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.content.XObjectObject" class="doc doc-heading">
            <code>XObjectObject</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="playa.content.ContentObject" href="#playa.content.ContentObject">ContentObject</a></code></p>


        <p>An eXternal Object, in the context of a page.</p>
<p>There are a couple of kinds of XObjects.  Here we are only
concerned with "Form XObjects" which, despite their name, have
nothing at all to do with fillable forms.  Instead they are like
little embeddable PDF pages, possibly with their own resources,
definitely with their own definition of "user space".</p>
<p>Image XObjects are handled by <code>ImageObject</code>.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.XObjectObject.xobjid">xobjid</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of this XObject (in the page resources).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.XObjectObject.stream">stream</span></code></td>
            <td>
                  <code><span title="playa.pdftypes.ContentStream">ContentStream</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Content stream with PDF operators.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.XObjectObject.resources">resources</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[None, <span title="typing.Dict">Dict</span>[str, <span title="playa.pdftypes.PDFObject">PDFObject</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Resources specific to this XObject, if any.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="playa.content.XObjectObject.group">group</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[None, <span title="typing.Dict">Dict</span>[str, <span title="playa.pdftypes.PDFObject">PDFObject</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Transparency group, if any.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>playa/content.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">XObjectObject</span><span class="p">(</span><span class="n">ContentObject</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;An eXternal Object, in the context of a page.</span>

<span class="sd">    There are a couple of kinds of XObjects.  Here we are only</span>
<span class="sd">    concerned with &quot;Form XObjects&quot; which, despite their name, have</span>
<span class="sd">    nothing at all to do with fillable forms.  Instead they are like</span>
<span class="sd">    little embeddable PDF pages, possibly with their own resources,</span>
<span class="sd">    definitely with their own definition of &quot;user space&quot;.</span>

<span class="sd">    Image XObjects are handled by `ImageObject`.</span>

<span class="sd">    Attributes:</span>
<span class="sd">      xobjid: Name of this XObject (in the page resources).</span>
<span class="sd">      stream: Content stream with PDF operators.</span>
<span class="sd">      resources: Resources specific to this XObject, if any.</span>
<span class="sd">      group: Transparency group, if any.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">xobjid</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">stream</span><span class="p">:</span> <span class="n">ContentStream</span>
    <span class="n">resources</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">]]</span>
    <span class="n">group</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">]]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDFObject</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rect</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the bounding box of this XObject in device space.&quot;&quot;&quot;</span>
        <span class="c1"># It is a required attribute!</span>
        <span class="k">if</span> <span class="s2">&quot;BBox&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;XObject </span><span class="si">%r</span><span class="s2"> has no BBox: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xobjid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">cropbox</span>
        <span class="k">return</span> <span class="n">transform_bbox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">,</span> <span class="n">rect_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">[</span><span class="s2">&quot;BBox&quot;</span><span class="p">]))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">buffer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Raw stream content for this XObject&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">buffer</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Token</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over tokens in the XObject&#39;s content stream.&quot;&quot;&quot;</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">ContentParser</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">])</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">pos</span><span class="p">,</span> <span class="n">tok</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">nexttoken</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="k">yield</span> <span class="n">tok</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">contents</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">PDFObject</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterator over PDF objects in the content stream.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">ContentParser</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">]):</span>
            <span class="k">yield</span> <span class="n">obj</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;ContentObject&quot;</span><span class="p">]:</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">playa.interp</span><span class="w"> </span><span class="kn">import</span> <span class="n">LazyInterpreter</span>

        <span class="n">interp</span> <span class="o">=</span> <span class="n">LazyInterpreter</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="p">,</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="p">,</span>
            <span class="n">ctm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ctm</span><span class="p">,</span>
            <span class="n">gstate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gstate</span><span class="p">,</span>
            <span class="c1"># This is not really correct if this XObject has a</span>
            <span class="c1"># StructParent, *but* in that case the standard forbids</span>
            <span class="c1"># there to be any marked content sections inside it so</span>
            <span class="c1"># this should never get accessed anyway.</span>
            <span class="n">parent_key</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_parentkey</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="n">interp</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">parent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Element&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The enclosing logical structure element, if any.&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">playa.structure</span><span class="w"> </span><span class="kn">import</span> <span class="n">Element</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_parent&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parentkey</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span>
        <span class="c1"># No structure, no parent!</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">structure</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">parent_tree</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_parentkey</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">Element</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span>
                <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">structure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Element&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Mapping of marked content IDs to logical structure elements.</span>

<span class="sd">        As with pages, Form XObjects can also contain their own</span>
<span class="sd">        mapping of marked content IDs to structure elements.</span>

<span class="sd">        Danger: Do not rely on this being a `list`.</span>
<span class="sd">            Currently this is implemented eagerly, but in the future it</span>
<span class="sd">            may return a lazy object.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">playa.structure</span><span class="w"> </span><span class="kn">import</span> <span class="n">Element</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_structmap&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_structmap</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_structmap</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Element&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">structure</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_structmap</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parentkey</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_structmap</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">parents</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">parent_tree</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_parentkey</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parents</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="c1"># This means that there is a single StructParent, and thus</span>
                <span class="c1"># no internal structure to this Form XObject</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_structmap</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_structmap</span>
        <span class="c1"># Elements can contain multiple marked content sections, so</span>
        <span class="c1"># don&#39;t create redundant Element objects for these</span>
        <span class="n">elements</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Element</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">parents</span><span class="p">:</span>
            <span class="n">objid</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">objid</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">ObjRef</span><span class="p">)</span> <span class="k">else</span> <span class="nb">id</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">objid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
                <span class="n">elements</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span> <span class="o">=</span> <span class="n">Element</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="p">,</span> <span class="n">dict_value</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_structmap</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elements</span><span class="p">[</span><span class="n">objid</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_structmap</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">mcid_texts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Mapping of marked content IDs to Unicode text strings.</span>

<span class="sd">        For use in text extraction from tagged PDFs.</span>

<span class="sd">        Danger: Do not rely on this being a `dict`.</span>
<span class="sd">            Currently this is implemented eagerly, but in the future it</span>
<span class="sd">            may return a lazy object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_textmap&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_textmap</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_textmap</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="n">_extract_mcid_texts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_textmap</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_stream</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">stream</span><span class="p">:</span> <span class="n">ContentStream</span><span class="p">,</span>
        <span class="n">page</span><span class="p">:</span> <span class="s2">&quot;Page&quot;</span><span class="p">,</span>
        <span class="n">xobjid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">gstate</span><span class="p">:</span> <span class="n">GraphicState</span><span class="p">,</span>
        <span class="n">ctm</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span>
        <span class="n">mcstack</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">MarkedContent</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;XObjectObject&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new XObjectObject from a content stream.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;Matrix&quot;</span> <span class="ow">in</span> <span class="n">stream</span><span class="p">:</span>
            <span class="n">ctm</span> <span class="o">=</span> <span class="n">mult_matrix</span><span class="p">(</span><span class="n">matrix_value</span><span class="p">(</span><span class="n">stream</span><span class="p">[</span><span class="s2">&quot;Matrix&quot;</span><span class="p">]),</span> <span class="n">ctm</span><span class="p">)</span>
        <span class="c1"># According to PDF reference 1.7 section 4.9.1, XObjects in</span>
        <span class="c1"># earlier PDFs (prior to v1.2) use the page&#39;s Resources entry</span>
        <span class="c1"># instead of having their own Resources entry.  So, this could</span>
        <span class="c1"># be None, in which case LazyInterpreter will fall back to</span>
        <span class="c1"># page.resources.</span>
        <span class="n">xobjres</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Resources&quot;</span><span class="p">)</span>
        <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">xobjres</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">dict_value</span><span class="p">(</span><span class="n">xobjres</span><span class="p">)</span>
        <span class="n">xobjgrp</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Group&quot;</span><span class="p">)</span>
        <span class="n">group</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">xobjgrp</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">dict_value</span><span class="p">(</span><span class="n">xobjgrp</span><span class="p">)</span>
        <span class="c1"># PDF 2.0, sec 11.6.6</span>
        <span class="c1"># Initial blend mode: Before execution of the transparency group</span>
        <span class="c1"># XObject’s content stream, the current blend mode in the graphics</span>
        <span class="c1"># state shall be initialised to Normal, the current stroking and</span>
        <span class="c1"># nonstroking alpha constants to 1.0, and the current soft mask to None</span>
        <span class="k">if</span> <span class="n">group</span> <span class="ow">and</span> <span class="n">group</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;S&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">LITERAL_TRANSPARENCY</span><span class="p">:</span>
            <span class="c1"># Need to copy here so as not to modify existing gstate,</span>
            <span class="c1"># unfortunately it will get copied again later...</span>
            <span class="n">gstate</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">gstate</span><span class="p">)</span>
            <span class="n">gstate</span><span class="o">.</span><span class="n">blend_mode</span> <span class="o">=</span> <span class="n">LITERAL_NORMAL</span>
            <span class="n">gstate</span><span class="o">.</span><span class="n">salpha</span> <span class="o">=</span> <span class="n">gstate</span><span class="o">.</span><span class="n">nalpha</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">gstate</span><span class="o">.</span><span class="n">smask</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># PDF 2.0, Table 359</span>
        <span class="c1"># At most one of [StructParent and StructParents] shall be</span>
        <span class="c1"># present in a given object. An object may be either a content</span>
        <span class="c1"># item in its entirety or a container for marked-content</span>
        <span class="c1"># sequences that are content items, but not both.</span>
        <span class="k">if</span> <span class="s2">&quot;StructParent&quot;</span> <span class="ow">in</span> <span class="n">stream</span><span class="p">:</span>
            <span class="n">parent_key</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">stream</span><span class="p">[</span><span class="s2">&quot;StructParent&quot;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="s2">&quot;StructParents&quot;</span> <span class="ow">in</span> <span class="n">stream</span><span class="p">:</span>
            <span class="n">parent_key</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">stream</span><span class="p">[</span><span class="s2">&quot;StructParents&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">parent_key</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">_pageref</span><span class="o">=</span><span class="n">page</span><span class="o">.</span><span class="n">pageref</span><span class="p">,</span>
            <span class="n">_parentkey</span><span class="o">=</span><span class="n">parent_key</span><span class="p">,</span>
            <span class="n">gstate</span><span class="o">=</span><span class="n">gstate</span><span class="p">,</span>
            <span class="n">ctm</span><span class="o">=</span><span class="n">ctm</span><span class="p">,</span>
            <span class="n">mcstack</span><span class="o">=</span><span class="n">mcstack</span><span class="p">,</span>
            <span class="n">xobjid</span><span class="o">=</span><span class="n">xobjid</span><span class="p">,</span>
            <span class="n">stream</span><span class="o">=</span><span class="n">stream</span><span class="p">,</span>
            <span class="n">resources</span><span class="o">=</span><span class="n">resources</span><span class="p">,</span>
            <span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="playa.content.XObjectObject.bbox" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bbox</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Get the bounding box of this XObject in device space.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.content.XObjectObject.buffer" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">buffer</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Raw stream content for this XObject</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.content.XObjectObject.contents" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">contents</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterator over PDF objects in the content stream.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.content.XObjectObject.mcid_texts" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mcid_texts</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Mapping of marked content IDs to Unicode text strings.</p>
<p>For use in text extraction from tagged PDFs.</p>


<details class="danger" open>
  <summary>Do not rely on this being a <code>dict</code>.</summary>
  <p>Currently this is implemented eagerly, but in the future it
may return a lazy object.</p>
</details>    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.content.XObjectObject.parent" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parent</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The enclosing logical structure element, if any.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.content.XObjectObject.structure" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">structure</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Mapping of marked content IDs to logical structure elements.</p>
<p>As with pages, Form XObjects can also contain their own
mapping of marked content IDs to structure elements.</p>


<details class="danger" open>
  <summary>Do not rely on this being a <code>list</code>.</summary>
  <p>Currently this is implemented eagerly, but in the future it
may return a lazy object.</p>
</details>    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.content.XObjectObject.tokens" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tokens</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterate over tokens in the XObject's content stream.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="playa.content.XObjectObject.from_stream" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_stream</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span> <span class="n">page</span><span class="p">,</span> <span class="n">xobjid</span><span class="p">,</span> <span class="n">gstate</span><span class="p">,</span> <span class="n">ctm</span><span class="p">,</span> <span class="n">mcstack</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Create a new XObjectObject from a content stream.</p>

            <details class="quote">
              <summary>Source code in <code>playa/content.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_stream</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">stream</span><span class="p">:</span> <span class="n">ContentStream</span><span class="p">,</span>
    <span class="n">page</span><span class="p">:</span> <span class="s2">&quot;Page&quot;</span><span class="p">,</span>
    <span class="n">xobjid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">gstate</span><span class="p">:</span> <span class="n">GraphicState</span><span class="p">,</span>
    <span class="n">ctm</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span>
    <span class="n">mcstack</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">MarkedContent</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;XObjectObject&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a new XObjectObject from a content stream.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;Matrix&quot;</span> <span class="ow">in</span> <span class="n">stream</span><span class="p">:</span>
        <span class="n">ctm</span> <span class="o">=</span> <span class="n">mult_matrix</span><span class="p">(</span><span class="n">matrix_value</span><span class="p">(</span><span class="n">stream</span><span class="p">[</span><span class="s2">&quot;Matrix&quot;</span><span class="p">]),</span> <span class="n">ctm</span><span class="p">)</span>
    <span class="c1"># According to PDF reference 1.7 section 4.9.1, XObjects in</span>
    <span class="c1"># earlier PDFs (prior to v1.2) use the page&#39;s Resources entry</span>
    <span class="c1"># instead of having their own Resources entry.  So, this could</span>
    <span class="c1"># be None, in which case LazyInterpreter will fall back to</span>
    <span class="c1"># page.resources.</span>
    <span class="n">xobjres</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Resources&quot;</span><span class="p">)</span>
    <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">xobjres</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">dict_value</span><span class="p">(</span><span class="n">xobjres</span><span class="p">)</span>
    <span class="n">xobjgrp</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Group&quot;</span><span class="p">)</span>
    <span class="n">group</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">xobjgrp</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">dict_value</span><span class="p">(</span><span class="n">xobjgrp</span><span class="p">)</span>
    <span class="c1"># PDF 2.0, sec 11.6.6</span>
    <span class="c1"># Initial blend mode: Before execution of the transparency group</span>
    <span class="c1"># XObject’s content stream, the current blend mode in the graphics</span>
    <span class="c1"># state shall be initialised to Normal, the current stroking and</span>
    <span class="c1"># nonstroking alpha constants to 1.0, and the current soft mask to None</span>
    <span class="k">if</span> <span class="n">group</span> <span class="ow">and</span> <span class="n">group</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;S&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">LITERAL_TRANSPARENCY</span><span class="p">:</span>
        <span class="c1"># Need to copy here so as not to modify existing gstate,</span>
        <span class="c1"># unfortunately it will get copied again later...</span>
        <span class="n">gstate</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">gstate</span><span class="p">)</span>
        <span class="n">gstate</span><span class="o">.</span><span class="n">blend_mode</span> <span class="o">=</span> <span class="n">LITERAL_NORMAL</span>
        <span class="n">gstate</span><span class="o">.</span><span class="n">salpha</span> <span class="o">=</span> <span class="n">gstate</span><span class="o">.</span><span class="n">nalpha</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">gstate</span><span class="o">.</span><span class="n">smask</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># PDF 2.0, Table 359</span>
    <span class="c1"># At most one of [StructParent and StructParents] shall be</span>
    <span class="c1"># present in a given object. An object may be either a content</span>
    <span class="c1"># item in its entirety or a container for marked-content</span>
    <span class="c1"># sequences that are content items, but not both.</span>
    <span class="k">if</span> <span class="s2">&quot;StructParent&quot;</span> <span class="ow">in</span> <span class="n">stream</span><span class="p">:</span>
        <span class="n">parent_key</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">stream</span><span class="p">[</span><span class="s2">&quot;StructParent&quot;</span><span class="p">])</span>
    <span class="k">elif</span> <span class="s2">&quot;StructParents&quot;</span> <span class="ow">in</span> <span class="n">stream</span><span class="p">:</span>
        <span class="n">parent_key</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">stream</span><span class="p">[</span><span class="s2">&quot;StructParents&quot;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">parent_key</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
        <span class="n">_pageref</span><span class="o">=</span><span class="n">page</span><span class="o">.</span><span class="n">pageref</span><span class="p">,</span>
        <span class="n">_parentkey</span><span class="o">=</span><span class="n">parent_key</span><span class="p">,</span>
        <span class="n">gstate</span><span class="o">=</span><span class="n">gstate</span><span class="p">,</span>
        <span class="n">ctm</span><span class="o">=</span><span class="n">ctm</span><span class="p">,</span>
        <span class="n">mcstack</span><span class="o">=</span><span class="n">mcstack</span><span class="p">,</span>
        <span class="n">xobjid</span><span class="o">=</span><span class="n">xobjid</span><span class="p">,</span>
        <span class="n">stream</span><span class="o">=</span><span class="n">stream</span><span class="p">,</span>
        <span class="n">resources</span><span class="o">=</span><span class="n">resources</span><span class="p">,</span>
        <span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="playa.structure" class="doc doc-heading">
            <code>playa.structure</code>


</h2>

    <div class="doc doc-contents first">

        <p>Lazy interface to PDF logical structure (PDF 1.7 sect 14.7).</p>








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="playa.structure.ContentItem" class="doc doc-heading">
            <code>ContentItem</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>Content item in logical structure tree.</p>
<p>This corresponds to an individual marked content section on a
specific page, and can be used to (lazily) find that section if
desired.</p>






              <details class="quote">
                <summary>Source code in <code>playa/structure.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ContentItem</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Content item in logical structure tree.</span>

<span class="sd">    This corresponds to an individual marked content section on a</span>
<span class="sd">    specific page, and can be used to (lazily) find that section if</span>
<span class="sd">    desired.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_pageref</span><span class="p">:</span> <span class="n">PageRef</span>
    <span class="n">mcid</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">stream</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ContentStream</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">_bbox</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Rect</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">page</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Page&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Specific page for this structure tree, if any.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pageref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">_deref_page</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pageref</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">doc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Document&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The document containing this content object.&quot;&quot;&quot;</span>
        <span class="n">docref</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pageref</span>
        <span class="k">return</span> <span class="n">_deref_document</span><span class="p">(</span><span class="n">docref</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rect</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Find the bounding box, if any, of this item, which is the</span>
<span class="sd">        smallest rectangle enclosing all objects in its marked content</span>
<span class="sd">        section.</span>

<span class="sd">        Note that this is currently quite inefficient as it involves</span>
<span class="sd">        interpreting the entire page.</span>

<span class="sd">        If the `page` attribute is `None`, then `bbox` will be</span>
<span class="sd">        `BBOX_NONE`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bbox</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bbox</span>
        <span class="n">page</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span>
        <span class="k">if</span> <span class="n">page</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bbox</span> <span class="o">=</span> <span class="n">BBOX_NONE</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">itor</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Page&quot;</span><span class="p">,</span> <span class="s2">&quot;XObjectObject&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">page</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">xobjects</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">objid</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">objid</span><span class="p">:</span>
                        <span class="n">itor</span> <span class="o">=</span> <span class="n">obj</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bbox</span> <span class="o">=</span> <span class="n">get_bound_rects</span><span class="p">(</span>
                <span class="n">obj</span><span class="o">.</span><span class="n">bbox</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">itor</span> <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">mcid</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcid</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bbox</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">text</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Unicode text contained in this structure element.&quot;&quot;&quot;</span>
        <span class="n">page</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span>
        <span class="k">if</span> <span class="n">page</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">itor</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Page&quot;</span><span class="p">,</span> <span class="s2">&quot;XObjectObject&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">page</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># FIXME: Potentially quite slow, but we hope this never happens</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">xobjects</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">objid</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">objid</span><span class="p">:</span>
                    <span class="n">itor</span> <span class="o">=</span> <span class="n">obj</span>
            <span class="c1"># FIXME: if we don&#39;t find it... then what? (probably None, but...)</span>
        <span class="n">texts</span> <span class="o">=</span> <span class="n">itor</span><span class="o">.</span><span class="n">mcid_texts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mcid</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">texts</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="playa.structure.ContentItem.bbox" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bbox</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Find the bounding box, if any, of this item, which is the
smallest rectangle enclosing all objects in its marked content
section.</p>
<p>Note that this is currently quite inefficient as it involves
interpreting the entire page.</p>
<p>If the <code>page</code> attribute is <code>None</code>, then <code>bbox</code> will be
<code>BBOX_NONE</code>.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.structure.ContentItem.doc" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">doc</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The document containing this content object.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.structure.ContentItem.page" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">page</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Specific page for this structure tree, if any.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.structure.ContentItem.text" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">text</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Unicode text contained in this structure element.</p>
    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.structure.ContentObject" class="doc doc-heading">
            <code>ContentObject</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>Content object in logical structure tree.</p>
<p>This corresponds to a content item that is an entire PDF (X)Object
(PDF 1.7 section 14.7.43), and can be used to (lazily) get that</p>
<p>The standard is very unclear on what this could be aside from an
<code>Annotation</code> or an <code>XObject</code> (presumably either a Form XObject or
an image).  An XObject must be a content stream, so that's clear
enough... Otherwise, since the <code>Type</code> key is not required in an
annotation dictionary we presume that this is an annotation if
it's not present.</p>
<p>Not to be confused with <code>playa.page.ContentObject</code>.  While you
<em>can</em> get there from here with the <code>obj</code> property, it may not be a
great idea, because the only way to do that correctly in the case
of an <code>XObject</code> (or image) is to interpret the containing page.</p>
<p>Sometimes, but not always, you can nonetheless rapidly access the
<code>bbox</code>, so this is also provided as a property here.</p>






              <details class="quote">
                <summary>Source code in <code>playa/structure.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ContentObject</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Content object in logical structure tree.</span>

<span class="sd">    This corresponds to a content item that is an entire PDF (X)Object</span>
<span class="sd">    (PDF 1.7 section 14.7.43), and can be used to (lazily) get that</span>

<span class="sd">    The standard is very unclear on what this could be aside from an</span>
<span class="sd">    `Annotation` or an `XObject` (presumably either a Form XObject or</span>
<span class="sd">    an image).  An XObject must be a content stream, so that&#39;s clear</span>
<span class="sd">    enough... Otherwise, since the `Type` key is not required in an</span>
<span class="sd">    annotation dictionary we presume that this is an annotation if</span>
<span class="sd">    it&#39;s not present.</span>

<span class="sd">    Not to be confused with `playa.page.ContentObject`.  While you</span>
<span class="sd">    *can* get there from here with the `obj` property, it may not be a</span>
<span class="sd">    great idea, because the only way to do that correctly in the case</span>
<span class="sd">    of an `XObject` (or image) is to interpret the containing page.</span>

<span class="sd">    Sometimes, but not always, you can nonetheless rapidly access the</span>
<span class="sd">    `bbox`, so this is also provided as a property here.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_pageref</span><span class="p">:</span> <span class="n">PageRef</span>
    <span class="n">props</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ContentStream</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">]]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">obj</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;XObjectObject&quot;</span><span class="p">,</span> <span class="s2">&quot;ImageObject&quot;</span><span class="p">,</span> <span class="s2">&quot;Annotation&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return an instantiated object, if possible.&quot;&quot;&quot;</span>
        <span class="n">objtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span>
        <span class="k">if</span> <span class="n">objtype</span> <span class="ow">is</span> <span class="n">LITERAL_ANNOT</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">playa.page</span><span class="w"> </span><span class="kn">import</span> <span class="n">Annotation</span>

            <span class="k">return</span> <span class="n">Annotation</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">objtype</span> <span class="ow">is</span> <span class="n">LITERAL_XOBJECT</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="p">,</span> <span class="n">ContentStream</span><span class="p">)</span>
            <span class="n">subtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Subtype&quot;</span><span class="p">)</span>
            <span class="n">itor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">images</span> <span class="k">if</span> <span class="n">subtype</span> <span class="ow">is</span> <span class="n">LITERAL_IMAGE</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">xobjects</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">itor</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">objid</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">objid</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">obj</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PSLiteral</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Type of this object, usually LITERAL_ANNOT or LITERAL_XOBJECT.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="p">,</span> <span class="n">ContentStream</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">LITERAL_XOBJECT</span>
        <span class="n">objtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">objtype</span><span class="p">,</span> <span class="n">PSLiteral</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">LITERAL_ANNOT</span>
        <span class="k">return</span> <span class="n">objtype</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">page</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Page&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Containing page for this content object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_deref_page</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pageref</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">doc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Document&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The document containing this content object.&quot;&quot;&quot;</span>
        <span class="n">docref</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pageref</span>
        <span class="k">return</span> <span class="n">_deref_document</span><span class="p">(</span><span class="n">docref</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rect</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Find the bounding box, if any, of this object.</span>

<span class="sd">        If there is no bounding box (very unlikely) this will be</span>
<span class="sd">        `BBOX_NONE`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;BBox&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="p">:</span>
            <span class="n">rawbox</span> <span class="o">=</span> <span class="n">rect_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;BBox&quot;</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">transform_bbox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">ctm</span><span class="p">,</span> <span class="n">rawbox</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;Rect&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="p">:</span>
            <span class="n">rawbox</span> <span class="o">=</span> <span class="n">rect_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;Rect&quot;</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">transform_bbox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">ctm</span><span class="p">,</span> <span class="n">rawbox</span><span class="p">)</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">BBOX_NONE</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">bbox</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="playa.structure.ContentObject.bbox" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bbox</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Find the bounding box, if any, of this object.</p>
<p>If there is no bounding box (very unlikely) this will be
<code>BBOX_NONE</code>.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.structure.ContentObject.doc" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">doc</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The document containing this content object.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.structure.ContentObject.obj" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">obj</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Return an instantiated object, if possible.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.structure.ContentObject.page" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">page</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Containing page for this content object.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.structure.ContentObject.type" class="doc doc-heading">
            <code class="highlight language-python"><span class="nb">type</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Type of this object, usually LITERAL_ANNOT or LITERAL_XOBJECT.</p>
    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.structure.Element" class="doc doc-heading">
            <code>Element</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="playa.structure.Findable" href="#playa.structure.Findable">Findable</a></code></p>


        <p>Logical structure element.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="playa.structure.Element.props">props</span></code></td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[str, <span title="playa.parser.PDFObject">PDFObject</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Structure element dictionary (PDF 1.7 table 323).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>playa/structure.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Element</span><span class="p">(</span><span class="n">Findable</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Logical structure element.</span>

<span class="sd">    Attributes:</span>
<span class="sd">      props: Structure element dictionary (PDF 1.7 table 323).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_docref</span><span class="p">:</span> <span class="n">DocumentRef</span>
    <span class="n">props</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">]</span>
    <span class="n">_role</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="s2">&quot;Document&quot;</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;Element&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct from PDF structure element dictionary.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">_docref</span><span class="o">=</span><span class="n">_ref_document</span><span class="p">(</span><span class="n">doc</span><span class="p">),</span> <span class="n">props</span><span class="o">=</span><span class="n">obj</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Structure type for this element.</span>

<span class="sd">        Note: Raw and standard structure types</span>
<span class="sd">            This type is quite likely idiosyncratic and defined by</span>
<span class="sd">            whatever style sheets the author used in their word</span>
<span class="sd">            processor.  Standard structure types (PDF 1.7 section</span>
<span class="sd">            14.8.4) are accessible through the `role_map` attribute of</span>
<span class="sd">            the structure root, or, for convenience (this is slow) via</span>
<span class="sd">            the `role` attribute on elements.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">literal_name</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;S&quot;</span><span class="p">])</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">role</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Standardized structure type.</span>

<span class="sd">        Note: Roles are always mapped</span>
<span class="sd">            Since it is common for documents to use standard types</span>
<span class="sd">            directly for some of their structure elements (typically</span>
<span class="sd">            ones with no content) and thus to omit them from the role</span>
<span class="sd">            map, `role` will always return a string in order to</span>
<span class="sd">            facilitate processing.  If you must absolutely know</span>
<span class="sd">            whether an element&#39;s type has no entry in the role map</span>
<span class="sd">            then you will need to consult it directly.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_role</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_role</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">structure</span>
        <span class="k">if</span> <span class="n">tree</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># it could happen!</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span>
        <span class="k">return</span> <span class="n">tree</span><span class="o">.</span><span class="n">role_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">doc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Document&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Containing document for this element.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_deref_document</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_docref</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">page</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Page&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Containing page for this element, if any.&quot;&quot;&quot;</span>
        <span class="n">pg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Pg&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pg</span><span class="p">,</span> <span class="n">ObjRef</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">pages</span><span class="o">.</span><span class="n">by_id</span><span class="p">(</span><span class="n">pg</span><span class="o">.</span><span class="n">objid</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">LOG</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;&#39;Pg&#39; entry not found in document: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">LOG</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;&#39;Pg&#39; entry is not an indirect object reference: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">props</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">parent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Element&quot;</span><span class="p">,</span> <span class="s2">&quot;Tree&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;P&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">p</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="n">LITERAL_STRUCTTREEROOT</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">structure</span>
        <span class="k">return</span> <span class="n">Element</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">contents</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">ContentItem</span><span class="p">,</span> <span class="n">ContentObject</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over all content items contained in an element.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">kid</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kid</span><span class="p">,</span> <span class="n">Element</span><span class="p">):</span>
                <span class="k">yield from</span> <span class="n">kid</span><span class="o">.</span><span class="n">contents</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kid</span><span class="p">,</span> <span class="p">(</span><span class="n">ContentItem</span><span class="p">,</span> <span class="n">ContentObject</span><span class="p">)):</span>
                <span class="k">yield</span> <span class="n">kid</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rect</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The bounding box, if any, of this element.</span>

<span class="sd">        Elements may explicitly define a `BBox` in default user space,</span>
<span class="sd">        in which case this is used.  Otherwise, the bounding box is</span>
<span class="sd">        the smallest rectangle enclosing all of the content items</span>
<span class="sd">        contained by this element (which may take some time to compute).</span>

<span class="sd">        Note that this is currently quite inefficient as it involves</span>
<span class="sd">        interpreting the entire page.</span>

<span class="sd">        Note: Elements may span multiple pages!</span>
<span class="sd">            In the case of an element (such as a `Document` for</span>
<span class="sd">            instance) that spans multiple pages, the bounding box</span>
<span class="sd">            cannot exist, and `BBOX_NONE` will be returned.  If the</span>
<span class="sd">            `page` attribute is `None`, then `bbox` will be</span>
<span class="sd">            `BBOX_NONE`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">page</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span>
        <span class="k">if</span> <span class="n">page</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">BBOX_NONE</span>
        <span class="k">if</span> <span class="s2">&quot;BBox&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="p">:</span>
            <span class="n">rawbox</span> <span class="o">=</span> <span class="n">rect_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;BBox&quot;</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">transform_bbox</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">ctm</span><span class="p">,</span> <span class="n">rawbox</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># NOTE: This is quite slow</span>
            <span class="k">return</span> <span class="n">get_bound_rects</span><span class="p">(</span>
                <span class="n">item</span><span class="o">.</span><span class="n">bbox</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">contents</span>
                <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">page</span> <span class="ow">is</span> <span class="n">page</span> <span class="ow">and</span> <span class="n">item</span><span class="o">.</span><span class="n">bbox</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">BBOX_NONE</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Element&quot;</span><span class="p">,</span> <span class="n">ContentItem</span><span class="p">,</span> <span class="n">ContentObject</span><span class="p">]]:</span>
        <span class="k">if</span> <span class="s2">&quot;K&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="p">:</span>
            <span class="n">kids</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;K&quot;</span><span class="p">])</span>
            <span class="k">yield from</span> <span class="n">_make_kids</span><span class="p">(</span><span class="n">kids</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_docref</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="playa.structure.Element.bbox" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bbox</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The bounding box, if any, of this element.</p>
<p>Elements may explicitly define a <code>BBox</code> in default user space,
in which case this is used.  Otherwise, the bounding box is
the smallest rectangle enclosing all of the content items
contained by this element (which may take some time to compute).</p>
<p>Note that this is currently quite inefficient as it involves
interpreting the entire page.</p>


<details class="note" open>
  <summary>Elements may span multiple pages!</summary>
  <p>In the case of an element (such as a <code>Document</code> for
instance) that spans multiple pages, the bounding box
cannot exist, and <code>BBOX_NONE</code> will be returned.  If the
<code>page</code> attribute is <code>None</code>, then <code>bbox</code> will be
<code>BBOX_NONE</code>.</p>
</details>    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.structure.Element.contents" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">contents</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterate over all content items contained in an element.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.structure.Element.doc" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">doc</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Containing document for this element.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.structure.Element.page" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">page</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Containing page for this element, if any.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.structure.Element.role" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">role</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Standardized structure type.</p>


<details class="note" open>
  <summary>Roles are always mapped</summary>
  <p>Since it is common for documents to use standard types
directly for some of their structure elements (typically
ones with no content) and thus to omit them from the role
map, <code>role</code> will always return a string in order to
facilitate processing.  If you must absolutely know
whether an element's type has no entry in the role map
then you will need to consult it directly.</p>
</details>    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.structure.Element.type" class="doc doc-heading">
            <code class="highlight language-python"><span class="nb">type</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Structure type for this element.</p>


<details class="note" open>
  <summary>Raw and standard structure types</summary>
  <p>This type is quite likely idiosyncratic and defined by
whatever style sheets the author used in their word
processor.  Standard structure types (PDF 1.7 section
14.8.4) are accessible through the <code>role_map</code> attribute of
the structure root, or, for convenience (this is slow) via
the <code>role</code> attribute on elements.</p>
</details>    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="playa.structure.Element.from_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_dict</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Construct from PDF structure element dictionary.</p>

            <details class="quote">
              <summary>Source code in <code>playa/structure.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="s2">&quot;Document&quot;</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;Element&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct from PDF structure element dictionary.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">_docref</span><span class="o">=</span><span class="n">_ref_document</span><span class="p">(</span><span class="n">doc</span><span class="p">),</span> <span class="n">props</span><span class="o">=</span><span class="n">obj</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.structure.Findable" class="doc doc-heading">
            <code>Findable</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Iterable">Iterable</span></code></p>


        <p>find() and find_all() methods that can be inherited to avoid
repeating oneself</p>






              <details class="quote">
                <summary>Source code in <code>playa/structure.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Findable</span><span class="p">(</span><span class="n">Iterable</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;find() and find_all() methods that can be inherited to avoid</span>
<span class="sd">    repeating oneself&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">find_all</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">matcher</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Pattern</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">MatchFunc</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;Element&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate depth-first over matching elements in subtree.</span>

<span class="sd">        The `matcher` argument is either a string, a regular</span>
<span class="sd">        expression, or a function taking a `Element` and returning</span>
<span class="sd">        `True` if the element matches, or `None` (default) to return</span>
<span class="sd">        all descendants in depth-first order.</span>

<span class="sd">        For compatibility with `pdfplumber` and consistent behaviour</span>
<span class="sd">        across documents, names and regular expressions are matched</span>
<span class="sd">        against the `role` attribute.  If you wish to match the &quot;raw&quot;</span>
<span class="sd">        structure type from the `type` attribute, you can do this with</span>
<span class="sd">        a matching function.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_find_all</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">matcher</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">find</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">matcher</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Pattern</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">MatchFunc</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Element&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Find the first matching element in subtree.</span>

<span class="sd">        The `matcher` argument is either a string or a regular</span>
<span class="sd">        expression to be matched against the `role` attribute, or a</span>
<span class="sd">        function taking a `Element` and returning `True` if the</span>
<span class="sd">        element matches, or `None` (default) to just get the first</span>
<span class="sd">        child element.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="n">_find_all</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">matcher</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="playa.structure.Findable.find" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find</span><span class="p">(</span><span class="n">matcher</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Find the first matching element in subtree.</p>
<p>The <code>matcher</code> argument is either a string or a regular
expression to be matched against the <code>role</code> attribute, or a
function taking a <code>Element</code> and returning <code>True</code> if the
element matches, or <code>None</code> (default) to just get the first
child element.</p>

            <details class="quote">
              <summary>Source code in <code>playa/structure.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">find</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">matcher</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Pattern</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">MatchFunc</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Element&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Find the first matching element in subtree.</span>

<span class="sd">    The `matcher` argument is either a string or a regular</span>
<span class="sd">    expression to be matched against the `role` attribute, or a</span>
<span class="sd">    function taking a `Element` and returning `True` if the</span>
<span class="sd">    element matches, or `None` (default) to just get the first</span>
<span class="sd">    child element.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="n">_find_all</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">matcher</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.structure.Findable.find_all" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find_all</span><span class="p">(</span><span class="n">matcher</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Iterate depth-first over matching elements in subtree.</p>
<p>The <code>matcher</code> argument is either a string, a regular
expression, or a function taking a <code>Element</code> and returning
<code>True</code> if the element matches, or <code>None</code> (default) to return
all descendants in depth-first order.</p>
<p>For compatibility with <code>pdfplumber</code> and consistent behaviour
across documents, names and regular expressions are matched
against the <code>role</code> attribute.  If you wish to match the "raw"
structure type from the <code>type</code> attribute, you can do this with
a matching function.</p>

            <details class="quote">
              <summary>Source code in <code>playa/structure.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">find_all</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">matcher</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Pattern</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">MatchFunc</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;Element&quot;</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterate depth-first over matching elements in subtree.</span>

<span class="sd">    The `matcher` argument is either a string, a regular</span>
<span class="sd">    expression, or a function taking a `Element` and returning</span>
<span class="sd">    `True` if the element matches, or `None` (default) to return</span>
<span class="sd">    all descendants in depth-first order.</span>

<span class="sd">    For compatibility with `pdfplumber` and consistent behaviour</span>
<span class="sd">    across documents, names and regular expressions are matched</span>
<span class="sd">    against the `role` attribute.  If you wish to match the &quot;raw&quot;</span>
<span class="sd">    structure type from the `type` attribute, you can do this with</span>
<span class="sd">    a matching function.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_find_all</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">matcher</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.structure.Tree" class="doc doc-heading">
            <code>Tree</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="playa.structure.Findable" href="#playa.structure.Findable">Findable</a></code></p>


        <p>Logical structure tree.</p>
<p>A structure tree can be iterated over in the same fashion as its
elements.  Note that even though it is forbidden for structure
tree root to contain content items, PLAYA is robust to this
possibility, thus you should not presume that iterating over it
will only yield <code>Element</code> instances.</p>
<p>The various attributes (role map, class map, pronunciation
dictionary, etc, etc) are accessible through <code>props</code> but currently
have no particular interpretation aside from the role map which is
accessible in normalized form through <code>role_map</code>.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="playa.structure.Tree.props">props</span></code></td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[str, <span title="playa.parser.PDFObject">PDFObject</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Structure tree root dictionary (PDF 1.7 table 322).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="playa.structure.Tree.role_map" href="#playa.structure.Tree.role_map">role_map</a></code></td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[str, str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mapping of structure element types (as strings) to
  standard structure types (as strings) (PDF 1.7 section 14.8.4)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="playa.structure.Tree.parent_tree" href="#playa.structure.Tree.parent_tree">parent_tree</a></code></td>
            <td>
                  <code><span title="playa.data_structures.NumberTree">NumberTree</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Parent tree linking marked content sections to
  structure elements (PDF 1.7 section 14.7.4.4)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>playa/structure.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Tree</span><span class="p">(</span><span class="n">Findable</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Logical structure tree.</span>

<span class="sd">    A structure tree can be iterated over in the same fashion as its</span>
<span class="sd">    elements.  Note that even though it is forbidden for structure</span>
<span class="sd">    tree root to contain content items, PLAYA is robust to this</span>
<span class="sd">    possibility, thus you should not presume that iterating over it</span>
<span class="sd">    will only yield `Element` instances.</span>

<span class="sd">    The various attributes (role map, class map, pronunciation</span>
<span class="sd">    dictionary, etc, etc) are accessible through `props` but currently</span>
<span class="sd">    have no particular interpretation aside from the role map which is</span>
<span class="sd">    accessible in normalized form through `role_map`.</span>

<span class="sd">    Attributes:</span>
<span class="sd">      props: Structure tree root dictionary (PDF 1.7 table 322).</span>
<span class="sd">      role_map: Mapping of structure element types (as strings) to</span>
<span class="sd">          standard structure types (as strings) (PDF 1.7 section 14.8.4)</span>
<span class="sd">      parent_tree: Parent tree linking marked content sections to</span>
<span class="sd">          structure elements (PDF 1.7 section 14.7.4.4)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_docref</span><span class="p">:</span> <span class="n">DocumentRef</span>
    <span class="n">props</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">]</span>
    <span class="n">_role_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
    <span class="n">_parent_tree</span><span class="p">:</span> <span class="n">NumberTree</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="s2">&quot;Document&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_docref</span> <span class="o">=</span> <span class="n">_ref_document</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">props</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">catalog</span><span class="p">[</span><span class="s2">&quot;StructTreeRoot&quot;</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Element&quot;</span><span class="p">,</span> <span class="n">ContentItem</span><span class="p">,</span> <span class="n">ContentObject</span><span class="p">]]:</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="n">_deref_document</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_docref</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_iter_structure</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">role_map</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Dictionary mapping some (not necessarily all) element types</span>
<span class="sd">        to their standard equivalents.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_role_map&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_role_map</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_role_map</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">rm</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;RoleMap&quot;</span><span class="p">))</span>  <span class="c1"># It is optional</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rm</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">rm</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">PSLiteral</span><span class="p">):</span>
                    <span class="n">role</span> <span class="o">=</span> <span class="n">literal_name</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">role</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_role_map</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">role</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_role_map</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">parent_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NumberTree</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parent tree for this document.</span>

<span class="sd">        This is a somewhat obscure data structure that links marked</span>
<span class="sd">        content sections to their corresponding structure elements.</span>
<span class="sd">        If you don&#39;t know what that means, you probably don&#39;t need it,</span>
<span class="sd">        but if you do, here it is.</span>

<span class="sd">        Unlike the structure tree itself, if there is no parent tree,</span>
<span class="sd">        this will be an empty NumberTree.  This is because the parent</span>
<span class="sd">        tree is required by the spec in the case where structure</span>
<span class="sd">        elements contain marked content, which is nearly all the time.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_parent_tree&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent_tree</span>
        <span class="k">if</span> <span class="s2">&quot;ParentTree&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parent_tree</span> <span class="o">=</span> <span class="n">NumberTree</span><span class="p">({})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parent_tree</span> <span class="o">=</span> <span class="n">NumberTree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;ParentTree&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent_tree</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">contents</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">ContentItem</span><span class="p">,</span> <span class="n">ContentObject</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over all content items in the tree.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">kid</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kid</span><span class="p">,</span> <span class="n">Element</span><span class="p">):</span>
                <span class="k">yield from</span> <span class="n">kid</span><span class="o">.</span><span class="n">contents</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kid</span><span class="p">,</span> <span class="p">(</span><span class="n">ContentItem</span><span class="p">,</span> <span class="n">ContentObject</span><span class="p">)):</span>
                <span class="c1"># This is not supposed to happen, but we will support it anyway</span>
                <span class="k">yield</span> <span class="n">kid</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">doc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Document&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Document with which this structure tree is associated.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_deref_document</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_docref</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="playa.structure.Tree.contents" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">contents</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Iterate over all content items in the tree.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.structure.Tree.doc" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">doc</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Document with which this structure tree is associated.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.structure.Tree.parent_tree" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parent_tree</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Parent tree for this document.</p>
<p>This is a somewhat obscure data structure that links marked
content sections to their corresponding structure elements.
If you don't know what that means, you probably don't need it,
but if you do, here it is.</p>
<p>Unlike the structure tree itself, if there is no parent tree,
this will be an empty NumberTree.  This is because the parent
tree is required by the spec in the case where structure
elements contain marked content, which is nearly all the time.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.structure.Tree.role_map" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">role_map</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Dictionary mapping some (not necessarily all) element types
to their standard equivalents.</p>
    </div>

</div>





  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="playa.outline" class="doc doc-heading">
            <code>playa.outline</code>


</h2>

    <div class="doc doc-contents first">

        <p>Lazy interface to PDF document outline (PDF 1.7 sect 12.3.3).</p>








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="playa.outline.Action" class="doc doc-heading">
            <code>Action</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>PDF actions (PDF 1.7 sect 12.6)</p>






              <details class="quote">
                <summary>Source code in <code>playa/outline.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Action</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;PDF actions (PDF 1.7 sect 12.6)&quot;&quot;&quot;</span>

    <span class="n">_docref</span><span class="p">:</span> <span class="n">DocumentRef</span>
    <span class="n">props</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PSLiteral</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;S&quot;</span><span class="p">],</span> <span class="n">PSLiteral</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;S&quot;</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">doc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Document&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get associated document if it exists.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_deref_document</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_docref</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">destination</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Destination</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Destination of this action, if any.&quot;&quot;&quot;</span>
        <span class="n">dest</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">dest</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="p">(</span><span class="n">PSLiteral</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
            <span class="n">LOG</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Unrecognized destination: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">Destination</span><span class="o">.</span><span class="n">from_dest</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="p">,</span> <span class="n">dest</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="playa.outline.Action.destination" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">destination</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Destination of this action, if any.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.outline.Action.doc" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">doc</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Get associated document if it exists.</p>
    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.outline.Destination" class="doc doc-heading">
            <code>Destination</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>PDF destinations (PDF 1.7 sect 12.3.2)</p>






              <details class="quote">
                <summary>Source code in <code>playa/outline.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Destination</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;PDF destinations (PDF 1.7 sect 12.3.2)&quot;&quot;&quot;</span>

    <span class="n">_docref</span><span class="p">:</span> <span class="n">DocumentRef</span>
    <span class="n">page_idx</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">display</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">PSLiteral</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">coords</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="o">...</span><span class="p">]</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_dest</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="s2">&quot;Document&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">PSLiteral</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Destination&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="p">(</span><span class="nb">bytes</span><span class="p">,</span> <span class="n">PSLiteral</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">doc</span><span class="o">.</span><span class="n">destinations</span><span class="p">[</span><span class="n">dest</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">dest</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unknown destination type: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_list</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="s2">&quot;Document&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Destination&quot;</span><span class="p">:</span>
        <span class="n">pageobj</span><span class="p">,</span> <span class="n">display</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span> <span class="o">=</span> <span class="n">dest</span>
        <span class="n">page_idx</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pageobj</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="c1"># Not really sure if this is page number or page index...</span>
            <span class="n">page_idx</span> <span class="o">=</span> <span class="n">pageobj</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pageobj</span><span class="p">,</span> <span class="n">ObjRef</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">page_idx</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">pages</span><span class="o">.</span><span class="n">by_id</span><span class="p">(</span><span class="n">pageobj</span><span class="o">.</span><span class="n">objid</span><span class="p">)</span><span class="o">.</span><span class="n">page_idx</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">LOG</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Invalid page object in destination: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pageobj</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">LOG</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Unrecognized page in destination object: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pageobj</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">display</span><span class="p">,</span> <span class="n">PSLiteral</span><span class="p">):</span>
            <span class="n">LOG</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Unknown display type: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">display</span><span class="p">)</span>
            <span class="n">display</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">x</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Destination</span><span class="p">(</span>
            <span class="n">_docref</span><span class="o">=</span><span class="n">_ref_document</span><span class="p">(</span><span class="n">doc</span><span class="p">),</span>
            <span class="n">page_idx</span><span class="o">=</span><span class="n">page_idx</span><span class="p">,</span>
            <span class="n">display</span><span class="o">=</span><span class="n">display</span><span class="p">,</span>
            <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.outline.Outline" class="doc doc-heading">
            <code>Outline</code>


</h3>


    <div class="doc doc-contents ">


        <p>PDF document outline (PDF 1.7 sect 12.3.3)</p>






              <details class="quote">
                <summary>Source code in <code>playa/outline.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Outline</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;PDF document outline (PDF 1.7 sect 12.3.3)&quot;&quot;&quot;</span>

    <span class="n">_docref</span><span class="p">:</span> <span class="n">DocumentRef</span>
    <span class="n">props</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="s2">&quot;Document&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_docref</span> <span class="o">=</span> <span class="n">_ref_document</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">props</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">catalog</span><span class="p">[</span><span class="s2">&quot;Outlines&quot;</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;Outline&quot;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="s2">&quot;First&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">props</span> <span class="ow">and</span> <span class="s2">&quot;Last&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="p">:</span>
            <span class="n">ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;First&quot;</span><span class="p">]</span>
            <span class="k">while</span> <span class="n">ref</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">ObjRef</span><span class="p">):</span>
                    <span class="n">LOG</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Not an indirect object reference: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ref</span><span class="p">)</span>
                    <span class="k">break</span>
                <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_from_ref</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span>
                <span class="n">ref</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Next&quot;</span><span class="p">)</span>
                <span class="k">yield</span> <span class="n">out</span>
                <span class="k">if</span> <span class="n">ref</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;Last&quot;</span><span class="p">]:</span>
                    <span class="k">break</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_from_ref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref</span><span class="p">:</span> <span class="n">ObjRef</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Outline&quot;</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">Outline</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">Outline</span><span class="p">)</span>
        <span class="n">out</span><span class="o">.</span><span class="n">_docref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_docref</span>
        <span class="n">out</span><span class="o">.</span><span class="n">props</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">out</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">doc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Document&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get associated document if it exists.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_deref_document</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_docref</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">title</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Title&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">raw</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
            <span class="n">LOG</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Title is not a string: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">raw</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">decode_text</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">destination</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Destination</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Destination for this outline item.</span>

<span class="sd">        Note: Special case of `GoTo` actions.</span>
<span class="sd">            Since internal `GoTo` actions (PDF 1.7 sect 12.6.4.2) in</span>
<span class="sd">            outlines and links are entirely equivalent to</span>
<span class="sd">            destinations, if one exists, it will be returned here as</span>
<span class="sd">            well.</span>

<span class="sd">        Returns:</span>
<span class="sd">            destination, if one exists.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dest</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Dest&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">dest</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="p">(</span><span class="n">PSLiteral</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
                    <span class="k">return</span> <span class="n">Destination</span><span class="o">.</span><span class="n">from_dest</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="p">,</span> <span class="n">dest</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">LOG</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Unknown named destination: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="p">)</span>
        <span class="c1"># Fall through to try an Action instead</span>
        <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">action</span>
        <span class="k">if</span> <span class="n">action</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">action</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">ACTION_GOTO</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">action</span><span class="o">.</span><span class="n">destination</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">action</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Action</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Action</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_docref</span><span class="p">,</span> <span class="n">dict_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]))</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">element</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Element</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The structure element associated with this outline item, if</span>
<span class="sd">        any.</span>

<span class="sd">        Returns:</span>
<span class="sd">            structure element, if one exists.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Element</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="p">,</span> <span class="n">dict_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;SE&quot;</span><span class="p">]))</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">parent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Outline&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
        <span class="n">ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Parent&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">ObjRef</span><span class="p">):</span>
            <span class="n">LOG</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Parent is not indirect object reference: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ref</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_from_ref</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="playa.outline.Outline.destination" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">destination</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Destination for this outline item.</p>


<details class="note" open>
  <summary>Special case of <code>GoTo</code> actions.</summary>
  <p>Since internal <code>GoTo</code> actions (PDF 1.7 sect 12.6.4.2) in
outlines and links are entirely equivalent to
destinations, if one exists, it will be returned here as
well.</p>
</details>

    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="playa.outline.Destination" href="#playa.outline.Destination">Destination</a>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>destination, if one exists.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.outline.Outline.doc" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">doc</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Get associated document if it exists.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="playa.outline.Outline.element" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">element</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The structure element associated with this outline item, if
any.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="playa.structure.Element" href="#playa.structure.Element">Element</a>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>structure element, if one exists.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>





  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="playa.font" class="doc doc-heading">
            <code>playa.font</code>


</h2>

    <div class="doc doc-contents first">

        <p>Font metrics and descriptors</p>


<details class="danger" open>
  <summary>API subject to change.</summary>
  <p>These APIs are unstable and subject to revision before PLAYA 1.0.</p>
</details>







  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="playa.font.CIDFont" class="doc doc-heading">
            <code>CIDFont</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="playa.font.Font" href="#playa.font.Font">Font</a></code></p>







              <details class="quote">
                <summary>Source code in <code>playa/font.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CIDFont</span><span class="p">(</span><span class="n">Font</span><span class="p">):</span>
    <span class="n">default_vdisp</span><span class="p">:</span> <span class="nb">float</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">spec</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">basefont</span> <span class="o">=</span> <span class="n">get_basefont</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cidsysteminfo</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;CIDSystemInfo&quot;</span><span class="p">,</span> <span class="p">{}))</span>
        <span class="c1"># These are *supposed* to be ASCII (PDF 1.7 section 9.7.3),</span>
        <span class="c1"># but for whatever reason they are sometimes UTF-16BE</span>
        <span class="n">cid_registry</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cidsysteminfo</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Registry&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cid_registry</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
            <span class="n">cid_registry</span> <span class="o">=</span> <span class="n">decode_text</span><span class="p">(</span><span class="n">cid_registry</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cid_registry</span> <span class="o">=</span> <span class="s2">&quot;unknown&quot;</span>
        <span class="n">cid_ordering</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cidsysteminfo</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Ordering&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cid_ordering</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
            <span class="n">cid_ordering</span> <span class="o">=</span> <span class="n">decode_text</span><span class="p">(</span><span class="n">cid_ordering</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cid_ordering</span> <span class="o">=</span> <span class="s2">&quot;unknown&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cidcoding</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cid_registry</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">cid_ordering</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="p">:</span> <span class="n">CMapBase</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cmap_from_spec</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">descriptor</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="s2">&quot;FontDescriptor&quot;</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Font spec is missing FontDescriptor: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">spec</span><span class="p">)</span>
            <span class="n">descriptor</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tounicode</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ToUnicodeMap</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unicode_map</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">UnicodeMap</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># Since None is equivalent to an identity map, avoid warning</span>
        <span class="c1"># in the case where there was some kind of explicit Identity</span>
        <span class="c1"># mapping (even though this is absolutely not standards compliant)</span>
        <span class="n">identity_map</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># First try to use an explicit ToUnicode Map</span>
        <span class="k">if</span> <span class="s2">&quot;ToUnicode&quot;</span> <span class="ow">in</span> <span class="n">spec</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;Encoding&quot;</span> <span class="ow">in</span> <span class="n">spec</span> <span class="ow">and</span> <span class="n">spec</span><span class="p">[</span><span class="s2">&quot;ToUnicode&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">spec</span><span class="p">[</span><span class="s2">&quot;Encoding&quot;</span><span class="p">]:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                    <span class="s2">&quot;ToUnicode and Encoding point to the same object, using an &quot;</span>
                    <span class="s2">&quot;identity mapping for Unicode instead of this nonsense: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">spec</span><span class="p">[</span><span class="s2">&quot;ToUnicode&quot;</span><span class="p">],</span>
                <span class="p">)</span>
                <span class="n">identity_map</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="s2">&quot;ToUnicode&quot;</span><span class="p">],</span> <span class="n">ContentStream</span><span class="p">):</span>
                <span class="n">strm</span> <span class="o">=</span> <span class="n">stream_value</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="s2">&quot;ToUnicode&quot;</span><span class="p">])</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Parsing ToUnicode from stream </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">strm</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tounicode</span> <span class="o">=</span> <span class="n">parse_tounicode</span><span class="p">(</span><span class="n">strm</span><span class="o">.</span><span class="n">buffer</span><span class="p">)</span>
            <span class="c1"># If there is no stream, consider it an Identity mapping</span>
            <span class="k">elif</span> <span class="p">(</span>
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="s2">&quot;ToUnicode&quot;</span><span class="p">],</span> <span class="n">PSLiteral</span><span class="p">)</span>
                <span class="ow">and</span> <span class="s2">&quot;Identity&quot;</span> <span class="ow">in</span> <span class="n">spec</span><span class="p">[</span><span class="s2">&quot;ToUnicode&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
            <span class="p">):</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Using identity mapping for ToUnicode </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">spec</span><span class="p">[</span><span class="s2">&quot;ToUnicode&quot;</span><span class="p">])</span>
                <span class="n">identity_map</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Unparseable ToUnicode in </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">spec</span><span class="p">)</span>
        <span class="c1"># If there is no ToUnicode, then try TrueType font tables</span>
        <span class="k">elif</span> <span class="s2">&quot;FontFile2&quot;</span> <span class="ow">in</span> <span class="n">descriptor</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fontfile</span> <span class="o">=</span> <span class="n">stream_value</span><span class="p">(</span><span class="n">descriptor</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;FontFile2&quot;</span><span class="p">))</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Parsing ToUnicode from TrueType font </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fontfile</span><span class="p">)</span>
            <span class="c1"># FIXME: Utterly gratuitous use of BytesIO</span>
            <span class="n">ttf</span> <span class="o">=</span> <span class="n">TrueTypeFontProgram</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basefont</span><span class="p">,</span> <span class="n">BytesIO</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fontfile</span><span class="o">.</span><span class="n">buffer</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tounicode</span> <span class="o">=</span> <span class="n">ttf</span><span class="o">.</span><span class="n">create_tounicode</span><span class="p">()</span>
        <span class="c1"># Or try to get a predefined UnicodeMap (not to be confused</span>
        <span class="c1"># with a ToUnicodeMap)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tounicode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">unicode_map</span> <span class="o">=</span> <span class="n">CMapDB</span><span class="o">.</span><span class="n">get_unicode_map</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">cidcoding</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">is_vertical</span><span class="p">(),</span>
                <span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unicode_map</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">tounicode</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">identity_map</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="s2">&quot;Unable to find/create/guess unicode mapping for CIDFont, &quot;</span>
                <span class="s2">&quot;using identity mapping: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">spec</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="c1"># FIXME: Verify that self.tounicode&#39;s code space corresponds</span>
        <span class="c1"># to self.cmap (this is actually quite hard because the code</span>
        <span class="c1"># spaces have been lost in the precompiled CMaps...)</span>

        <span class="n">widths</span> <span class="o">=</span> <span class="n">_get_widths</span><span class="p">(</span><span class="n">list_value</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;W&quot;</span><span class="p">,</span> <span class="p">[])))</span>
        <span class="k">if</span> <span class="s2">&quot;DW&quot;</span> <span class="ow">in</span> <span class="n">spec</span><span class="p">:</span>
            <span class="n">default_width</span> <span class="o">=</span> <span class="n">num_value</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="s2">&quot;DW&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">default_width</span> <span class="o">=</span> <span class="mi">1000</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vertical</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">is_vertical</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertical</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;DW2&quot;</span> <span class="ow">in</span> <span class="n">spec</span><span class="p">:</span>
                <span class="p">(</span><span class="n">vy</span><span class="p">,</span> <span class="n">w1</span><span class="p">)</span> <span class="o">=</span> <span class="n">point_value</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="s2">&quot;DW2&quot;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># seemingly arbitrary values, but found in PDF 2.0 Table 115</span>
                <span class="n">vy</span> <span class="o">=</span> <span class="mi">880</span>  <span class="c1"># vertical component of position vector</span>
                <span class="n">w1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1000</span>  <span class="c1"># default vertical displacement</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">default_position</span> <span class="o">=</span> <span class="p">(</span><span class="n">default_width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">vy</span><span class="p">)</span>
            <span class="c1"># The horizontal displacement is *always* zero (PDF 2.0</span>
            <span class="c1"># sec 9.7.4.3) so we only store the vertical.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">default_vdisp</span> <span class="o">=</span> <span class="n">w1</span>
            <span class="c1"># Glyph-specific vertical displacement and position vectors if any</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">positions</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vdisps</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">if</span> <span class="s2">&quot;W2&quot;</span> <span class="ow">in</span> <span class="n">spec</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">cid</span><span class="p">,</span> <span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="p">(</span><span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">))</span> <span class="ow">in</span> <span class="n">_get_widths2</span><span class="p">(</span><span class="n">list_value</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="s2">&quot;W2&quot;</span><span class="p">]))</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="n">cid</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vdisps</span><span class="p">[</span><span class="n">cid</span><span class="p">]</span> <span class="o">=</span> <span class="n">w1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">default_position</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">default_vdisp</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">positions</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vdisps</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Font</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">descriptor</span><span class="p">,</span> <span class="n">widths</span><span class="p">,</span> <span class="n">default_width</span><span class="o">=</span><span class="n">default_width</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_cmap_from_spec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spec</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">CMapBase</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get cmap from font specification</span>

<span class="sd">        For certain PDFs, Encoding Type isn&#39;t mentioned as an attribute of</span>
<span class="sd">        Encoding but as an attribute of CMapName, where CMapName is an</span>
<span class="sd">        attribute of spec[&#39;Encoding&#39;].</span>
<span class="sd">        The horizontal/vertical modes are mentioned with different name</span>
<span class="sd">        such as &#39;DLIdent-H/V&#39;,&#39;OneByteIdentityH/V&#39;,&#39;Identity-H/V&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmap_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cmap_name</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">CMapDB</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap_name</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># Parse an embedded CMap if necessary</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="s2">&quot;Encoding&quot;</span><span class="p">],</span> <span class="n">ContentStream</span><span class="p">):</span>
                <span class="n">strm</span> <span class="o">=</span> <span class="n">stream_value</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="s2">&quot;Encoding&quot;</span><span class="p">])</span>
                <span class="k">return</span> <span class="n">parse_encoding</span><span class="p">(</span><span class="n">strm</span><span class="o">.</span><span class="n">buffer</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Failed to get cmap </span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cmap_name</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">CMap</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_get_cmap_name</span><span class="p">(</span><span class="n">spec</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get cmap name from font specification&quot;&quot;&quot;</span>
        <span class="n">cmap_name</span> <span class="o">=</span> <span class="s2">&quot;unknown&quot;</span>  <span class="c1"># default value</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">spec_encoding</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="s2">&quot;Encoding&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">spec_encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">cmap_name</span> <span class="o">=</span> <span class="n">literal_name</span><span class="p">(</span><span class="n">spec_encoding</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">spec_encoding</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="s2">&quot;CMapName&quot;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">spec_encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">cmap_name</span> <span class="o">=</span> <span class="n">literal_name</span><span class="p">(</span><span class="n">spec_encoding</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Font spec is missing Encoding: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">spec</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Font spec has invalid Encoding: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">spec</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">IDENTITY_ENCODER</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cmap_name</span><span class="p">,</span> <span class="n">cmap_name</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">decode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tounicode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;decode with ToUnicodeMap: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
            <span class="c1"># FIXME: Should verify that the codes are actually the</span>
            <span class="c1"># same (or just trust the codes that come from the cmap)</span>
            <span class="k">return</span> <span class="nb">zip</span><span class="p">(</span>
                <span class="p">(</span><span class="n">cid</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">cid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">data</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">tounicode</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">unicode_map</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;decode with UnicodeMap: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">cid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unicode_map</span><span class="o">.</span><span class="n">get_unichr</span><span class="p">(</span><span class="n">cid</span><span class="p">))</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">cid</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;decode with identity unicode map: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">cid</span><span class="p">,</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">substr</span><span class="p">,</span> <span class="s2">&quot;big&quot;</span><span class="p">)))</span>
                <span class="k">for</span> <span class="n">substr</span><span class="p">,</span> <span class="n">cid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;CIDFont: basefont=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">basefont</span><span class="si">!r}</span><span class="s2">, cidcoding=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cidcoding</span><span class="si">!r}</span><span class="s2">&gt;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">vdisp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get vertical displacement for vertical writing mode, in</span>
<span class="sd">        text space units.</span>

<span class="sd">        Returns 0 for horizontal writing, for obvious reasons.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">vdisps</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_vdisp</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get position vector for vertical writing mode, in text</span>
<span class="sd">        space units.</span>

<span class="sd">        This is quite ill-defined in the PDF standard (PDF 2.0 Figure</span>
<span class="sd">        55), but basically it specifies a translation of the glyph</span>
<span class="sd">        with respect to the origin.  It is *subtracted* from that</span>
<span class="sd">        origin to give the glyph position.  So if your text matrix is</span>
<span class="sd">        `[1 0 0 1 100 100]`, and your font size is `10`, a position</span>
<span class="sd">        vector of `[500 200]` will place the origin of the glyph in</span>
<span class="sd">        glyph space at `[-500 -200]`, which becomes `[-.5 -.2]` in</span>
<span class="sd">        text space, then `[-5 -2]` after applying the font size, thus</span>
<span class="sd">        the glyph is painted with its origin at `[95 98]`.</span>

<span class="sd">        Yes, the horizontal scaling factor **does** apply to the</span>
<span class="sd">        horizontal component of the position vector, even if some PDF</span>
<span class="sd">        viewers don&#39;t think so.</span>

<span class="sd">        For horizontal writing, it is obviously (0, 0).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_position</span><span class="p">)</span>
        <span class="c1"># We know that the matrix is diagonal here</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span>
        <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">vx</span><span class="p">,</span> <span class="n">d</span> <span class="o">*</span> <span class="n">vy</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">char_bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rect</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the standard bounding box for a character from its CID.</span>

<span class="sd">        This is the standard bounding box in text space units based on</span>
<span class="sd">        width, descent and ascent, translated by the position vector.</span>

<span class="sd">        Danger: Not the actual bounding box of the glyph.</span>
<span class="sd">            This is a standardized bounding box for use in text</span>
<span class="sd">            extraction and layout analysis.  It does not correspond to</span>
<span class="sd">            the actual bounding box of an individual glyph as</span>
<span class="sd">            specified by the font program.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widths</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_width</span><span class="p">)</span>
        <span class="c1"># We know that the matrix is diagonal here</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertical</span><span class="p">:</span>
            <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_position</span><span class="p">)</span>
            <span class="c1"># Horizontal offset for glyph origin vs. text</span>
            <span class="c1"># space origin.</span>
            <span class="n">vx</span> <span class="o">=</span> <span class="o">-</span><span class="n">vx</span>
            <span class="c1"># Vertical offset for glyph origin</span>
            <span class="n">vy</span> <span class="o">=</span> <span class="o">-</span><span class="n">vy</span>
            <span class="c1"># Find glyph bbox</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="n">a</span> <span class="o">*</span> <span class="n">vx</span><span class="p">,</span>
                <span class="n">d</span> <span class="o">*</span> <span class="p">(</span><span class="n">vy</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">descent</span><span class="p">),</span>
                <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">vx</span> <span class="o">+</span> <span class="n">width</span><span class="p">),</span>
                <span class="n">d</span> <span class="o">*</span> <span class="p">(</span><span class="n">vy</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ascent</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">d</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">descent</span><span class="p">,</span> <span class="n">a</span> <span class="o">*</span> <span class="n">width</span><span class="p">,</span> <span class="n">d</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ascent</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="playa.font.CIDFont.char_bbox" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">char_bbox</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get the standard bounding box for a character from its CID.</p>
<p>This is the standard bounding box in text space units based on
width, descent and ascent, translated by the position vector.</p>


<details class="danger" open>
  <summary>Not the actual bounding box of the glyph.</summary>
  <p>This is a standardized bounding box for use in text
extraction and layout analysis.  It does not correspond to
the actual bounding box of an individual glyph as
specified by the font program.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>playa/font.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">char_bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rect</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the standard bounding box for a character from its CID.</span>

<span class="sd">    This is the standard bounding box in text space units based on</span>
<span class="sd">    width, descent and ascent, translated by the position vector.</span>

<span class="sd">    Danger: Not the actual bounding box of the glyph.</span>
<span class="sd">        This is a standardized bounding box for use in text</span>
<span class="sd">        extraction and layout analysis.  It does not correspond to</span>
<span class="sd">        the actual bounding box of an individual glyph as</span>
<span class="sd">        specified by the font program.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widths</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_width</span><span class="p">)</span>
    <span class="c1"># We know that the matrix is diagonal here</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertical</span><span class="p">:</span>
        <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_position</span><span class="p">)</span>
        <span class="c1"># Horizontal offset for glyph origin vs. text</span>
        <span class="c1"># space origin.</span>
        <span class="n">vx</span> <span class="o">=</span> <span class="o">-</span><span class="n">vx</span>
        <span class="c1"># Vertical offset for glyph origin</span>
        <span class="n">vy</span> <span class="o">=</span> <span class="o">-</span><span class="n">vy</span>
        <span class="c1"># Find glyph bbox</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">a</span> <span class="o">*</span> <span class="n">vx</span><span class="p">,</span>
            <span class="n">d</span> <span class="o">*</span> <span class="p">(</span><span class="n">vy</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">descent</span><span class="p">),</span>
            <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">vx</span> <span class="o">+</span> <span class="n">width</span><span class="p">),</span>
            <span class="n">d</span> <span class="o">*</span> <span class="p">(</span><span class="n">vy</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ascent</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">d</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">descent</span><span class="p">,</span> <span class="n">a</span> <span class="o">*</span> <span class="n">width</span><span class="p">,</span> <span class="n">d</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ascent</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.font.CIDFont.get_cmap_from_spec" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_cmap_from_spec</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get cmap from font specification</p>
<p>For certain PDFs, Encoding Type isn't mentioned as an attribute of
Encoding but as an attribute of CMapName, where CMapName is an
attribute of spec['Encoding'].
The horizontal/vertical modes are mentioned with different name
such as 'DLIdent-H/V','OneByteIdentityH/V','Identity-H/V'.</p>

            <details class="quote">
              <summary>Source code in <code>playa/font.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_cmap_from_spec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spec</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">CMapBase</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get cmap from font specification</span>

<span class="sd">    For certain PDFs, Encoding Type isn&#39;t mentioned as an attribute of</span>
<span class="sd">    Encoding but as an attribute of CMapName, where CMapName is an</span>
<span class="sd">    attribute of spec[&#39;Encoding&#39;].</span>
<span class="sd">    The horizontal/vertical modes are mentioned with different name</span>
<span class="sd">    such as &#39;DLIdent-H/V&#39;,&#39;OneByteIdentityH/V&#39;,&#39;Identity-H/V&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cmap_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cmap_name</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">CMapDB</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap_name</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># Parse an embedded CMap if necessary</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="s2">&quot;Encoding&quot;</span><span class="p">],</span> <span class="n">ContentStream</span><span class="p">):</span>
            <span class="n">strm</span> <span class="o">=</span> <span class="n">stream_value</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="s2">&quot;Encoding&quot;</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">parse_encoding</span><span class="p">(</span><span class="n">strm</span><span class="o">.</span><span class="n">buffer</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Failed to get cmap </span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cmap_name</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">CMap</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.font.CIDFont.position" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">position</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get position vector for vertical writing mode, in text
space units.</p>
<p>This is quite ill-defined in the PDF standard (PDF 2.0 Figure
55), but basically it specifies a translation of the glyph
with respect to the origin.  It is <em>subtracted</em> from that
origin to give the glyph position.  So if your text matrix is
<code>[1 0 0 1 100 100]</code>, and your font size is <code>10</code>, a position
vector of <code>[500 200]</code> will place the origin of the glyph in
glyph space at <code>[-500 -200]</code>, which becomes <code>[-.5 -.2]</code> in
text space, then <code>[-5 -2]</code> after applying the font size, thus
the glyph is painted with its origin at <code>[95 98]</code>.</p>
<p>Yes, the horizontal scaling factor <strong>does</strong> apply to the
horizontal component of the position vector, even if some PDF
viewers don't think so.</p>
<p>For horizontal writing, it is obviously (0, 0).</p>

            <details class="quote">
              <summary>Source code in <code>playa/font.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get position vector for vertical writing mode, in text</span>
<span class="sd">    space units.</span>

<span class="sd">    This is quite ill-defined in the PDF standard (PDF 2.0 Figure</span>
<span class="sd">    55), but basically it specifies a translation of the glyph</span>
<span class="sd">    with respect to the origin.  It is *subtracted* from that</span>
<span class="sd">    origin to give the glyph position.  So if your text matrix is</span>
<span class="sd">    `[1 0 0 1 100 100]`, and your font size is `10`, a position</span>
<span class="sd">    vector of `[500 200]` will place the origin of the glyph in</span>
<span class="sd">    glyph space at `[-500 -200]`, which becomes `[-.5 -.2]` in</span>
<span class="sd">    text space, then `[-5 -2]` after applying the font size, thus</span>
<span class="sd">    the glyph is painted with its origin at `[95 98]`.</span>

<span class="sd">    Yes, the horizontal scaling factor **does** apply to the</span>
<span class="sd">    horizontal component of the position vector, even if some PDF</span>
<span class="sd">    viewers don&#39;t think so.</span>

<span class="sd">    For horizontal writing, it is obviously (0, 0).</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_position</span><span class="p">)</span>
    <span class="c1"># We know that the matrix is diagonal here</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">vx</span><span class="p">,</span> <span class="n">d</span> <span class="o">*</span> <span class="n">vy</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.font.CIDFont.vdisp" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">vdisp</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get vertical displacement for vertical writing mode, in
text space units.</p>
<p>Returns 0 for horizontal writing, for obvious reasons.</p>

            <details class="quote">
              <summary>Source code in <code>playa/font.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">vdisp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get vertical displacement for vertical writing mode, in</span>
<span class="sd">    text space units.</span>

<span class="sd">    Returns 0 for horizontal writing, for obvious reasons.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">vdisps</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_vdisp</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.font.Font" class="doc doc-heading">
            <code>Font</code>


</h3>


    <div class="doc doc-contents ">







              <details class="quote">
                <summary>Source code in <code>playa/font.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Font</span><span class="p">:</span>
    <span class="n">vertical</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">multibyte</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">descriptor</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">],</span>
        <span class="n">widths</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
        <span class="n">default_width</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">descriptor</span> <span class="o">=</span> <span class="n">descriptor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widths</span> <span class="o">=</span> <span class="n">widths</span>
        <span class="n">fontname</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">descriptor</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;FontName&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fontname</span><span class="p">,</span> <span class="n">PSLiteral</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fontname</span> <span class="o">=</span> <span class="n">literal_name</span><span class="p">(</span><span class="n">fontname</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fontname</span><span class="p">,</span> <span class="p">(</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fontname</span> <span class="o">=</span> <span class="n">decode_text</span><span class="p">(</span><span class="n">fontname</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fontname</span> <span class="o">=</span> <span class="s2">&quot;unknown&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">basefont</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fontname</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">descriptor</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Flags&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="c1"># Default values based on default DW2 metrics</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ascent</span> <span class="o">=</span> <span class="n">num_value</span><span class="p">(</span><span class="n">descriptor</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Ascent&quot;</span><span class="p">,</span> <span class="mi">880</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">descent</span> <span class="o">=</span> <span class="n">num_value</span><span class="p">(</span><span class="n">descriptor</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Descent&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">120</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">italic_angle</span> <span class="o">=</span> <span class="n">num_value</span><span class="p">(</span><span class="n">descriptor</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ItalicAngle&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">default_width</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">default_width</span> <span class="o">=</span> <span class="n">num_value</span><span class="p">(</span><span class="n">descriptor</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;MissingWidth&quot;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">default_width</span> <span class="o">=</span> <span class="n">default_width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leading</span> <span class="o">=</span> <span class="n">num_value</span><span class="p">(</span><span class="n">descriptor</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Leading&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="k">if</span> <span class="s2">&quot;FontBBox&quot;</span> <span class="ow">in</span> <span class="n">descriptor</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span> <span class="o">=</span> <span class="n">rect_value</span><span class="p">(</span><span class="n">descriptor</span><span class="p">[</span><span class="s2">&quot;FontBBox&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">:</span> <span class="n">Matrix</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c1"># PDF RM 9.8.1 specifies /Descent should always be a negative number.</span>
        <span class="c1"># PScript5.dll seems to produce Descent with a positive number, but</span>
        <span class="c1"># text analysis will be wrong if this is taken as correct. So force</span>
        <span class="c1"># descent to negative.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">descent</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">descent</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">descent</span>
        <span class="c1"># NOTE: A Type3 font *can* have positive descent because the</span>
        <span class="c1"># FontMatrix might be flipped, this is handled in the subclass</span>
        <span class="c1"># (but also, we ignore ascent and descent on Type3 fonts)</span>

        <span class="c1"># For some unknown reason sometimes Ascent and Descent are</span>
        <span class="c1"># both zero, in which case set them from the bbox.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ascent</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">descent</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">descent</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ascent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;&lt;Font&gt;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">decode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
        <span class="c1"># Default to an Identity map</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;decode with identity: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">((</span><span class="n">cid</span><span class="p">,</span> <span class="nb">chr</span><span class="p">(</span><span class="n">cid</span><span class="p">))</span> <span class="k">for</span> <span class="n">cid</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">hdisp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the horizontal displacement (so-called &quot;width&quot;) of a character</span>
<span class="sd">        from its CID.&quot;&quot;&quot;</span>
        <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widths</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_width</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">width</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">vdisp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get vertical displacement for vertical writing mode, in</span>
<span class="sd">        text space units.</span>

<span class="sd">        This is always 0 for simple fonts as they have no vertical</span>
<span class="sd">        writing mode.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get position vector for vertical writing mode, in text</span>
<span class="sd">        space units.</span>

<span class="sd">        This is always `[0 0]` for simple fonts as they have no</span>
<span class="sd">        vertical writing mode.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">char_bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rect</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the standard bounding box for a character from its CID.</span>

<span class="sd">        This is, very specifically, `[0 descent width ascent]` in text</span>
<span class="sd">        space units.</span>

<span class="sd">        Danger: Not the actual bounding box of the glyph.</span>
<span class="sd">            This is a standardized bounding box for use in text</span>
<span class="sd">            extraction and layout analysis.  It does not correspond to</span>
<span class="sd">            the actual bounding box of an individual glyph as</span>
<span class="sd">            specified by the font program.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widths</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_width</span><span class="p">)</span>
        <span class="c1"># We know the matrix is diagonal</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">d</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">descent</span><span class="p">,</span> <span class="n">a</span> <span class="o">*</span> <span class="n">width</span><span class="p">,</span> <span class="n">d</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ascent</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="playa.font.Font.char_bbox" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">char_bbox</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get the standard bounding box for a character from its CID.</p>
<p>This is, very specifically, <code>[0 descent width ascent]</code> in text
space units.</p>


<details class="danger" open>
  <summary>Not the actual bounding box of the glyph.</summary>
  <p>This is a standardized bounding box for use in text
extraction and layout analysis.  It does not correspond to
the actual bounding box of an individual glyph as
specified by the font program.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>playa/font.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">char_bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rect</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the standard bounding box for a character from its CID.</span>

<span class="sd">    This is, very specifically, `[0 descent width ascent]` in text</span>
<span class="sd">    space units.</span>

<span class="sd">    Danger: Not the actual bounding box of the glyph.</span>
<span class="sd">        This is a standardized bounding box for use in text</span>
<span class="sd">        extraction and layout analysis.  It does not correspond to</span>
<span class="sd">        the actual bounding box of an individual glyph as</span>
<span class="sd">        specified by the font program.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widths</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_width</span><span class="p">)</span>
    <span class="c1"># We know the matrix is diagonal</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">d</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">descent</span><span class="p">,</span> <span class="n">a</span> <span class="o">*</span> <span class="n">width</span><span class="p">,</span> <span class="n">d</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ascent</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.font.Font.hdisp" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hdisp</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get the horizontal displacement (so-called "width") of a character
from its CID.</p>

            <details class="quote">
              <summary>Source code in <code>playa/font.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">hdisp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the horizontal displacement (so-called &quot;width&quot;) of a character</span>
<span class="sd">    from its CID.&quot;&quot;&quot;</span>
    <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widths</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_width</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">width</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.font.Font.position" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">position</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get position vector for vertical writing mode, in text
space units.</p>
<p>This is always <code>[0 0]</code> for simple fonts as they have no
vertical writing mode.</p>

            <details class="quote">
              <summary>Source code in <code>playa/font.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get position vector for vertical writing mode, in text</span>
<span class="sd">    space units.</span>

<span class="sd">    This is always `[0 0]` for simple fonts as they have no</span>
<span class="sd">    vertical writing mode.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.font.Font.vdisp" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">vdisp</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get vertical displacement for vertical writing mode, in
text space units.</p>
<p>This is always 0 for simple fonts as they have no vertical
writing mode.</p>

            <details class="quote">
              <summary>Source code in <code>playa/font.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">vdisp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get vertical displacement for vertical writing mode, in</span>
<span class="sd">    text space units.</span>

<span class="sd">    This is always 0 for simple fonts as they have no vertical</span>
<span class="sd">    writing mode.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.font.Type1Font" class="doc doc-heading">
            <code>Type1Font</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="playa.font.SimpleFont">SimpleFont</span></code></p>







              <details class="quote">
                <summary>Source code in <code>playa/font.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Type1Font</span><span class="p">(</span><span class="n">SimpleFont</span><span class="p">):</span>
    <span class="n">char_widths</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spec</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">basefont</span> <span class="o">=</span> <span class="n">get_basefont</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
        <span class="n">widths</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">basefont</span> <span class="ow">in</span> <span class="n">FONT_METRICS</span><span class="p">:</span>
            <span class="p">(</span><span class="n">descriptor</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">char_widths</span><span class="p">)</span> <span class="o">=</span> <span class="n">FONT_METRICS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">basefont</span><span class="p">]</span>
            <span class="n">widths</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">descriptor</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;FontDescriptor&quot;</span><span class="p">,</span> <span class="p">{}))</span>
            <span class="n">firstchar</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;FirstChar&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
            <span class="c1"># lastchar = int_value(spec.get(&#39;LastChar&#39;, 255))</span>
            <span class="n">width_list</span> <span class="o">=</span> <span class="n">list_value</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Widths&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">256</span><span class="p">))</span>
            <span class="n">widths</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span> <span class="o">+</span> <span class="n">firstchar</span><span class="p">:</span> <span class="n">num_value</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">width_list</span><span class="p">)}</span>
        <span class="n">SimpleFont</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">descriptor</span><span class="p">,</span> <span class="n">widths</span><span class="p">,</span> <span class="n">spec</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_implicit_encoding</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">descriptor</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">PSLiteral</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]:</span>
        <span class="c1"># PDF 1.7 Table 114: For a font program that is embedded in</span>
        <span class="c1"># the PDF file, the implicit base encoding shall be the font</span>
        <span class="c1"># program’s built-in encoding.</span>
        <span class="k">if</span> <span class="s2">&quot;FontFile&quot;</span> <span class="ow">in</span> <span class="n">descriptor</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fontfile</span> <span class="o">=</span> <span class="n">stream_value</span><span class="p">(</span><span class="n">descriptor</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;FontFile&quot;</span><span class="p">))</span>
            <span class="n">length1</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fontfile</span><span class="p">[</span><span class="s2">&quot;Length1&quot;</span><span class="p">])</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fontfile</span><span class="o">.</span><span class="n">buffer</span><span class="p">[:</span><span class="n">length1</span><span class="p">]</span>
            <span class="n">parser</span> <span class="o">=</span> <span class="n">Type1FontHeaderParser</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">parser</span><span class="o">.</span><span class="n">get_encoding</span><span class="p">()</span>
        <span class="k">elif</span> <span class="s2">&quot;FontFile3&quot;</span> <span class="ow">in</span> <span class="n">descriptor</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fontfile3</span> <span class="o">=</span> <span class="n">stream_value</span><span class="p">(</span><span class="n">descriptor</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;FontFile3&quot;</span><span class="p">))</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">cfffont</span> <span class="o">=</span> <span class="n">CFFFontProgram</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basefont</span><span class="p">,</span> <span class="n">BytesIO</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fontfile3</span><span class="o">.</span><span class="n">buffer</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cfffont</span> <span class="o">=</span> <span class="n">cfffont</span>
                <span class="k">return</span> <span class="p">{</span>
                    <span class="n">cid</span><span class="p">:</span> <span class="n">cfffont</span><span class="o">.</span><span class="n">gid2name</span><span class="p">[</span><span class="n">gid</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">cid</span><span class="p">,</span> <span class="n">gid</span> <span class="ow">in</span> <span class="n">cfffont</span><span class="o">.</span><span class="n">code2gid</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">gid</span> <span class="ow">in</span> <span class="n">cfffont</span><span class="o">.</span><span class="n">gid2name</span>
                <span class="p">}</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Failed to parse CFFFont </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fontfile3</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">LITERAL_STANDARD_ENCODING</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">basefont</span> <span class="o">==</span> <span class="s2">&quot;Symbol&quot;</span><span class="p">:</span>
            <span class="c1"># FIXME: This (and zapf) can be obtained from the AFM files</span>
            <span class="k">return</span> <span class="n">SYMBOL_BUILTIN_ENCODING</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">basefont</span> <span class="o">==</span> <span class="s2">&quot;ZapfDingbats&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ZAPFDINGBATS_BUILTIN_ENCODING</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># PDF 1.7 Table 114: Otherwise, for a nonsymbolic font, it</span>
            <span class="c1"># shall be StandardEncoding, and for a symbolic font, it</span>
            <span class="c1"># shall be the font&#39;s built-in encoding (see FIXME above)</span>
            <span class="k">return</span> <span class="n">LITERAL_STANDARD_ENCODING</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_glyph_space_width</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="c1"># Commit 6e4f36d &lt;- what&#39;s the purpose of this? seems very cursed</span>
        <span class="c1"># reverting this would make #76 easy to fix since cid2unicode would only be</span>
        <span class="c1"># needed when ToUnicode is absent</span>
        <span class="c1">#</span>
        <span class="c1"># Answer: It exists entirely to support core fonts with a</span>
        <span class="c1"># custom Encoding defined over them (accented characters for</span>
        <span class="c1"># example).  The correct fix is to redo the AFM parsing to:</span>
        <span class="c1">#</span>
        <span class="c1"># - Get the implicit encoding (it&#39;s usually LITERAL_STANDARD_ENCODING)</span>
        <span class="c1"># - Index the widths by glyph names, not encoding values</span>
        <span class="c1"># - As a treat, we can also get the encodings for Symbol and ZapfDingbats</span>
        <span class="c1">#</span>
        <span class="c1"># Then we can construct `self.widths` directly using `self.encoding`.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">char_widths</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cid2unicode</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_width</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">char_widths</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cid2unicode</span><span class="p">[</span><span class="n">cid</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_width</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">widths</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_width</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">hdisp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the horizontal displacement (so-called &quot;width&quot;) of a character</span>
<span class="sd">        from its CID.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_glyph_space_width</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">char_bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rect</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the standard bounding box for a character from its CID.</span>

<span class="sd">        This is, very specifically, `[0 descent width ascent]` in text</span>
<span class="sd">        space units.</span>

<span class="sd">        Danger: Not the actual bounding box of the glyph.</span>
<span class="sd">            This is a standardized bounding box for use in text</span>
<span class="sd">            extraction and layout analysis.  It does not correspond to</span>
<span class="sd">            the actual bounding box of an individual glyph as</span>
<span class="sd">            specified by the font program.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_glyph_space_width</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span>
        <span class="c1"># We know the matrix is diagonal</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">d</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">descent</span><span class="p">,</span> <span class="n">a</span> <span class="o">*</span> <span class="n">width</span><span class="p">,</span> <span class="n">d</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ascent</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;&lt;Type1Font: basefont=</span><span class="si">%r</span><span class="s2">&gt;&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">basefont</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="playa.font.Type1Font.char_bbox" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">char_bbox</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get the standard bounding box for a character from its CID.</p>
<p>This is, very specifically, <code>[0 descent width ascent]</code> in text
space units.</p>


<details class="danger" open>
  <summary>Not the actual bounding box of the glyph.</summary>
  <p>This is a standardized bounding box for use in text
extraction and layout analysis.  It does not correspond to
the actual bounding box of an individual glyph as
specified by the font program.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>playa/font.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">char_bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rect</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the standard bounding box for a character from its CID.</span>

<span class="sd">    This is, very specifically, `[0 descent width ascent]` in text</span>
<span class="sd">    space units.</span>

<span class="sd">    Danger: Not the actual bounding box of the glyph.</span>
<span class="sd">        This is a standardized bounding box for use in text</span>
<span class="sd">        extraction and layout analysis.  It does not correspond to</span>
<span class="sd">        the actual bounding box of an individual glyph as</span>
<span class="sd">        specified by the font program.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_glyph_space_width</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span>
    <span class="c1"># We know the matrix is diagonal</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">d</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">descent</span><span class="p">,</span> <span class="n">a</span> <span class="o">*</span> <span class="n">width</span><span class="p">,</span> <span class="n">d</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ascent</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.font.Type1Font.hdisp" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hdisp</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get the horizontal displacement (so-called "width") of a character
from its CID.</p>

            <details class="quote">
              <summary>Source code in <code>playa/font.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">hdisp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the horizontal displacement (so-called &quot;width&quot;) of a character</span>
<span class="sd">    from its CID.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_glyph_space_width</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.font.Type3Font" class="doc doc-heading">
            <code>Type3Font</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="playa.font.SimpleFont">SimpleFont</span></code></p>







              <details class="quote">
                <summary>Source code in <code>playa/font.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Type3Font</span><span class="p">(</span><span class="n">SimpleFont</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spec</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">firstchar</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;FirstChar&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="c1"># lastchar = int_value(spec.get(&#39;LastChar&#39;, 0))</span>
        <span class="n">width_list</span> <span class="o">=</span> <span class="n">list_value</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Widths&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">256</span><span class="p">))</span>
        <span class="n">widths</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span> <span class="o">+</span> <span class="n">firstchar</span><span class="p">:</span> <span class="n">num_value</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">width_list</span><span class="p">)}</span>
        <span class="n">descriptor</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;FontDescriptor&quot;</span><span class="p">,</span> <span class="p">{}))</span>
        <span class="n">SimpleFont</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">descriptor</span><span class="p">,</span> <span class="n">widths</span><span class="p">,</span> <span class="n">spec</span><span class="p">)</span>
        <span class="c1"># Type 3 fonts don&#39;t have a BaseFont in their font dictionary</span>
        <span class="c1"># and generally don&#39;t have a FontName in their descriptor</span>
        <span class="c1"># (https://github.com/pdf-association/pdf-issues/issues/11) as</span>
        <span class="c1"># they aren&#39;t considered to be subsettable, so we should just</span>
        <span class="c1"># look at Name to get their name and ignore whatever</span>
        <span class="c1"># SimpleFont.__init__ tells us</span>
        <span class="n">fontname</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">descriptor</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;FontName&quot;</span><span class="p">,</span> <span class="n">spec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Name&quot;</span><span class="p">)))</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fontname</span><span class="p">,</span> <span class="n">PSLiteral</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fontname</span> <span class="o">=</span> <span class="n">fontname</span><span class="o">.</span><span class="n">name</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fontname</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fontname</span> <span class="o">=</span> <span class="n">decode_text</span><span class="p">(</span><span class="n">fontname</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fontname</span> <span class="o">=</span> <span class="s2">&quot;unknown&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">basefont</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fontname</span>
        <span class="c1"># Get the character definitions so we can interpret them</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">charprocs</span> <span class="o">=</span> <span class="n">dict_value</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;CharProcs&quot;</span><span class="p">,</span> <span class="p">{}))</span>
        <span class="c1"># Get font-specific resources (FIXME: There is a huge amount</span>
        <span class="c1"># of ambiguity surrounding resources in Type3 fonts, see</span>
        <span class="c1"># https://github.com/pdf-association/pdf-issues/issues/128)</span>
        <span class="n">resources</span> <span class="o">=</span> <span class="n">resolve1</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Resources&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="kc">None</span> <span class="k">if</span> <span class="n">resources</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">dict_value</span><span class="p">(</span><span class="n">resources</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;FontMatrix&quot;</span> <span class="ow">in</span> <span class="n">spec</span><span class="p">:</span>  <span class="c1"># it is actually required though</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span> <span class="o">=</span> <span class="n">matrix_value</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="s2">&quot;FontMatrix&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="c1"># FontBBox is in the font dictionary for Type 3 fonts</span>
        <span class="k">if</span> <span class="s2">&quot;FontBBox&quot;</span> <span class="ow">in</span> <span class="n">spec</span><span class="p">:</span>  <span class="c1"># it is also required though</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span> <span class="o">=</span> <span class="n">rect_value</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="s2">&quot;FontBBox&quot;</span><span class="p">])</span>
            <span class="c1"># otherwise it was set in SimpleFont.__init__</span>

        <span class="c1"># Set ascent/descent from the bbox (they *could* be in the</span>
        <span class="c1"># descriptor but this is very unlikely, and then, they might</span>
        <span class="c1"># also both be zero, which is bad)</span>
        <span class="n">_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">descent</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ascent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_implicit_encoding</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">descriptor</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PDFObject</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">PSLiteral</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]:</span>
        <span class="c1"># PDF 1.7 sec 9.6.6.3: A Type 3 font’s mapping from character</span>
        <span class="c1"># codes to glyph names shall be entirely defined by its</span>
        <span class="c1"># Encoding entry, which is required in this case.</span>
        <span class="k">return</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">char_bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rect</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the standard bounding box for a character from its CID.</span>

<span class="sd">        This is the smallest rectangle enclosing [0 descent width</span>
<span class="sd">        ascent] after the font matrix has been applied.</span>

<span class="sd">        Danger: Not the actual bounding box of the glyph (but almost).</span>
<span class="sd">            The descent and ascent here are from the **font** and not</span>
<span class="sd">            from the individual **glyph** so this will be somewhat</span>
<span class="sd">            larger than the actual bounding box.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widths</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_width</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">transform_bbox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">descent</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ascent</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;&lt;Type3Font&gt;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="playa.font.Type3Font.char_bbox" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">char_bbox</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get the standard bounding box for a character from its CID.</p>
<p>This is the smallest rectangle enclosing [0 descent width
ascent] after the font matrix has been applied.</p>


<details class="danger" open>
  <summary>Not the actual bounding box of the glyph (but almost).</summary>
  <p>The descent and ascent here are from the <strong>font</strong> and not
from the individual <strong>glyph</strong> so this will be somewhat
larger than the actual bounding box.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>playa/font.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">char_bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rect</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the standard bounding box for a character from its CID.</span>

<span class="sd">    This is the smallest rectangle enclosing [0 descent width</span>
<span class="sd">    ascent] after the font matrix has been applied.</span>

<span class="sd">    Danger: Not the actual bounding box of the glyph (but almost).</span>
<span class="sd">        The descent and ascent here are from the **font** and not</span>
<span class="sd">        from the individual **glyph** so this will be somewhat</span>
<span class="sd">        larger than the actual bounding box.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widths</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_width</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">transform_bbox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">descent</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ascent</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="playa.parser" class="doc doc-heading">
            <code>playa.parser</code>


</h2>

    <div class="doc doc-contents first">

        <p>PDF lexer and parser</p>


<details class="danger" open>
  <summary>API subject to change.</summary>
  <p>These APIs are unstable and subject to revision before PLAYA 1.0.</p>
</details>







  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="playa.parser.ContentParser" class="doc doc-heading">
            <code>ContentParser</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="playa.parser.ObjectParser" href="#playa.parser.ObjectParser">ObjectParser</a></code></p>


        <p>Parse the concatenation of multiple content streams, as
described in the spec (PDF 1.7, p.86):</p>
<p>...the effect shall be as if all of the streams in the array were
concatenated, in order, to form a single stream.  Conforming
writers can create image objects and other resources as they
occur, even though they interrupt the content stream. The division
between streams may occur only at the boundaries between lexical
tokens (see 7.2, "Lexical Conventions") but shall be unrelated to
the page’s logical content or organization.</p>






              <details class="quote">
                <summary>Source code in <code>playa/parser.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ContentParser</span><span class="p">(</span><span class="n">ObjectParser</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse the concatenation of multiple content streams, as</span>
<span class="sd">    described in the spec (PDF 1.7, p.86):</span>

<span class="sd">    ...the effect shall be as if all of the streams in the array were</span>
<span class="sd">    concatenated, in order, to form a single stream.  Conforming</span>
<span class="sd">    writers can create image objects and other resources as they</span>
<span class="sd">    occur, even though they interrupt the content stream. The division</span>
<span class="sd">    between streams may occur only at the boundaries between lexical</span>
<span class="sd">    tokens (see 7.2, &quot;Lexical Conventions&quot;) but shall be unrelated to</span>
<span class="sd">    the page’s logical content or organization.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">streams</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">PDFObject</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">streamiter</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">streams</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">stream</span> <span class="o">=</span> <span class="n">stream_value</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">streamiter</span><span class="p">))</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">buffer</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Found non-stream in contents: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">streams</span><span class="p">)</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">nexttoken</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Token</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Override nexttoken() to continue parsing in subsequent streams.</span>

<span class="sd">        TODO: If we want to avoid evil implementation inheritance, we</span>
<span class="sd">        should do this in the lexer instead.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">nexttoken</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="c1"># Will also raise StopIteration if there are no more,</span>
                <span class="c1"># which is exactly what we want</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">ref</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">streamiter</span><span class="p">)</span>
                    <span class="n">stream</span> <span class="o">=</span> <span class="n">stream_value</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">newstream</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">buffer</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Found non-stream in contents: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ref</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="playa.parser.ContentParser.nexttoken" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">nexttoken</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Override nexttoken() to continue parsing in subsequent streams.</p>
<p>TODO: If we want to avoid evil implementation inheritance, we
should do this in the lexer instead.</p>

            <details class="quote">
              <summary>Source code in <code>playa/parser.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">nexttoken</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Token</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Override nexttoken() to continue parsing in subsequent streams.</span>

<span class="sd">    TODO: If we want to avoid evil implementation inheritance, we</span>
<span class="sd">    should do this in the lexer instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">nexttoken</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
            <span class="c1"># Will also raise StopIteration if there are no more,</span>
            <span class="c1"># which is exactly what we want</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ref</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">streamiter</span><span class="p">)</span>
                <span class="n">stream</span> <span class="o">=</span> <span class="n">stream_value</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">newstream</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">buffer</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Found non-stream in contents: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ref</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.parser.IndirectObjectParser" class="doc doc-heading">
            <code>IndirectObjectParser</code>


</h3>


    <div class="doc doc-contents ">


        <p>IndirectObjectParser fetches indirect objects from a data
stream.  It holds a weak reference to the document in order to
resolve indirect references.  If the document is deleted then this
will obviously no longer work.</p>
<p>Note that according to PDF 1.7 sec 7.5.3, "The body of a PDF file
shall consist of a sequence of indirect objects representing the
contents of a document."  Therefore unlike the base <code>ObjectParser</code>,
<code>IndirectObjectParser</code> returns <em>only</em> indrect objects and not bare
keywords, strings, numbers, etc.</p>
<p>However, unlike <code>ObjectParser</code>, it will also read and return
<code>ContentStream</code>s, as these <em>must</em> be indirect objects by definition.</p>


<details class="typical-usage" open>
  <summary>Typical usage</summary>
  <p>parser = IndirectObjectParser(fp, doc)
for object in parser:
    ...</p>
</details>





              <details class="quote">
                <summary>Source code in <code>playa/parser.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">IndirectObjectParser</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;IndirectObjectParser fetches indirect objects from a data</span>
<span class="sd">    stream.  It holds a weak reference to the document in order to</span>
<span class="sd">    resolve indirect references.  If the document is deleted then this</span>
<span class="sd">    will obviously no longer work.</span>

<span class="sd">    Note that according to PDF 1.7 sec 7.5.3, &quot;The body of a PDF file</span>
<span class="sd">    shall consist of a sequence of indirect objects representing the</span>
<span class="sd">    contents of a document.&quot;  Therefore unlike the base `ObjectParser`,</span>
<span class="sd">    `IndirectObjectParser` returns *only* indrect objects and not bare</span>
<span class="sd">    keywords, strings, numbers, etc.</span>

<span class="sd">    However, unlike `ObjectParser`, it will also read and return</span>
<span class="sd">    `ContentStream`s, as these *must* be indirect objects by definition.</span>

<span class="sd">    Typical usage:</span>
<span class="sd">      parser = IndirectObjectParser(fp, doc)</span>
<span class="sd">      for object in parser:</span>
<span class="sd">          ...</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="n">mmap</span><span class="o">.</span><span class="n">mmap</span><span class="p">],</span>
        <span class="n">doc</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Document&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">strict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span> <span class="o">=</span> <span class="n">ObjectParser</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">doc</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="n">strict</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objstack</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">PDFObject</span><span class="p">,</span> <span class="n">ContentStream</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">docref</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">doc</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_ref_document</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">strict</span> <span class="o">=</span> <span class="n">strict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decipher</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">doc</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">doc</span><span class="o">.</span><span class="n">decipher</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">doc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Document&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get associated document if it exists.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">docref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">_deref_document</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">docref</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">IndirectObject</span><span class="p">]]:</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">IndirectObject</span><span class="p">]:</span>
        <span class="n">obj</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">PDFObject</span><span class="p">,</span> <span class="n">ContentStream</span><span class="p">]</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">pos</span><span class="p">,</span> <span class="n">obj</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">PSKeyword</span><span class="p">)</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;endobj&quot;</span><span class="p">):</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_endobj</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">obj</span> <span class="ow">is</span> <span class="n">KEYWORD_STREAM</span><span class="p">:</span>
                    <span class="n">stream</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stream</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">objstack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pos</span><span class="p">,</span> <span class="n">stream</span><span class="p">))</span>
                <span class="k">elif</span> <span class="n">obj</span> <span class="ow">is</span> <span class="n">KEYWORD_ENDSTREAM</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objstack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">ContentStream</span><span class="p">):</span>
                        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Got endstream without a stream, ignoring!&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">PSKeyword</span><span class="p">)</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;endstream&quot;</span><span class="p">):</span>
                    <span class="c1"># Some broken PDFs have junk after &quot;endstream&quot;</span>
                    <span class="n">errmsg</span> <span class="o">=</span> <span class="s2">&quot;Expected &#39;endstream&#39;, got </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">obj</span><span class="p">,)</span>
                    <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">objstack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pos</span><span class="p">,</span> <span class="n">obj</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="k">raise</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">errmsg</span> <span class="o">=</span> <span class="s2">&quot;Syntax error near position </span><span class="si">%d</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
                    <span class="k">continue</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_endobj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">PDFObject</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">IndirectObject</span><span class="p">]:</span>
        <span class="c1"># Some broken PDFs omit the space after `endobj`...</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">KEYWORD_ENDOBJ</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;endobj&quot;</span><span class="p">))</span>
        <span class="c1"># objid genno &quot;obj&quot; (skipped) ... and the object</span>
        <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objstack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="p">(</span><span class="n">kpos</span><span class="p">,</span> <span class="n">kwd</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objstack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">kwd</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">KEYWORD_OBJ</span><span class="p">:</span>
            <span class="n">errmsg</span> <span class="o">=</span> <span class="s2">&quot;Expected &#39;obj&#39; at </span><span class="si">%d</span><span class="s2">, got </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">kpos</span><span class="p">,</span> <span class="n">kwd</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
        <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">genno</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objstack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="c1"># Update pos to be the beginning of the indirect object</span>
        <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">objid</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objstack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">objid</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">objid</span><span class="p">)</span>
            <span class="n">genno</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">genno</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">objs</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="nb">repr</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objstack</span><span class="p">),</span> <span class="p">(</span><span class="n">objid</span><span class="p">,</span> <span class="n">genno</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">errmsg</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Failed to parse indirect object at </span><span class="si">{</span><span class="n">pos</span><span class="si">}</span><span class="s2">: &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;got: </span><span class="si">{</span><span class="n">objs</span><span class="si">}</span><span class="s2"> &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;before &#39;endobj&#39;&quot;</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
        <span class="c1"># ContentStream is *special* and needs these</span>
        <span class="c1"># internally for decryption.</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">ContentStream</span><span class="p">):</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">objid</span> <span class="o">=</span> <span class="n">objid</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">genno</span> <span class="o">=</span> <span class="n">genno</span>
        <span class="c1"># Decrypt indirect objects at top level (inside object streams</span>
        <span class="c1"># they are handled by ObjectStreamParser)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">decipher</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pos</span><span class="p">,</span> <span class="n">IndirectObject</span><span class="p">(</span>
                <span class="n">objid</span><span class="p">,</span>
                <span class="n">genno</span><span class="p">,</span>
                <span class="n">decipher_all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decipher</span><span class="p">,</span> <span class="n">objid</span><span class="p">,</span> <span class="n">genno</span><span class="p">,</span> <span class="n">obj</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pos</span><span class="p">,</span> <span class="n">IndirectObject</span><span class="p">(</span><span class="n">objid</span><span class="p">,</span> <span class="n">genno</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_stream</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">PDFObject</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ContentStream</span><span class="p">:</span>
        <span class="c1"># PDF 1.7 sec 7.3.8.1: A stream shall consist of a</span>
        <span class="c1"># dictionary followed by zero or more bytes bracketed</span>
        <span class="c1"># between the keywords `stream` (followed by newline)</span>
        <span class="c1"># and `endstream`</span>
        <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">dic</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objstack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dic</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="c1"># sec 7.3.8.1: the stream dictionary shall be a</span>
            <span class="c1"># direct object.</span>
            <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span><span class="s2">&quot;Incorrect type for stream dictionary </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dic</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># sec 7.3.8.2: Every stream dictionary shall have</span>
            <span class="c1"># a Length entry that indicates how many bytes of</span>
            <span class="c1"># the PDF file are used for the stream’s data</span>
            <span class="c1"># FIXME: This call is **not** thread-safe as we currently</span>
            <span class="c1"># reuse the same IndirectObjectParser to resolve references</span>
            <span class="n">objlen</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="s2">&quot;Length&quot;</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;/Length is undefined in stream dictionary </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dic</span><span class="p">)</span>
            <span class="n">objlen</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="c1"># FIXME: This warning should be suppressed in fallback</span>
            <span class="c1"># xref parsing, since we obviously can&#39;t resolve any</span>
            <span class="c1"># references yet.  Either that or fallback xref parsing</span>
            <span class="c1"># should just run a regex over the PDF and not try to</span>
            <span class="c1"># actually parse the objects (probably a better solution)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;/Length reference cannot be resolved in </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dic</span><span class="p">)</span>
            <span class="n">objlen</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="c1"># FIXME: This may happen with incremental updates</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;/Length reference resolves to non-integer in </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dic</span><span class="p">)</span>
            <span class="n">objlen</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># sec 7.3.8.1: The keyword `stream` that follows the stream</span>
        <span class="c1"># dictionary shall be followed by an end-of-line</span>
        <span class="c1"># marker consisting of either a CARRIAGE RETURN and a</span>
        <span class="c1"># LINE FEED or just a LINE FEED, and not by a CARRIAGE</span>
        <span class="c1"># RETURN alone.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="o">.</span><span class="n">nextline</span><span class="p">()</span>
        <span class="k">assert</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&quot;stream&quot;</span>
        <span class="c1"># Because PDFs do not follow the spec, we will read</span>
        <span class="c1"># *at least* the specified number of bytes, which</span>
        <span class="c1"># could be zero (particularly if not specified!), up</span>
        <span class="c1"># until the &quot;endstream&quot; tag.  In most cases it is</span>
        <span class="c1"># expected that this extra data will be included in</span>
        <span class="c1"># the stream anyway, but for encrypted streams you</span>
        <span class="c1"># probably don&#39;t want that (LOL @ PDF &quot;security&quot;)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">objlen</span><span class="p">)</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc</span>
        <span class="n">decipher</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">doc</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">doc</span><span class="o">.</span><span class="n">decipher</span>
        <span class="c1"># sec 7.3.8.1: There should be an end-of-line marker after the</span>
        <span class="c1"># data and before endstream; this marker shall not be included</span>
        <span class="c1"># in the stream length.</span>
        <span class="c1">#</span>
        <span class="c1"># TRANSLATION: We expect either one of PDF&#39;s many end-of-line</span>
        <span class="c1"># markers, endstream, or EOL + endstream.  If we get something</span>
        <span class="c1"># else, it&#39;s an error in strict mode, otherwise, we throw it</span>
        <span class="c1"># on the pile and keep going.</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">ENDSTREAMR</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="o">.</span><span class="n">_lexer</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ContentStream</span><span class="p">(</span><span class="n">dic</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">decipher</span><span class="p">)</span>
        <span class="c1"># We already know it&#39;s an error in strict mode, but read the</span>
        <span class="c1"># line anyway to show the user what&#39;s wrong</span>
        <span class="n">pos</span><span class="p">,</span> <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="o">.</span><span class="n">nextline</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span><span class="s2">&quot;Expected newline or &#39;endstream&#39;, got </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
        <span class="c1"># Now glom on all the data until we see endstream</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="sa">b</span><span class="s2">&quot;endstream&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">idx</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;endstream&quot;</span><span class="p">)</span>
                <span class="n">data</span> <span class="o">+=</span> <span class="n">line</span><span class="p">[:</span><span class="n">idx</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="n">idx</span><span class="p">)</span>
                <span class="k">break</span>
            <span class="n">data</span> <span class="o">+=</span> <span class="n">line</span>
            <span class="n">pos</span><span class="p">,</span> <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="o">.</span><span class="n">nextline</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">:</span>  <span class="c1"># Means EOF</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Incorrect length for stream, no &#39;endstream&#39; found&quot;</span><span class="p">)</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="n">ContentStream</span><span class="p">(</span><span class="n">dic</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">decipher</span><span class="p">)</span>

    <span class="c1"># Delegation follows</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">seek</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Seek to a position.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear internal parser state.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="playa.parser.IndirectObjectParser.doc" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">doc</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Get associated document if it exists.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="playa.parser.IndirectObjectParser.reset" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reset</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Clear internal parser state.</p>

            <details class="quote">
              <summary>Source code in <code>playa/parser.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Clear internal parser state.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.parser.IndirectObjectParser.seek" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">seek</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Seek to a position.</p>

            <details class="quote">
              <summary>Source code in <code>playa/parser.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">seek</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Seek to a position.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.parser.Lexer" class="doc doc-heading">
            <code>Lexer</code>


</h3>


    <div class="doc doc-contents ">


        <p>Lexer for PDF data.</p>






              <details class="quote">
                <summary>Source code in <code>playa/parser.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Lexer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Lexer for PDF data.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="n">mmap</span><span class="o">.</span><span class="n">mmap</span><span class="p">],</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tokens</span><span class="p">:</span> <span class="n">Deque</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Token</span><span class="p">]]</span> <span class="o">=</span> <span class="n">deque</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">seek</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Seek to a position and reinitialize parser state.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_curtokenpos</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tokens</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">tell</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the current position in the buffer.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objlen</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Read data from current position, advancing to the end of</span>
<span class="sd">        this data.&quot;&quot;&quot;</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="n">objlen</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">pos</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">nextline</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Get the next line ending either with \r, \n, or \r\n,</span>
<span class="sd">        starting at the current position.&quot;&quot;&quot;</span>
        <span class="n">linepos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">EOLR</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">linepos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">linepos</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Token</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over tokens.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Token</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the next token in iteration, raising StopIteration when</span>
<span class="sd">        done.&quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">LEXER</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># can only happen at EOS</span>
                <span class="k">raise</span> <span class="ne">StopIteration</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_curtokenpos</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">lastgroup</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;whitespace&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">):</span>  <span class="c1"># type: ignore</span>
                <span class="c1"># Okay, we got a token or something</span>
                <span class="k">break</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">lastgroup</span> <span class="o">==</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span> <span class="o">=</span> <span class="n">HEXDIGIT</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">16</span><span class="p">),)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span>
            <span class="p">)</span>
            <span class="n">tok</span> <span class="o">=</span> <span class="n">LIT</span><span class="p">(</span><span class="n">name_str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span><span class="p">))</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_curtokenpos</span><span class="p">,</span> <span class="n">tok</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">lastgroup</span> <span class="o">==</span> <span class="s2">&quot;number&quot;</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
            <span class="k">if</span> <span class="sa">b</span><span class="s2">&quot;.&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_curtokenpos</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_curtokenpos</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">lastgroup</span> <span class="o">==</span> <span class="s2">&quot;startdict&quot;</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_curtokenpos</span><span class="p">,</span> <span class="n">KEYWORD_DICT_BEGIN</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">lastgroup</span> <span class="o">==</span> <span class="s2">&quot;enddict&quot;</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_curtokenpos</span><span class="p">,</span> <span class="n">KEYWORD_DICT_END</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">lastgroup</span> <span class="o">==</span> <span class="s2">&quot;startstr&quot;</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_endstr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">end</span><span class="p">()],</span> <span class="n">m</span><span class="o">.</span><span class="n">end</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">lastgroup</span> <span class="o">==</span> <span class="s2">&quot;hexstr&quot;</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span> <span class="o">=</span> <span class="n">SPC</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;0&quot;</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_curtokenpos</span><span class="p">,</span> <span class="n">unhexlify</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span><span class="p">))</span>
        <span class="c1"># Anything else is treated as a keyword (whether explicitly matched or not)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&quot;true&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_curtokenpos</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&quot;false&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_curtokenpos</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_curtokenpos</span><span class="p">,</span> <span class="n">KWD</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_parse_endstr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Token</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse the remainder of a string.&quot;&quot;&quot;</span>
        <span class="c1"># Handle nonsense CRLF conversion in strings (PDF 1.7, p.15)</span>
        <span class="n">parts</span> <span class="o">=</span> <span class="p">[</span><span class="n">EOLR</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">start</span><span class="p">)]</span>
        <span class="n">paren</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">STRLEXER</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">lastgroup</span> <span class="o">==</span> <span class="s2">&quot;parenright&quot;</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
                <span class="n">paren</span> <span class="o">-=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">paren</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># By far the most common situation!</span>
                    <span class="k">break</span>
                <span class="n">parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">m</span><span class="o">.</span><span class="n">lastgroup</span> <span class="o">==</span> <span class="s2">&quot;parenleft&quot;</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
                <span class="n">parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">paren</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">m</span><span class="o">.</span><span class="n">lastgroup</span> <span class="o">==</span> <span class="s2">&quot;escape&quot;</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
                <span class="nb">chr</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">chr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ESC_STRING</span><span class="p">:</span>
                    <span class="c1"># PDF 1.7 sec 7.3.4.2: If the character following</span>
                    <span class="c1"># the REVERSE SOLIDUS is not one of those shown in</span>
                    <span class="c1"># Table 3, the REVERSE SOLIDUS shall be ignored.</span>
                    <span class="n">parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">bytes</span><span class="p">((</span><span class="n">ESC_STRING</span><span class="p">[</span><span class="nb">chr</span><span class="p">],)))</span>
            <span class="k">elif</span> <span class="n">m</span><span class="o">.</span><span class="n">lastgroup</span> <span class="o">==</span> <span class="s2">&quot;octal&quot;</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
                <span class="n">chrcode</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="mi">8</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">chrcode</span> <span class="o">&gt;=</span> <span class="mi">256</span><span class="p">:</span>
                    <span class="c1"># PDF1.7 p.16: &quot;high-order overflow shall be</span>
                    <span class="c1"># ignored.&quot;</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Invalid octal </span><span class="si">%r</span><span class="s2"> (</span><span class="si">%d</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">chrcode</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">bytes</span><span class="p">((</span><span class="n">chrcode</span><span class="p">,)))</span>
            <span class="k">elif</span> <span class="n">m</span><span class="o">.</span><span class="n">lastgroup</span> <span class="o">==</span> <span class="s2">&quot;newline&quot;</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
                <span class="c1"># Handle nonsense CRLF conversion in strings (PDF 1.7, p.15)</span>
                <span class="n">parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">m</span><span class="o">.</span><span class="n">lastgroup</span> <span class="o">==</span> <span class="s2">&quot;linebreak&quot;</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">paren</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Unterminated string at </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">StopIteration</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_curtokenpos</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parts</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="playa.parser.Lexer.__iter__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__iter__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Iterate over tokens.</p>

            <details class="quote">
              <summary>Source code in <code>playa/parser.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Token</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterate over tokens.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.parser.Lexer.__next__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__next__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get the next token in iteration, raising StopIteration when
done.</p>

            <details class="quote">
              <summary>Source code in <code>playa/parser.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Token</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the next token in iteration, raising StopIteration when</span>
<span class="sd">    done.&quot;&quot;&quot;</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">LEXER</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># can only happen at EOS</span>
            <span class="k">raise</span> <span class="ne">StopIteration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_curtokenpos</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">lastgroup</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;whitespace&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">):</span>  <span class="c1"># type: ignore</span>
            <span class="c1"># Okay, we got a token or something</span>
            <span class="k">break</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">lastgroup</span> <span class="o">==</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span> <span class="o">=</span> <span class="n">HEXDIGIT</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">16</span><span class="p">),)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span>
        <span class="p">)</span>
        <span class="n">tok</span> <span class="o">=</span> <span class="n">LIT</span><span class="p">(</span><span class="n">name_str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_curtokenpos</span><span class="p">,</span> <span class="n">tok</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">lastgroup</span> <span class="o">==</span> <span class="s2">&quot;number&quot;</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
        <span class="k">if</span> <span class="sa">b</span><span class="s2">&quot;.&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_curtokenpos</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_curtokenpos</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">lastgroup</span> <span class="o">==</span> <span class="s2">&quot;startdict&quot;</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_curtokenpos</span><span class="p">,</span> <span class="n">KEYWORD_DICT_BEGIN</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">lastgroup</span> <span class="o">==</span> <span class="s2">&quot;enddict&quot;</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_curtokenpos</span><span class="p">,</span> <span class="n">KEYWORD_DICT_END</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">lastgroup</span> <span class="o">==</span> <span class="s2">&quot;startstr&quot;</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_endstr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">end</span><span class="p">()],</span> <span class="n">m</span><span class="o">.</span><span class="n">end</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">lastgroup</span> <span class="o">==</span> <span class="s2">&quot;hexstr&quot;</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span> <span class="o">=</span> <span class="n">SPC</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;0&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_curtokenpos</span><span class="p">,</span> <span class="n">unhexlify</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span><span class="p">))</span>
    <span class="c1"># Anything else is treated as a keyword (whether explicitly matched or not)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&quot;true&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_curtokenpos</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&quot;false&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_curtokenpos</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_curtokenpos</span><span class="p">,</span> <span class="n">KWD</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.parser.Lexer.nextline" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">nextline</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get the next line ending either with \r, \n, or \r\n,
starting at the current position.</p>

            <details class="quote">
              <summary>Source code in <code>playa/parser.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">nextline</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Get the next line ending either with \r, \n, or \r\n,</span>
<span class="sd">    starting at the current position.&quot;&quot;&quot;</span>
    <span class="n">linepos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">EOLR</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">linepos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">linepos</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.parser.Lexer.read" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read</span><span class="p">(</span><span class="n">objlen</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Read data from current position, advancing to the end of
this data.</p>

            <details class="quote">
              <summary>Source code in <code>playa/parser.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objlen</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read data from current position, advancing to the end of</span>
<span class="sd">    this data.&quot;&quot;&quot;</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="n">objlen</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">pos</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.parser.Lexer.seek" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">seek</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Seek to a position and reinitialize parser state.</p>

            <details class="quote">
              <summary>Source code in <code>playa/parser.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">seek</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Seek to a position and reinitialize parser state.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_curtoken</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_curtokenpos</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_tokens</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.parser.Lexer.tell" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tell</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get the current position in the buffer.</p>

            <details class="quote">
              <summary>Source code in <code>playa/parser.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">tell</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the current position in the buffer.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.parser.ObjectParser" class="doc doc-heading">
            <code>ObjectParser</code>


</h3>


    <div class="doc doc-contents ">


        <p>ObjectParser is used to parse PDF object streams (and
content streams, which have the same syntax).  Notably these
consist of, well, a stream of objects without the surrounding
<code>obj</code> and <code>endobj</code> tokens (which cannot occur in an object
stream).</p>
<p>They can contain indirect object references (so, must be
initialized with a <code>Document</code> to resolve these) but for perhaps
obvious reasons (how would you parse that) these cannot occur at
the top level of the stream, only inside an array or dictionary.</p>






              <details class="quote">
                <summary>Source code in <code>playa/parser.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ObjectParser</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ObjectParser is used to parse PDF object streams (and</span>
<span class="sd">    content streams, which have the same syntax).  Notably these</span>
<span class="sd">    consist of, well, a stream of objects without the surrounding</span>
<span class="sd">    `obj` and `endobj` tokens (which cannot occur in an object</span>
<span class="sd">    stream).</span>

<span class="sd">    They can contain indirect object references (so, must be</span>
<span class="sd">    initialized with a `Document` to resolve these) but for perhaps</span>
<span class="sd">    obvious reasons (how would you parse that) these cannot occur at</span>
<span class="sd">    the top level of the stream, only inside an array or dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="n">mmap</span><span class="o">.</span><span class="n">mmap</span><span class="p">],</span>
        <span class="n">doc</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Document&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">strict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lexer</span> <span class="o">=</span> <span class="n">Lexer</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">StackEntry</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">docref</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">doc</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_ref_document</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">strict</span> <span class="o">=</span> <span class="n">strict</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">doc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Document&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get associated document if it exists.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">docref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">_deref_document</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">docref</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">newstream</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="n">mmap</span><span class="o">.</span><span class="n">mmap</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Continue parsing from a new data stream.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lexer</span> <span class="o">=</span> <span class="n">Lexer</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear internal parser state.&quot;&quot;&quot;</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">[:]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">StackEntry</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over (position, object) tuples.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StackEntry</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get next PDF object from stream (raises StopIteration at EOF).&quot;&quot;&quot;</span>
        <span class="n">top</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">obj</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">PDFObject</span><span class="p">],</span> <span class="n">PDFObject</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span> <span class="ow">and</span> <span class="n">top</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nexttoken</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">token</span> <span class="ow">is</span> <span class="n">KEYWORD_ARRAY_BEGIN</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">top</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">top</span> <span class="o">=</span> <span class="n">pos</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pos</span><span class="p">,</span> <span class="n">token</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">token</span> <span class="ow">is</span> <span class="n">KEYWORD_ARRAY_END</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">pos</span><span class="p">,</span> <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pop_to</span><span class="p">(</span><span class="n">KEYWORD_ARRAY_BEGIN</span><span class="p">)</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">PDFSyntaxError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">e</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;When constructing array from </span><span class="si">%r</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">pos</span> <span class="o">==</span> <span class="n">top</span><span class="p">:</span>
                    <span class="n">top</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">return</span> <span class="n">pos</span><span class="p">,</span> <span class="n">obj</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pos</span><span class="p">,</span> <span class="n">obj</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">token</span> <span class="ow">is</span> <span class="n">KEYWORD_DICT_BEGIN</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">top</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">top</span> <span class="o">=</span> <span class="n">pos</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pos</span><span class="p">,</span> <span class="n">token</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">token</span> <span class="ow">is</span> <span class="n">KEYWORD_DICT_END</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">objs</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pop_to</span><span class="p">(</span><span class="n">KEYWORD_DICT_BEGIN</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">objs</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">error_msg</span> <span class="o">=</span> <span class="p">(</span>
                            <span class="s2">&quot;Dictionary contains odd number of objects: </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">objs</span>
                        <span class="p">)</span>
                        <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>
                    <span class="n">obj</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="n">literal_name</span><span class="p">(</span><span class="n">k</span><span class="p">):</span> <span class="n">v</span>
                        <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">choplist</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">objs</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                    <span class="p">}</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">PDFSyntaxError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">e</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;When constructing dict from </span><span class="si">%r</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">pos</span> <span class="o">==</span> <span class="n">top</span><span class="p">:</span>
                    <span class="n">top</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">return</span> <span class="n">pos</span><span class="p">,</span> <span class="n">obj</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pos</span><span class="p">,</span> <span class="n">obj</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">token</span> <span class="ow">is</span> <span class="n">KEYWORD_PROC_BEGIN</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">top</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">top</span> <span class="o">=</span> <span class="n">pos</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pos</span><span class="p">,</span> <span class="n">token</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">token</span> <span class="ow">is</span> <span class="n">KEYWORD_PROC_END</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">pos</span><span class="p">,</span> <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pop_to</span><span class="p">(</span><span class="n">KEYWORD_PROC_BEGIN</span><span class="p">)</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">PDFSyntaxError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">e</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;When constructing proc from </span><span class="si">%r</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">pos</span> <span class="o">==</span> <span class="n">top</span><span class="p">:</span>
                    <span class="n">top</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">return</span> <span class="n">pos</span><span class="p">,</span> <span class="n">obj</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pos</span><span class="p">,</span> <span class="n">obj</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">token</span> <span class="ow">is</span> <span class="n">KEYWORD_NULL</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pos</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">token</span> <span class="ow">is</span> <span class="n">KEYWORD_R</span><span class="p">:</span>
                <span class="c1"># reference to indirect object (only allowed inside another object)</span>
                <span class="k">if</span> <span class="n">top</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Ignoring indirect object reference at top level&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pos</span><span class="p">,</span> <span class="n">token</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_object_reference</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pos</span><span class="p">,</span> <span class="n">obj</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">token</span> <span class="ow">is</span> <span class="n">KEYWORD_BI</span><span class="p">:</span>
                <span class="c1"># Inline images must occur at the top level, otherwise</span>
                <span class="c1"># something is wrong (probably a corrupt file)</span>
                <span class="k">if</span> <span class="n">top</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span>
                        <span class="s2">&quot;Inline image not at top level of stream &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">pos</span><span class="si">}</span><span class="s2"> != </span><span class="si">{</span><span class="n">top</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="si">}</span><span class="s2">)&quot;</span>
                    <span class="p">)</span>
                <span class="n">top</span> <span class="o">=</span> <span class="n">pos</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pos</span><span class="p">,</span> <span class="n">token</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">token</span> <span class="ow">is</span> <span class="n">KEYWORD_ID</span><span class="p">:</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_inline_image</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">top</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">return</span> <span class="n">pos</span><span class="p">,</span> <span class="n">obj</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Literally anything else, including any other keyword</span>
                <span class="c1"># (will be returned above if top is None, or later if</span>
                <span class="c1"># we are inside some object)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pos</span><span class="p">,</span> <span class="n">token</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">pop_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="p">:</span> <span class="n">PSKeyword</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">PDFObject</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Pop everything from the stack back to token.&quot;&quot;&quot;</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PDFObject</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">:</span>
            <span class="n">pos</span><span class="p">,</span> <span class="n">last</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">last</span> <span class="ow">is</span> <span class="n">token</span><span class="p">:</span>
                <span class="n">context</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
                <span class="k">return</span> <span class="n">pos</span><span class="p">,</span> <span class="n">context</span>
            <span class="n">context</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">last</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unmatched end token </span><span class="si">{</span><span class="n">token</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_object_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">token</span><span class="p">:</span> <span class="n">Token</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">ObjRef</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get an indirect object reference upon finding an &quot;R&quot; token.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_pos</span><span class="p">,</span> <span class="n">_genno</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="n">_pos</span><span class="p">,</span> <span class="n">objid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span>
                    <span class="s2">&quot;Expected generation and object id in indirect object reference&quot;</span>
                <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;Expected generation and object id in indirect object reference: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">e</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">objid</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">objid</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">objid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span>
                    <span class="s2">&quot;Object ID in reference at pos </span><span class="si">%d</span><span class="s2"> cannot be 0&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pos</span><span class="p">,)</span>
                <span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Ignoring indirect object reference to 0 at </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">ObjRef</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">docref</span><span class="p">,</span> <span class="n">objid</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_inline_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">token</span><span class="p">:</span> <span class="n">Token</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">InlineImage</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get an inline image upon finding an &quot;ID&quot; token.</span>

<span class="sd">        Returns a tuple of the position of the target in the data and</span>
<span class="sd">        the image data.  Advances the file pointer to a position after</span>
<span class="sd">        the &quot;EI&quot; token that (we hope) ends the image.</span>

<span class="sd">        Note: WELCOME IN THE HELL!!!</span>
<span class="sd">            If you&#39;re lucky enough to have PDF 2.0 documents, then you</span>
<span class="sd">            can skip this, you aren&#39;t actually in (the) hell.  Otherwise</span>
<span class="sd">            read on to know why you might be missng images or reading</span>
<span class="sd">            a lot of garbage in your logs:</span>

<span class="sd">            - The PDF 1.7 standard only specifies that image data must be</span>
<span class="sd">              delimited by `ID` and `EI`, and that &quot;The bytes between</span>
<span class="sd">              the `ID` and `EI` operators shall be treated the same as a</span>
<span class="sd">              stream object’s data, even though they do not follow the</span>
<span class="sd">              standard stream syntax.&quot;  What does that even mean?</span>
<span class="sd">            - And, that must be &quot;a single whitespace character&quot;</span>
<span class="sd">              following `ID` (floating in perfume, served in a man&#39;s</span>
<span class="sd">              hat), except in the case of `ASCIIHexDecode` or</span>
<span class="sd">              `ASCII85Decode` (in which case there can just be any</span>
<span class="sd">              whitespace you like, or none at all).</span>
<span class="sd">            - It&#39;s obviously impossible to determine what a &quot;conforming</span>
<span class="sd">              implementation&quot; of this should do.</span>

<span class="sd">            In the easiest case, if it&#39;s `ASCIIHexDecode` data then we</span>
<span class="sd">            can just look for the first instance of `b&quot;EI&quot;`, ignoring all</span>
<span class="sd">            whitespace, since `b&quot;EI&quot;` is thankfully not a valid hex</span>
<span class="sd">            sequence.</span>

<span class="sd">            Otherwise, the stream data can, and inevitably will,</span>
<span class="sd">            contain the literal bytes `b&quot;EI&quot;`, so no, we can&#39;t just</span>
<span class="sd">            search for that.  In the case of `ASCII85Decode`, however,</span>
<span class="sd">            you can look for the `b&quot;~&gt;&quot;` end-of-data sequence but note</span>
<span class="sd">            that sometimes it... contains whitespace!</span>

<span class="sd">            So, we try for `b&quot;\\sEI\\b&quot;`, which is not foolproof since</span>
<span class="sd">            you could have the pixel values `(32, 69, 73)` in your</span>
<span class="sd">            image followed by some other byte... so in that case,</span>
<span class="sd">            expect a bunch of nonsense in the logs and possible data</span>
<span class="sd">            loss.  Also in the rare case where `b&quot;EI&quot;` was preceded by</span>
<span class="sd">            `b&quot;\\r\\n&quot;`, there will be an extra `\\r` in the image</span>
<span class="sd">            data.  Too bad.</span>

<span class="sd">            And finally if that doesn&#39;t work then we will try to salvage</span>
<span class="sd">            something by just looking for &quot;EI&quot;, somewhere, anywhere.  We</span>
<span class="sd">            take the most distant one, and if this causes you to lose</span>
<span class="sd">            data, well, it&#39;s definitely Adobe&#39;s fault.</span>

<span class="sd">            There **is** an absolutely foolproof way to parse inline</span>
<span class="sd">            images, but it&#39;s ridiculous so we won&#39;t do it:</span>

<span class="sd">            1. Find the very first instance of `b&quot;EI&quot;`.</span>
<span class="sd">            2. Extract the image itself (which could be in various formats).</span>
<span class="sd">            3. If it&#39;s a valid image, congratulations!  Otherwise try again.</span>

<span class="sd">            The moral of the story is that the author of this part of</span>
<span class="sd">            the PDF specification should have considered a career in</span>
<span class="sd">            literally anything else.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">PSKeyword</span><span class="p">)</span> <span class="ow">and</span> <span class="n">token</span> <span class="ow">is</span> <span class="n">KEYWORD_ID</span>
        <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Not ID: </span><span class="si">{</span><span class="n">token</span><span class="si">!r}</span><span class="s2">&quot;</span>
        <span class="n">idpos</span> <span class="o">=</span> <span class="n">pos</span>
        <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">objs</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pop_to</span><span class="p">(</span><span class="n">KEYWORD_BI</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">objs</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">error_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Invalid dictionary construct: </span><span class="si">{</span><span class="n">objs</span><span class="si">!r}</span><span class="s2">&quot;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>
        <span class="n">dic</span> <span class="o">=</span> <span class="p">{</span><span class="n">literal_name</span><span class="p">(</span><span class="n">k</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">choplist</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">objs</span><span class="p">)</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">}</span>

        <span class="n">target_re</span> <span class="o">=</span> <span class="n">EIR</span>
        <span class="n">whitespace_re</span> <span class="o">=</span> <span class="n">SPC</span>
        <span class="c1"># Final filter is actually the *first* in the list</span>
        <span class="n">final_filter</span> <span class="o">=</span> <span class="n">dic</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="n">dic</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Filter&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">final_filter</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="n">final_filter</span><span class="p">:</span>
            <span class="n">final_filter</span> <span class="o">=</span> <span class="n">final_filter</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">final_filter</span> <span class="ow">in</span> <span class="n">LITERALS_ASCII85_DECODE</span><span class="p">:</span>
            <span class="c1"># ASCII85: look for ~&gt;EI, ignoring all whitespace</span>
            <span class="n">whitespace_re</span> <span class="o">=</span> <span class="n">WSR</span>
            <span class="n">target_re</span> <span class="o">=</span> <span class="n">A85R</span>
        <span class="k">elif</span> <span class="n">final_filter</span> <span class="ow">in</span> <span class="n">LITERALS_ASCIIHEX_DECODE</span><span class="p">:</span>
            <span class="c1"># ASCIIHex: just look for EI</span>
            <span class="n">whitespace_re</span> <span class="o">=</span> <span class="n">WSR</span>
            <span class="n">target_re</span> <span class="o">=</span> <span class="n">EIEIR</span>

        <span class="c1"># Find the start of the image data by skipping the appropriate</span>
        <span class="c1"># amount of whitespace.  In the case of ASCII filters, we need</span>
        <span class="c1"># to skip any extra whitespace before we use a possible Length</span>
        <span class="c1"># value (this is very dumb but the standard says...)</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">idpos</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lexer</span><span class="o">.</span><span class="n">data</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">whitespace_re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Note that WSR will also match nothing</span>
            <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ID token at </span><span class="si">{</span><span class="n">pos</span><span class="si">}</span><span class="s2"> not followed by whitespace&quot;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># If you have Length, you have everything</span>
        <span class="n">length</span> <span class="o">=</span> <span class="n">dic</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">,</span> <span class="n">dic</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Length&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">pos</span> <span class="o">+</span> <span class="n">int_value</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">end</span><span class="p">)</span>
            <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nexttoken</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">KEYWORD_EI</span><span class="p">:</span>
                <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;EI not found after Length </span><span class="si">{</span><span class="n">length</span><span class="si">!r}</span><span class="s2">&quot;</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">InlineImage</span><span class="p">(</span><span class="n">dic</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">pos</span><span class="p">:</span><span class="n">end</span><span class="p">])</span>

        <span class="n">m</span> <span class="o">=</span> <span class="n">target_re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">InlineImage</span><span class="p">(</span><span class="n">dic</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">pos</span> <span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">0</span><span class="p">)])</span>
        <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Inline image at </span><span class="si">{</span><span class="n">pos</span><span class="si">}</span><span class="s2"> not terminated with </span><span class="si">{</span><span class="n">target_re</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>

        <span class="n">m</span> <span class="o">=</span> <span class="n">FURTHESTEIR</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Inline image at </span><span class="si">%d</span><span class="s2"> has no whitespace before EI, &quot;</span>
                <span class="s2">&quot;expect horrible data loss!!!&quot;</span><span class="p">,</span>
                <span class="n">pos</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">InlineImage</span><span class="p">(</span><span class="n">dic</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">pos</span> <span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">])</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="c1"># Delegation follows</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">seek</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Seek to a position.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lexer</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">tell</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the current position in the file.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lexer</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objlen</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Read data from a specified position, moving the current</span>
<span class="sd">        position to the end of this data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lexer</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">objlen</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">nextline</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Read (and do not parse) next line from underlying data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lexer</span><span class="o">.</span><span class="n">nextline</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">nexttoken</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Token</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the next token in iteration, raising StopIteration when</span>
<span class="sd">        done.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_lexer</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="playa.parser.ObjectParser.doc" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">doc</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Get associated document if it exists.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="playa.parser.ObjectParser.__iter__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__iter__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Iterate over (position, object) tuples.</p>

            <details class="quote">
              <summary>Source code in <code>playa/parser.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">StackEntry</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterate over (position, object) tuples.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.parser.ObjectParser.__next__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__next__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get next PDF object from stream (raises StopIteration at EOF).</p>

            <details class="quote">
              <summary>Source code in <code>playa/parser.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StackEntry</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get next PDF object from stream (raises StopIteration at EOF).&quot;&quot;&quot;</span>
    <span class="n">top</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">PDFObject</span><span class="p">],</span> <span class="n">PDFObject</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span> <span class="ow">and</span> <span class="n">top</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nexttoken</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">token</span> <span class="ow">is</span> <span class="n">KEYWORD_ARRAY_BEGIN</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">top</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">top</span> <span class="o">=</span> <span class="n">pos</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pos</span><span class="p">,</span> <span class="n">token</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">token</span> <span class="ow">is</span> <span class="n">KEYWORD_ARRAY_END</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">pos</span><span class="p">,</span> <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pop_to</span><span class="p">(</span><span class="n">KEYWORD_ARRAY_BEGIN</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">PDFSyntaxError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">e</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;When constructing array from </span><span class="si">%r</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">pos</span> <span class="o">==</span> <span class="n">top</span><span class="p">:</span>
                <span class="n">top</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">return</span> <span class="n">pos</span><span class="p">,</span> <span class="n">obj</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pos</span><span class="p">,</span> <span class="n">obj</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">token</span> <span class="ow">is</span> <span class="n">KEYWORD_DICT_BEGIN</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">top</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">top</span> <span class="o">=</span> <span class="n">pos</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pos</span><span class="p">,</span> <span class="n">token</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">token</span> <span class="ow">is</span> <span class="n">KEYWORD_DICT_END</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">objs</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pop_to</span><span class="p">(</span><span class="n">KEYWORD_DICT_BEGIN</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">objs</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">error_msg</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="s2">&quot;Dictionary contains odd number of objects: </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">objs</span>
                    <span class="p">)</span>
                    <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="n">literal_name</span><span class="p">(</span><span class="n">k</span><span class="p">):</span> <span class="n">v</span>
                    <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">choplist</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">objs</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="p">}</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">PDFSyntaxError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">e</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;When constructing dict from </span><span class="si">%r</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">pos</span> <span class="o">==</span> <span class="n">top</span><span class="p">:</span>
                <span class="n">top</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">return</span> <span class="n">pos</span><span class="p">,</span> <span class="n">obj</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pos</span><span class="p">,</span> <span class="n">obj</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">token</span> <span class="ow">is</span> <span class="n">KEYWORD_PROC_BEGIN</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">top</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">top</span> <span class="o">=</span> <span class="n">pos</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pos</span><span class="p">,</span> <span class="n">token</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">token</span> <span class="ow">is</span> <span class="n">KEYWORD_PROC_END</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">pos</span><span class="p">,</span> <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pop_to</span><span class="p">(</span><span class="n">KEYWORD_PROC_BEGIN</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">PDFSyntaxError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">e</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;When constructing proc from </span><span class="si">%r</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">pos</span> <span class="o">==</span> <span class="n">top</span><span class="p">:</span>
                <span class="n">top</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">return</span> <span class="n">pos</span><span class="p">,</span> <span class="n">obj</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pos</span><span class="p">,</span> <span class="n">obj</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">token</span> <span class="ow">is</span> <span class="n">KEYWORD_NULL</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pos</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">token</span> <span class="ow">is</span> <span class="n">KEYWORD_R</span><span class="p">:</span>
            <span class="c1"># reference to indirect object (only allowed inside another object)</span>
            <span class="k">if</span> <span class="n">top</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Ignoring indirect object reference at top level&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pos</span><span class="p">,</span> <span class="n">token</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_object_reference</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pos</span><span class="p">,</span> <span class="n">obj</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">token</span> <span class="ow">is</span> <span class="n">KEYWORD_BI</span><span class="p">:</span>
            <span class="c1"># Inline images must occur at the top level, otherwise</span>
            <span class="c1"># something is wrong (probably a corrupt file)</span>
            <span class="k">if</span> <span class="n">top</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span>
                    <span class="s2">&quot;Inline image not at top level of stream &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">pos</span><span class="si">}</span><span class="s2"> != </span><span class="si">{</span><span class="n">top</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="si">}</span><span class="s2">)&quot;</span>
                <span class="p">)</span>
            <span class="n">top</span> <span class="o">=</span> <span class="n">pos</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pos</span><span class="p">,</span> <span class="n">token</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">token</span> <span class="ow">is</span> <span class="n">KEYWORD_ID</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_inline_image</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">top</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">return</span> <span class="n">pos</span><span class="p">,</span> <span class="n">obj</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Literally anything else, including any other keyword</span>
            <span class="c1"># (will be returned above if top is None, or later if</span>
            <span class="c1"># we are inside some object)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pos</span><span class="p">,</span> <span class="n">token</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.parser.ObjectParser.get_inline_image" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_inline_image</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get an inline image upon finding an "ID" token.</p>
<p>Returns a tuple of the position of the target in the data and
the image data.  Advances the file pointer to a position after
the "EI" token that (we hope) ends the image.</p>


<details class="note" open>
  <summary>WELCOME IN THE HELL!!!</summary>
  <p>If you're lucky enough to have PDF 2.0 documents, then you
can skip this, you aren't actually in (the) hell.  Otherwise
read on to know why you might be missng images or reading
a lot of garbage in your logs:</p>
<ul>
<li>The PDF 1.7 standard only specifies that image data must be
  delimited by <code>ID</code> and <code>EI</code>, and that "The bytes between
  the <code>ID</code> and <code>EI</code> operators shall be treated the same as a
  stream object’s data, even though they do not follow the
  standard stream syntax."  What does that even mean?</li>
<li>And, that must be "a single whitespace character"
  following <code>ID</code> (floating in perfume, served in a man's
  hat), except in the case of <code>ASCIIHexDecode</code> or
  <code>ASCII85Decode</code> (in which case there can just be any
  whitespace you like, or none at all).</li>
<li>It's obviously impossible to determine what a "conforming
  implementation" of this should do.</li>
</ul>
<p>In the easiest case, if it's <code>ASCIIHexDecode</code> data then we
can just look for the first instance of <code>b"EI"</code>, ignoring all
whitespace, since <code>b"EI"</code> is thankfully not a valid hex
sequence.</p>
<p>Otherwise, the stream data can, and inevitably will,
contain the literal bytes <code>b"EI"</code>, so no, we can't just
search for that.  In the case of <code>ASCII85Decode</code>, however,
you can look for the <code>b"~&gt;"</code> end-of-data sequence but note
that sometimes it... contains whitespace!</p>
<p>So, we try for <code>b"\sEI\b"</code>, which is not foolproof since
you could have the pixel values <code>(32, 69, 73)</code> in your
image followed by some other byte... so in that case,
expect a bunch of nonsense in the logs and possible data
loss.  Also in the rare case where <code>b"EI"</code> was preceded by
<code>b"\r\n"</code>, there will be an extra <code>\r</code> in the image
data.  Too bad.</p>
<p>And finally if that doesn't work then we will try to salvage
something by just looking for "EI", somewhere, anywhere.  We
take the most distant one, and if this causes you to lose
data, well, it's definitely Adobe's fault.</p>
<p>There <strong>is</strong> an absolutely foolproof way to parse inline
images, but it's ridiculous so we won't do it:</p>
<ol>
<li>Find the very first instance of <code>b"EI"</code>.</li>
<li>Extract the image itself (which could be in various formats).</li>
<li>If it's a valid image, congratulations!  Otherwise try again.</li>
</ol>
<p>The moral of the story is that the author of this part of
the PDF specification should have considered a career in
literally anything else.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>playa/parser.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_inline_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">token</span><span class="p">:</span> <span class="n">Token</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">InlineImage</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get an inline image upon finding an &quot;ID&quot; token.</span>

<span class="sd">    Returns a tuple of the position of the target in the data and</span>
<span class="sd">    the image data.  Advances the file pointer to a position after</span>
<span class="sd">    the &quot;EI&quot; token that (we hope) ends the image.</span>

<span class="sd">    Note: WELCOME IN THE HELL!!!</span>
<span class="sd">        If you&#39;re lucky enough to have PDF 2.0 documents, then you</span>
<span class="sd">        can skip this, you aren&#39;t actually in (the) hell.  Otherwise</span>
<span class="sd">        read on to know why you might be missng images or reading</span>
<span class="sd">        a lot of garbage in your logs:</span>

<span class="sd">        - The PDF 1.7 standard only specifies that image data must be</span>
<span class="sd">          delimited by `ID` and `EI`, and that &quot;The bytes between</span>
<span class="sd">          the `ID` and `EI` operators shall be treated the same as a</span>
<span class="sd">          stream object’s data, even though they do not follow the</span>
<span class="sd">          standard stream syntax.&quot;  What does that even mean?</span>
<span class="sd">        - And, that must be &quot;a single whitespace character&quot;</span>
<span class="sd">          following `ID` (floating in perfume, served in a man&#39;s</span>
<span class="sd">          hat), except in the case of `ASCIIHexDecode` or</span>
<span class="sd">          `ASCII85Decode` (in which case there can just be any</span>
<span class="sd">          whitespace you like, or none at all).</span>
<span class="sd">        - It&#39;s obviously impossible to determine what a &quot;conforming</span>
<span class="sd">          implementation&quot; of this should do.</span>

<span class="sd">        In the easiest case, if it&#39;s `ASCIIHexDecode` data then we</span>
<span class="sd">        can just look for the first instance of `b&quot;EI&quot;`, ignoring all</span>
<span class="sd">        whitespace, since `b&quot;EI&quot;` is thankfully not a valid hex</span>
<span class="sd">        sequence.</span>

<span class="sd">        Otherwise, the stream data can, and inevitably will,</span>
<span class="sd">        contain the literal bytes `b&quot;EI&quot;`, so no, we can&#39;t just</span>
<span class="sd">        search for that.  In the case of `ASCII85Decode`, however,</span>
<span class="sd">        you can look for the `b&quot;~&gt;&quot;` end-of-data sequence but note</span>
<span class="sd">        that sometimes it... contains whitespace!</span>

<span class="sd">        So, we try for `b&quot;\\sEI\\b&quot;`, which is not foolproof since</span>
<span class="sd">        you could have the pixel values `(32, 69, 73)` in your</span>
<span class="sd">        image followed by some other byte... so in that case,</span>
<span class="sd">        expect a bunch of nonsense in the logs and possible data</span>
<span class="sd">        loss.  Also in the rare case where `b&quot;EI&quot;` was preceded by</span>
<span class="sd">        `b&quot;\\r\\n&quot;`, there will be an extra `\\r` in the image</span>
<span class="sd">        data.  Too bad.</span>

<span class="sd">        And finally if that doesn&#39;t work then we will try to salvage</span>
<span class="sd">        something by just looking for &quot;EI&quot;, somewhere, anywhere.  We</span>
<span class="sd">        take the most distant one, and if this causes you to lose</span>
<span class="sd">        data, well, it&#39;s definitely Adobe&#39;s fault.</span>

<span class="sd">        There **is** an absolutely foolproof way to parse inline</span>
<span class="sd">        images, but it&#39;s ridiculous so we won&#39;t do it:</span>

<span class="sd">        1. Find the very first instance of `b&quot;EI&quot;`.</span>
<span class="sd">        2. Extract the image itself (which could be in various formats).</span>
<span class="sd">        3. If it&#39;s a valid image, congratulations!  Otherwise try again.</span>

<span class="sd">        The moral of the story is that the author of this part of</span>
<span class="sd">        the PDF specification should have considered a career in</span>
<span class="sd">        literally anything else.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="p">(</span>
        <span class="nb">isinstance</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">PSKeyword</span><span class="p">)</span> <span class="ow">and</span> <span class="n">token</span> <span class="ow">is</span> <span class="n">KEYWORD_ID</span>
    <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Not ID: </span><span class="si">{</span><span class="n">token</span><span class="si">!r}</span><span class="s2">&quot;</span>
    <span class="n">idpos</span> <span class="o">=</span> <span class="n">pos</span>
    <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">objs</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pop_to</span><span class="p">(</span><span class="n">KEYWORD_BI</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">objs</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">error_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Invalid dictionary construct: </span><span class="si">{</span><span class="n">objs</span><span class="si">!r}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>
    <span class="n">dic</span> <span class="o">=</span> <span class="p">{</span><span class="n">literal_name</span><span class="p">(</span><span class="n">k</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">choplist</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">objs</span><span class="p">)</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">}</span>

    <span class="n">target_re</span> <span class="o">=</span> <span class="n">EIR</span>
    <span class="n">whitespace_re</span> <span class="o">=</span> <span class="n">SPC</span>
    <span class="c1"># Final filter is actually the *first* in the list</span>
    <span class="n">final_filter</span> <span class="o">=</span> <span class="n">dic</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="n">dic</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Filter&quot;</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">final_filter</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="n">final_filter</span><span class="p">:</span>
        <span class="n">final_filter</span> <span class="o">=</span> <span class="n">final_filter</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">final_filter</span> <span class="ow">in</span> <span class="n">LITERALS_ASCII85_DECODE</span><span class="p">:</span>
        <span class="c1"># ASCII85: look for ~&gt;EI, ignoring all whitespace</span>
        <span class="n">whitespace_re</span> <span class="o">=</span> <span class="n">WSR</span>
        <span class="n">target_re</span> <span class="o">=</span> <span class="n">A85R</span>
    <span class="k">elif</span> <span class="n">final_filter</span> <span class="ow">in</span> <span class="n">LITERALS_ASCIIHEX_DECODE</span><span class="p">:</span>
        <span class="c1"># ASCIIHex: just look for EI</span>
        <span class="n">whitespace_re</span> <span class="o">=</span> <span class="n">WSR</span>
        <span class="n">target_re</span> <span class="o">=</span> <span class="n">EIEIR</span>

    <span class="c1"># Find the start of the image data by skipping the appropriate</span>
    <span class="c1"># amount of whitespace.  In the case of ASCII filters, we need</span>
    <span class="c1"># to skip any extra whitespace before we use a possible Length</span>
    <span class="c1"># value (this is very dumb but the standard says...)</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">idpos</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lexer</span><span class="o">.</span><span class="n">data</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">whitespace_re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Note that WSR will also match nothing</span>
        <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ID token at </span><span class="si">{</span><span class="n">pos</span><span class="si">}</span><span class="s2"> not followed by whitespace&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># If you have Length, you have everything</span>
    <span class="n">length</span> <span class="o">=</span> <span class="n">dic</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">,</span> <span class="n">dic</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Length&quot;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">pos</span> <span class="o">+</span> <span class="n">int_value</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">end</span><span class="p">)</span>
        <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nexttoken</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">KEYWORD_EI</span><span class="p">:</span>
            <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;EI not found after Length </span><span class="si">{</span><span class="n">length</span><span class="si">!r}</span><span class="s2">&quot;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">InlineImage</span><span class="p">(</span><span class="n">dic</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">pos</span><span class="p">:</span><span class="n">end</span><span class="p">])</span>

    <span class="n">m</span> <span class="o">=</span> <span class="n">target_re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">InlineImage</span><span class="p">(</span><span class="n">dic</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">pos</span> <span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">0</span><span class="p">)])</span>
    <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Inline image at </span><span class="si">{</span><span class="n">pos</span><span class="si">}</span><span class="s2"> not terminated with </span><span class="si">{</span><span class="n">target_re</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>

    <span class="n">m</span> <span class="o">=</span> <span class="n">FURTHESTEIR</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;Inline image at </span><span class="si">%d</span><span class="s2"> has no whitespace before EI, &quot;</span>
            <span class="s2">&quot;expect horrible data loss!!!&quot;</span><span class="p">,</span>
            <span class="n">pos</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">InlineImage</span><span class="p">(</span><span class="n">dic</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">pos</span> <span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">])</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.parser.ObjectParser.get_object_reference" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_object_reference</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get an indirect object reference upon finding an "R" token.</p>

            <details class="quote">
              <summary>Source code in <code>playa/parser.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_object_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">token</span><span class="p">:</span> <span class="n">Token</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">ObjRef</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get an indirect object reference upon finding an &quot;R&quot; token.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">_pos</span><span class="p">,</span> <span class="n">_genno</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">_pos</span><span class="p">,</span> <span class="n">objid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span>
                <span class="s2">&quot;Expected generation and object id in indirect object reference&quot;</span>
            <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Expected generation and object id in indirect object reference: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">e</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="n">objid</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">objid</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">objid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span>
                <span class="s2">&quot;Object ID in reference at pos </span><span class="si">%d</span><span class="s2"> cannot be 0&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pos</span><span class="p">,)</span>
            <span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Ignoring indirect object reference to 0 at </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">ObjRef</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">docref</span><span class="p">,</span> <span class="n">objid</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.parser.ObjectParser.newstream" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">newstream</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Continue parsing from a new data stream.</p>

            <details class="quote">
              <summary>Source code in <code>playa/parser.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">newstream</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="n">mmap</span><span class="o">.</span><span class="n">mmap</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Continue parsing from a new data stream.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_lexer</span> <span class="o">=</span> <span class="n">Lexer</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.parser.ObjectParser.nextline" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">nextline</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Read (and do not parse) next line from underlying data.</p>

            <details class="quote">
              <summary>Source code in <code>playa/parser.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">nextline</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read (and do not parse) next line from underlying data.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lexer</span><span class="o">.</span><span class="n">nextline</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.parser.ObjectParser.nexttoken" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">nexttoken</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get the next token in iteration, raising StopIteration when
done.</p>

            <details class="quote">
              <summary>Source code in <code>playa/parser.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">nexttoken</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Token</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the next token in iteration, raising StopIteration when</span>
<span class="sd">    done.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_lexer</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.parser.ObjectParser.pop_to" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pop_to</span><span class="p">(</span><span class="n">token</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Pop everything from the stack back to token.</p>

            <details class="quote">
              <summary>Source code in <code>playa/parser.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">pop_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="p">:</span> <span class="n">PSKeyword</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">PDFObject</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pop everything from the stack back to token.&quot;&quot;&quot;</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PDFObject</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">:</span>
        <span class="n">pos</span><span class="p">,</span> <span class="n">last</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">last</span> <span class="ow">is</span> <span class="n">token</span><span class="p">:</span>
            <span class="n">context</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">pos</span><span class="p">,</span> <span class="n">context</span>
        <span class="n">context</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">last</span><span class="p">)</span>
    <span class="k">raise</span> <span class="n">PDFSyntaxError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unmatched end token </span><span class="si">{</span><span class="n">token</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.parser.ObjectParser.read" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read</span><span class="p">(</span><span class="n">objlen</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Read data from a specified position, moving the current
position to the end of this data.</p>

            <details class="quote">
              <summary>Source code in <code>playa/parser.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objlen</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read data from a specified position, moving the current</span>
<span class="sd">    position to the end of this data.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lexer</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">objlen</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.parser.ObjectParser.reset" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reset</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Clear internal parser state.</p>

            <details class="quote">
              <summary>Source code in <code>playa/parser.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Clear internal parser state.&quot;&quot;&quot;</span>
    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">[:]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.parser.ObjectParser.seek" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">seek</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Seek to a position.</p>

            <details class="quote">
              <summary>Source code in <code>playa/parser.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">seek</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Seek to a position.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_lexer</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="playa.parser.ObjectParser.tell" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tell</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get the current position in the file.</p>

            <details class="quote">
              <summary>Source code in <code>playa/parser.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">tell</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the current position in the file.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lexer</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="playa.parser.ObjectStreamParser" class="doc doc-heading">
            <code>ObjectStreamParser</code>


</h3>


    <div class="doc doc-contents ">


        <p>Parse indirect objects from an object stream.</p>






              <details class="quote">
                <summary>Source code in <code>playa/parser.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ObjectStreamParser</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parse indirect objects from an object stream.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">stream</span><span class="p">:</span> <span class="n">ContentStream</span><span class="p">,</span>
        <span class="n">doc</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Document&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span> <span class="o">=</span> <span class="n">ObjectParser</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="n">doc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">buffer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nobj</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">stream</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">first</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">stream</span><span class="p">[</span><span class="s2">&quot;First&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">objid</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="p">)</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="p">)</span>
                <span class="n">objid</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">objid</span><span class="p">)</span>
                <span class="n">pos</span> <span class="o">=</span> <span class="n">int_value</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Unexpected EOF in object stream&quot;</span><span class="p">)</span>
                <span class="k">break</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">objid</span><span class="p">,</span> <span class="n">pos</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offsets</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">nobj</span><span class="p">:</span>
                <span class="k">break</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">IndirectObject</span><span class="p">]]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">)</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">objid</span><span class="p">,</span> <span class="n">opos</span><span class="p">),</span> <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offsets</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">pos</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">first</span> <span class="o">+</span> <span class="n">opos</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;Invalid object stream: object </span><span class="si">%d</span><span class="s2"> is at </span><span class="si">%d</span><span class="s2">, should be at </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">objid</span><span class="p">,</span>
                    <span class="n">pos</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">first</span> <span class="o">+</span> <span class="n">opos</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">yield</span> <span class="n">pos</span><span class="p">,</span> <span class="n">IndirectObject</span><span class="p">(</span><span class="n">objid</span><span class="o">=</span><span class="n">objid</span><span class="p">,</span> <span class="n">genno</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="playa.parser.reverse_iter_lines" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reverse_iter_lines</span><span class="p">(</span><span class="n">buffer</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Iterate backwards over lines starting at the current position.</p>
<p>This is used to locate the trailers at the end of a file.</p>

            <details class="quote">
              <summary>Source code in <code>playa/parser.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reverse_iter_lines</span><span class="p">(</span><span class="n">buffer</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="n">mmap</span><span class="o">.</span><span class="n">mmap</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterate backwards over lines starting at the current position.</span>

<span class="sd">    This is used to locate the trailers at the end of a file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">endline</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buffer</span><span class="p">)</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">nidx</span> <span class="o">=</span> <span class="n">buffer</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
        <span class="n">ridx</span> <span class="o">=</span> <span class="n">buffer</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
        <span class="n">best</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">nidx</span><span class="p">,</span> <span class="n">ridx</span><span class="p">)</span>
        <span class="k">yield</span> <span class="n">best</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">buffer</span><span class="p">[</span><span class="n">best</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">endline</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">best</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">endline</span> <span class="o">=</span> <span class="n">best</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">best</span>
        <span class="k">if</span> <span class="n">pos</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">buffer</span><span class="p">[</span><span class="n">pos</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">pos</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">-=</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="playa.worker" class="doc doc-heading">
            <code>playa.worker</code>


</h2>

    <div class="doc doc-contents first">

        <p>Worker subprocess related functions and data.</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="playa.worker.in_worker" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">in_worker</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Are we currently in a worker process?</p>

            <details class="quote">
              <summary>Source code in <code>playa/worker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">in_worker</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Are we currently in a worker process?&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">__pdf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; David Huggins-Daines 2024-present
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
    
  </body>
</html>